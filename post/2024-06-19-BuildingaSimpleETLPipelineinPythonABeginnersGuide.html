<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>파이썬으로 간단한 ETL 파이프라인 구축하기 초보자를 위한 안내 | itposting</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://itposting.github.io///post/2024-06-19-BuildingaSimpleETLPipelineinPythonABeginnersGuide" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="파이썬으로 간단한 ETL 파이프라인 구축하기 초보자를 위한 안내 | itposting" data-gatsby-head="true"/><meta property="og:title" content="파이썬으로 간단한 ETL 파이프라인 구축하기 초보자를 위한 안내 | itposting" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-06-19-BuildingaSimpleETLPipelineinPythonABeginnersGuide_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://itposting.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://itposting.github.io///post/2024-06-19-BuildingaSimpleETLPipelineinPythonABeginnersGuide" data-gatsby-head="true"/><meta name="twitter:title" content="파이썬으로 간단한 ETL 파이프라인 구축하기 초보자를 위한 안내 | itposting" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-06-19-BuildingaSimpleETLPipelineinPythonABeginnersGuide_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | itposting" data-gatsby-head="true"/><meta name="article:published_time" content="2024-06-19 16:10" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-23YXDLKDCL"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-23YXDLKDCL');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-ac4aa08aae62f90e.js" defer=""></script><script src="/_next/static/chunks/463-0429087d4c0b0335.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-d849684d6d83f07a.js" defer=""></script><script src="/_next/static/8coAiP0lmiEK5aH6nkQkj/_buildManifest.js" defer=""></script><script src="/_next/static/8coAiP0lmiEK5aH6nkQkj/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">IT Posting</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">파이썬으로 간단한 ETL 파이프라인 구축하기 초보자를 위한 안내</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="파이썬으로 간단한 ETL 파이프라인 구축하기 초보자를 위한 안내" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">IT Posting</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Jun 19, 2024</span><span class="posts_reading_time__f7YPP">4<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-06-19-BuildingaSimpleETLPipelineinPythonABeginnersGuide&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<p>소개:</p>
<p>ETL (추출, 변환, 로드)은 데이터 엔지니어링에서 필수적인 프로세스로, 다양한 소스에서 데이터를 수집, 변환 및 저장하는 기능을 제공합니다. 이 안내서에서는 Python을 사용하여 날씨 데이터를 API에서 추출, 변환하고 CSV 파일에 저장하는 간단한 ETL 파이프라인을 구축하는 방법을 안내해 드리겠습니다.</p>
<p>설치:</p>
<p>시작하려면 Python 3.8 이상 버전 및 몇 가지 라이브러리가 설치되어 있어야 합니다. 터미널을 열고 다음 명령을 실행하세요:</p>
<div class="content-ad"></div>
<pre><code class="hljs language-js">pip install requests pandas
</code></pre>
<p><strong>단계 1: 날씨 데이터 추출 기능용 액세스 키 얻기</strong></p>
<p>날씨 데이터를 가져오기 위해 OpenWeatherMap API를 사용할 것입니다. 먼저 API 키를 얻어야 합니다.</p>
<ol>
<li>API 키 등록하세요:</li>
</ol>
<div class="content-ad"></div>
<ul>
<li>OpenWeatherMap 웹사이트로 이동해 주세요.</li>
<li>무료 계정을 등록하고 API 키를 획득해 주세요.</li>
</ul>
<p><strong>2. API 문서:</strong></p>
<ul>
<li>현재 날씨 데이터 섹션으로 이동해 주세요.</li>
<li>"Current Weather Data"를 클릭한 다음 "API 문서"를 클릭해 주세요.</li>
<li>요청하는 방법을 이해하기 위해 "도시 이름으로 내장된 API 요청"으로 스크롤해 주세요.</li>
</ul>
<p><strong>단계 2: 함수 추출</strong></p>
<div class="content-ad"></div>
<p>이제 API 키가 있으니, API에서 날씨 데이터를 가져오는 추출 함수를 작성해 봅시다.</p>
<pre><code class="hljs language-js"># 중요한 라이브러리들

<span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
</code></pre>
<pre><code class="hljs language-js">def <span class="hljs-title function_">fetch_weather_data</span>(<span class="hljs-attr">city</span>: str, <span class="hljs-attr">api_key</span>: str):
    url = f<span class="hljs-string">'http://api.openweathermap.org/data/2.5/weather?q={city}&#x26;appid={api_key}&#x26;units=metric'</span>
    response = requests.<span class="hljs-title function_">get</span>(url)
    <span class="hljs-keyword">if</span> response.<span class="hljs-property">status_code</span> == <span class="hljs-number">200</span>:
        <span class="hljs-keyword">return</span> response.<span class="hljs-title function_">json</span>()
    <span class="hljs-attr">else</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">None</span>

# 예시 사용법
api_key = <span class="hljs-string">'당신의_openweathermap_api_키'</span>
city = <span class="hljs-string">'런던'</span>
weather_data = <span class="hljs-title function_">fetch_weather_data</span>(city, api_key)
<span class="hljs-title function_">print</span>(weather_data)
</code></pre>
<p>fetch_weather_data 함수는 도시 이름과 API 키를 사용하여 API 요청 URL을 작성하고, API로 GET 요청을 보내 성공적인 요청이면 JSON 형식의 응답 데이터를 반환합니다.</p>
<div class="content-ad"></div>
<h3>단계 3: 변환 함수</h3>
<p>이제 데이터를 보다 구조화된 형식으로 변환할 것입니다:</p>
<pre><code class="hljs language-js">def <span class="hljs-title function_">transform_weather_data</span>(<span class="hljs-attr">data</span>: dict):
    <span class="hljs-keyword">if</span> not <span class="hljs-attr">data</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">None</span>

    weather_info = {
        <span class="hljs-string">'city'</span>: data[<span class="hljs-string">'name'</span>],
        <span class="hljs-string">'temperature'</span>: data[<span class="hljs-string">'main'</span>][<span class="hljs-string">'temp'</span>],
        <span class="hljs-string">'humidity'</span>: data[<span class="hljs-string">'main'</span>][<span class="hljs-string">'humidity'</span>],
        <span class="hljs-string">'weather'</span>: data[<span class="hljs-string">'weather'</span>][<span class="hljs-number">0</span>][<span class="hljs-string">'description'</span>],
        <span class="hljs-string">'wind_speed'</span>: data[<span class="hljs-string">'wind'</span>][<span class="hljs-string">'speed'</span>],
        <span class="hljs-string">'wind_deg'</span>: data[<span class="hljs-string">'wind'</span>][<span class="hljs-string">'deg'</span>]
    }
    <span class="hljs-keyword">return</span> weather_info

# 예제 사용법
transformed_data = <span class="hljs-title function_">transform_weather_data</span>(weather_data)
<span class="hljs-title function_">print</span>(transformed_data)
</code></pre>
<h3>단계 4: 모든 단계를 결합하는 함수</h3>
<div class="content-ad"></div>
<p>마지막으로, 변환된 데이터를 CSV 파일로 로드하겠습니다:</p>
<pre><code class="hljs language-js">def <span class="hljs-title function_">load_data_to_csv</span>(<span class="hljs-attr">data</span>: dict, <span class="hljs-attr">file_path</span>: str):
    df = pd.<span class="hljs-title class_">DataFrame</span>([data])
    df.<span class="hljs-title function_">to_csv</span>(file_path, index=<span class="hljs-title class_">False</span>)

# 사용 예시
output_file = <span class="hljs-string">'weather_data.csv'</span>
<span class="hljs-title function_">load_data_to_csv</span>(transformed_data, output_file)
<span class="hljs-title function_">print</span>(f<span class="hljs-string">'{output_file}에 데이터 저장 완료'</span>)
</code></pre>
<p>모든 단계를 통합한 완전한 스크립트입니다:</p>
<div class="content-ad"></div>
<pre><code class="hljs language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">fetch_weather_data</span>(<span class="hljs-params">city: <span class="hljs-built_in">str</span>, api_key: <span class="hljs-built_in">str</span></span>):
    url = <span class="hljs-string">f'http://api.openweathermap.org/data/2.5/weather?q=<span class="hljs-subst">{city}</span>&#x26;appid=<span class="hljs-subst">{api_key}</span>&#x26;units=metric'</span>
    response = requests.get(url)
    <span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:
        <span class="hljs-keyword">return</span> response.json()
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">transform_weather_data</span>(<span class="hljs-params">data: <span class="hljs-built_in">dict</span></span>):
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> data:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>

    weather_info = {
        <span class="hljs-string">'city'</span>: data[<span class="hljs-string">'name'</span>],
        <span class="hljs-string">'temperature'</span>: data[<span class="hljs-string">'main'</span>][<span class="hljs-string">'temp'</span>],
        <span class="hljs-string">'humidity'</span>: data[<span class="hljs-string">'main'</span>][<span class="hljs-string">'humidity'</span>],
        <span class="hljs-string">'weather'</span>: data[<span class="hljs-string">'weather'</span>][<span class="hljs-number">0</span>][<span class="hljs-string">'description'</span>],
        <span class="hljs-string">'wind_speed'</span>: data[<span class="hljs-string">'wind'</span>][<span class="hljs-string">'speed'</span>],
        <span class="hljs-string">'wind_deg'</span>: data[<span class="hljs-string">'wind'</span>][<span class="hljs-string">'deg'</span>]
    }
    <span class="hljs-keyword">return</span> weather_info

<span class="hljs-keyword">def</span> <span class="hljs-title function_">load_data_to_csv</span>(<span class="hljs-params">data: <span class="hljs-built_in">dict</span>, file_path: <span class="hljs-built_in">str</span></span>):
    df = pd.DataFrame([data])
    df.to_csv(file_path, index=<span class="hljs-literal">False</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    api_key = <span class="hljs-string">'your_openweathermap_api_key'</span>
    city = <span class="hljs-string">'London'</span>
    weather_data = fetch_weather_data(city, api_key)
    <span class="hljs-keyword">if</span> weather_data:
        transformed_data = transform_weather_data(weather_data)
        output_file = <span class="hljs-string">'weather_data.csv'</span>
        load_data_to_csv(transformed_data, output_file)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f'Data saved to <span class="hljs-subst">{output_file}</span>'</span>)
    <span class="hljs-keyword">else</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">'Failed to fetch data'</span>)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    main()
</code></pre>
<p><strong>결론</strong></p>
<p>이번 튜토리얼에서는 Python으로 간단한 ETL(추출, 변환, 적재) 파이프라인을 만들었습니다. API에서 데이터를 가져와 변환한 뒤 CSV 파일로 저장했습니다. 이 기본 프로젝트를 통해 데이터 엔지니어링 및 분석에서 중요한 ETL 프로세스를 이해할 수 있습니다.</p>
<p><strong>추가 자료</strong></p>
<div class="content-ad"></div>
<ul>
<li>OpenWeatherMap API</li>
</ul>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"파이썬으로 간단한 ETL 파이프라인 구축하기 초보자를 위한 안내","description":"","date":"2024-06-19 16:10","slug":"2024-06-19-BuildingaSimpleETLPipelineinPythonABeginnersGuide","content":"\n\n소개:\n\nETL (추출, 변환, 로드)은 데이터 엔지니어링에서 필수적인 프로세스로, 다양한 소스에서 데이터를 수집, 변환 및 저장하는 기능을 제공합니다. 이 안내서에서는 Python을 사용하여 날씨 데이터를 API에서 추출, 변환하고 CSV 파일에 저장하는 간단한 ETL 파이프라인을 구축하는 방법을 안내해 드리겠습니다.\n\n설치:\n\n시작하려면 Python 3.8 이상 버전 및 몇 가지 라이브러리가 설치되어 있어야 합니다. 터미널을 열고 다음 명령을 실행하세요:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\npip install requests pandas\n```\n\n**단계 1: 날씨 데이터 추출 기능용 액세스 키 얻기**\n\n날씨 데이터를 가져오기 위해 OpenWeatherMap API를 사용할 것입니다. 먼저 API 키를 얻어야 합니다.\n\n1. API 키 등록하세요:\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n- OpenWeatherMap 웹사이트로 이동해 주세요.\n- 무료 계정을 등록하고 API 키를 획득해 주세요.\n\n**2. API 문서:**\n\n- 현재 날씨 데이터 섹션으로 이동해 주세요.\n- \"Current Weather Data\"를 클릭한 다음 \"API 문서\"를 클릭해 주세요.\n- 요청하는 방법을 이해하기 위해 \"도시 이름으로 내장된 API 요청\"으로 스크롤해 주세요.\n\n**단계 2: 함수 추출**\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n이제 API 키가 있으니, API에서 날씨 데이터를 가져오는 추출 함수를 작성해 봅시다.\n\n```js\n# 중요한 라이브러리들\n\nimport requests\nimport pandas as pd\n```\n\n```js\ndef fetch_weather_data(city: str, api_key: str):\n    url = f'http://api.openweathermap.org/data/2.5/weather?q={city}\u0026appid={api_key}\u0026units=metric'\n    response = requests.get(url)\n    if response.status_code == 200:\n        return response.json()\n    else:\n        return None\n\n# 예시 사용법\napi_key = '당신의_openweathermap_api_키'\ncity = '런던'\nweather_data = fetch_weather_data(city, api_key)\nprint(weather_data)\n```\n\nfetch_weather_data 함수는 도시 이름과 API 키를 사용하여 API 요청 URL을 작성하고, API로 GET 요청을 보내 성공적인 요청이면 JSON 형식의 응답 데이터를 반환합니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n### 단계 3: 변환 함수\n\n이제 데이터를 보다 구조화된 형식으로 변환할 것입니다:\n\n```js\ndef transform_weather_data(data: dict):\n    if not data:\n        return None\n\n    weather_info = {\n        'city': data['name'],\n        'temperature': data['main']['temp'],\n        'humidity': data['main']['humidity'],\n        'weather': data['weather'][0]['description'],\n        'wind_speed': data['wind']['speed'],\n        'wind_deg': data['wind']['deg']\n    }\n    return weather_info\n\n# 예제 사용법\ntransformed_data = transform_weather_data(weather_data)\nprint(transformed_data)\r\n```\n\n### 단계 4: 모든 단계를 결합하는 함수\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n마지막으로, 변환된 데이터를 CSV 파일로 로드하겠습니다:\n\n```js\ndef load_data_to_csv(data: dict, file_path: str):\n    df = pd.DataFrame([data])\n    df.to_csv(file_path, index=False)\n\n# 사용 예시\noutput_file = 'weather_data.csv'\nload_data_to_csv(transformed_data, output_file)\nprint(f'{output_file}에 데이터 저장 완료')\n```\n\n모든 단계를 통합한 완전한 스크립트입니다:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```python\ndef fetch_weather_data(city: str, api_key: str):\n    url = f'http://api.openweathermap.org/data/2.5/weather?q={city}\u0026appid={api_key}\u0026units=metric'\n    response = requests.get(url)\n    if response.status_code == 200:\n        return response.json()\n    else:\n        return None\n\ndef transform_weather_data(data: dict):\n    if not data:\n        return None\n\n    weather_info = {\n        'city': data['name'],\n        'temperature': data['main']['temp'],\n        'humidity': data['main']['humidity'],\n        'weather': data['weather'][0]['description'],\n        'wind_speed': data['wind']['speed'],\n        'wind_deg': data['wind']['deg']\n    }\n    return weather_info\n\ndef load_data_to_csv(data: dict, file_path: str):\n    df = pd.DataFrame([data])\n    df.to_csv(file_path, index=False)\n\ndef main():\n    api_key = 'your_openweathermap_api_key'\n    city = 'London'\n    weather_data = fetch_weather_data(city, api_key)\n    if weather_data:\n        transformed_data = transform_weather_data(weather_data)\n        output_file = 'weather_data.csv'\n        load_data_to_csv(transformed_data, output_file)\n        print(f'Data saved to {output_file}')\n    else:\n        print('Failed to fetch data')\n\nif __name__ == '__main__':\n    main()\n```\n\n**결론**\n\n이번 튜토리얼에서는 Python으로 간단한 ETL(추출, 변환, 적재) 파이프라인을 만들었습니다. API에서 데이터를 가져와 변환한 뒤 CSV 파일로 저장했습니다. 이 기본 프로젝트를 통해 데이터 엔지니어링 및 분석에서 중요한 ETL 프로세스를 이해할 수 있습니다.\n\n**추가 자료**\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n- OpenWeatherMap API","ogImage":{"url":"/assets/img/2024-06-19-BuildingaSimpleETLPipelineinPythonABeginnersGuide_0.png"},"coverImage":"/assets/img/2024-06-19-BuildingaSimpleETLPipelineinPythonABeginnersGuide_0.png","tag":["Tech"],"readingTime":4},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003e소개:\u003c/p\u003e\n\u003cp\u003eETL (추출, 변환, 로드)은 데이터 엔지니어링에서 필수적인 프로세스로, 다양한 소스에서 데이터를 수집, 변환 및 저장하는 기능을 제공합니다. 이 안내서에서는 Python을 사용하여 날씨 데이터를 API에서 추출, 변환하고 CSV 파일에 저장하는 간단한 ETL 파이프라인을 구축하는 방법을 안내해 드리겠습니다.\u003c/p\u003e\n\u003cp\u003e설치:\u003c/p\u003e\n\u003cp\u003e시작하려면 Python 3.8 이상 버전 및 몇 가지 라이브러리가 설치되어 있어야 합니다. 터미널을 열고 다음 명령을 실행하세요:\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003epip install requests pandas\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003e단계 1: 날씨 데이터 추출 기능용 액세스 키 얻기\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e날씨 데이터를 가져오기 위해 OpenWeatherMap API를 사용할 것입니다. 먼저 API 키를 얻어야 합니다.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eAPI 키 등록하세요:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eOpenWeatherMap 웹사이트로 이동해 주세요.\u003c/li\u003e\n\u003cli\u003e무료 계정을 등록하고 API 키를 획득해 주세요.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e2. API 문서:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e현재 날씨 데이터 섹션으로 이동해 주세요.\u003c/li\u003e\n\u003cli\u003e\"Current Weather Data\"를 클릭한 다음 \"API 문서\"를 클릭해 주세요.\u003c/li\u003e\n\u003cli\u003e요청하는 방법을 이해하기 위해 \"도시 이름으로 내장된 API 요청\"으로 스크롤해 주세요.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e단계 2: 함수 추출\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e이제 API 키가 있으니, API에서 날씨 데이터를 가져오는 추출 함수를 작성해 봅시다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# 중요한 라이브러리들\n\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e requests\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e pandas \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e pd\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003edef \u003cspan class=\"hljs-title function_\"\u003efetch_weather_data\u003c/span\u003e(\u003cspan class=\"hljs-attr\"\u003ecity\u003c/span\u003e: str, \u003cspan class=\"hljs-attr\"\u003eapi_key\u003c/span\u003e: str):\n    url = f\u003cspan class=\"hljs-string\"\u003e'http://api.openweathermap.org/data/2.5/weather?q={city}\u0026#x26;appid={api_key}\u0026#x26;units=metric'\u003c/span\u003e\n    response = requests.\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(url)\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e response.\u003cspan class=\"hljs-property\"\u003estatus_code\u003c/span\u003e == \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e:\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e response.\u003cspan class=\"hljs-title function_\"\u003ejson\u003c/span\u003e()\n    \u003cspan class=\"hljs-attr\"\u003eelse\u003c/span\u003e:\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eNone\u003c/span\u003e\n\n# 예시 사용법\napi_key = \u003cspan class=\"hljs-string\"\u003e'당신의_openweathermap_api_키'\u003c/span\u003e\ncity = \u003cspan class=\"hljs-string\"\u003e'런던'\u003c/span\u003e\nweather_data = \u003cspan class=\"hljs-title function_\"\u003efetch_weather_data\u003c/span\u003e(city, api_key)\n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(weather_data)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003efetch_weather_data 함수는 도시 이름과 API 키를 사용하여 API 요청 URL을 작성하고, API로 GET 요청을 보내 성공적인 요청이면 JSON 형식의 응답 데이터를 반환합니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003ch3\u003e단계 3: 변환 함수\u003c/h3\u003e\n\u003cp\u003e이제 데이터를 보다 구조화된 형식으로 변환할 것입니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003edef \u003cspan class=\"hljs-title function_\"\u003etransform_weather_data\u003c/span\u003e(\u003cspan class=\"hljs-attr\"\u003edata\u003c/span\u003e: dict):\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e not \u003cspan class=\"hljs-attr\"\u003edata\u003c/span\u003e:\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eNone\u003c/span\u003e\n\n    weather_info = {\n        \u003cspan class=\"hljs-string\"\u003e'city'\u003c/span\u003e: data[\u003cspan class=\"hljs-string\"\u003e'name'\u003c/span\u003e],\n        \u003cspan class=\"hljs-string\"\u003e'temperature'\u003c/span\u003e: data[\u003cspan class=\"hljs-string\"\u003e'main'\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e'temp'\u003c/span\u003e],\n        \u003cspan class=\"hljs-string\"\u003e'humidity'\u003c/span\u003e: data[\u003cspan class=\"hljs-string\"\u003e'main'\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e'humidity'\u003c/span\u003e],\n        \u003cspan class=\"hljs-string\"\u003e'weather'\u003c/span\u003e: data[\u003cspan class=\"hljs-string\"\u003e'weather'\u003c/span\u003e][\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e'description'\u003c/span\u003e],\n        \u003cspan class=\"hljs-string\"\u003e'wind_speed'\u003c/span\u003e: data[\u003cspan class=\"hljs-string\"\u003e'wind'\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e'speed'\u003c/span\u003e],\n        \u003cspan class=\"hljs-string\"\u003e'wind_deg'\u003c/span\u003e: data[\u003cspan class=\"hljs-string\"\u003e'wind'\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e'deg'\u003c/span\u003e]\n    }\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e weather_info\n\n# 예제 사용법\ntransformed_data = \u003cspan class=\"hljs-title function_\"\u003etransform_weather_data\u003c/span\u003e(weather_data)\n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(transformed_data)\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e단계 4: 모든 단계를 결합하는 함수\u003c/h3\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e마지막으로, 변환된 데이터를 CSV 파일로 로드하겠습니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003edef \u003cspan class=\"hljs-title function_\"\u003eload_data_to_csv\u003c/span\u003e(\u003cspan class=\"hljs-attr\"\u003edata\u003c/span\u003e: dict, \u003cspan class=\"hljs-attr\"\u003efile_path\u003c/span\u003e: str):\n    df = pd.\u003cspan class=\"hljs-title class_\"\u003eDataFrame\u003c/span\u003e([data])\n    df.\u003cspan class=\"hljs-title function_\"\u003eto_csv\u003c/span\u003e(file_path, index=\u003cspan class=\"hljs-title class_\"\u003eFalse\u003c/span\u003e)\n\n# 사용 예시\noutput_file = \u003cspan class=\"hljs-string\"\u003e'weather_data.csv'\u003c/span\u003e\n\u003cspan class=\"hljs-title function_\"\u003eload_data_to_csv\u003c/span\u003e(transformed_data, output_file)\n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(f\u003cspan class=\"hljs-string\"\u003e'{output_file}에 데이터 저장 완료'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e모든 단계를 통합한 완전한 스크립트입니다:\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003efetch_weather_data\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003ecity: \u003cspan class=\"hljs-built_in\"\u003estr\u003c/span\u003e, api_key: \u003cspan class=\"hljs-built_in\"\u003estr\u003c/span\u003e\u003c/span\u003e):\n    url = \u003cspan class=\"hljs-string\"\u003ef'http://api.openweathermap.org/data/2.5/weather?q=\u003cspan class=\"hljs-subst\"\u003e{city}\u003c/span\u003e\u0026#x26;appid=\u003cspan class=\"hljs-subst\"\u003e{api_key}\u003c/span\u003e\u0026#x26;units=metric'\u003c/span\u003e\n    response = requests.get(url)\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e response.status_code == \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e:\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e response.json()\n    \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e:\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003eNone\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003etransform_weather_data\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003edata: \u003cspan class=\"hljs-built_in\"\u003edict\u003c/span\u003e\u003c/span\u003e):\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e data:\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003eNone\u003c/span\u003e\n\n    weather_info = {\n        \u003cspan class=\"hljs-string\"\u003e'city'\u003c/span\u003e: data[\u003cspan class=\"hljs-string\"\u003e'name'\u003c/span\u003e],\n        \u003cspan class=\"hljs-string\"\u003e'temperature'\u003c/span\u003e: data[\u003cspan class=\"hljs-string\"\u003e'main'\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e'temp'\u003c/span\u003e],\n        \u003cspan class=\"hljs-string\"\u003e'humidity'\u003c/span\u003e: data[\u003cspan class=\"hljs-string\"\u003e'main'\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e'humidity'\u003c/span\u003e],\n        \u003cspan class=\"hljs-string\"\u003e'weather'\u003c/span\u003e: data[\u003cspan class=\"hljs-string\"\u003e'weather'\u003c/span\u003e][\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e'description'\u003c/span\u003e],\n        \u003cspan class=\"hljs-string\"\u003e'wind_speed'\u003c/span\u003e: data[\u003cspan class=\"hljs-string\"\u003e'wind'\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e'speed'\u003c/span\u003e],\n        \u003cspan class=\"hljs-string\"\u003e'wind_deg'\u003c/span\u003e: data[\u003cspan class=\"hljs-string\"\u003e'wind'\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e'deg'\u003c/span\u003e]\n    }\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e weather_info\n\n\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eload_data_to_csv\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003edata: \u003cspan class=\"hljs-built_in\"\u003edict\u003c/span\u003e, file_path: \u003cspan class=\"hljs-built_in\"\u003estr\u003c/span\u003e\u003c/span\u003e):\n    df = pd.DataFrame([data])\n    df.to_csv(file_path, index=\u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e)\n\n\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003emain\u003c/span\u003e():\n    api_key = \u003cspan class=\"hljs-string\"\u003e'your_openweathermap_api_key'\u003c/span\u003e\n    city = \u003cspan class=\"hljs-string\"\u003e'London'\u003c/span\u003e\n    weather_data = fetch_weather_data(city, api_key)\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e weather_data:\n        transformed_data = transform_weather_data(weather_data)\n        output_file = \u003cspan class=\"hljs-string\"\u003e'weather_data.csv'\u003c/span\u003e\n        load_data_to_csv(transformed_data, output_file)\n        \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003ef'Data saved to \u003cspan class=\"hljs-subst\"\u003e{output_file}\u003c/span\u003e'\u003c/span\u003e)\n    \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e:\n        \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'Failed to fetch data'\u003c/span\u003e)\n\n\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e __name__ == \u003cspan class=\"hljs-string\"\u003e'__main__'\u003c/span\u003e:\n    main()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003e결론\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e이번 튜토리얼에서는 Python으로 간단한 ETL(추출, 변환, 적재) 파이프라인을 만들었습니다. API에서 데이터를 가져와 변환한 뒤 CSV 파일로 저장했습니다. 이 기본 프로젝트를 통해 데이터 엔지니어링 및 분석에서 중요한 ETL 프로세스를 이해할 수 있습니다.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e추가 자료\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eOpenWeatherMap API\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-06-19-BuildingaSimpleETLPipelineinPythonABeginnersGuide"},"buildId":"8coAiP0lmiEK5aH6nkQkj","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>