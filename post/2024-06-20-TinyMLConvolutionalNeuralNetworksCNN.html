<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>ë§ˆì´í¬ë¡œ ë¨¸ì‹ ëŸ¬ë‹  í•©ì„±ê³± ì‹ ê²½ë§ CNN | itposting</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://itposting.github.io///post/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="ë§ˆì´í¬ë¡œ ë¨¸ì‹ ëŸ¬ë‹  í•©ì„±ê³± ì‹ ê²½ë§ CNN | itposting" data-gatsby-head="true"/><meta property="og:title" content="ë§ˆì´í¬ë¡œ ë¨¸ì‹ ëŸ¬ë‹  í•©ì„±ê³± ì‹ ê²½ë§ CNN | itposting" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://itposting.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://itposting.github.io///post/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN" data-gatsby-head="true"/><meta name="twitter:title" content="ë§ˆì´í¬ë¡œ ë¨¸ì‹ ëŸ¬ë‹  í•©ì„±ê³± ì‹ ê²½ë§ CNN | itposting" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | itposting" data-gatsby-head="true"/><meta name="article:published_time" content="2024-06-20 16:55" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-23YXDLKDCL"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-23YXDLKDCL');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-4a646156c659a948.js" defer=""></script><script src="/_next/static/chunks/348-d11c34b645b13f5b.js" defer=""></script><script src="/_next/static/chunks/162-4172e84c8e2aa747.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-0fd008072af5a644.js" defer=""></script><script src="/_next/static/FH3Qr-mLAesqA0X5IFRQr/_buildManifest.js" defer=""></script><script src="/_next/static/FH3Qr-mLAesqA0X5IFRQr/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">IT Posting</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">ë§ˆì´í¬ë¡œ ë¨¸ì‹ ëŸ¬ë‹  í•©ì„±ê³± ì‹ ê²½ë§ CNN</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="ë§ˆì´í¬ë¡œ ë¨¸ì‹ ëŸ¬ë‹  í•©ì„±ê³± ì‹ ê²½ë§ CNN" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">IT Posting</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Jun 20, 2024</span><span class="posts_reading_time__f7YPP">23<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<p>ìˆ˜í•™ì  ê¸°ì´ˆë¶€í„° ì—£ì§€ êµ¬í˜„ê¹Œì§€</p>
<h1>ì†Œì…œ ë¯¸ë””ì–´:</h1>
<p>ğŸ‘¨ğŸ½â€ğŸ’» Github: thommaskevin/TinyML (github.com)
ğŸ‘·ğŸ¾ Linkedin: Thommas Kevin | LinkedIn
ğŸ“½ Youtube: Thommas Kevin â€” YouTube
ğŸ‘¨ğŸ»â€ğŸ« ì—°êµ¬ ê·¸ë£¹: Conecta.ai (ufrn.br)</p>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_0.png" alt="ì´ë¯¸ì§€"></p>
<h2>ìš”ì•½</h2>
<h1>1 â€” ì»¨ë³¼ë£¨ì…˜ ì‹ ê²½ë§ ì—­ì‚¬</h1>
<p>ì»¨ë³¼ë£¨ì…˜ ì‹ ê²½ë§(CNN)ì˜ ê°œë…ì€ 1980ë…„ëŒ€ ê¸ˆì‚¬ì´ í›„ì½”ì‹œë§ˆì˜ ì—°êµ¬ë¡œ í˜•ì„±ë˜ê¸° ì‹œì‘í–ˆìŠµë‹ˆë‹¤. ê·¸ëŠ” Neocognitronì„ ê°œë°œí–ˆëŠ”ë°, ì´ëŠ” ë™ë¬¼ì˜ ì‹œê° ì‹œìŠ¤í…œ êµ¬ì¡°ì—ì„œ ì˜ê°ì„ ë°›ì•„ ìê°€ ì¡°ì§í™” ê³¼ì •ì„ í†µí•´ ì‹œê°ì  íŒ¨í„´ì„ ì¸ì‹í•  ìˆ˜ ìˆëŠ” í•™ìŠµì´ ê°€ëŠ¥í•œ ê³„ì¸µì  êµ¬ì¡°ë¥¼ ê°€ì¡ŒìŠµë‹ˆë‹¤. ì´ ì‘ì—…ì€ í˜„ëŒ€ CNNì˜ ê°œë°œì„ ìœ„í•œ ì¤‘ìš”í•œ ì„ í–‰ ì—°êµ¬ì˜€ìŠµë‹ˆë‹¤.</p>
<p>CNNì˜ í˜„ëŒ€ ì•„í‚¤í…ì²˜ëŠ” ì–€ ë¥´ì¿¤ê³¼ ê·¸ì˜ ë™ë£Œë“¤ì— ì˜í•´ 1980ë…„ëŒ€ í›„ë°˜ê³¼ 1990ë…„ëŒ€ ì´ˆì— ì œì•ˆë˜ì—ˆìŠµë‹ˆë‹¤. ê·¸ë“¤ì€ MNIST ë°ì´í„°ì…‹ì—ì„œ ì†ìœ¼ë¡œ ì“´ ìˆ«ìë¥¼ ì¸ì‹í•˜ê¸° ìœ„í•´ ì„¤ê³„ëœ ì»¨ë³¼ë£¨ì…˜ ì‹ ê²½ë§ì¸ LeNet-5ë¥¼ ê°œë°œí–ˆìŠµë‹ˆë‹¤. LeNet-5ëŠ” ì—¬ëŸ¬ ê°œì˜ ì»¨ë³¼ë£¨ì…˜ ë ˆì´ì–´ë¥¼ ê±°ì¹œ í›„ pooling ë ˆì´ì–´ì™€ ì™„ì „ ì—°ê²° ë ˆì´ì–´ë¡œ ì´ì–´ì§€ëŠ” êµ¬ì¡°ë¡œ, ì˜¤ëŠ˜ë‚  ì‚¬ìš©ë˜ëŠ” CNNì˜ ì•„í‚¤í…ì²˜ì˜ ê¸°ì´ˆë¥¼ êµ¬ì¶•í–ˆìŠµë‹ˆë‹¤.</p>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_2.png" alt="image"></p>
<p>ì´ˆê¸° ì„±ê³µì—ë„ ë¶ˆêµ¬í•˜ê³  CNNì˜ í™œìš©ì€ ê³„ì‚° ì œì•½ê³¼ ëŒ€ê·œëª¨ ë ˆì´ë¸” ë°ì´í„°ì…‹ì˜ ë¶€ì¡±ìœ¼ë¡œ ì œí•œë˜ì—ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì»´í“¨íŒ… íŒŒì›Œê°€ ì¦ê°€í•˜ê³  GPU(ê·¸ë˜í”½ ì²˜ë¦¬ ì¥ì¹˜)ë¥¼ ì‚¬ìš©í•´ ë”¥ ë„¤íŠ¸ì›Œí¬ë¥¼ í›ˆë ¨í•˜ëŠ” ê¸°ìˆ ì´ ì‹¤í˜„ ê°€ëŠ¥í•´ì§€ë©´ì„œ CNNì€ ë” ë§ì€ ê´€ì‹¬ì„ ëŒê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ê²Œë‹¤ê°€ ImageNetê³¼ ê°™ì€ ëŒ€ê·œëª¨ ë ˆì´ë¸” ì´ë¯¸ì§€ ë°ì´í„°ë² ì´ìŠ¤ì˜ ê°œë°œì€ ë”¥ ë„¤íŠ¸ì›Œí¬ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ í›ˆë ¨í•˜ê¸° ìœ„í•œ í•„ìˆ˜ ìë£Œë¥¼ ì œê³µí–ˆìŠµë‹ˆë‹¤.</p>
<p>2012ë…„ì— Alex Krizhevsky, Ilya Sutskever, Geoffrey Hintonì´ ê°œë°œí•œ AlexNetì´ ImageNet ëŒ€ê·œëª¨ ì‹œê° ì¸ì‹ ì±Œë¦°ì§€(ILSVRC)ì—ì„œ ê²½ìŸ ìƒëŒ€ë“¤ë³´ë‹¤ í° í­ìœ¼ë¡œ ìš°ìŠ¹í•˜ë©´ì„œ ì „í™˜ì ì´ ì°¾ì•„ì™”ìŠµë‹ˆë‹¤. AlexNetì€ ì—¬ëŸ¬ ì»¨ë³¼ë£¨ì…˜ ë ˆì´ì–´, ReLU í™œì„±í™” í•¨ìˆ˜, ê·¸ë¦¬ê³  dropoutê³¼ ê°™ì€ ì •ê·œí™” ê¸°ë²•ì„ í™œìš©í•˜ì—¬ ì‹œê° ì¸ì‹ ì‘ì—…ì— CNNì˜ ì„±ëŠ¥ì„ ì…ì¦í–ˆìŠµë‹ˆë‹¤. ì´í›„ë¡œ CNNì€ ë‹¤ì–‘í•œ ì‘ìš© ë¶„ì•¼ì— ëŒ€í•œ ì£¼ìš” ë„êµ¬ê°€ ë˜ì–´ ì§€ì†ì ì¸ í˜ì‹ ì„ ì´ëŒì–´ë‚´ëŠ” ë° ì´ë¥´ë €ìŠµë‹ˆë‹¤. VGGNet, GoogLeNet(Inception), ResNetê³¼ ê°™ì€ ëª¨ë¸ë“¤ì€ ë„¤íŠ¸ì›Œí¬ì˜ ê¹Šì´, íš¨ìœ¨ì„±, ì •í™•ë„ë¥¼ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•œ ìƒˆë¡œìš´ ì•„í‚¤í…ì²˜ì™€ ê¸°ë²•ë“¤ì„ ì†Œê°œí–ˆìŠµë‹ˆë‹¤.</p>
<p>ì§€ê¸ˆì€ CNNì´ ë§ì€ ì¸ê³µì§€ëŠ¥ ì‹œìŠ¤í…œì˜ í•„ìˆ˜ êµ¬ì„± ìš”ì†Œì…ë‹ˆë‹¤. ì´ë¯¸ì§€ ì¸ì‹ ë¿ë§Œ ì•„ë‹ˆë¼ ë¹„ë””ì˜¤ ë¶„ì„, ìì—°ì–´ ì²˜ë¦¬, ì˜í•™ ì§„ë‹¨, ììœ¨ ì£¼í–‰ì°¨ ë“± ë‹¤ì–‘í•œ ë¶„ì•¼ì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤. ì—°êµ¬ëŠ” ê³„ì†í•´ì„œ ë°œì „í•˜ê³  ìˆìœ¼ë©°, íš¨ìœ¨ì ì¸ í•©ì„±ê³± ì‹ ê²½ë§, ê¹Šì€ ì‹ ê²½ë§(DNNs), ìƒì„±ì  ì ëŒ€ ì‹ ê²½ë§(GANs) ë“±ì˜ í˜ì‹ ì´ ì´ë£¨ì–´ì§€ê³  ìˆìŠµë‹ˆë‹¤.</p>
<h1>2â€” í•©ì„±ê³± ì‹ ê²½ë§ ì´ë¡ </h1>
<p>ìˆ˜í•™ì—ì„œ "í•©ì„±ê³±"ì€ í•œ í•¨ìˆ˜ê°€ ë‹¤ë¥¸ í•¨ìˆ˜ì— ì˜í•´ ë³€í™˜ë˜ëŠ” í†µí•© ì—°ì‚°ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì‹ ê²½ë§ì˜ ë§¥ë½ì—ì„œëŠ” ì´ ê°œë…ì´ ì „í†µì ì¸ í†µê³„ì  í•´ì„ê³¼ ë‹¤ë¦…ë‹ˆë‹¤.</p>
<p>ê¸°ë³¸ì ìœ¼ë¡œ ìš°ë¦¬ëŠ” ì…ë ¥ í•¨ìˆ˜ë¡œ ì‹œì‘í•©ë‹ˆë‹¤. ìš°ë¦¬ì˜ ê²½ìš°ì—ëŠ” ì£¼ë¡œ ì´ë¯¸ì§€ì…ë‹ˆë‹¤. ë˜í•œ, í•„í„°(ì»¤ë„ì´ë¼ê³ ë„ í•¨)ë¥¼ ì†Œê°œí•©ë‹ˆë‹¤. ì´ë¯¸ì§€ëŠ” ì ê³± ì—°ì‚°ì„ í†µí•´ ë³€í™˜ë˜ëŠ” í•¨ìˆ˜ë¡œ, ì¼ë°˜ì ìœ¼ë¡œ "í•©ì„±ê³±(convolution)"ì´ë¼ê³  í•©ë‹ˆë‹¤. ê·¸ ë‹¤ìŒ, ì´ëŸ¬í•œ í•„í„°ë¥¼ ì…ë ¥ ì´ë¯¸ì§€ì— ì ìš©í•˜ë©´ "íŠ¹ì„± ë§µ(feature maps)"ì´ë¼ê³  í•˜ëŠ” ì¶œë ¥ ì´ë¯¸ì§€ë¥¼ ì–»ê²Œ ë©ë‹ˆë‹¤.</p>
<h2>2.1 â€” í•©ì„±ê³± ê³„ì¸µ</h2>
<p>í•©ì„±ê³± ê³„ì¸µì€ íŒ¨í„´ì„ ê°ì§€í•˜ê³  í•„í„°(ì»¤ë„)ë¥¼ í†µí•´ íŠ¹ì„± ë§µì„ ìƒì„±í•˜ê¸° ìœ„í•´ ì´ë¯¸ì§€ê°€ ì²˜ë¦¬ë˜ëŠ” ê³³ì…ë‹ˆë‹¤. ì´ëŸ¬í•œ íŠ¹ì„± ë§µì€ í•„í„°ê°€ ì‹ë³„í•˜ë ¤ëŠ” ê° ì†ì„±ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. í•„í„°ëŠ” ì¼ë°˜ì ìœ¼ë¡œ (3x3) ë˜ëŠ” (5x5) í–‰ë ¬ë¡œ êµ¬ì„±ë˜ì–´ ìˆìœ¼ë©°, ê° í•„í„°ëŠ” ì…ë ¥ ì´ë¯¸ì§€ì—ì„œ ë™ì¼í•œ í¬ê¸°ì˜ í•„ë“œë¥¼ ì°¨ì§€í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ, í•„í„°ê°€ í•œ ì¹¸ì”© ê°€ë¡œë¡œ ì´ë™í•˜ê³  ê°™ì€ í”„ë¡œì„¸ìŠ¤ê°€ ë°˜ë³µë©ë‹ˆë‹¤. ê°€ë¡œ ëì— ë„ë‹¬í•˜ë©´ í•„í„°ê°€ í•œ ì¹¸ ì•„ë˜ë¡œ ì´ë™í•˜ê³  ì ê³± í”„ë¡œì„¸ìŠ¤ê°€ ë‹¤ì‹œ ìˆ˜í‰ìœ¼ë¡œ ì ìš©ë©ë‹ˆë‹¤. ê·¸ ê²°ê³¼ëŠ” ìˆœì„œëŒ€ë¡œ ì¶œë ¥ì— ì¶”ê°€ë˜ì–´ íŠ¹ì„± ë§µì„ ìƒì„±í•©ë‹ˆë‹¤.</p>
<p><img src="https://miro.medium.com/v2/resize:fit:1400/0*4UZXfXs7eQ3TT02M.gif" alt="ì´ë¯¸ì§€"></p>
<p>ì…ë ¥ ì´ë¯¸ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” í…ì„œ Iì˜ ì°¨ì›ì´ m1 x m2 x mcì¸ ê²½ìš°ë¥¼ ê°€ì •í•´ ë´…ì‹œë‹¤. ì´ í…ì„œì—ì„œ,</p>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_4.png" alt="image1"></p>
<p>ìš°ë¦¬ëŠ” ì…ë ¥ ì´ë¯¸ì§€ì™€ ì¼ì¹˜í•˜ëŠ” ì±„ë„ ìˆ˜ë¥¼ ê°€ì§„ (n1 x n2 x nc) ì°¨ì›ì„ ê°€ì§€ëŠ” í•„í„°ë¥¼ ì ìš©í•©ë‹ˆë‹¤. ì´ í•„í„°ëŠ” ì´ë¯¸ì§€ë¥¼ ì™¼ìª½ì—ì„œ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì›€ì§ì´ë©´ì„œ, ì…ë ¥ í…ì„œ Iì˜ í•´ë‹¹ ì˜ì—­ê³¼ ìš”ì†Œë³„ ê³±ì…ˆì„ ìˆ˜í–‰í•˜ê³  ì´ëŸ¬í•œ ê³±ì…ˆ ê²°ê³¼ë¥¼ í•©ì‚°í•©ë‹ˆë‹¤. ìŠ¤íŠ¸ë¼ì´ë“œ ë§¤ê°œë³€ìˆ˜ëŠ” í•„í„°ê°€ ì´ë¯¸ì§€ë¥¼ íš¡ë‹¨í•˜ëŠ” ë‹¨ê³„ í¬ê¸°ë¥¼ ê²°ì •í•©ë‹ˆë‹¤. Iì™€ K ì‚¬ì´ì˜ ì´ ì‘ì—…ì˜ ê²°ê³¼ëŠ” ë‹¤ë¥¸ ì°¨ì› (m1 - n1 + 1) x (m2 - n2 + 1) x 1ì„ ê°€ì§„ ë˜ ë‹¤ë¥¸ í…ì„œë¥¼ ìƒì„±í•©ë‹ˆë‹¤.</p>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_5.png" alt="image2"></p>
<p>ì•ˆë…•í•˜ì„¸ìš”,</p>
<p>íŠ¹ì§• ë§µì˜ (i, j)ë²ˆì§¸ í•­ëª©ì€ ë‹¤ìŒê³¼ ê°™ì´ ê³„ì‚°ë©ë‹ˆë‹¤:</p>
<p>ë‹¤ìŒ ì˜ˆë¥¼ ì„ íƒí–ˆìŠµë‹ˆë‹¤. 5x5x1 ì°¨ì› ì´ë¯¸ì§€ê°€ 3x3x1 ì»¤ë„ë¡œ í•©ì„±ë˜ê³  s=1 ìŠ¤íŠ¸ë¼ì´ë“œê°€ ì ìš©ë©ë‹ˆë‹¤.</p>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_8.png" alt="image"></p>
<p>íŠ¹ì§• ë§µì˜ (i, j)-ë²ˆì§¸ í•­ëª©ì€ ë‹¨ì¼ ì±„ë„ì— ëŒ€í•œ ë‹¤ìŒ ì¼ë°˜ ê³µì‹ìœ¼ë¡œ ì£¼ì–´ì§‘ë‹ˆë‹¤:</p>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_9.png" alt="formula"></p>
<p>ìœ„ ì˜ˆì—ì„œ feature mapì˜ (1, 1)ë²ˆ ì§¸ í•­ëª©ì„ ê³„ì‚°í•´ ë´…ì‹œë‹¤:</p>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_10.png" alt="image"></p>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_11.png" alt="image"></p>
<p>ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” í•­ëª©ì€ 0ìœ¼ë¡œ ëŒ€ì²´ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_12.png" alt="Image"></p>
<p>ë§ˆì°¬ê°€ì§€ë¡œ, ë‚¨ì€ í•­ëª©ë“¤ì€ ë™ì¼í•œ ê³µì‹ì„ ì‚¬ìš©í•˜ì—¬ ê³„ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ê³¼ì •ì€ ì„œë¡œ ë‹¤ë¥¸ ìœ í˜•ì˜ í•„í„°ë¥¼ ì ìš©í•¨ìœ¼ë¡œì¨ ë°˜ë³µë˜ë©°, ê°ê°ì´ ì´ë¯¸ì§€ì˜ ë‹¤ë¥¸ íŠ¹ì§•ì„ ìº¡ì²˜í•˜ëŠ” ê²ƒì„ ë³´ì—¬ì¤ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, í•„í„° ê°œìˆ˜ê°€ í•˜ë‚˜ ì´ìƒì´ ë  ìˆ˜ ìˆì–´ì„œ ìŠ¤íŠ¸ë¼ì´ë“œ ê°œë…ì´ ë„ì…ë©ë‹ˆë‹¤.</p>
<h2>2.2â€” íŒ¨ë”© ë ˆì´ì–´</h2>
<p>ê¸°ë³¸ CNNì€ (n x n) í¬ê¸°ì˜ í‘ë°± ì´ë¯¸ì§€ì™€ (f x f) í¬ê¸°ì˜ í•„í„°/ì»¤ë„ì„ ì‚¬ìš©í•˜ì—¬ ê²°ê³¼ë¥¼ ì œê³µí•˜ë©°, ì¶œë ¥ í¬ê¸°ëŠ” (n - f + 1) x (n - f + 1)ì´ ë©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, (8 x 8) ì´ë¯¸ì§€ì™€ (3 x 3) í•„í„°ë¥¼ ì‚¬ìš©í•œ ì–´ë–¤ í•©ì„± ê³± ì‘ì—…ì˜ ê²½ìš°, ì¶œë ¥ ì´ë¯¸ì§€ í¬ê¸°ëŠ” (6 x 6)ì´ ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ í¬ê¸°ì˜ ê°ì†ŒëŠ” ì´ë¯¸ì§€ ì²˜ë¦¬ ì¤‘ ì¼ê´€ì ìœ¼ë¡œ ë°œìƒí•˜ë©°, ë ˆì´ì–´ì˜ ì¶œë ¥ì´ ì¼ë°˜ì ìœ¼ë¡œ ì…ë ¥ë³´ë‹¤ ì‘ìŠµë‹ˆë‹¤. ë˜í•œ, í•©ì„± ê³± ì‘ì—…ì—ì„œ ì‚¬ìš©ë˜ëŠ” í•„í„°ëŠ” í”½ì…€ì„ íš¡ë‹¨í•˜ë©´ì„œ í•­ìƒ ëª¨ì„œë¦¬ì— ì´ˆì ì„ ë‘ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_13.png" alt="TinyML CNN"></p>
<p>ë¨¸ì‹  ëŸ¬ë‹ì—ì„œ ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ì—¬ëŸ¬ ìœ í˜•ì˜ íŒ¨ë”©ì´ ìˆìŠµë‹ˆë‹¤:</p>
<ul>
<li>Same íŒ¨ë”©: Same íŒ¨ë”©ì€ ì›ë³¸ ì´ë¯¸ì§€ì˜ ì™¸ë¶€ í”„ë ˆì„ì— ì¼ë°˜ì ìœ¼ë¡œ 0ê³¼ ê°™ì€ ì¶”ê°€ ìš”ì†Œë¥¼ ì¶”ê°€í•˜ëŠ” ê²ƒì„ í¬í•¨í•©ë‹ˆë‹¤. ì´ ë°©ì‹ìœ¼ë¡œ ì…ë ¥ì„ í™•ì¥í•¨ìœ¼ë¡œì¨, í•„í„°ê°€ ë” ë„“ì€ ì˜ì—­ì„ ìŠ¤ìº”í•  ìˆ˜ ìˆê²Œ ë˜ì–´ ì¶œë ¥ ì´ë¯¸ì§€ê°€ ì›ë³¸ê³¼ ë™ì¼í•œ í¬ê¸°ë¥¼ ìœ ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ê²ƒì€ ì»¨ë³¼ë£¨ì…˜ ì‘ì—… ì¤‘ ê³µê°„ì  ì°¨ì›ì„ ìœ ì§€í•˜ëŠ” ë° ìœ ìš©í•©ë‹ˆë‹¤.</li>
<li>Valid íŒ¨ë”©: Same íŒ¨ë”©ê³¼ëŠ” ë‹¬ë¦¬, Valid íŒ¨ë”©ì€ ì´ë¯¸ì§€ì— ì¶”ê°€ ìš”ì†Œë¥¼ ì¶”ê°€í•˜ëŠ” ê²ƒì„ í¬í•¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í•„í„°ëŠ” ì¶”ê°€ ìš”ì†Œ ì—†ì´ ì›ë³¸ ì´ë¯¸ì§€ë¥¼ í›‘ì–´ê°‘ë‹ˆë‹¤. ì´ê²ƒì€ ê°„ê²©ìœ¼ë¡œ ì¸í•œ ì¼ë¶€ ë°ì´í„° ì†ì‹¤ì´ ë°œìƒí•  ìˆ˜ ìˆì§€ë§Œ, valid íŒ¨ë”©ì€ ì¶œë ¥ í”¼ì³ ë§µì˜ í¬ê¸°ë¥¼ ì¤„ì´ê³ ì í•  ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì¶•ì†ŒëŠ” ëª¨ë¸ì˜ ë§¤ê°œë³€ìˆ˜ ìˆ˜ë¥¼ ì¤„ì´ê³  ê³„ì‚° íš¨ìœ¨ì„±ì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
<li>Causal íŒ¨ë”©: Causal íŒ¨ë”©ì€ ì£¼ë¡œ ì‹œí€€ìŠ¤-íˆ¬-ì‹œí€€ìŠ¤ ëª¨ë¸ ë° ì‹œê³„ì—´ ì˜ˆì¸¡ì— ì‚¬ìš©ë˜ë©°, íŠ¹íˆ 1ì°¨ì› ì»¨ë³¼ë£¨ì…˜ ë ˆì´ì–´ì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ ìœ í˜•ì˜ íŒ¨ë”©ì€ ë°ì´í„° ì‹œí€€ìŠ¤ì˜ ì‹œì‘ ë¶€ë¶„ì— ìš”ì†Œë¥¼ ì¶”ê°€í•˜ì—¬ ì•Œê³ ë¦¬ì¦˜ì´ ì´ˆê¸° ì‹œê°„ ë‹¨ê³„ì— ëŒ€í•œ ê°’ì„ ì˜ˆì¸¡í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤. ê³¼ê±° ë° í˜„ì¬ ë°ì´í„°ë¥¼ ì˜ˆì¸¡ì— í¬í•¨ì‹œí‚´ìœ¼ë¡œì¨, causal íŒ¨ë”©ì€ ëª¨ë¸ì´ ì¶”ë¡  ì¤‘ì— ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ë¯¸ë˜ ë°ì´í„°ë¥¼ í™œìš©í•˜ì§€ ì•Šë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤.</li>
<li>Full íŒ¨ë”©: ì´ ìœ í˜•ì˜ íŒ¨ë”©ì€ ì…ë ¥ì˜ í…Œë‘ë¦¬ ì£¼ìœ„ì— ì—¬ëŸ¬ ë ˆì´ì–´ì˜ 0ì„ ì¶”ê°€í•˜ì—¬ ì›ë³¸ ì´ë¯¸ì§€ í¬ê¸°ë³´ë‹¤ í° ì¶œë ¥ í”¼ì³ ë§µì„ ìƒì„±í•©ë‹ˆë‹¤. Full íŒ¨ë”©ì€ ëœ ì¼ë°˜ì ì´ì§€ë§Œ ë” í° ì¶œë ¥ í¬ê¸°ê°€ í•„ìš”í•œ íŠ¹ì • ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<h2>2.3 â€”Pooling Layer</h2>
<p>í’€ë§ ë ˆì´ì–´ì—ì„œëŠ” ì»¨ë³¼ë£¨ì…˜ëœ íŠ¹ì§•ì˜ ê³µê°„ ì°¨ì›ì´ ì¼ë°˜ì ìœ¼ë¡œ ì¶•ì†Œë˜ì–´ ì…ë ¥ ì´ë¯¸ì§€ì—ì„œ ì£¼ìš”í•œ íŠ¹ì§•ì„ ì¶”ì¶œí•˜ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤. ì´ í¬ê¸°ì˜ ì¶•ì†ŒëŠ” ì»¨ë³¼ë£¨ì…˜ ë ˆì´ì–´ì—ì„œ ì–»ì€ ì¶œë ¥ì— í’€ë§ í•¨ìˆ˜ë¥¼ ì ìš©í•˜ì—¬ ë‹¬ì„±ë©ë‹ˆë‹¤. ì´ë ‡ê²Œ ê°€ì •í•´ ë´…ì‹œë‹¤:</p>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_14.png" alt="ê·¸ë¦¼ 1"></p>
<p>í’€ë§ëœ ë¶€ë¶„ì˜ ì°¨ì›ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_15.png" alt="ê·¸ë¦¼ 2"></p>
<p>ë”¥ëŸ¬ë‹ì—ì„œëŠ” 3ê°€ì§€ ì¢…ë¥˜ì˜ í’€ë§ì´ ìˆì–´ìš”:</p>
<p>í‰ê·  í’€ë§: ì»¤ë²„ëœ ì˜ì—­ ë‚´ í”½ì…€ ê°’ì˜ í‰ê· ì´ ì¶œë ¥ ë§¤íŠ¸ë¦­ìŠ¤ë¡œ ì „ë‹¬ë©ë‹ˆë‹¤.</p>
<p>ìµœëŒ€ í’€ë§: ì»¤ë²„ëœ ì˜ì—­ ë‚´ í”½ì…€ ê°’ ì¤‘ ê°€ì¥ ë†’ì€ ê°’ì´ ì¶œë ¥ ë§¤íŠ¸ë¦­ìŠ¤ë¡œ ì „ë‹¬ë©ë‹ˆë‹¤.</p>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_16.png" alt="ì´ë¯¸ì§€"></p>
<p>ì „ì—­ ìµœëŒ€ í’€ë§(Global Max Pooling) : ëª¨ë“  ì…ë ¥ í¬ê¸°ì˜ í”½ì…€ ê°’ ì¤‘ ê°€ì¥ ë†’ì€ ê°’ì´ ì¶œë ¥ í–‰ë ¬ë¡œ ì „ë‹¬ë©ë‹ˆë‹¤. ì´ ìœ í˜•ì˜ í’€ë§ì—ì„œ í’€ í¬ê¸°ëŠ” ì…ë ¥ í¬ê¸°ì™€ ë™ì¼í•©ë‹ˆë‹¤.</p>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_17.png" alt="ì´ë¯¸ì§€"></p>
<p>sum pooling, average pooling, max poolingê³¼ ê°™ì€ ë‹¤ì–‘í•œ ìœ í˜•ì˜ í’€ë§ì´ ìˆìŠµë‹ˆë‹¤. ìµœëŒ€ í’€ë§ì˜ ì˜ˆëŠ” ì•„ë˜ì— ì œê³µë©ë‹ˆë‹¤. ìµœëŒ€ í’€ë§ì€ 2x2 íŒ¨ì¹˜ì— ìˆ˜í–‰ë©ë‹ˆë‹¤. ê° íŒ¨ì¹˜ì—ì„œ ìµœëŒ“ê°’ì´ ì„ íƒë©ë‹ˆë‹¤.</p>
<h2>2.4 â€” í”Œë˜íŠ¼ ë ˆì´ì–´</h2>
<p>í”Œë˜íŠ¼ ë ˆì´ì–´ëŠ” ì‹ ê²½ë§ ì•„í‚¤í…ì²˜ì—ì„œ ì¤‘ìš”í•œ êµ¬ì„± ìš”ì†Œì´ë©°, íŠ¹íˆ í•©ì„±ê³± ë ˆì´ì–´ì—ì„œ ì™„ì „íˆ ì—°ê²°ëœ ë ˆì´ì–´ë¡œì˜ ì „í™˜ ì‹œì— ì¤‘ìš”í•©ë‹ˆë‹¤. ì´ ë ˆì´ì–´ëŠ” í•©ì„±ê³± ë° í’€ë§ ë ˆì´ì–´ì—ì„œ ìƒì„±ëœ ë‹¤ì°¨ì› í”¼ì³ ë§µì„ ì¼ì°¨ì› ë²¡í„°ë¡œ ë³€í™˜í•˜ì—¬, ë¶„ë¥˜ ë˜ëŠ” íšŒê·€ ì‘ì—…ì„ ìœ„í•´ í›„ì† ì™„ì „íˆ ì—°ê²°ëœ ë ˆì´ì–´ë¡œ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_18.png" alt="ì´ë¯¸ì§€ ì„¤ëª…"></p>
<p>ë‹¤ìŒì€ í”Œë˜íŠ¼ ë ˆì´ì–´ì˜ ì‘ë™ ë°©ì‹ì…ë‹ˆë‹¤:</p>
<ul>
<li>ì…ë ¥: í”Œë˜íŠ¼ ë ˆì´ì–´ì˜ ì…ë ¥ì€ ì¼ë°˜ì ìœ¼ë¡œ ì´ì „ í•©ì„±ê³± ë˜ëŠ” í’€ë§ ë ˆì´ì–´ì—ì„œ ìƒì„±ëœ í”¼ì³ ë§µì„ ë‚˜íƒ€ë‚´ëŠ” ë‹¤ì°¨ì› í…ì„œì…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë§ˆì§€ë§‰ í•©ì„±ê³± ë˜ëŠ” í’€ë§ ë ˆì´ì–´ê°€ ë†’ì´, ë„ˆë¹„, ê¹Šì´ì˜ í”¼ì³ ë§µì„ ìƒì„±í•œë‹¤ë©´ ì…ë ¥ í…ì„œëŠ” (ë°°ì¹˜ í¬ê¸°, ë†’ì´, ë„ˆë¹„, ê¹Šì´) í˜•íƒœë¥¼ ê°€ì§ˆ ê²ƒì…ë‹ˆë‹¤.</li>
<li>í”Œë˜íŒ…: í”Œë˜íŒ… ë ˆì´ì–´ëŠ” ë‹¨ìˆœíˆ í”¼ì³ ë§µì˜ ëª¨ë“  ìš”ì†Œë¥¼ í•˜ë‚˜ì˜ ì°¨ì›ì„ ë”°ë¼ ì—°ê²°í•˜ì—¬ ì…ë ¥ í…ì„œë¥¼ ì¼ì°¨ì› ë²¡í„°ë¡œ ë‹¤ì‹œ í˜•íƒœí™”í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, í”¼ì³ ë§µì´ ë†’ì´, ë„ˆë¹„, ê¹Šì´ì˜ ì°¨ì›ì„ ê°€ì§„ë‹¤ë©´ í”Œë˜íŒ… ë ˆì´ì–´ëŠ” ì´ë¥¼ ë†’ì´ * ë„ˆë¹„ * ê¹Šì´ì˜ ê¸¸ì´ë¥¼ ê°€ì§„ ë²¡í„°ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.</li>
<li>ì¶œë ¥: í”Œë˜íŒ… ë ˆì´ì–´ì˜ ì¶œë ¥ì€ í”¼ì³ ë§µì„ í”Œë˜íŒ…í•œ ì¼ì°¨ì› ë²¡í„°ì…ë‹ˆë‹¤. ì´ ë²¡í„°ëŠ” ì´í›„ì˜ ì™„ì „íˆ ì—°ê²°ëœ ë ˆì´ì–´ì˜ ì…ë ¥ìœ¼ë¡œ ì „ë‹¬ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<p>í‰íƒ„í™” ë ˆì´ì–´ì˜ ëª©ì ì€ íŠ¹ì„± ë§µì—ì„œ ìº¡ì²˜ëœ ê³µê°„ ì •ë³´ë¥¼ ì™„ì „ ì—°ê²° ë ˆì´ì–´ì—ì„œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì™„ì „ ì—°ê²° ë ˆì´ì–´ëŠ” ì¼ì°¨ì› ì…ë ¥ ë²¡í„°ë¥¼ í•„ìš”ë¡œí•˜ë¯€ë¡œ íŠ¹ì„± ë§µì„ í‰íƒ„í™”í•¨ìœ¼ë¡œì¨ ì‹ ê²½ë§ì´ ë°ì´í„°ì˜ ë‹¤ì–‘í•œ ê³µê°„ ìœ„ì¹˜ì— ê±¸ì³ ë³µì¡í•œ íŒ¨í„´ê³¼ ê´€ê³„ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ í•™ìŠµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ë” ì •í™•í•œ ì˜ˆì¸¡ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ì´ì „ì˜ í•©ì„±ê³± ë˜ëŠ” í’€ë§ ë ˆì´ì–´ì— ì˜í•´ ìƒì„±ëœ íŠ¹ì„± ë§µ ğ¹ ì§‘í•©ì´ ìˆë‹¤ê³  ê°€ì •í•´ë´…ì‹œë‹¤. ì´ëŸ¬í•œ íŠ¹ì„± ë§µì˜ ì°¨ì›ì„ ë‹¤ìŒê³¼ ê°™ì´ í‘œê¸°í•´ ë´…ì‹œë‹¤:</p>
<ul>
<li>ğ»: íŠ¹ì„± ë§µì˜ ë†’ì´</li>
<li>ğ‘Š: íŠ¹ì„± ë§µì˜ ë„ˆë¹„</li>
<li>ğ·: íŠ¹ì„± ë§µì˜ ê¹Šì´ (ì±„ë„ ìˆ˜)</li>
<li>ğµ: ë°°ì¹˜ í¬ê¸° (ë°°ì¹˜ì— í¬í•¨ëœ ìƒ˜í”Œ ìˆ˜)</li>
</ul>
<p>ê·¸ëŸ¬ë©´ íŠ¹ì„± ë§µ ğ¹ì˜ í˜•íƒœëŠ” (B,H,W,D)ê°€ ë©ë‹ˆë‹¤. ì—¬ê¸°ì„œ ğµì€ ë°°ì¹˜ í¬ê¸°ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</p>
<p>ì´ëŸ¬í•œ í”¼ì²˜ ë§µì„ ì¼ì°¨ì› ë²¡í„°ë¡œ í‰íƒ„í™”í•˜ê¸° ìœ„í•´, ë‹¨ìˆœíˆ ì´ë¥¼ ê¸¸ì´ ğ»Ã—ğ‘ŠÃ—ğ·ì˜ ë²¡í„°ë¡œ ì¬êµ¬ì„±í•©ë‹ˆë‹¤. ìˆ˜í•™ì ìœ¼ë¡œ í‘œí˜„í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p>
<p>Flatten(ğ¹)=reshape(ğ¹, (ğµ, ğ»Ã—ğ‘ŠÃ—ğ·))</p>
<p>ì´ ê²½ìš°, ì¬êµ¬ì„± ì—°ì‚°ì€ (ğµ, ğ», ğ‘Š, ğ·) í…ì„œë¥¼ (ğµ, ğ»Ã—ğ‘ŠÃ—ğ·) í…ì„œë¡œ ì¬êµ¬ì„±í•˜ì—¬ ê³µê°„ ì°¨ì›ì„ í•˜ë‚˜ì˜ ì°¨ì›ìœ¼ë¡œ í¼ì¹˜ê²Œ ë©ë‹ˆë‹¤.</p>
<p>ì˜ˆë¥¼ ë“¤ì–´, ë§Œì•½ ğ¹ê°€ ì°¨ì›ì´ (4,5,5,3)ì¸ ê²½ìš° (ë°°ì¹˜ í¬ê¸°ê°€ 4, ë†’ì´ê°€ 5, ë„ˆë¹„ê°€ 5, ê¹Šì´ê°€ 3ì¸ í”¼ì²˜ ë§µ), ê·¸ëŸ¬ë©´ í‰íƒ„í™”ëœ ì¶œë ¥ì€ (4,75) ì°¨ì›ì„ ê°–ê²Œ ë˜ë©°, ê° í–‰ì€ ë°°ì¹˜ì˜ í•œ ìƒ˜í”Œì— ëŒ€í•œ í‰íƒ„í™”ëœ í”¼ì²˜ ë§µì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</p>
<p>ì´ í‰íƒ„í™”ëœ ë²¡í„°ëŠ” ì‹ ê²½ë§ì˜ í›„ì† ì™„ì „ ì—°ê²° ë ˆì´ì–´ì— ì…ë ¥ìœ¼ë¡œ ì „ë‹¬ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<h1>3 â€” TinyML êµ¬í˜„</h1>
<p>ì´ ì˜ˆì œë¥¼ í†µí•´ ESP32, ì•„ë‘ì´ë…¸, ë¼ì¦ˆë² ë¦¬ íŒŒì´ ë° ê¸°íƒ€ ë‹¤ì–‘í•œ ë§ˆì´í¬ë¡œì»¨íŠ¸ë¡¤ëŸ¬ ë˜ëŠ” IoT ì¥ì¹˜ì—ì„œ ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>3.0 â€” requirements.txt íŒŒì¼ì— ë‚˜ì—´ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.</p>
<pre><code class="hljs language-python">!pip install -r requirements.txt
</code></pre>
<p>3.1 â€” ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°€ì ¸ì˜¤ê¸°</p>
<pre><code class="hljs language-python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> load_digits
<span class="hljs-keyword">import</span> tensorflow <span class="hljs-keyword">as</span> tf
<span class="hljs-keyword">from</span> tensorflow.keras <span class="hljs-keyword">import</span> layers
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> accuracy_score
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> confusion_matrix
<span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns
<span class="hljs-keyword">import</span> os
</code></pre>
<p>3.2 â€” ë°ì´í„°ì…‹ ë¶ˆëŸ¬ì˜¤ê¸°</p>
<p>MNISTì€ Modified National Institute of Standards and Technology databaseì˜ ì¤„ì„ë§ë¡œ, ê¸°ê³µ í•™ìŠµ ë° ì»´í“¨í„° ë¹„ì „ ë¶„ì•¼ì—ì„œ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” ë°ì´í„°ì…‹ì…ë‹ˆë‹¤. ì´ ë°ì´í„°ì…‹ì€ 0ì—ì„œ 9ê¹Œì§€ì˜ ì†ìœ¼ë¡œ ì“´ ìˆ«ìë“¤ì˜ ëª¨ìŒìœ¼ë¡œ, ê° ìˆ«ìëŠ” 28x28 í”½ì…€ í¬ê¸°ì˜ íšŒìƒ‰ ìŒì˜ ì´ë¯¸ì§€ë¡œ í‘œí˜„ë©ë‹ˆë‹¤. ì´ ë°ì´í„°ì…‹ì—ëŠ” ì´ 70,000ê°œì˜ ì´ë¯¸ì§€ê°€ í¬í•¨ë˜ì–´ ìˆìœ¼ë©°, ì´ ì¤‘ 60,000ê°œì˜ ì´ë¯¸ì§€ëŠ” í›ˆë ¨ì— ì‚¬ìš©ë˜ê³  10,000ê°œì˜ ì´ë¯¸ì§€ëŠ” í…ŒìŠ¤íŠ¸ì— ì‚¬ìš©ë©ë‹ˆë‹¤.</p>
<p>ë§í¬: <a href="https://www.nist.gov/itl/products-and-services/emnist-dataset" rel="nofollow" target="_blank">https://www.nist.gov/itl/products-and-services/emnist-dataset</a></p>
<pre><code class="hljs language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_data</span>():
    np.random.seed(<span class="hljs-number">1337</span>)
    x_values, y_values = load_digits(return_X_y=<span class="hljs-literal">True</span>)
    x_values /= x_values.<span class="hljs-built_in">max</span>()
    <span class="hljs-comment"># reshape to (8 x 8 x 1)</span>
    x_values = x_values.reshape((<span class="hljs-built_in">len</span>(x_values), <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>))
    <span class="hljs-comment"># split into train, validation, test</span>
    TRAIN_SPLIT = <span class="hljs-built_in">int</span>(<span class="hljs-number">0.6</span> * <span class="hljs-built_in">len</span>(x_values))
    TEST_SPLIT = <span class="hljs-built_in">int</span>(<span class="hljs-number">0.2</span> * <span class="hljs-built_in">len</span>(x_values) + TRAIN_SPLIT)
    x_train, x_test, x_validate = np.split(x_values, [TRAIN_SPLIT, TEST_SPLIT])
    y_train, y_test, y_validate = np.split(y_values, [TRAIN_SPLIT, TEST_SPLIT])

    <span class="hljs-keyword">return</span> x_train, x_test, x_validate, y_train, y_test, y_validate
</code></pre>
<p>3.3 â€” ë°ì´í„° ë¶„í• </p>
<pre><code class="hljs language-js">X_train, X_test, X_validate, y_train, y_test, y_validate = <span class="hljs-title function_">get_data</span>()
</code></pre>
<p>3.4 â€” íƒìƒ‰ì  ë°ì´í„° ë¶„ì„</p>
<pre><code class="hljs language-js">X_train__ = X_train.<span class="hljs-title function_">reshape</span>(X_train.<span class="hljs-property">shape</span>[<span class="hljs-number">0</span>], <span class="hljs-number">8</span>, <span class="hljs-number">8</span>)

fig, axis = plt.<span class="hljs-title function_">subplots</span>(<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, figsize=(<span class="hljs-number">20</span>, <span class="hljs-number">10</span>))
<span class="hljs-keyword">for</span> i, ax <span class="hljs-keyword">in</span> <span class="hljs-title function_">enumerate</span>(axis.<span class="hljs-property">flat</span>):
    ax.<span class="hljs-title function_">imshow</span>(X_train__[i], cmap=<span class="hljs-string">'binary'</span>)
    digit = y_train[i]
    ax.<span class="hljs-title function_">set</span>(title = f<span class="hljs-string">"ì‹¤ì œ ìˆ«ìëŠ” {digit}ì…ë‹ˆë‹¤."</span>)
</code></pre>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_19.png" alt="ì´ë¯¸ì§€"></p>
<p>3.5â€” ëª¨ë¸ ì •ì˜í•˜ê¸°</p>
<pre><code class="hljs language-js">model = tf.<span class="hljs-property">keras</span>.<span class="hljs-title class_">Sequential</span>()
model.<span class="hljs-title function_">add</span>(layers.<span class="hljs-title class_">Conv2D</span>(<span class="hljs-number">8</span>, (<span class="hljs-number">3</span>, <span class="hljs-number">3</span>), activation=<span class="hljs-string">'relu'</span>, input_shape=(<span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>)))
model.<span class="hljs-title function_">add</span>(layers.<span class="hljs-title class_">MaxPooling2D</span>((<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)))
model.<span class="hljs-title function_">add</span>(layers.<span class="hljs-title class_">Flatten</span>())
model.<span class="hljs-title function_">add</span>(layers.<span class="hljs-title class_">Dense</span>(<span class="hljs-title function_">len</span>(np.<span class="hljs-title function_">unique</span>(y_train))))
</code></pre>
<pre><code class="hljs language-js">model.<span class="hljs-title function_">summary</span>()
</code></pre>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_20.png" alt="ì´ë¯¸ì§€"></p>
<pre><code class="hljs language-js"><span class="hljs-title function_">plot_model</span>(model, to_file=<span class="hljs-string">'./figures/model.png'</span>)
</code></pre>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_21.png" alt="Plot"></p>
<p>3.6â€”ëª¨ë¸ ì»´íŒŒì¼í•˜ê¸°</p>
<pre><code class="hljs language-js">model.<span class="hljs-title function_">compile</span>(optimizer=<span class="hljs-string">'adam'</span>, loss=tf.<span class="hljs-property">keras</span>.<span class="hljs-property">losses</span>.<span class="hljs-title class_">SparseCategoricalCrossentropy</span>(from_logits=<span class="hljs-title class_">True</span>), metrics=[<span class="hljs-string">'accuracy'</span>])
</code></pre>
<p>3.7 â€” ëª¨ë¸ í›ˆë ¨</p>
<pre><code class="hljs language-js">history = model.<span class="hljs-title function_">fit</span>(X_train, y_train,
                    epochs=<span class="hljs-number">50</span>,
                    batch_size=<span class="hljs-number">16</span>,
                    validation_data=(X_validate, y_validate))
</code></pre>
<pre><code class="hljs language-js">model.<span class="hljs-title function_">save</span>(<span class="hljs-string">'.\models\model.keras'</span>)
</code></pre>
<pre><code class="hljs language-js">loss = history.<span class="hljs-property">history</span>[<span class="hljs-string">'loss'</span>]
val_loss = history.<span class="hljs-property">history</span>[<span class="hljs-string">'val_loss'</span>]
epochs = <span class="hljs-title function_">range</span>(<span class="hljs-number">1</span>, <span class="hljs-title function_">len</span>(loss) + <span class="hljs-number">1</span>)
plt.<span class="hljs-title function_">plot</span>(epochs, loss, <span class="hljs-string">'r.'</span>, label=<span class="hljs-string">'í›ˆë ¨ ì†ì‹¤'</span>)
plt.<span class="hljs-title function_">plot</span>(epochs, val_loss, <span class="hljs-string">'y'</span>, label=<span class="hljs-string">'ê²€ì¦ ì†ì‹¤'</span>)
plt.<span class="hljs-title function_">title</span>(<span class="hljs-string">'í›ˆë ¨ ë° ê²€ì¦ ì†ì‹¤'</span>)
plt.<span class="hljs-title function_">xlabel</span>(<span class="hljs-string">'ì—í¬í¬'</span>)
plt.<span class="hljs-title function_">ylabel</span>(<span class="hljs-string">'ì†ì‹¤'</span>)
plt.<span class="hljs-title function_">grid</span>()
plt.<span class="hljs-title function_">legend</span>()
plt.<span class="hljs-title function_">savefig</span>(<span class="hljs-string">'.\\figures\\history_traing.png'</span>, dpi=<span class="hljs-number">300</span>, bbox_inches=<span class="hljs-string">'tight'</span>)
plt.<span class="hljs-title function_">show</span>()
</code></pre>
<p>ëª¨ë¸ í‰ê°€</p>
<p>í…ŒìŠ¤íŠ¸ ë°ì´í„°</p>
<pre><code class="hljs language-js">def <span class="hljs-title function_">test_model</span>(model, x_test, y_test):
    x_test = (x_test / x_test.<span class="hljs-title function_">max</span>()).<span class="hljs-title function_">reshape</span>((<span class="hljs-title function_">len</span>(x_test), <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>))
    y_pred = model.<span class="hljs-title function_">predict</span>(x_test).<span class="hljs-title function_">argmax</span>(axis=<span class="hljs-number">1</span>)
    <span class="hljs-title function_">print</span>(<span class="hljs-string">'ì •í™•ë„'</span>, ((y_pred == y_test).<span class="hljs-title function_">sum</span>() / <span class="hljs-title function_">len</span>(y_test))*<span class="hljs-number">100</span>, <span class="hljs-string">"%"</span>)
</code></pre>
<pre><code class="hljs language-js"><span class="hljs-title function_">test_model</span>(model, X_test, y_test)
</code></pre>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_23.png" alt="Image"></p>
<p>3.8.2 â€” Confusion matrix</p>
<pre><code class="hljs language-js">fig = plt.<span class="hljs-title function_">figure</span>(figsize=(<span class="hljs-number">10</span>, <span class="hljs-number">10</span>)) # <span class="hljs-title class_">Set</span> <span class="hljs-title class_">Figure</span>

y_pred = model.<span class="hljs-title function_">predict</span>(X_test) # <span class="hljs-title class_">Predict</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">probabilities</span> <span class="hljs-keyword">as</span> <span class="hljs-number">2</span> => [<span class="hljs-number">0.1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.9</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
Y_pred = np.<span class="hljs-title function_">argmax</span>(y_pred, <span class="hljs-number">1</span>) # <span class="hljs-title class_">Decode</span> <span class="hljs-title class_">Predicted</span> labels
mat = <span class="hljs-title function_">confusion_matrix</span>(y_test, Y_pred) # <span class="hljs-title class_">Confusion</span> matrix

# <span class="hljs-title class_">Plot</span> <span class="hljs-title class_">Confusion</span> matrix
sns.<span class="hljs-title function_">heatmap</span>(mat.<span class="hljs-property">T</span>, square=<span class="hljs-title class_">True</span>, annot=<span class="hljs-title class_">True</span>, cbar=<span class="hljs-title class_">False</span>, cmap=plt.<span class="hljs-property">cm</span>.<span class="hljs-property">Blues</span>, fmt=<span class="hljs-string">'.0f'</span>, 
            xticklabels=np.<span class="hljs-title function_">unique</span>(y_test), yticklabels=np.<span class="hljs-title function_">unique</span>(y_test), 
            annot_kws={<span class="hljs-string">"fontsize"</span>: <span class="hljs-number">14</span>}, linewidths=<span class="hljs-number">1</span>, linecolor=<span class="hljs-string">'white'</span>)

plt.<span class="hljs-title function_">xlabel</span>(<span class="hljs-string">'Predicted Values'</span>, fontsize=<span class="hljs-number">14</span>)
plt.<span class="hljs-title function_">ylabel</span>(<span class="hljs-string">'True Values'</span>, fontsize=<span class="hljs-number">14</span>)
plt.<span class="hljs-title function_">xticks</span>(fontsize=<span class="hljs-number">14</span>)
plt.<span class="hljs-title function_">yticks</span>(fontsize=<span class="hljs-number">14</span>)
plt.<span class="hljs-title function_">savefig</span>(<span class="hljs-string">'.\\figures\\confusion_matrix.png'</span>, dpi=<span class="hljs-number">300</span>, bbox_inches=<span class="hljs-string">'tight'</span>)
plt.<span class="hljs-title function_">show</span>()
</code></pre>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_24.png" alt="ì´ë¯¸ì§€"></p>
<p>3.8.3â€” ì˜ˆì¸¡ ìœ íš¨ì„± ê²€ì‚¬ ê²°ê³¼</p>
<pre><code class="hljs language-js">y_pred = model.<span class="hljs-title function_">predict</span>(X_test)
X_test__ = X_test

fig, axis = plt.<span class="hljs-title function_">subplots</span>(<span class="hljs-number">4</span>, <span class="hljs-number">4</span>, figsize=(<span class="hljs-number">12</span>, <span class="hljs-number">14</span>))
<span class="hljs-keyword">for</span> i, ax <span class="hljs-keyword">in</span> <span class="hljs-title function_">enumerate</span>(axis.<span class="hljs-property">flat</span>):
    ax.<span class="hljs-title function_">imshow</span>(X_test__[i], cmap=<span class="hljs-string">'binary'</span>)
    ax.<span class="hljs-title function_">set</span>(title = f<span class="hljs-string">"ì‹¤ì œ ìˆ«ì: {y_test[i]}\nì˜ˆì¸¡ ìˆ«ì: {y_pred[i].argmax()}"</span>)
</code></pre>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_25.png" alt="ì´ë¯¸ì§€"></p>
<p>3.9 â€” ë§ˆì´í¬ë¡œì»¨íŠ¸ë¡¤ëŸ¬ì— êµ¬í˜„í•  ëª¨ë¸ì„ ì–»ê¸°</p>
<p>3.9.1 â€” C í”„ë¡œê·¸ë˜ë°ì„ ìœ„í•´ ì¼ë¶€ 16ì§„ìˆ˜ ê°’ì„ ë°°ì—´ë¡œ ë³€í™˜í•˜ê¸°</p>
<pre><code class="hljs language-js"># í•¨ìˆ˜: C í”„ë¡œê·¸ë˜ë°ì„ ìœ„í•´ ì¼ë¶€ <span class="hljs-number">16</span>ì§„ìˆ˜ ê°’ì„ ë°°ì—´ë¡œ ë³€í™˜
def <span class="hljs-title function_">hex_to_c_array</span>(hex_data, var_name):

  c_str = <span class="hljs-string">''</span>

  # í—¤ë” ê°€ë“œ ìƒì„±
  c_str += <span class="hljs-string">'#ifdef __has_attribute\n'</span>
  c_str += <span class="hljs-string">'#define HAVE_ATTRIBUTE(x) __has_attribute(x)\n'</span>
  c_str += <span class="hljs-string">'#else\n'</span>
  c_str += <span class="hljs-string">'#define HAVE_ATTRIBUTE(x) 0\n'</span>
  c_str += <span class="hljs-string">'#endif\n'</span>
  c_str += <span class="hljs-string">'#if HAVE_ATTRIBUTE(aligned) || (defined(__GNUC__) &#x26;&#x26; !defined(__clang__))\n'</span>
  c_str += <span class="hljs-string">'#define DATA_ALIGN_ATTRIBUTE __attribute__((aligned(4)))\n'</span>
  c_str += <span class="hljs-string">'#else\n'</span>
  c_str += <span class="hljs-string">'#define DATA_ALIGN_ATTRIBUTE\n'</span>
  c_str += <span class="hljs-string">'#endif\n\n'</span>

  # C ë³€ìˆ˜ ì„ ì–¸
  c_str += <span class="hljs-string">'const unsigned char '</span> + var_name + <span class="hljs-string">'[]  DATA_ALIGN_ATTRIBUTE = {'</span>
  hex_array = []
  <span class="hljs-keyword">for</span> i, val <span class="hljs-keyword">in</span> <span class="hljs-title function_">enumerate</span>(hex_data) :

    # <span class="hljs-number">16</span>ì§„ìˆ˜ì—ì„œ ë¬¸ìì—´ë¡œ ë³€í™˜
    hex_str = <span class="hljs-title function_">format</span>(val, <span class="hljs-string">'#04x'</span>)

    # ê° ì¤„ì´ <span class="hljs-number">80</span>ì ì´ë‚´ë¡œ ìœ ì§€ë˜ë„ë¡ ì„œì‹ ì§€ì • ì¶”ê°€
    <span class="hljs-keyword">if</span> (i + <span class="hljs-number">1</span>) &#x3C; <span class="hljs-title function_">len</span>(hex_data):
      hex_str += <span class="hljs-string">','</span>
    <span class="hljs-keyword">if</span> (i + <span class="hljs-number">1</span>) % <span class="hljs-number">12</span> == <span class="hljs-number">0</span>:
      hex_str += <span class="hljs-string">'\n '</span>
    hex_array.<span class="hljs-title function_">append</span>(hex_str)

  # ë§ˆì§€ë§‰ ì¤‘ê´„í˜¸ ì¶”ê°€
  c_str += <span class="hljs-string">'\n '</span> + <span class="hljs-title function_">format</span>(<span class="hljs-string">' '</span>.<span class="hljs-title function_">join</span>(hex_array)) + <span class="hljs-string">'\n};\n\n'</span>

  # í—¤ë” ê°€ë“œ ì¢…ë£Œ
  c_str += <span class="hljs-string">'const int '</span> + var_name + <span class="hljs-string">'_len = '</span> + <span class="hljs-title function_">str</span>(<span class="hljs-title function_">len</span>(hex_data)) + <span class="hljs-string">';\n'</span>

  <span class="hljs-keyword">return</span> c_str
</code></pre>
<p>3.9.2â€”ëª¨ë¸ì„ Float32ì™€ Int8í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ê¸°</p>
<pre><code class="hljs language-js">def <span class="hljs-title function_">representative_dataset</span>():
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-title function_">range</span>(<span class="hljs-title function_">len</span>(X_train)):
        input_data = np.<span class="hljs-title function_">array</span>([X_train[i]], dtype=np.<span class="hljs-property">float32</span>)
        <span class="hljs-keyword">yield</span> [input_data]

def <span class="hljs-title function_">converter_quantization_model</span>(model, model_name):

    # <span class="hljs-title class_">Convert</span> the model to float32
    converter_float32 = tf.<span class="hljs-property">lite</span>.<span class="hljs-property">TFLiteConverter</span>.<span class="hljs-title function_">from_keras_model</span>(model)
    converter_float32.<span class="hljs-property">optimizations</span> = [tf.<span class="hljs-property">lite</span>.<span class="hljs-property">Optimize</span>.<span class="hljs-property">DEFAULT</span>]
    converter_float32.<span class="hljs-property">target_spec</span>.<span class="hljs-property">supported_types</span> = [tf.<span class="hljs-property">float32</span>]
    converter_float32.<span class="hljs-property">_experimental_lower_tensor_list_ops</span> = <span class="hljs-title class_">False</span>
    converter_float32.<span class="hljs-property">supported_ops</span> = [tf.<span class="hljs-property">lite</span>.<span class="hljs-property">OpsSet</span>.<span class="hljs-property">TFLITE_BUILTINS</span>, tf.<span class="hljs-property">lite</span>.<span class="hljs-property">OpsSet</span>.<span class="hljs-property">SELECT_TF_OPS</span>]
    converter_float32.<span class="hljs-property">representative_dataset</span> = representative_dataset
    tflite_model_float32 = converter_float32.<span class="hljs-title function_">convert</span>()
    <span class="hljs-title function_">print</span>(tflite_model_float32)
    <span class="hljs-keyword">with</span> <span class="hljs-title function_">open</span>(model_name+<span class="hljs-string">'_quant_float32'</span> + <span class="hljs-string">'.h'</span>, <span class="hljs-string">'w'</span>) <span class="hljs-keyword">as</span> <span class="hljs-attr">file</span>:
        file.<span class="hljs-title function_">write</span>(<span class="hljs-title function_">hex_to_c_array</span>(tflite_model_float32, model_name+<span class="hljs-string">'_quant_float32'</span>))
    <span class="hljs-keyword">with</span> <span class="hljs-title function_">open</span>(model_name+<span class="hljs-string">'_quant_float32.tflite'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> <span class="hljs-attr">f</span>:
        f.<span class="hljs-title function_">write</span>(tflite_model_float32)
    size_model_tflite_float32 = os.<span class="hljs-property">path</span>.<span class="hljs-title function_">getsize</span>(model_name+<span class="hljs-string">'_quant_float32.tflite'</span>)
    <span class="hljs-title function_">print</span>(model_name+f<span class="hljs-string">'_quant_float32.tflite: {size_model_tflite_float32} Bytes'</span>)

    # <span class="hljs-title class_">Convert</span> the model to <span class="hljs-title class_">Int8</span>
    converter_int8 = tf.<span class="hljs-property">lite</span>.<span class="hljs-property">TFLiteConverter</span>.<span class="hljs-title function_">from_keras_model</span>(model)
    converter_int8.<span class="hljs-property">optimizations</span> = [tf.<span class="hljs-property">lite</span>.<span class="hljs-property">Optimize</span>.<span class="hljs-property">DEFAULT</span>]
    converter_int8.<span class="hljs-property">target_spec</span>.<span class="hljs-property">supported_types</span> = [tf.<span class="hljs-property">int8</span>]
    converter_int8.<span class="hljs-property">representative_dataset</span> = representative_dataset
    converter_int8.<span class="hljs-property">target_spec</span>.<span class="hljs-property">supported_ops</span> = [
        tf.<span class="hljs-property">lite</span>.<span class="hljs-property">OpsSet</span>.<span class="hljs-property">TFLITE_BUILTINS_INT8</span>,
        tf.<span class="hljs-property">lite</span>.<span class="hljs-property">OpsSet</span>.<span class="hljs-property">SELECT_TF_OPS</span>,
    ]
    converter_int8.<span class="hljs-property">target_spec</span>.<span class="hljs-property">supported_ops</span> = [tf.<span class="hljs-property">lite</span>.<span class="hljs-property">OpsSet</span>.<span class="hljs-property">TFLITE_BUILTINS</span>]
    converter_int8.<span class="hljs-property">target_spec</span>.<span class="hljs-property">supported_ops</span> = [tf.<span class="hljs-property">lite</span>.<span class="hljs-property">OpsSet</span>.<span class="hljs-property">TFLITE_BUILTINS_INT8</span>]
    converter_int8.<span class="hljs-property">experimental_new_converter</span> = <span class="hljs-title class_">True</span>
    converter_int8.<span class="hljs-property">experimental_new_quantizer</span> = <span class="hljs-title class_">True</span>
    converter_int8.<span class="hljs-property">experimental_new_calibrator</span> = <span class="hljs-title class_">True</span>
    tflite_model_int8 = converter_int8.<span class="hljs-title function_">convert</span>()
    <span class="hljs-keyword">with</span> <span class="hljs-title function_">open</span>(model_name+<span class="hljs-string">'_quant_int8'</span> + <span class="hljs-string">'.h'</span>, <span class="hljs-string">'w'</span>) <span class="hljs-keyword">as</span> <span class="hljs-attr">file</span>:
        file.<span class="hljs-title function_">write</span>(<span class="hljs-title function_">hex_to_c_array</span>(tflite_model_int8, model_name+<span class="hljs-string">'_quant_int8'</span>))
    <span class="hljs-keyword">with</span> <span class="hljs-title function_">open</span>(model_name+<span class="hljs-string">'_quant_int8.tflite'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> <span class="hljs-attr">f</span>:
        f.<span class="hljs-title function_">write</span>(tflite_model_int8)
    size_model_tflite_int8 = os.<span class="hljs-property">path</span>.<span class="hljs-title function_">getsize</span>(model_name+<span class="hljs-string">'_quant_int8.tflite'</span>)
    <span class="hljs-title function_">print</span>(model_name+f<span class="hljs-string">'_quant_int8.tflite: {size_model_tflite_int8} Bytes'</span>)

    <span class="hljs-keyword">return</span> <span class="hljs-title class_">None</span>
</code></pre>
<pre><code class="hljs language-js">model_name=<span class="hljs-string">'.\models\model'</span>
<span class="hljs-title function_">converter_quantization_model</span>(model, model_name)
</code></pre>
<p>3.10 â€” Quantized Model Evaluation</p>
<pre><code class="hljs language-js">def evaluate_quantization(model_path, X_test, y_test, quantization_type):
    interpreter = tf.<span class="hljs-property">lite</span>.<span class="hljs-title class_">Interpreter</span>(model_path=model_path)
    interpreter.<span class="hljs-title function_">allocate_tensors</span>()

    # <span class="hljs-title class_">Evaluate</span> the quantized model
    input_index = interpreter.<span class="hljs-title function_">get_input_details</span>()[<span class="hljs-number">0</span>][<span class="hljs-string">'index'</span>]
    output_index = interpreter.<span class="hljs-title function_">get_output_details</span>()[<span class="hljs-number">0</span>][<span class="hljs-string">'index'</span>]
    predictions = []
    processing_times = []

    X_test = np.<span class="hljs-title function_">array</span>(X_test, dtype=np.<span class="hljs-property">float32</span>)
    
    <span class="hljs-keyword">for</span> X <span class="hljs-keyword">in</span> <span class="hljs-attr">X_test</span>:
        interpreter.<span class="hljs-title function_">set_tensor</span>(input_index, [X])       
        start_time = time.<span class="hljs-title function_">time</span>()
        interpreter.<span class="hljs-title function_">invoke</span>()
        end_time = time.<span class="hljs-title function_">time</span>()
        processing_time = end_time - start_time
        processing_times.<span class="hljs-title function_">append</span>(processing_time)
        output = interpreter.<span class="hljs-title function_">get_tensor</span>(output_index).<span class="hljs-title function_">argmax</span>(axis=<span class="hljs-number">1</span>)
        predictions.<span class="hljs-title function_">append</span>(output[<span class="hljs-number">0</span>])

    acc = <span class="hljs-title function_">accuracy_score</span>(y_test, predictions)
   
    # <span class="hljs-title class_">Calculate</span> the average and standard deviation <span class="hljs-keyword">of</span> differences
    result = { <span class="hljs-string">"Accuracy (%): "</span>:acc*<span class="hljs-number">100</span>,
                <span class="hljs-string">"Process time (s): "</span>: np.<span class="hljs-title function_">mean</span>(processing_times)
            }

    <span class="hljs-keyword">return</span> result
</code></pre>
<pre><code class="hljs language-js">model_name = <span class="hljs-string">'.\models\model'</span>
</code></pre>
<pre><code class="hljs language-js">eval_quant_float32 = evaluate_quantization(model_name + <span class="hljs-string">'_quant_float32.tflite'</span>, X_test, y_test, <span class="hljs-string">'float32'</span>)
eval_quant_float32
</code></pre>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_26.png" alt="Image"></p>
<pre><code class="hljs language-js">eval_quant_int8 = evaluate_quantization(model_name + <span class="hljs-string">'_quant_int8.tflite'</span>, X_test, y_test, <span class="hljs-string">'int8'</span>)
eval_quant_int8 
</code></pre>
<h2>3.11 â€” ëª¨ë¸ ë°°í¬</h2>
<p>ì´ ì˜ˆì œë¥¼ í†µí•´ ESP32, ì•„ë‘ì´ë…¸, ì•„ë‘ì´ë…¸ Portenta H7 with Vision Shield, ë¼ì¦ˆë² ë¦¬íŒŒì´ ë° ê¸°íƒ€ ë‹¤ì–‘í•œ ë§ˆì´í¬ë¡œì»¨íŠ¸ë¡¤ëŸ¬ ë˜ëŠ” IoT ì¥ì¹˜ì— ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>3.11.1 â€” EloquentTinyML ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜</p>
<p>ë„ì„œê´€ í´ë”ë¡œ ì´ë™í•˜ì—¬ EloquentTinyML-mainì„ ì„¤ì¹˜í•´ì£¼ì„¸ìš”.</p>
<p>3.11.2 â€” ì™„ì „í•œ ì•„ë‘ì´ë…¸ ìŠ¤ì¼€ì¹˜</p>
<p>model_quant_float32.h ë˜ëŠ” model_quant_int8.h íŒŒì¼ì„ ì—´ì–´ì„œ ë‹¤ìŒì—ì„œ ëª¨ë“  16ì§„ìˆ˜ ê°’ì„ ë³µì‚¬í•˜ì„¸ìš”:</p>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_28.png" alt="ì´ë¯¸ì§€"></p>
<p>ì•„ë˜ì™€ ê°™ì´ ë³€ê²½í•´ì£¼ì„¸ìš”:</p>
<p>and model len</p>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_29.png" alt="image"></p>
<p>and cut in model.h:</p>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_30.png" alt="image"></p>
<p>and</p>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_31.png" alt="image"></p>
<p>3.11.2 â€” ì™„ì„±ëœ ì•„ë‘ì´ë…¸ ìŠ¤ì¼€ì¹˜</p>
<pre><code class="hljs language-js">#include &#x3C;<span class="hljs-title class_">EloquentTinyML</span>.<span class="hljs-property">h</span>>
#include &#x3C;eloquent_tinyml/tensorflow.<span class="hljs-property">h</span>>

<span class="hljs-comment">// sine_model.h contains the array you exported from Python with xxd or tinymlgen</span>
#include <span class="hljs-string">"model.h"</span>

#define <span class="hljs-variable constant_">N_INPUTS</span> <span class="hljs-number">64</span>
#define <span class="hljs-variable constant_">N_OUTPUTS</span> <span class="hljs-number">10</span>
<span class="hljs-comment">// in future projects you may need to tweak this value: it's a trial and error process</span>
#define <span class="hljs-variable constant_">TENSOR_ARENA_SIZE</span> <span class="hljs-number">6</span>*<span class="hljs-number">1024</span>

<span class="hljs-title class_">Eloquent</span>::<span class="hljs-title class_">TinyML</span>::<span class="hljs-title class_">TensorFlow</span>::<span class="hljs-title class_">TensorFlow</span>&#x3C;<span class="hljs-variable constant_">N_INPUTS</span>, <span class="hljs-variable constant_">N_OUTPUTS</span>, <span class="hljs-variable constant_">TENSOR_ARENA_SIZE</span>> tf;

float input[<span class="hljs-number">64</span>] = {<span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>12500000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>50000000000f, <span class="hljs-number">0.</span>56250000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>81250000000f, <span class="hljs-number">0.</span>31250000000f, <span class="hljs-number">0.</span>87500000000f, <span class="hljs-number">0.</span>50000000000f, <span class="hljs-number">0.</span>43750000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>75000000000f, <span class="hljs-number">0.</span>31250000000f, <span class="hljs-number">0.</span>12500000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>56250000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>43750000000f, <span class="hljs-number">0.</span>31250000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>18750000000f, <span class="hljs-number">0.</span>31250000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>18750000000f, <span class="hljs-number">0.</span>62500000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>12500000000f, <span class="hljs-number">0.</span>62500000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>06250000000f, <span class="hljs-number">0.</span>81250000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>06250000000f, <span class="hljs-number">0.</span>75000000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>31250000000f, <span class="hljs-number">0.</span>81250000000f, <span class="hljs-number">0.</span>31250000000f, <span class="hljs-number">0.</span>56250000000f, <span class="hljs-number">0.</span>81250000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>00000000000f, <span class="hljs-number">0.</span>56250000000f, <span class="hljs-number">1.</span>00000000000f, <span class="hljs-number">1.</span>00000000000f, <span class="hljs-number">0.</span>43750000000f, <span class="hljs-number">0.</span>00000000000f};

float y_pred[<span class="hljs-number">10</span>] = {<span class="hljs-number">0</span>};

<span class="hljs-keyword">void</span> <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) {
    <span class="hljs-title class_">Serial</span>.<span class="hljs-title function_">begin</span>(<span class="hljs-number">9600</span>);
    <span class="hljs-title function_">delay</span>(<span class="hljs-number">4000</span>);
    tf.<span class="hljs-title function_">begin</span>(model);

    <span class="hljs-comment">// check if model loaded fine</span>
    <span class="hljs-keyword">if</span> (!tf.<span class="hljs-title function_">isOk</span>()) {
      <span class="hljs-title class_">Serial</span>.<span class="hljs-title function_">print</span>(<span class="hljs-string">"ERROR: "</span>);
      <span class="hljs-title class_">Serial</span>.<span class="hljs-title function_">println</span>(tf.<span class="hljs-title function_">getErrorMessage</span>());

      <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) <span class="hljs-title function_">delay</span>(<span class="hljs-number">1000</span>);
    }
}

<span class="hljs-keyword">void</span> <span class="hljs-title function_">loop</span>(<span class="hljs-params"></span>) {

        tf.<span class="hljs-title function_">predict</span>(input, y_pred);
        <span class="hljs-keyword">for</span> (int i = <span class="hljs-number">0</span>; i &#x3C; <span class="hljs-number">10</span>; i++) {
            <span class="hljs-title class_">Serial</span>.<span class="hljs-title function_">print</span>(y_pred[i]);
            <span class="hljs-title class_">Serial</span>.<span class="hljs-title function_">print</span>(i == <span class="hljs-number">9</span> ? <span class="hljs-string">'\n'</span> : <span class="hljs-string">','</span>);
        }
    <span class="hljs-title class_">Serial</span>.<span class="hljs-title function_">print</span>(<span class="hljs-string">"Predicted class is: "</span>);
      <span class="hljs-title class_">Serial</span>.<span class="hljs-title function_">println</span>(tf.<span class="hljs-title function_">probaToClass</span>(y_pred));
      <span class="hljs-comment">// or you can skip the predict() method and call directly predictClass()</span>
      <span class="hljs-title class_">Serial</span>.<span class="hljs-title function_">print</span>(<span class="hljs-string">"Sanity check: "</span>);
      <span class="hljs-title class_">Serial</span>.<span class="hljs-title function_">println</span>(tf.<span class="hljs-title function_">predictClass</span>(input));
      <span class="hljs-title function_">delay</span>(<span class="hljs-number">2000</span>);

}
</code></pre>
<p>3.12 â€” ê²°ê³¼</p>
<p>3.12.1 â€” ì–‘ìí™”ëœ ëª¨ë¸ Float32</p>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_32.png" alt="ì´ë¯¸ì§€"></p>
<p>3.12.1 â€” ì–‘ìí™”ëœ ëª¨ë¸ Int8</p>
<p><img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_33.png" alt="image"></p>
<p>Full project in: <a href="https://github.com/thommaskevin/TinyML" rel="nofollow" target="_blank">TinyML/13_CNN at main Â· thommaskevin/TinyML</a></p>
<h2>If you like it, consider buying my coffee â˜•ï¸ğŸ’° (Bitcoin)</h2>
<p>code: bc1qzydjy4m9yhmjjrkgtrzhsgmkq79qenvcvc7qzn</p>
<p><code>&#x3C;img src="/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_34.png" /></code></p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"ë§ˆì´í¬ë¡œ ë¨¸ì‹ ëŸ¬ë‹  í•©ì„±ê³± ì‹ ê²½ë§ CNN","description":"","date":"2024-06-20 16:55","slug":"2024-06-20-TinyMLConvolutionalNeuralNetworksCNN","content":"\n\nìˆ˜í•™ì  ê¸°ì´ˆë¶€í„° ì—£ì§€ êµ¬í˜„ê¹Œì§€\n\n# ì†Œì…œ ë¯¸ë””ì–´:\n\nğŸ‘¨ğŸ½â€ğŸ’» Github: thommaskevin/TinyML (github.com)\nğŸ‘·ğŸ¾ Linkedin: Thommas Kevin | LinkedIn\nğŸ“½ Youtube: Thommas Kevin â€” YouTube\nğŸ‘¨ğŸ»â€ğŸ« ì—°êµ¬ ê·¸ë£¹: Conecta.ai (ufrn.br)\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_0.png)\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n## ìš”ì•½\n\n# 1 â€” ì»¨ë³¼ë£¨ì…˜ ì‹ ê²½ë§ ì—­ì‚¬\n\nì»¨ë³¼ë£¨ì…˜ ì‹ ê²½ë§(CNN)ì˜ ê°œë…ì€ 1980ë…„ëŒ€ ê¸ˆì‚¬ì´ í›„ì½”ì‹œë§ˆì˜ ì—°êµ¬ë¡œ í˜•ì„±ë˜ê¸° ì‹œì‘í–ˆìŠµë‹ˆë‹¤. ê·¸ëŠ” Neocognitronì„ ê°œë°œí–ˆëŠ”ë°, ì´ëŠ” ë™ë¬¼ì˜ ì‹œê° ì‹œìŠ¤í…œ êµ¬ì¡°ì—ì„œ ì˜ê°ì„ ë°›ì•„ ìê°€ ì¡°ì§í™” ê³¼ì •ì„ í†µí•´ ì‹œê°ì  íŒ¨í„´ì„ ì¸ì‹í•  ìˆ˜ ìˆëŠ” í•™ìŠµì´ ê°€ëŠ¥í•œ ê³„ì¸µì  êµ¬ì¡°ë¥¼ ê°€ì¡ŒìŠµë‹ˆë‹¤. ì´ ì‘ì—…ì€ í˜„ëŒ€ CNNì˜ ê°œë°œì„ ìœ„í•œ ì¤‘ìš”í•œ ì„ í–‰ ì—°êµ¬ì˜€ìŠµë‹ˆë‹¤.\n\n\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_1.png\" /\u003e\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nCNNì˜ í˜„ëŒ€ ì•„í‚¤í…ì²˜ëŠ” ì–€ ë¥´ì¿¤ê³¼ ê·¸ì˜ ë™ë£Œë“¤ì— ì˜í•´ 1980ë…„ëŒ€ í›„ë°˜ê³¼ 1990ë…„ëŒ€ ì´ˆì— ì œì•ˆë˜ì—ˆìŠµë‹ˆë‹¤. ê·¸ë“¤ì€ MNIST ë°ì´í„°ì…‹ì—ì„œ ì†ìœ¼ë¡œ ì“´ ìˆ«ìë¥¼ ì¸ì‹í•˜ê¸° ìœ„í•´ ì„¤ê³„ëœ ì»¨ë³¼ë£¨ì…˜ ì‹ ê²½ë§ì¸ LeNet-5ë¥¼ ê°œë°œí–ˆìŠµë‹ˆë‹¤. LeNet-5ëŠ” ì—¬ëŸ¬ ê°œì˜ ì»¨ë³¼ë£¨ì…˜ ë ˆì´ì–´ë¥¼ ê±°ì¹œ í›„ pooling ë ˆì´ì–´ì™€ ì™„ì „ ì—°ê²° ë ˆì´ì–´ë¡œ ì´ì–´ì§€ëŠ” êµ¬ì¡°ë¡œ, ì˜¤ëŠ˜ë‚  ì‚¬ìš©ë˜ëŠ” CNNì˜ ì•„í‚¤í…ì²˜ì˜ ê¸°ì´ˆë¥¼ êµ¬ì¶•í–ˆìŠµë‹ˆë‹¤.\n\n![image](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_2.png)\n\nì´ˆê¸° ì„±ê³µì—ë„ ë¶ˆêµ¬í•˜ê³  CNNì˜ í™œìš©ì€ ê³„ì‚° ì œì•½ê³¼ ëŒ€ê·œëª¨ ë ˆì´ë¸” ë°ì´í„°ì…‹ì˜ ë¶€ì¡±ìœ¼ë¡œ ì œí•œë˜ì—ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì»´í“¨íŒ… íŒŒì›Œê°€ ì¦ê°€í•˜ê³  GPU(ê·¸ë˜í”½ ì²˜ë¦¬ ì¥ì¹˜)ë¥¼ ì‚¬ìš©í•´ ë”¥ ë„¤íŠ¸ì›Œí¬ë¥¼ í›ˆë ¨í•˜ëŠ” ê¸°ìˆ ì´ ì‹¤í˜„ ê°€ëŠ¥í•´ì§€ë©´ì„œ CNNì€ ë” ë§ì€ ê´€ì‹¬ì„ ëŒê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ê²Œë‹¤ê°€ ImageNetê³¼ ê°™ì€ ëŒ€ê·œëª¨ ë ˆì´ë¸” ì´ë¯¸ì§€ ë°ì´í„°ë² ì´ìŠ¤ì˜ ê°œë°œì€ ë”¥ ë„¤íŠ¸ì›Œí¬ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ í›ˆë ¨í•˜ê¸° ìœ„í•œ í•„ìˆ˜ ìë£Œë¥¼ ì œê³µí–ˆìŠµë‹ˆë‹¤.\n\n2012ë…„ì— Alex Krizhevsky, Ilya Sutskever, Geoffrey Hintonì´ ê°œë°œí•œ AlexNetì´ ImageNet ëŒ€ê·œëª¨ ì‹œê° ì¸ì‹ ì±Œë¦°ì§€(ILSVRC)ì—ì„œ ê²½ìŸ ìƒëŒ€ë“¤ë³´ë‹¤ í° í­ìœ¼ë¡œ ìš°ìŠ¹í•˜ë©´ì„œ ì „í™˜ì ì´ ì°¾ì•„ì™”ìŠµë‹ˆë‹¤. AlexNetì€ ì—¬ëŸ¬ ì»¨ë³¼ë£¨ì…˜ ë ˆì´ì–´, ReLU í™œì„±í™” í•¨ìˆ˜, ê·¸ë¦¬ê³  dropoutê³¼ ê°™ì€ ì •ê·œí™” ê¸°ë²•ì„ í™œìš©í•˜ì—¬ ì‹œê° ì¸ì‹ ì‘ì—…ì— CNNì˜ ì„±ëŠ¥ì„ ì…ì¦í–ˆìŠµë‹ˆë‹¤. ì´í›„ë¡œ CNNì€ ë‹¤ì–‘í•œ ì‘ìš© ë¶„ì•¼ì— ëŒ€í•œ ì£¼ìš” ë„êµ¬ê°€ ë˜ì–´ ì§€ì†ì ì¸ í˜ì‹ ì„ ì´ëŒì–´ë‚´ëŠ” ë° ì´ë¥´ë €ìŠµë‹ˆë‹¤. VGGNet, GoogLeNet(Inception), ResNetê³¼ ê°™ì€ ëª¨ë¸ë“¤ì€ ë„¤íŠ¸ì›Œí¬ì˜ ê¹Šì´, íš¨ìœ¨ì„±, ì •í™•ë„ë¥¼ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•œ ìƒˆë¡œìš´ ì•„í‚¤í…ì²˜ì™€ ê¸°ë²•ë“¤ì„ ì†Œê°œí–ˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_3.png\" /\u003e\n\nì§€ê¸ˆì€ CNNì´ ë§ì€ ì¸ê³µì§€ëŠ¥ ì‹œìŠ¤í…œì˜ í•„ìˆ˜ êµ¬ì„± ìš”ì†Œì…ë‹ˆë‹¤. ì´ë¯¸ì§€ ì¸ì‹ ë¿ë§Œ ì•„ë‹ˆë¼ ë¹„ë””ì˜¤ ë¶„ì„, ìì—°ì–´ ì²˜ë¦¬, ì˜í•™ ì§„ë‹¨, ììœ¨ ì£¼í–‰ì°¨ ë“± ë‹¤ì–‘í•œ ë¶„ì•¼ì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤. ì—°êµ¬ëŠ” ê³„ì†í•´ì„œ ë°œì „í•˜ê³  ìˆìœ¼ë©°, íš¨ìœ¨ì ì¸ í•©ì„±ê³± ì‹ ê²½ë§, ê¹Šì€ ì‹ ê²½ë§(DNNs), ìƒì„±ì  ì ëŒ€ ì‹ ê²½ë§(GANs) ë“±ì˜ í˜ì‹ ì´ ì´ë£¨ì–´ì§€ê³  ìˆìŠµë‹ˆë‹¤.\n\n# 2â€” í•©ì„±ê³± ì‹ ê²½ë§ ì´ë¡ \n\nìˆ˜í•™ì—ì„œ \"í•©ì„±ê³±\"ì€ í•œ í•¨ìˆ˜ê°€ ë‹¤ë¥¸ í•¨ìˆ˜ì— ì˜í•´ ë³€í™˜ë˜ëŠ” í†µí•© ì—°ì‚°ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì‹ ê²½ë§ì˜ ë§¥ë½ì—ì„œëŠ” ì´ ê°œë…ì´ ì „í†µì ì¸ í†µê³„ì  í•´ì„ê³¼ ë‹¤ë¦…ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nê¸°ë³¸ì ìœ¼ë¡œ ìš°ë¦¬ëŠ” ì…ë ¥ í•¨ìˆ˜ë¡œ ì‹œì‘í•©ë‹ˆë‹¤. ìš°ë¦¬ì˜ ê²½ìš°ì—ëŠ” ì£¼ë¡œ ì´ë¯¸ì§€ì…ë‹ˆë‹¤. ë˜í•œ, í•„í„°(ì»¤ë„ì´ë¼ê³ ë„ í•¨)ë¥¼ ì†Œê°œí•©ë‹ˆë‹¤. ì´ë¯¸ì§€ëŠ” ì ê³± ì—°ì‚°ì„ í†µí•´ ë³€í™˜ë˜ëŠ” í•¨ìˆ˜ë¡œ, ì¼ë°˜ì ìœ¼ë¡œ \"í•©ì„±ê³±(convolution)\"ì´ë¼ê³  í•©ë‹ˆë‹¤. ê·¸ ë‹¤ìŒ, ì´ëŸ¬í•œ í•„í„°ë¥¼ ì…ë ¥ ì´ë¯¸ì§€ì— ì ìš©í•˜ë©´ \"íŠ¹ì„± ë§µ(feature maps)\"ì´ë¼ê³  í•˜ëŠ” ì¶œë ¥ ì´ë¯¸ì§€ë¥¼ ì–»ê²Œ ë©ë‹ˆë‹¤.\n\n## 2.1 â€” í•©ì„±ê³± ê³„ì¸µ\n\ní•©ì„±ê³± ê³„ì¸µì€ íŒ¨í„´ì„ ê°ì§€í•˜ê³  í•„í„°(ì»¤ë„)ë¥¼ í†µí•´ íŠ¹ì„± ë§µì„ ìƒì„±í•˜ê¸° ìœ„í•´ ì´ë¯¸ì§€ê°€ ì²˜ë¦¬ë˜ëŠ” ê³³ì…ë‹ˆë‹¤. ì´ëŸ¬í•œ íŠ¹ì„± ë§µì€ í•„í„°ê°€ ì‹ë³„í•˜ë ¤ëŠ” ê° ì†ì„±ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. í•„í„°ëŠ” ì¼ë°˜ì ìœ¼ë¡œ (3x3) ë˜ëŠ” (5x5) í–‰ë ¬ë¡œ êµ¬ì„±ë˜ì–´ ìˆìœ¼ë©°, ê° í•„í„°ëŠ” ì…ë ¥ ì´ë¯¸ì§€ì—ì„œ ë™ì¼í•œ í¬ê¸°ì˜ í•„ë“œë¥¼ ì°¨ì§€í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ, í•„í„°ê°€ í•œ ì¹¸ì”© ê°€ë¡œë¡œ ì´ë™í•˜ê³  ê°™ì€ í”„ë¡œì„¸ìŠ¤ê°€ ë°˜ë³µë©ë‹ˆë‹¤. ê°€ë¡œ ëì— ë„ë‹¬í•˜ë©´ í•„í„°ê°€ í•œ ì¹¸ ì•„ë˜ë¡œ ì´ë™í•˜ê³  ì ê³± í”„ë¡œì„¸ìŠ¤ê°€ ë‹¤ì‹œ ìˆ˜í‰ìœ¼ë¡œ ì ìš©ë©ë‹ˆë‹¤. ê·¸ ê²°ê³¼ëŠ” ìˆœì„œëŒ€ë¡œ ì¶œë ¥ì— ì¶”ê°€ë˜ì–´ íŠ¹ì„± ë§µì„ ìƒì„±í•©ë‹ˆë‹¤.\n\n![ì´ë¯¸ì§€](https://miro.medium.com/v2/resize:fit:1400/0*4UZXfXs7eQ3TT02M.gif)\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì…ë ¥ ì´ë¯¸ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” í…ì„œ Iì˜ ì°¨ì›ì´ m1 x m2 x mcì¸ ê²½ìš°ë¥¼ ê°€ì •í•´ ë´…ì‹œë‹¤. ì´ í…ì„œì—ì„œ,\n\n![image1](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_4.png)\n\nìš°ë¦¬ëŠ” ì…ë ¥ ì´ë¯¸ì§€ì™€ ì¼ì¹˜í•˜ëŠ” ì±„ë„ ìˆ˜ë¥¼ ê°€ì§„ (n1 x n2 x nc) ì°¨ì›ì„ ê°€ì§€ëŠ” í•„í„°ë¥¼ ì ìš©í•©ë‹ˆë‹¤. ì´ í•„í„°ëŠ” ì´ë¯¸ì§€ë¥¼ ì™¼ìª½ì—ì„œ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì›€ì§ì´ë©´ì„œ, ì…ë ¥ í…ì„œ Iì˜ í•´ë‹¹ ì˜ì—­ê³¼ ìš”ì†Œë³„ ê³±ì…ˆì„ ìˆ˜í–‰í•˜ê³  ì´ëŸ¬í•œ ê³±ì…ˆ ê²°ê³¼ë¥¼ í•©ì‚°í•©ë‹ˆë‹¤. ìŠ¤íŠ¸ë¼ì´ë“œ ë§¤ê°œë³€ìˆ˜ëŠ” í•„í„°ê°€ ì´ë¯¸ì§€ë¥¼ íš¡ë‹¨í•˜ëŠ” ë‹¨ê³„ í¬ê¸°ë¥¼ ê²°ì •í•©ë‹ˆë‹¤. Iì™€ K ì‚¬ì´ì˜ ì´ ì‘ì—…ì˜ ê²°ê³¼ëŠ” ë‹¤ë¥¸ ì°¨ì› (m1 - n1 + 1) x (m2 - n2 + 1) x 1ì„ ê°€ì§„ ë˜ ë‹¤ë¥¸ í…ì„œë¥¼ ìƒì„±í•©ë‹ˆë‹¤.\n\n![image2](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_5.png)\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì•ˆë…•í•˜ì„¸ìš”,\n\n\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_6.png\" /\u003e\n\níŠ¹ì§• ë§µì˜ (i, j)ë²ˆì§¸ í•­ëª©ì€ ë‹¤ìŒê³¼ ê°™ì´ ê³„ì‚°ë©ë‹ˆë‹¤:\n\n\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_7.png\" /\u003e\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\në‹¤ìŒ ì˜ˆë¥¼ ì„ íƒí–ˆìŠµë‹ˆë‹¤. 5x5x1 ì°¨ì› ì´ë¯¸ì§€ê°€ 3x3x1 ì»¤ë„ë¡œ í•©ì„±ë˜ê³  s=1 ìŠ¤íŠ¸ë¼ì´ë“œê°€ ì ìš©ë©ë‹ˆë‹¤.\n\n![image](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_8.png)\n\níŠ¹ì§• ë§µì˜ (i, j)-ë²ˆì§¸ í•­ëª©ì€ ë‹¨ì¼ ì±„ë„ì— ëŒ€í•œ ë‹¤ìŒ ì¼ë°˜ ê³µì‹ìœ¼ë¡œ ì£¼ì–´ì§‘ë‹ˆë‹¤:\n\n![formula](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_9.png)\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nìœ„ ì˜ˆì—ì„œ feature mapì˜ (1, 1)ë²ˆ ì§¸ í•­ëª©ì„ ê³„ì‚°í•´ ë´…ì‹œë‹¤:\n\n![image](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_10.png)\n\n![image](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_11.png)\n\nì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” í•­ëª©ì€ 0ìœ¼ë¡œ ëŒ€ì²´ë˜ì—ˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\n![Image](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_12.png)\n\në§ˆì°¬ê°€ì§€ë¡œ, ë‚¨ì€ í•­ëª©ë“¤ì€ ë™ì¼í•œ ê³µì‹ì„ ì‚¬ìš©í•˜ì—¬ ê³„ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ê³¼ì •ì€ ì„œë¡œ ë‹¤ë¥¸ ìœ í˜•ì˜ í•„í„°ë¥¼ ì ìš©í•¨ìœ¼ë¡œì¨ ë°˜ë³µë˜ë©°, ê°ê°ì´ ì´ë¯¸ì§€ì˜ ë‹¤ë¥¸ íŠ¹ì§•ì„ ìº¡ì²˜í•˜ëŠ” ê²ƒì„ ë³´ì—¬ì¤ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, í•„í„° ê°œìˆ˜ê°€ í•˜ë‚˜ ì´ìƒì´ ë  ìˆ˜ ìˆì–´ì„œ ìŠ¤íŠ¸ë¼ì´ë“œ ê°œë…ì´ ë„ì…ë©ë‹ˆë‹¤.\n\n## 2.2â€” íŒ¨ë”© ë ˆì´ì–´\n\nê¸°ë³¸ CNNì€ (n x n) í¬ê¸°ì˜ í‘ë°± ì´ë¯¸ì§€ì™€ (f x f) í¬ê¸°ì˜ í•„í„°/ì»¤ë„ì„ ì‚¬ìš©í•˜ì—¬ ê²°ê³¼ë¥¼ ì œê³µí•˜ë©°, ì¶œë ¥ í¬ê¸°ëŠ” (n - f + 1) x (n - f + 1)ì´ ë©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, (8 x 8) ì´ë¯¸ì§€ì™€ (3 x 3) í•„í„°ë¥¼ ì‚¬ìš©í•œ ì–´ë–¤ í•©ì„± ê³± ì‘ì—…ì˜ ê²½ìš°, ì¶œë ¥ ì´ë¯¸ì§€ í¬ê¸°ëŠ” (6 x 6)ì´ ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ í¬ê¸°ì˜ ê°ì†ŒëŠ” ì´ë¯¸ì§€ ì²˜ë¦¬ ì¤‘ ì¼ê´€ì ìœ¼ë¡œ ë°œìƒí•˜ë©°, ë ˆì´ì–´ì˜ ì¶œë ¥ì´ ì¼ë°˜ì ìœ¼ë¡œ ì…ë ¥ë³´ë‹¤ ì‘ìŠµë‹ˆë‹¤. ë˜í•œ, í•©ì„± ê³± ì‘ì—…ì—ì„œ ì‚¬ìš©ë˜ëŠ” í•„í„°ëŠ” í”½ì…€ì„ íš¡ë‹¨í•˜ë©´ì„œ í•­ìƒ ëª¨ì„œë¦¬ì— ì´ˆì ì„ ë‘ì§€ ì•ŠìŠµë‹ˆë‹¤.\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\n![TinyML CNN](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_13.png)\n\në¨¸ì‹  ëŸ¬ë‹ì—ì„œ ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ì—¬ëŸ¬ ìœ í˜•ì˜ íŒ¨ë”©ì´ ìˆìŠµë‹ˆë‹¤:\n\n- Same íŒ¨ë”©: Same íŒ¨ë”©ì€ ì›ë³¸ ì´ë¯¸ì§€ì˜ ì™¸ë¶€ í”„ë ˆì„ì— ì¼ë°˜ì ìœ¼ë¡œ 0ê³¼ ê°™ì€ ì¶”ê°€ ìš”ì†Œë¥¼ ì¶”ê°€í•˜ëŠ” ê²ƒì„ í¬í•¨í•©ë‹ˆë‹¤. ì´ ë°©ì‹ìœ¼ë¡œ ì…ë ¥ì„ í™•ì¥í•¨ìœ¼ë¡œì¨, í•„í„°ê°€ ë” ë„“ì€ ì˜ì—­ì„ ìŠ¤ìº”í•  ìˆ˜ ìˆê²Œ ë˜ì–´ ì¶œë ¥ ì´ë¯¸ì§€ê°€ ì›ë³¸ê³¼ ë™ì¼í•œ í¬ê¸°ë¥¼ ìœ ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ê²ƒì€ ì»¨ë³¼ë£¨ì…˜ ì‘ì—… ì¤‘ ê³µê°„ì  ì°¨ì›ì„ ìœ ì§€í•˜ëŠ” ë° ìœ ìš©í•©ë‹ˆë‹¤.\n- Valid íŒ¨ë”©: Same íŒ¨ë”©ê³¼ëŠ” ë‹¬ë¦¬, Valid íŒ¨ë”©ì€ ì´ë¯¸ì§€ì— ì¶”ê°€ ìš”ì†Œë¥¼ ì¶”ê°€í•˜ëŠ” ê²ƒì„ í¬í•¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í•„í„°ëŠ” ì¶”ê°€ ìš”ì†Œ ì—†ì´ ì›ë³¸ ì´ë¯¸ì§€ë¥¼ í›‘ì–´ê°‘ë‹ˆë‹¤. ì´ê²ƒì€ ê°„ê²©ìœ¼ë¡œ ì¸í•œ ì¼ë¶€ ë°ì´í„° ì†ì‹¤ì´ ë°œìƒí•  ìˆ˜ ìˆì§€ë§Œ, valid íŒ¨ë”©ì€ ì¶œë ¥ í”¼ì³ ë§µì˜ í¬ê¸°ë¥¼ ì¤„ì´ê³ ì í•  ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì¶•ì†ŒëŠ” ëª¨ë¸ì˜ ë§¤ê°œë³€ìˆ˜ ìˆ˜ë¥¼ ì¤„ì´ê³  ê³„ì‚° íš¨ìœ¨ì„±ì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n- Causal íŒ¨ë”©: Causal íŒ¨ë”©ì€ ì£¼ë¡œ ì‹œí€€ìŠ¤-íˆ¬-ì‹œí€€ìŠ¤ ëª¨ë¸ ë° ì‹œê³„ì—´ ì˜ˆì¸¡ì— ì‚¬ìš©ë˜ë©°, íŠ¹íˆ 1ì°¨ì› ì»¨ë³¼ë£¨ì…˜ ë ˆì´ì–´ì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ ìœ í˜•ì˜ íŒ¨ë”©ì€ ë°ì´í„° ì‹œí€€ìŠ¤ì˜ ì‹œì‘ ë¶€ë¶„ì— ìš”ì†Œë¥¼ ì¶”ê°€í•˜ì—¬ ì•Œê³ ë¦¬ì¦˜ì´ ì´ˆê¸° ì‹œê°„ ë‹¨ê³„ì— ëŒ€í•œ ê°’ì„ ì˜ˆì¸¡í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤. ê³¼ê±° ë° í˜„ì¬ ë°ì´í„°ë¥¼ ì˜ˆì¸¡ì— í¬í•¨ì‹œí‚´ìœ¼ë¡œì¨, causal íŒ¨ë”©ì€ ëª¨ë¸ì´ ì¶”ë¡  ì¤‘ì— ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ë¯¸ë˜ ë°ì´í„°ë¥¼ í™œìš©í•˜ì§€ ì•Šë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤.\n- Full íŒ¨ë”©: ì´ ìœ í˜•ì˜ íŒ¨ë”©ì€ ì…ë ¥ì˜ í…Œë‘ë¦¬ ì£¼ìœ„ì— ì—¬ëŸ¬ ë ˆì´ì–´ì˜ 0ì„ ì¶”ê°€í•˜ì—¬ ì›ë³¸ ì´ë¯¸ì§€ í¬ê¸°ë³´ë‹¤ í° ì¶œë ¥ í”¼ì³ ë§µì„ ìƒì„±í•©ë‹ˆë‹¤. Full íŒ¨ë”©ì€ ëœ ì¼ë°˜ì ì´ì§€ë§Œ ë” í° ì¶œë ¥ í¬ê¸°ê°€ í•„ìš”í•œ íŠ¹ì • ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n## 2.3 â€”Pooling Layer\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\ní’€ë§ ë ˆì´ì–´ì—ì„œëŠ” ì»¨ë³¼ë£¨ì…˜ëœ íŠ¹ì§•ì˜ ê³µê°„ ì°¨ì›ì´ ì¼ë°˜ì ìœ¼ë¡œ ì¶•ì†Œë˜ì–´ ì…ë ¥ ì´ë¯¸ì§€ì—ì„œ ì£¼ìš”í•œ íŠ¹ì§•ì„ ì¶”ì¶œí•˜ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤. ì´ í¬ê¸°ì˜ ì¶•ì†ŒëŠ” ì»¨ë³¼ë£¨ì…˜ ë ˆì´ì–´ì—ì„œ ì–»ì€ ì¶œë ¥ì— í’€ë§ í•¨ìˆ˜ë¥¼ ì ìš©í•˜ì—¬ ë‹¬ì„±ë©ë‹ˆë‹¤. ì´ë ‡ê²Œ ê°€ì •í•´ ë´…ì‹œë‹¤:\n\n![ê·¸ë¦¼ 1](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_14.png)\n\ní’€ë§ëœ ë¶€ë¶„ì˜ ì°¨ì›ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:\n\n![ê·¸ë¦¼ 2](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_15.png)\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\në”¥ëŸ¬ë‹ì—ì„œëŠ” 3ê°€ì§€ ì¢…ë¥˜ì˜ í’€ë§ì´ ìˆì–´ìš”:\n\ní‰ê·  í’€ë§: ì»¤ë²„ëœ ì˜ì—­ ë‚´ í”½ì…€ ê°’ì˜ í‰ê· ì´ ì¶œë ¥ ë§¤íŠ¸ë¦­ìŠ¤ë¡œ ì „ë‹¬ë©ë‹ˆë‹¤.\n\nìµœëŒ€ í’€ë§: ì»¤ë²„ëœ ì˜ì—­ ë‚´ í”½ì…€ ê°’ ì¤‘ ê°€ì¥ ë†’ì€ ê°’ì´ ì¶œë ¥ ë§¤íŠ¸ë¦­ìŠ¤ë¡œ ì „ë‹¬ë©ë‹ˆë‹¤.\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_16.png)\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì „ì—­ ìµœëŒ€ í’€ë§(Global Max Pooling) : ëª¨ë“  ì…ë ¥ í¬ê¸°ì˜ í”½ì…€ ê°’ ì¤‘ ê°€ì¥ ë†’ì€ ê°’ì´ ì¶œë ¥ í–‰ë ¬ë¡œ ì „ë‹¬ë©ë‹ˆë‹¤. ì´ ìœ í˜•ì˜ í’€ë§ì—ì„œ í’€ í¬ê¸°ëŠ” ì…ë ¥ í¬ê¸°ì™€ ë™ì¼í•©ë‹ˆë‹¤.\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_17.png)\n\nsum pooling, average pooling, max poolingê³¼ ê°™ì€ ë‹¤ì–‘í•œ ìœ í˜•ì˜ í’€ë§ì´ ìˆìŠµë‹ˆë‹¤. ìµœëŒ€ í’€ë§ì˜ ì˜ˆëŠ” ì•„ë˜ì— ì œê³µë©ë‹ˆë‹¤. ìµœëŒ€ í’€ë§ì€ 2x2 íŒ¨ì¹˜ì— ìˆ˜í–‰ë©ë‹ˆë‹¤. ê° íŒ¨ì¹˜ì—ì„œ ìµœëŒ“ê°’ì´ ì„ íƒë©ë‹ˆë‹¤.\n\n## 2.4 â€” í”Œë˜íŠ¼ ë ˆì´ì–´\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\ní”Œë˜íŠ¼ ë ˆì´ì–´ëŠ” ì‹ ê²½ë§ ì•„í‚¤í…ì²˜ì—ì„œ ì¤‘ìš”í•œ êµ¬ì„± ìš”ì†Œì´ë©°, íŠ¹íˆ í•©ì„±ê³± ë ˆì´ì–´ì—ì„œ ì™„ì „íˆ ì—°ê²°ëœ ë ˆì´ì–´ë¡œì˜ ì „í™˜ ì‹œì— ì¤‘ìš”í•©ë‹ˆë‹¤. ì´ ë ˆì´ì–´ëŠ” í•©ì„±ê³± ë° í’€ë§ ë ˆì´ì–´ì—ì„œ ìƒì„±ëœ ë‹¤ì°¨ì› í”¼ì³ ë§µì„ ì¼ì°¨ì› ë²¡í„°ë¡œ ë³€í™˜í•˜ì—¬, ë¶„ë¥˜ ë˜ëŠ” íšŒê·€ ì‘ì—…ì„ ìœ„í•´ í›„ì† ì™„ì „íˆ ì—°ê²°ëœ ë ˆì´ì–´ë¡œ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n![ì´ë¯¸ì§€ ì„¤ëª…](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_18.png)\n\në‹¤ìŒì€ í”Œë˜íŠ¼ ë ˆì´ì–´ì˜ ì‘ë™ ë°©ì‹ì…ë‹ˆë‹¤:\n\n- ì…ë ¥: í”Œë˜íŠ¼ ë ˆì´ì–´ì˜ ì…ë ¥ì€ ì¼ë°˜ì ìœ¼ë¡œ ì´ì „ í•©ì„±ê³± ë˜ëŠ” í’€ë§ ë ˆì´ì–´ì—ì„œ ìƒì„±ëœ í”¼ì³ ë§µì„ ë‚˜íƒ€ë‚´ëŠ” ë‹¤ì°¨ì› í…ì„œì…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë§ˆì§€ë§‰ í•©ì„±ê³± ë˜ëŠ” í’€ë§ ë ˆì´ì–´ê°€ ë†’ì´, ë„ˆë¹„, ê¹Šì´ì˜ í”¼ì³ ë§µì„ ìƒì„±í•œë‹¤ë©´ ì…ë ¥ í…ì„œëŠ” (ë°°ì¹˜ í¬ê¸°, ë†’ì´, ë„ˆë¹„, ê¹Šì´) í˜•íƒœë¥¼ ê°€ì§ˆ ê²ƒì…ë‹ˆë‹¤.\n- í”Œë˜íŒ…: í”Œë˜íŒ… ë ˆì´ì–´ëŠ” ë‹¨ìˆœíˆ í”¼ì³ ë§µì˜ ëª¨ë“  ìš”ì†Œë¥¼ í•˜ë‚˜ì˜ ì°¨ì›ì„ ë”°ë¼ ì—°ê²°í•˜ì—¬ ì…ë ¥ í…ì„œë¥¼ ì¼ì°¨ì› ë²¡í„°ë¡œ ë‹¤ì‹œ í˜•íƒœí™”í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, í”¼ì³ ë§µì´ ë†’ì´, ë„ˆë¹„, ê¹Šì´ì˜ ì°¨ì›ì„ ê°€ì§„ë‹¤ë©´ í”Œë˜íŒ… ë ˆì´ì–´ëŠ” ì´ë¥¼ ë†’ì´ * ë„ˆë¹„ * ê¹Šì´ì˜ ê¸¸ì´ë¥¼ ê°€ì§„ ë²¡í„°ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.\n- ì¶œë ¥: í”Œë˜íŒ… ë ˆì´ì–´ì˜ ì¶œë ¥ì€ í”¼ì³ ë§µì„ í”Œë˜íŒ…í•œ ì¼ì°¨ì› ë²¡í„°ì…ë‹ˆë‹¤. ì´ ë²¡í„°ëŠ” ì´í›„ì˜ ì™„ì „íˆ ì—°ê²°ëœ ë ˆì´ì–´ì˜ ì…ë ¥ìœ¼ë¡œ ì „ë‹¬ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\ní‰íƒ„í™” ë ˆì´ì–´ì˜ ëª©ì ì€ íŠ¹ì„± ë§µì—ì„œ ìº¡ì²˜ëœ ê³µê°„ ì •ë³´ë¥¼ ì™„ì „ ì—°ê²° ë ˆì´ì–´ì—ì„œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì™„ì „ ì—°ê²° ë ˆì´ì–´ëŠ” ì¼ì°¨ì› ì…ë ¥ ë²¡í„°ë¥¼ í•„ìš”ë¡œí•˜ë¯€ë¡œ íŠ¹ì„± ë§µì„ í‰íƒ„í™”í•¨ìœ¼ë¡œì¨ ì‹ ê²½ë§ì´ ë°ì´í„°ì˜ ë‹¤ì–‘í•œ ê³µê°„ ìœ„ì¹˜ì— ê±¸ì³ ë³µì¡í•œ íŒ¨í„´ê³¼ ê´€ê³„ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ í•™ìŠµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ë” ì •í™•í•œ ì˜ˆì¸¡ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì´ì „ì˜ í•©ì„±ê³± ë˜ëŠ” í’€ë§ ë ˆì´ì–´ì— ì˜í•´ ìƒì„±ëœ íŠ¹ì„± ë§µ ğ¹ ì§‘í•©ì´ ìˆë‹¤ê³  ê°€ì •í•´ë´…ì‹œë‹¤. ì´ëŸ¬í•œ íŠ¹ì„± ë§µì˜ ì°¨ì›ì„ ë‹¤ìŒê³¼ ê°™ì´ í‘œê¸°í•´ ë´…ì‹œë‹¤:\n\n- ğ»: íŠ¹ì„± ë§µì˜ ë†’ì´\n- ğ‘Š: íŠ¹ì„± ë§µì˜ ë„ˆë¹„\n- ğ·: íŠ¹ì„± ë§µì˜ ê¹Šì´ (ì±„ë„ ìˆ˜)\n- ğµ: ë°°ì¹˜ í¬ê¸° (ë°°ì¹˜ì— í¬í•¨ëœ ìƒ˜í”Œ ìˆ˜)\n\nê·¸ëŸ¬ë©´ íŠ¹ì„± ë§µ ğ¹ì˜ í˜•íƒœëŠ” (B,H,W,D)ê°€ ë©ë‹ˆë‹¤. ì—¬ê¸°ì„œ ğµì€ ë°°ì¹˜ í¬ê¸°ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì´ëŸ¬í•œ í”¼ì²˜ ë§µì„ ì¼ì°¨ì› ë²¡í„°ë¡œ í‰íƒ„í™”í•˜ê¸° ìœ„í•´, ë‹¨ìˆœíˆ ì´ë¥¼ ê¸¸ì´ ğ»Ã—ğ‘ŠÃ—ğ·ì˜ ë²¡í„°ë¡œ ì¬êµ¬ì„±í•©ë‹ˆë‹¤. ìˆ˜í•™ì ìœ¼ë¡œ í‘œí˜„í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:\n\nFlatten(ğ¹)=reshape(ğ¹, (ğµ, ğ»Ã—ğ‘ŠÃ—ğ·))\n\nì´ ê²½ìš°, ì¬êµ¬ì„± ì—°ì‚°ì€ (ğµ, ğ», ğ‘Š, ğ·) í…ì„œë¥¼ (ğµ, ğ»Ã—ğ‘ŠÃ—ğ·) í…ì„œë¡œ ì¬êµ¬ì„±í•˜ì—¬ ê³µê°„ ì°¨ì›ì„ í•˜ë‚˜ì˜ ì°¨ì›ìœ¼ë¡œ í¼ì¹˜ê²Œ ë©ë‹ˆë‹¤.\n\nì˜ˆë¥¼ ë“¤ì–´, ë§Œì•½ ğ¹ê°€ ì°¨ì›ì´ (4,5,5,3)ì¸ ê²½ìš° (ë°°ì¹˜ í¬ê¸°ê°€ 4, ë†’ì´ê°€ 5, ë„ˆë¹„ê°€ 5, ê¹Šì´ê°€ 3ì¸ í”¼ì²˜ ë§µ), ê·¸ëŸ¬ë©´ í‰íƒ„í™”ëœ ì¶œë ¥ì€ (4,75) ì°¨ì›ì„ ê°–ê²Œ ë˜ë©°, ê° í–‰ì€ ë°°ì¹˜ì˜ í•œ ìƒ˜í”Œì— ëŒ€í•œ í‰íƒ„í™”ëœ í”¼ì²˜ ë§µì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì´ í‰íƒ„í™”ëœ ë²¡í„°ëŠ” ì‹ ê²½ë§ì˜ í›„ì† ì™„ì „ ì—°ê²° ë ˆì´ì–´ì— ì…ë ¥ìœ¼ë¡œ ì „ë‹¬ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n# 3 â€” TinyML êµ¬í˜„\n\nì´ ì˜ˆì œë¥¼ í†µí•´ ESP32, ì•„ë‘ì´ë…¸, ë¼ì¦ˆë² ë¦¬ íŒŒì´ ë° ê¸°íƒ€ ë‹¤ì–‘í•œ ë§ˆì´í¬ë¡œì»¨íŠ¸ë¡¤ëŸ¬ ë˜ëŠ” IoT ì¥ì¹˜ì—ì„œ ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n3.0 â€” requirements.txt íŒŒì¼ì— ë‚˜ì—´ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```python\n!pip install -r requirements.txt\n```\n\n3.1 â€” ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°€ì ¸ì˜¤ê¸°\n\n```python\nimport numpy as np\nfrom sklearn.datasets import load_digits\nimport tensorflow as tf\nfrom tensorflow.keras import layers\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import confusion_matrix\nfrom matplotlib import pyplot as plt\nimport time\nimport seaborn as sns\nimport os\n```\n\n3.2 â€” ë°ì´í„°ì…‹ ë¶ˆëŸ¬ì˜¤ê¸°\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nMNISTì€ Modified National Institute of Standards and Technology databaseì˜ ì¤„ì„ë§ë¡œ, ê¸°ê³µ í•™ìŠµ ë° ì»´í“¨í„° ë¹„ì „ ë¶„ì•¼ì—ì„œ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” ë°ì´í„°ì…‹ì…ë‹ˆë‹¤. ì´ ë°ì´í„°ì…‹ì€ 0ì—ì„œ 9ê¹Œì§€ì˜ ì†ìœ¼ë¡œ ì“´ ìˆ«ìë“¤ì˜ ëª¨ìŒìœ¼ë¡œ, ê° ìˆ«ìëŠ” 28x28 í”½ì…€ í¬ê¸°ì˜ íšŒìƒ‰ ìŒì˜ ì´ë¯¸ì§€ë¡œ í‘œí˜„ë©ë‹ˆë‹¤. ì´ ë°ì´í„°ì…‹ì—ëŠ” ì´ 70,000ê°œì˜ ì´ë¯¸ì§€ê°€ í¬í•¨ë˜ì–´ ìˆìœ¼ë©°, ì´ ì¤‘ 60,000ê°œì˜ ì´ë¯¸ì§€ëŠ” í›ˆë ¨ì— ì‚¬ìš©ë˜ê³  10,000ê°œì˜ ì´ë¯¸ì§€ëŠ” í…ŒìŠ¤íŠ¸ì— ì‚¬ìš©ë©ë‹ˆë‹¤.\n\në§í¬: [https://www.nist.gov/itl/products-and-services/emnist-dataset](https://www.nist.gov/itl/products-and-services/emnist-dataset)\n\n```python\ndef get_data():\n    np.random.seed(1337)\n    x_values, y_values = load_digits(return_X_y=True)\n    x_values /= x_values.max()\n    # reshape to (8 x 8 x 1)\n    x_values = x_values.reshape((len(x_values), 8, 8, 1))\n    # split into train, validation, test\n    TRAIN_SPLIT = int(0.6 * len(x_values))\n    TEST_SPLIT = int(0.2 * len(x_values) + TRAIN_SPLIT)\n    x_train, x_test, x_validate = np.split(x_values, [TRAIN_SPLIT, TEST_SPLIT])\n    y_train, y_test, y_validate = np.split(y_values, [TRAIN_SPLIT, TEST_SPLIT])\n\n    return x_train, x_test, x_validate, y_train, y_test, y_validate\n```\n\n3.3 â€” ë°ì´í„° ë¶„í• \n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\nX_train, X_test, X_validate, y_train, y_test, y_validate = get_data()\n```\n\n3.4 â€” íƒìƒ‰ì  ë°ì´í„° ë¶„ì„\n\n```js\nX_train__ = X_train.reshape(X_train.shape[0], 8, 8)\n\nfig, axis = plt.subplots(1, 4, figsize=(20, 10))\nfor i, ax in enumerate(axis.flat):\n    ax.imshow(X_train__[i], cmap='binary')\n    digit = y_train[i]\n    ax.set(title = f\"ì‹¤ì œ ìˆ«ìëŠ” {digit}ì…ë‹ˆë‹¤.\")\n```\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_19.png)\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n3.5â€” ëª¨ë¸ ì •ì˜í•˜ê¸°\n\n```js\nmodel = tf.keras.Sequential()\nmodel.add(layers.Conv2D(8, (3, 3), activation='relu', input_shape=(8, 8, 1)))\nmodel.add(layers.MaxPooling2D((2, 2)))\nmodel.add(layers.Flatten())\nmodel.add(layers.Dense(len(np.unique(y_train))))\n```\n\n```js\nmodel.summary()\n```\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_20.png)\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\nplot_model(model, to_file='./figures/model.png')\n```\n\n![Plot](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_21.png)\n\n3.6â€”ëª¨ë¸ ì»´íŒŒì¼í•˜ê¸°\n\n```js\nmodel.compile(optimizer='adam', loss=tf.keras.losses.SparseCategoricalCrossentropy(from_logits=True), metrics=['accuracy'])\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n3.7 â€” ëª¨ë¸ í›ˆë ¨\n\n```js\nhistory = model.fit(X_train, y_train,\n                    epochs=50,\n                    batch_size=16,\n                    validation_data=(X_validate, y_validate))\n```\n\n```js\nmodel.save('.\\models\\model.keras')\n```\n\n```js\nloss = history.history['loss']\nval_loss = history.history['val_loss']\nepochs = range(1, len(loss) + 1)\nplt.plot(epochs, loss, 'r.', label='í›ˆë ¨ ì†ì‹¤')\nplt.plot(epochs, val_loss, 'y', label='ê²€ì¦ ì†ì‹¤')\nplt.title('í›ˆë ¨ ë° ê²€ì¦ ì†ì‹¤')\nplt.xlabel('ì—í¬í¬')\nplt.ylabel('ì†ì‹¤')\nplt.grid()\nplt.legend()\nplt.savefig('.\\\\figures\\\\history_traing.png', dpi=300, bbox_inches='tight')\nplt.show()\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_22.png\" /\u003e\n\nëª¨ë¸ í‰ê°€\n\ní…ŒìŠ¤íŠ¸ ë°ì´í„°\n\n```js\ndef test_model(model, x_test, y_test):\n    x_test = (x_test / x_test.max()).reshape((len(x_test), 8, 8, 1))\n    y_pred = model.predict(x_test).argmax(axis=1)\n    print('ì •í™•ë„', ((y_pred == y_test).sum() / len(y_test))*100, \"%\")\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\n```js\ntest_model(model, X_test, y_test)\n```\n\n![Image](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_23.png)\n\n3.8.2 â€” Confusion matrix\n\n```js\nfig = plt.figure(figsize=(10, 10)) # Set Figure\n\ny_pred = model.predict(X_test) # Predict class probabilities as 2 =\u003e [0.1, 0, 0.9, 0, 0, 0, 0, 0, 0, 0]\nY_pred = np.argmax(y_pred, 1) # Decode Predicted labels\nmat = confusion_matrix(y_test, Y_pred) # Confusion matrix\n\n# Plot Confusion matrix\nsns.heatmap(mat.T, square=True, annot=True, cbar=False, cmap=plt.cm.Blues, fmt='.0f', \n            xticklabels=np.unique(y_test), yticklabels=np.unique(y_test), \n            annot_kws={\"fontsize\": 14}, linewidths=1, linecolor='white')\n\nplt.xlabel('Predicted Values', fontsize=14)\nplt.ylabel('True Values', fontsize=14)\nplt.xticks(fontsize=14)\nplt.yticks(fontsize=14)\nplt.savefig('.\\\\figures\\\\confusion_matrix.png', dpi=300, bbox_inches='tight')\nplt.show()\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_24.png)\n\n3.8.3â€” ì˜ˆì¸¡ ìœ íš¨ì„± ê²€ì‚¬ ê²°ê³¼\n\n```js\ny_pred = model.predict(X_test)\nX_test__ = X_test\n\nfig, axis = plt.subplots(4, 4, figsize=(12, 14))\nfor i, ax in enumerate(axis.flat):\n    ax.imshow(X_test__[i], cmap='binary')\n    ax.set(title = f\"ì‹¤ì œ ìˆ«ì: {y_test[i]}\\nì˜ˆì¸¡ ìˆ«ì: {y_pred[i].argmax()}\")\n```\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_25.png)\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n3.9 â€” ë§ˆì´í¬ë¡œì»¨íŠ¸ë¡¤ëŸ¬ì— êµ¬í˜„í•  ëª¨ë¸ì„ ì–»ê¸°\n\n3.9.1 â€” C í”„ë¡œê·¸ë˜ë°ì„ ìœ„í•´ ì¼ë¶€ 16ì§„ìˆ˜ ê°’ì„ ë°°ì—´ë¡œ ë³€í™˜í•˜ê¸°\n\n```js\n# í•¨ìˆ˜: C í”„ë¡œê·¸ë˜ë°ì„ ìœ„í•´ ì¼ë¶€ 16ì§„ìˆ˜ ê°’ì„ ë°°ì—´ë¡œ ë³€í™˜\ndef hex_to_c_array(hex_data, var_name):\n\n  c_str = ''\n\n  # í—¤ë” ê°€ë“œ ìƒì„±\n  c_str += '#ifdef __has_attribute\\n'\n  c_str += '#define HAVE_ATTRIBUTE(x) __has_attribute(x)\\n'\n  c_str += '#else\\n'\n  c_str += '#define HAVE_ATTRIBUTE(x) 0\\n'\n  c_str += '#endif\\n'\n  c_str += '#if HAVE_ATTRIBUTE(aligned) || (defined(__GNUC__) \u0026\u0026 !defined(__clang__))\\n'\n  c_str += '#define DATA_ALIGN_ATTRIBUTE __attribute__((aligned(4)))\\n'\n  c_str += '#else\\n'\n  c_str += '#define DATA_ALIGN_ATTRIBUTE\\n'\n  c_str += '#endif\\n\\n'\n\n  # C ë³€ìˆ˜ ì„ ì–¸\n  c_str += 'const unsigned char ' + var_name + '[]  DATA_ALIGN_ATTRIBUTE = {'\n  hex_array = []\n  for i, val in enumerate(hex_data) :\n\n    # 16ì§„ìˆ˜ì—ì„œ ë¬¸ìì—´ë¡œ ë³€í™˜\n    hex_str = format(val, '#04x')\n\n    # ê° ì¤„ì´ 80ì ì´ë‚´ë¡œ ìœ ì§€ë˜ë„ë¡ ì„œì‹ ì§€ì • ì¶”ê°€\n    if (i + 1) \u003c len(hex_data):\n      hex_str += ','\n    if (i + 1) % 12 == 0:\n      hex_str += '\\n '\n    hex_array.append(hex_str)\n\n  # ë§ˆì§€ë§‰ ì¤‘ê´„í˜¸ ì¶”ê°€\n  c_str += '\\n ' + format(' '.join(hex_array)) + '\\n};\\n\\n'\n\n  # í—¤ë” ê°€ë“œ ì¢…ë£Œ\n  c_str += 'const int ' + var_name + '_len = ' + str(len(hex_data)) + ';\\n'\n\n  return c_str\n```\n\n3.9.2â€”ëª¨ë¸ì„ Float32ì™€ Int8í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ê¸°\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\ndef representative_dataset():\n    for i in range(len(X_train)):\n        input_data = np.array([X_train[i]], dtype=np.float32)\n        yield [input_data]\n\ndef converter_quantization_model(model, model_name):\n\n    # Convert the model to float32\n    converter_float32 = tf.lite.TFLiteConverter.from_keras_model(model)\n    converter_float32.optimizations = [tf.lite.Optimize.DEFAULT]\n    converter_float32.target_spec.supported_types = [tf.float32]\n    converter_float32._experimental_lower_tensor_list_ops = False\n    converter_float32.supported_ops = [tf.lite.OpsSet.TFLITE_BUILTINS, tf.lite.OpsSet.SELECT_TF_OPS]\n    converter_float32.representative_dataset = representative_dataset\n    tflite_model_float32 = converter_float32.convert()\n    print(tflite_model_float32)\n    with open(model_name+'_quant_float32' + '.h', 'w') as file:\n        file.write(hex_to_c_array(tflite_model_float32, model_name+'_quant_float32'))\n    with open(model_name+'_quant_float32.tflite', 'wb') as f:\n        f.write(tflite_model_float32)\n    size_model_tflite_float32 = os.path.getsize(model_name+'_quant_float32.tflite')\n    print(model_name+f'_quant_float32.tflite: {size_model_tflite_float32} Bytes')\n\n    # Convert the model to Int8\n    converter_int8 = tf.lite.TFLiteConverter.from_keras_model(model)\n    converter_int8.optimizations = [tf.lite.Optimize.DEFAULT]\n    converter_int8.target_spec.supported_types = [tf.int8]\n    converter_int8.representative_dataset = representative_dataset\n    converter_int8.target_spec.supported_ops = [\n        tf.lite.OpsSet.TFLITE_BUILTINS_INT8,\n        tf.lite.OpsSet.SELECT_TF_OPS,\n    ]\n    converter_int8.target_spec.supported_ops = [tf.lite.OpsSet.TFLITE_BUILTINS]\n    converter_int8.target_spec.supported_ops = [tf.lite.OpsSet.TFLITE_BUILTINS_INT8]\n    converter_int8.experimental_new_converter = True\n    converter_int8.experimental_new_quantizer = True\n    converter_int8.experimental_new_calibrator = True\n    tflite_model_int8 = converter_int8.convert()\n    with open(model_name+'_quant_int8' + '.h', 'w') as file:\n        file.write(hex_to_c_array(tflite_model_int8, model_name+'_quant_int8'))\n    with open(model_name+'_quant_int8.tflite', 'wb') as f:\n        f.write(tflite_model_int8)\n    size_model_tflite_int8 = os.path.getsize(model_name+'_quant_int8.tflite')\n    print(model_name+f'_quant_int8.tflite: {size_model_tflite_int8} Bytes')\n\n    return None\n```\n\n```js\nmodel_name='.\\models\\model'\nconverter_quantization_model(model, model_name)\n```\n\n3.10 â€” Quantized Model Evaluation\n\n```js\ndef evaluate_quantization(model_path, X_test, y_test, quantization_type):\n    interpreter = tf.lite.Interpreter(model_path=model_path)\n    interpreter.allocate_tensors()\n\n    # Evaluate the quantized model\n    input_index = interpreter.get_input_details()[0]['index']\n    output_index = interpreter.get_output_details()[0]['index']\n    predictions = []\n    processing_times = []\n\n    X_test = np.array(X_test, dtype=np.float32)\n    \n    for X in X_test:\n        interpreter.set_tensor(input_index, [X])       \n        start_time = time.time()\n        interpreter.invoke()\n        end_time = time.time()\n        processing_time = end_time - start_time\n        processing_times.append(processing_time)\n        output = interpreter.get_tensor(output_index).argmax(axis=1)\n        predictions.append(output[0])\n\n    acc = accuracy_score(y_test, predictions)\n   \n    # Calculate the average and standard deviation of differences\n    result = { \"Accuracy (%): \":acc*100,\n                \"Process time (s): \": np.mean(processing_times)\n            }\n\n    return result\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\nmodel_name = '.\\models\\model'\n```\n\n```js\neval_quant_float32 = evaluate_quantization(model_name + '_quant_float32.tflite', X_test, y_test, 'float32')\neval_quant_float32\n```\n\n![Image](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_26.png)\n\n```js\neval_quant_int8 = evaluate_quantization(model_name + '_quant_int8.tflite', X_test, y_test, 'int8')\neval_quant_int8 \n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_27.png\" /\u003e\n\n## 3.11 â€” ëª¨ë¸ ë°°í¬\n\nì´ ì˜ˆì œë¥¼ í†µí•´ ESP32, ì•„ë‘ì´ë…¸, ì•„ë‘ì´ë…¸ Portenta H7 with Vision Shield, ë¼ì¦ˆë² ë¦¬íŒŒì´ ë° ê¸°íƒ€ ë‹¤ì–‘í•œ ë§ˆì´í¬ë¡œì»¨íŠ¸ë¡¤ëŸ¬ ë˜ëŠ” IoT ì¥ì¹˜ì— ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n3.11.1 â€” EloquentTinyML ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\në„ì„œê´€ í´ë”ë¡œ ì´ë™í•˜ì—¬ EloquentTinyML-mainì„ ì„¤ì¹˜í•´ì£¼ì„¸ìš”.\n\n3.11.2 â€” ì™„ì „í•œ ì•„ë‘ì´ë…¸ ìŠ¤ì¼€ì¹˜\n\nmodel_quant_float32.h ë˜ëŠ” model_quant_int8.h íŒŒì¼ì„ ì—´ì–´ì„œ ë‹¤ìŒì—ì„œ ëª¨ë“  16ì§„ìˆ˜ ê°’ì„ ë³µì‚¬í•˜ì„¸ìš”:\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_28.png)\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nì•„ë˜ì™€ ê°™ì´ ë³€ê²½í•´ì£¼ì„¸ìš”:\n\n\nand model len\n\n![image](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_29.png)\n\nand cut in model.h:\n\n![image](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_30.png)\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nand\n\n![image](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_31.png)\n\n3.11.2 â€” ì™„ì„±ëœ ì•„ë‘ì´ë…¸ ìŠ¤ì¼€ì¹˜\n\n```js\n#include \u003cEloquentTinyML.h\u003e\n#include \u003celoquent_tinyml/tensorflow.h\u003e\n\n// sine_model.h contains the array you exported from Python with xxd or tinymlgen\n#include \"model.h\"\n\n#define N_INPUTS 64\n#define N_OUTPUTS 10\n// in future projects you may need to tweak this value: it's a trial and error process\n#define TENSOR_ARENA_SIZE 6*1024\n\nEloquent::TinyML::TensorFlow::TensorFlow\u003cN_INPUTS, N_OUTPUTS, TENSOR_ARENA_SIZE\u003e tf;\n\nfloat input[64] = {0.00000000000f, 0.12500000000f, 0.00000000000f, 0.50000000000f, 0.56250000000f, 0.00000000000f, 0.00000000000f, 0.00000000000f, 0.00000000000f, 0.81250000000f, 0.31250000000f, 0.87500000000f, 0.50000000000f, 0.43750000000f, 0.00000000000f, 0.00000000000f, 0.00000000000f, 0.75000000000f, 0.31250000000f, 0.12500000000f, 0.00000000000f, 0.56250000000f, 0.00000000000f, 0.00000000000f, 0.00000000000f, 0.43750000000f, 0.31250000000f, 0.00000000000f, 0.00000000000f, 0.18750000000f, 0.31250000000f, 0.00000000000f, 0.00000000000f, 0.18750000000f, 0.62500000000f, 0.00000000000f, 0.00000000000f, 0.12500000000f, 0.62500000000f, 0.00000000000f, 0.00000000000f, 0.06250000000f, 0.81250000000f, 0.00000000000f, 0.00000000000f, 0.06250000000f, 0.75000000000f, 0.00000000000f, 0.00000000000f, 0.00000000000f, 0.31250000000f, 0.81250000000f, 0.31250000000f, 0.56250000000f, 0.81250000000f, 0.00000000000f, 0.00000000000f, 0.00000000000f, 0.00000000000f, 0.56250000000f, 1.00000000000f, 1.00000000000f, 0.43750000000f, 0.00000000000f};\n\nfloat y_pred[10] = {0};\n\nvoid setup() {\n    Serial.begin(9600);\n    delay(4000);\n    tf.begin(model);\n\n    // check if model loaded fine\n    if (!tf.isOk()) {\n      Serial.print(\"ERROR: \");\n      Serial.println(tf.getErrorMessage());\n\n      while (true) delay(1000);\n    }\n}\n\nvoid loop() {\n\n        tf.predict(input, y_pred);\n        for (int i = 0; i \u003c 10; i++) {\n            Serial.print(y_pred[i]);\n            Serial.print(i == 9 ? '\\n' : ',');\n        }\n    Serial.print(\"Predicted class is: \");\n      Serial.println(tf.probaToClass(y_pred));\n      // or you can skip the predict() method and call directly predictClass()\n      Serial.print(\"Sanity check: \");\n      Serial.println(tf.predictClass(input));\n      delay(2000);\n\n}\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n3.12 â€” ê²°ê³¼\n\n3.12.1 â€” ì–‘ìí™”ëœ ëª¨ë¸ Float32\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_32.png)\n\n3.12.1 â€” ì–‘ìí™”ëœ ëª¨ë¸ Int8\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\n![image](/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_33.png)\n\nFull project in: [TinyML/13_CNN at main Â· thommaskevin/TinyML](https://github.com/thommaskevin/TinyML)\n\n## If you like it, consider buying my coffee â˜•ï¸ğŸ’° (Bitcoin)\n\ncode: bc1qzydjy4m9yhmjjrkgtrzhsgmkq79qenvcvc7qzn\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n`\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_34.png\" /\u003e`","ogImage":{"url":"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_0.png"},"coverImage":"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_0.png","tag":["Tech"],"readingTime":23},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003eìˆ˜í•™ì  ê¸°ì´ˆë¶€í„° ì—£ì§€ êµ¬í˜„ê¹Œì§€\u003c/p\u003e\n\u003ch1\u003eì†Œì…œ ë¯¸ë””ì–´:\u003c/h1\u003e\n\u003cp\u003eğŸ‘¨ğŸ½â€ğŸ’» Github: thommaskevin/TinyML (github.com)\nğŸ‘·ğŸ¾ Linkedin: Thommas Kevin | LinkedIn\nğŸ“½ Youtube: Thommas Kevin â€” YouTube\nğŸ‘¨ğŸ»â€ğŸ« ì—°êµ¬ ê·¸ë£¹: Conecta.ai (ufrn.br)\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_0.png\" alt=\"ì´ë¯¸ì§€\"\u003e\u003c/p\u003e\n\u003ch2\u003eìš”ì•½\u003c/h2\u003e\n\u003ch1\u003e1 â€” ì»¨ë³¼ë£¨ì…˜ ì‹ ê²½ë§ ì—­ì‚¬\u003c/h1\u003e\n\u003cp\u003eì»¨ë³¼ë£¨ì…˜ ì‹ ê²½ë§(CNN)ì˜ ê°œë…ì€ 1980ë…„ëŒ€ ê¸ˆì‚¬ì´ í›„ì½”ì‹œë§ˆì˜ ì—°êµ¬ë¡œ í˜•ì„±ë˜ê¸° ì‹œì‘í–ˆìŠµë‹ˆë‹¤. ê·¸ëŠ” Neocognitronì„ ê°œë°œí–ˆëŠ”ë°, ì´ëŠ” ë™ë¬¼ì˜ ì‹œê° ì‹œìŠ¤í…œ êµ¬ì¡°ì—ì„œ ì˜ê°ì„ ë°›ì•„ ìê°€ ì¡°ì§í™” ê³¼ì •ì„ í†µí•´ ì‹œê°ì  íŒ¨í„´ì„ ì¸ì‹í•  ìˆ˜ ìˆëŠ” í•™ìŠµì´ ê°€ëŠ¥í•œ ê³„ì¸µì  êµ¬ì¡°ë¥¼ ê°€ì¡ŒìŠµë‹ˆë‹¤. ì´ ì‘ì—…ì€ í˜„ëŒ€ CNNì˜ ê°œë°œì„ ìœ„í•œ ì¤‘ìš”í•œ ì„ í–‰ ì—°êµ¬ì˜€ìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eCNNì˜ í˜„ëŒ€ ì•„í‚¤í…ì²˜ëŠ” ì–€ ë¥´ì¿¤ê³¼ ê·¸ì˜ ë™ë£Œë“¤ì— ì˜í•´ 1980ë…„ëŒ€ í›„ë°˜ê³¼ 1990ë…„ëŒ€ ì´ˆì— ì œì•ˆë˜ì—ˆìŠµë‹ˆë‹¤. ê·¸ë“¤ì€ MNIST ë°ì´í„°ì…‹ì—ì„œ ì†ìœ¼ë¡œ ì“´ ìˆ«ìë¥¼ ì¸ì‹í•˜ê¸° ìœ„í•´ ì„¤ê³„ëœ ì»¨ë³¼ë£¨ì…˜ ì‹ ê²½ë§ì¸ LeNet-5ë¥¼ ê°œë°œí–ˆìŠµë‹ˆë‹¤. LeNet-5ëŠ” ì—¬ëŸ¬ ê°œì˜ ì»¨ë³¼ë£¨ì…˜ ë ˆì´ì–´ë¥¼ ê±°ì¹œ í›„ pooling ë ˆì´ì–´ì™€ ì™„ì „ ì—°ê²° ë ˆì´ì–´ë¡œ ì´ì–´ì§€ëŠ” êµ¬ì¡°ë¡œ, ì˜¤ëŠ˜ë‚  ì‚¬ìš©ë˜ëŠ” CNNì˜ ì•„í‚¤í…ì²˜ì˜ ê¸°ì´ˆë¥¼ êµ¬ì¶•í–ˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_2.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003eì´ˆê¸° ì„±ê³µì—ë„ ë¶ˆêµ¬í•˜ê³  CNNì˜ í™œìš©ì€ ê³„ì‚° ì œì•½ê³¼ ëŒ€ê·œëª¨ ë ˆì´ë¸” ë°ì´í„°ì…‹ì˜ ë¶€ì¡±ìœ¼ë¡œ ì œí•œë˜ì—ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì»´í“¨íŒ… íŒŒì›Œê°€ ì¦ê°€í•˜ê³  GPU(ê·¸ë˜í”½ ì²˜ë¦¬ ì¥ì¹˜)ë¥¼ ì‚¬ìš©í•´ ë”¥ ë„¤íŠ¸ì›Œí¬ë¥¼ í›ˆë ¨í•˜ëŠ” ê¸°ìˆ ì´ ì‹¤í˜„ ê°€ëŠ¥í•´ì§€ë©´ì„œ CNNì€ ë” ë§ì€ ê´€ì‹¬ì„ ëŒê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ê²Œë‹¤ê°€ ImageNetê³¼ ê°™ì€ ëŒ€ê·œëª¨ ë ˆì´ë¸” ì´ë¯¸ì§€ ë°ì´í„°ë² ì´ìŠ¤ì˜ ê°œë°œì€ ë”¥ ë„¤íŠ¸ì›Œí¬ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ í›ˆë ¨í•˜ê¸° ìœ„í•œ í•„ìˆ˜ ìë£Œë¥¼ ì œê³µí–ˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e2012ë…„ì— Alex Krizhevsky, Ilya Sutskever, Geoffrey Hintonì´ ê°œë°œí•œ AlexNetì´ ImageNet ëŒ€ê·œëª¨ ì‹œê° ì¸ì‹ ì±Œë¦°ì§€(ILSVRC)ì—ì„œ ê²½ìŸ ìƒëŒ€ë“¤ë³´ë‹¤ í° í­ìœ¼ë¡œ ìš°ìŠ¹í•˜ë©´ì„œ ì „í™˜ì ì´ ì°¾ì•„ì™”ìŠµë‹ˆë‹¤. AlexNetì€ ì—¬ëŸ¬ ì»¨ë³¼ë£¨ì…˜ ë ˆì´ì–´, ReLU í™œì„±í™” í•¨ìˆ˜, ê·¸ë¦¬ê³  dropoutê³¼ ê°™ì€ ì •ê·œí™” ê¸°ë²•ì„ í™œìš©í•˜ì—¬ ì‹œê° ì¸ì‹ ì‘ì—…ì— CNNì˜ ì„±ëŠ¥ì„ ì…ì¦í–ˆìŠµë‹ˆë‹¤. ì´í›„ë¡œ CNNì€ ë‹¤ì–‘í•œ ì‘ìš© ë¶„ì•¼ì— ëŒ€í•œ ì£¼ìš” ë„êµ¬ê°€ ë˜ì–´ ì§€ì†ì ì¸ í˜ì‹ ì„ ì´ëŒì–´ë‚´ëŠ” ë° ì´ë¥´ë €ìŠµë‹ˆë‹¤. VGGNet, GoogLeNet(Inception), ResNetê³¼ ê°™ì€ ëª¨ë¸ë“¤ì€ ë„¤íŠ¸ì›Œí¬ì˜ ê¹Šì´, íš¨ìœ¨ì„±, ì •í™•ë„ë¥¼ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•œ ìƒˆë¡œìš´ ì•„í‚¤í…ì²˜ì™€ ê¸°ë²•ë“¤ì„ ì†Œê°œí–ˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eì§€ê¸ˆì€ CNNì´ ë§ì€ ì¸ê³µì§€ëŠ¥ ì‹œìŠ¤í…œì˜ í•„ìˆ˜ êµ¬ì„± ìš”ì†Œì…ë‹ˆë‹¤. ì´ë¯¸ì§€ ì¸ì‹ ë¿ë§Œ ì•„ë‹ˆë¼ ë¹„ë””ì˜¤ ë¶„ì„, ìì—°ì–´ ì²˜ë¦¬, ì˜í•™ ì§„ë‹¨, ììœ¨ ì£¼í–‰ì°¨ ë“± ë‹¤ì–‘í•œ ë¶„ì•¼ì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤. ì—°êµ¬ëŠ” ê³„ì†í•´ì„œ ë°œì „í•˜ê³  ìˆìœ¼ë©°, íš¨ìœ¨ì ì¸ í•©ì„±ê³± ì‹ ê²½ë§, ê¹Šì€ ì‹ ê²½ë§(DNNs), ìƒì„±ì  ì ëŒ€ ì‹ ê²½ë§(GANs) ë“±ì˜ í˜ì‹ ì´ ì´ë£¨ì–´ì§€ê³  ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003ch1\u003e2â€” í•©ì„±ê³± ì‹ ê²½ë§ ì´ë¡ \u003c/h1\u003e\n\u003cp\u003eìˆ˜í•™ì—ì„œ \"í•©ì„±ê³±\"ì€ í•œ í•¨ìˆ˜ê°€ ë‹¤ë¥¸ í•¨ìˆ˜ì— ì˜í•´ ë³€í™˜ë˜ëŠ” í†µí•© ì—°ì‚°ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì‹ ê²½ë§ì˜ ë§¥ë½ì—ì„œëŠ” ì´ ê°œë…ì´ ì „í†µì ì¸ í†µê³„ì  í•´ì„ê³¼ ë‹¤ë¦…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eê¸°ë³¸ì ìœ¼ë¡œ ìš°ë¦¬ëŠ” ì…ë ¥ í•¨ìˆ˜ë¡œ ì‹œì‘í•©ë‹ˆë‹¤. ìš°ë¦¬ì˜ ê²½ìš°ì—ëŠ” ì£¼ë¡œ ì´ë¯¸ì§€ì…ë‹ˆë‹¤. ë˜í•œ, í•„í„°(ì»¤ë„ì´ë¼ê³ ë„ í•¨)ë¥¼ ì†Œê°œí•©ë‹ˆë‹¤. ì´ë¯¸ì§€ëŠ” ì ê³± ì—°ì‚°ì„ í†µí•´ ë³€í™˜ë˜ëŠ” í•¨ìˆ˜ë¡œ, ì¼ë°˜ì ìœ¼ë¡œ \"í•©ì„±ê³±(convolution)\"ì´ë¼ê³  í•©ë‹ˆë‹¤. ê·¸ ë‹¤ìŒ, ì´ëŸ¬í•œ í•„í„°ë¥¼ ì…ë ¥ ì´ë¯¸ì§€ì— ì ìš©í•˜ë©´ \"íŠ¹ì„± ë§µ(feature maps)\"ì´ë¼ê³  í•˜ëŠ” ì¶œë ¥ ì´ë¯¸ì§€ë¥¼ ì–»ê²Œ ë©ë‹ˆë‹¤.\u003c/p\u003e\n\u003ch2\u003e2.1 â€” í•©ì„±ê³± ê³„ì¸µ\u003c/h2\u003e\n\u003cp\u003eí•©ì„±ê³± ê³„ì¸µì€ íŒ¨í„´ì„ ê°ì§€í•˜ê³  í•„í„°(ì»¤ë„)ë¥¼ í†µí•´ íŠ¹ì„± ë§µì„ ìƒì„±í•˜ê¸° ìœ„í•´ ì´ë¯¸ì§€ê°€ ì²˜ë¦¬ë˜ëŠ” ê³³ì…ë‹ˆë‹¤. ì´ëŸ¬í•œ íŠ¹ì„± ë§µì€ í•„í„°ê°€ ì‹ë³„í•˜ë ¤ëŠ” ê° ì†ì„±ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. í•„í„°ëŠ” ì¼ë°˜ì ìœ¼ë¡œ (3x3) ë˜ëŠ” (5x5) í–‰ë ¬ë¡œ êµ¬ì„±ë˜ì–´ ìˆìœ¼ë©°, ê° í•„í„°ëŠ” ì…ë ¥ ì´ë¯¸ì§€ì—ì„œ ë™ì¼í•œ í¬ê¸°ì˜ í•„ë“œë¥¼ ì°¨ì§€í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ, í•„í„°ê°€ í•œ ì¹¸ì”© ê°€ë¡œë¡œ ì´ë™í•˜ê³  ê°™ì€ í”„ë¡œì„¸ìŠ¤ê°€ ë°˜ë³µë©ë‹ˆë‹¤. ê°€ë¡œ ëì— ë„ë‹¬í•˜ë©´ í•„í„°ê°€ í•œ ì¹¸ ì•„ë˜ë¡œ ì´ë™í•˜ê³  ì ê³± í”„ë¡œì„¸ìŠ¤ê°€ ë‹¤ì‹œ ìˆ˜í‰ìœ¼ë¡œ ì ìš©ë©ë‹ˆë‹¤. ê·¸ ê²°ê³¼ëŠ” ìˆœì„œëŒ€ë¡œ ì¶œë ¥ì— ì¶”ê°€ë˜ì–´ íŠ¹ì„± ë§µì„ ìƒì„±í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://miro.medium.com/v2/resize:fit:1400/0*4UZXfXs7eQ3TT02M.gif\" alt=\"ì´ë¯¸ì§€\"\u003e\u003c/p\u003e\n\u003cp\u003eì…ë ¥ ì´ë¯¸ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” í…ì„œ Iì˜ ì°¨ì›ì´ m1 x m2 x mcì¸ ê²½ìš°ë¥¼ ê°€ì •í•´ ë´…ì‹œë‹¤. ì´ í…ì„œì—ì„œ,\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_4.png\" alt=\"image1\"\u003e\u003c/p\u003e\n\u003cp\u003eìš°ë¦¬ëŠ” ì…ë ¥ ì´ë¯¸ì§€ì™€ ì¼ì¹˜í•˜ëŠ” ì±„ë„ ìˆ˜ë¥¼ ê°€ì§„ (n1 x n2 x nc) ì°¨ì›ì„ ê°€ì§€ëŠ” í•„í„°ë¥¼ ì ìš©í•©ë‹ˆë‹¤. ì´ í•„í„°ëŠ” ì´ë¯¸ì§€ë¥¼ ì™¼ìª½ì—ì„œ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì›€ì§ì´ë©´ì„œ, ì…ë ¥ í…ì„œ Iì˜ í•´ë‹¹ ì˜ì—­ê³¼ ìš”ì†Œë³„ ê³±ì…ˆì„ ìˆ˜í–‰í•˜ê³  ì´ëŸ¬í•œ ê³±ì…ˆ ê²°ê³¼ë¥¼ í•©ì‚°í•©ë‹ˆë‹¤. ìŠ¤íŠ¸ë¼ì´ë“œ ë§¤ê°œë³€ìˆ˜ëŠ” í•„í„°ê°€ ì´ë¯¸ì§€ë¥¼ íš¡ë‹¨í•˜ëŠ” ë‹¨ê³„ í¬ê¸°ë¥¼ ê²°ì •í•©ë‹ˆë‹¤. Iì™€ K ì‚¬ì´ì˜ ì´ ì‘ì—…ì˜ ê²°ê³¼ëŠ” ë‹¤ë¥¸ ì°¨ì› (m1 - n1 + 1) x (m2 - n2 + 1) x 1ì„ ê°€ì§„ ë˜ ë‹¤ë¥¸ í…ì„œë¥¼ ìƒì„±í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_5.png\" alt=\"image2\"\u003e\u003c/p\u003e\n\u003cp\u003eì•ˆë…•í•˜ì„¸ìš”,\u003c/p\u003e\n\u003cp\u003eíŠ¹ì§• ë§µì˜ (i, j)ë²ˆì§¸ í•­ëª©ì€ ë‹¤ìŒê³¼ ê°™ì´ ê³„ì‚°ë©ë‹ˆë‹¤:\u003c/p\u003e\n\u003cp\u003eë‹¤ìŒ ì˜ˆë¥¼ ì„ íƒí–ˆìŠµë‹ˆë‹¤. 5x5x1 ì°¨ì› ì´ë¯¸ì§€ê°€ 3x3x1 ì»¤ë„ë¡œ í•©ì„±ë˜ê³  s=1 ìŠ¤íŠ¸ë¼ì´ë“œê°€ ì ìš©ë©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_8.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003eíŠ¹ì§• ë§µì˜ (i, j)-ë²ˆì§¸ í•­ëª©ì€ ë‹¨ì¼ ì±„ë„ì— ëŒ€í•œ ë‹¤ìŒ ì¼ë°˜ ê³µì‹ìœ¼ë¡œ ì£¼ì–´ì§‘ë‹ˆë‹¤:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_9.png\" alt=\"formula\"\u003e\u003c/p\u003e\n\u003cp\u003eìœ„ ì˜ˆì—ì„œ feature mapì˜ (1, 1)ë²ˆ ì§¸ í•­ëª©ì„ ê³„ì‚°í•´ ë´…ì‹œë‹¤:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_10.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_11.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003eì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” í•­ëª©ì€ 0ìœ¼ë¡œ ëŒ€ì²´ë˜ì—ˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_12.png\" alt=\"Image\"\u003e\u003c/p\u003e\n\u003cp\u003eë§ˆì°¬ê°€ì§€ë¡œ, ë‚¨ì€ í•­ëª©ë“¤ì€ ë™ì¼í•œ ê³µì‹ì„ ì‚¬ìš©í•˜ì—¬ ê³„ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ê³¼ì •ì€ ì„œë¡œ ë‹¤ë¥¸ ìœ í˜•ì˜ í•„í„°ë¥¼ ì ìš©í•¨ìœ¼ë¡œì¨ ë°˜ë³µë˜ë©°, ê°ê°ì´ ì´ë¯¸ì§€ì˜ ë‹¤ë¥¸ íŠ¹ì§•ì„ ìº¡ì²˜í•˜ëŠ” ê²ƒì„ ë³´ì—¬ì¤ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, í•„í„° ê°œìˆ˜ê°€ í•˜ë‚˜ ì´ìƒì´ ë  ìˆ˜ ìˆì–´ì„œ ìŠ¤íŠ¸ë¼ì´ë“œ ê°œë…ì´ ë„ì…ë©ë‹ˆë‹¤.\u003c/p\u003e\n\u003ch2\u003e2.2â€” íŒ¨ë”© ë ˆì´ì–´\u003c/h2\u003e\n\u003cp\u003eê¸°ë³¸ CNNì€ (n x n) í¬ê¸°ì˜ í‘ë°± ì´ë¯¸ì§€ì™€ (f x f) í¬ê¸°ì˜ í•„í„°/ì»¤ë„ì„ ì‚¬ìš©í•˜ì—¬ ê²°ê³¼ë¥¼ ì œê³µí•˜ë©°, ì¶œë ¥ í¬ê¸°ëŠ” (n - f + 1) x (n - f + 1)ì´ ë©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, (8 x 8) ì´ë¯¸ì§€ì™€ (3 x 3) í•„í„°ë¥¼ ì‚¬ìš©í•œ ì–´ë–¤ í•©ì„± ê³± ì‘ì—…ì˜ ê²½ìš°, ì¶œë ¥ ì´ë¯¸ì§€ í¬ê¸°ëŠ” (6 x 6)ì´ ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ í¬ê¸°ì˜ ê°ì†ŒëŠ” ì´ë¯¸ì§€ ì²˜ë¦¬ ì¤‘ ì¼ê´€ì ìœ¼ë¡œ ë°œìƒí•˜ë©°, ë ˆì´ì–´ì˜ ì¶œë ¥ì´ ì¼ë°˜ì ìœ¼ë¡œ ì…ë ¥ë³´ë‹¤ ì‘ìŠµë‹ˆë‹¤. ë˜í•œ, í•©ì„± ê³± ì‘ì—…ì—ì„œ ì‚¬ìš©ë˜ëŠ” í•„í„°ëŠ” í”½ì…€ì„ íš¡ë‹¨í•˜ë©´ì„œ í•­ìƒ ëª¨ì„œë¦¬ì— ì´ˆì ì„ ë‘ì§€ ì•ŠìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_13.png\" alt=\"TinyML CNN\"\u003e\u003c/p\u003e\n\u003cp\u003eë¨¸ì‹  ëŸ¬ë‹ì—ì„œ ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ì—¬ëŸ¬ ìœ í˜•ì˜ íŒ¨ë”©ì´ ìˆìŠµë‹ˆë‹¤:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eSame íŒ¨ë”©: Same íŒ¨ë”©ì€ ì›ë³¸ ì´ë¯¸ì§€ì˜ ì™¸ë¶€ í”„ë ˆì„ì— ì¼ë°˜ì ìœ¼ë¡œ 0ê³¼ ê°™ì€ ì¶”ê°€ ìš”ì†Œë¥¼ ì¶”ê°€í•˜ëŠ” ê²ƒì„ í¬í•¨í•©ë‹ˆë‹¤. ì´ ë°©ì‹ìœ¼ë¡œ ì…ë ¥ì„ í™•ì¥í•¨ìœ¼ë¡œì¨, í•„í„°ê°€ ë” ë„“ì€ ì˜ì—­ì„ ìŠ¤ìº”í•  ìˆ˜ ìˆê²Œ ë˜ì–´ ì¶œë ¥ ì´ë¯¸ì§€ê°€ ì›ë³¸ê³¼ ë™ì¼í•œ í¬ê¸°ë¥¼ ìœ ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ê²ƒì€ ì»¨ë³¼ë£¨ì…˜ ì‘ì—… ì¤‘ ê³µê°„ì  ì°¨ì›ì„ ìœ ì§€í•˜ëŠ” ë° ìœ ìš©í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eValid íŒ¨ë”©: Same íŒ¨ë”©ê³¼ëŠ” ë‹¬ë¦¬, Valid íŒ¨ë”©ì€ ì´ë¯¸ì§€ì— ì¶”ê°€ ìš”ì†Œë¥¼ ì¶”ê°€í•˜ëŠ” ê²ƒì„ í¬í•¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í•„í„°ëŠ” ì¶”ê°€ ìš”ì†Œ ì—†ì´ ì›ë³¸ ì´ë¯¸ì§€ë¥¼ í›‘ì–´ê°‘ë‹ˆë‹¤. ì´ê²ƒì€ ê°„ê²©ìœ¼ë¡œ ì¸í•œ ì¼ë¶€ ë°ì´í„° ì†ì‹¤ì´ ë°œìƒí•  ìˆ˜ ìˆì§€ë§Œ, valid íŒ¨ë”©ì€ ì¶œë ¥ í”¼ì³ ë§µì˜ í¬ê¸°ë¥¼ ì¤„ì´ê³ ì í•  ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì¶•ì†ŒëŠ” ëª¨ë¸ì˜ ë§¤ê°œë³€ìˆ˜ ìˆ˜ë¥¼ ì¤„ì´ê³  ê³„ì‚° íš¨ìœ¨ì„±ì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eCausal íŒ¨ë”©: Causal íŒ¨ë”©ì€ ì£¼ë¡œ ì‹œí€€ìŠ¤-íˆ¬-ì‹œí€€ìŠ¤ ëª¨ë¸ ë° ì‹œê³„ì—´ ì˜ˆì¸¡ì— ì‚¬ìš©ë˜ë©°, íŠ¹íˆ 1ì°¨ì› ì»¨ë³¼ë£¨ì…˜ ë ˆì´ì–´ì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ ìœ í˜•ì˜ íŒ¨ë”©ì€ ë°ì´í„° ì‹œí€€ìŠ¤ì˜ ì‹œì‘ ë¶€ë¶„ì— ìš”ì†Œë¥¼ ì¶”ê°€í•˜ì—¬ ì•Œê³ ë¦¬ì¦˜ì´ ì´ˆê¸° ì‹œê°„ ë‹¨ê³„ì— ëŒ€í•œ ê°’ì„ ì˜ˆì¸¡í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤. ê³¼ê±° ë° í˜„ì¬ ë°ì´í„°ë¥¼ ì˜ˆì¸¡ì— í¬í•¨ì‹œí‚´ìœ¼ë¡œì¨, causal íŒ¨ë”©ì€ ëª¨ë¸ì´ ì¶”ë¡  ì¤‘ì— ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ë¯¸ë˜ ë°ì´í„°ë¥¼ í™œìš©í•˜ì§€ ì•Šë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eFull íŒ¨ë”©: ì´ ìœ í˜•ì˜ íŒ¨ë”©ì€ ì…ë ¥ì˜ í…Œë‘ë¦¬ ì£¼ìœ„ì— ì—¬ëŸ¬ ë ˆì´ì–´ì˜ 0ì„ ì¶”ê°€í•˜ì—¬ ì›ë³¸ ì´ë¯¸ì§€ í¬ê¸°ë³´ë‹¤ í° ì¶œë ¥ í”¼ì³ ë§µì„ ìƒì„±í•©ë‹ˆë‹¤. Full íŒ¨ë”©ì€ ëœ ì¼ë°˜ì ì´ì§€ë§Œ ë” í° ì¶œë ¥ í¬ê¸°ê°€ í•„ìš”í•œ íŠ¹ì • ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e2.3 â€”Pooling Layer\u003c/h2\u003e\n\u003cp\u003eí’€ë§ ë ˆì´ì–´ì—ì„œëŠ” ì»¨ë³¼ë£¨ì…˜ëœ íŠ¹ì§•ì˜ ê³µê°„ ì°¨ì›ì´ ì¼ë°˜ì ìœ¼ë¡œ ì¶•ì†Œë˜ì–´ ì…ë ¥ ì´ë¯¸ì§€ì—ì„œ ì£¼ìš”í•œ íŠ¹ì§•ì„ ì¶”ì¶œí•˜ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤. ì´ í¬ê¸°ì˜ ì¶•ì†ŒëŠ” ì»¨ë³¼ë£¨ì…˜ ë ˆì´ì–´ì—ì„œ ì–»ì€ ì¶œë ¥ì— í’€ë§ í•¨ìˆ˜ë¥¼ ì ìš©í•˜ì—¬ ë‹¬ì„±ë©ë‹ˆë‹¤. ì´ë ‡ê²Œ ê°€ì •í•´ ë´…ì‹œë‹¤:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_14.png\" alt=\"ê·¸ë¦¼ 1\"\u003e\u003c/p\u003e\n\u003cp\u003eí’€ë§ëœ ë¶€ë¶„ì˜ ì°¨ì›ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_15.png\" alt=\"ê·¸ë¦¼ 2\"\u003e\u003c/p\u003e\n\u003cp\u003eë”¥ëŸ¬ë‹ì—ì„œëŠ” 3ê°€ì§€ ì¢…ë¥˜ì˜ í’€ë§ì´ ìˆì–´ìš”:\u003c/p\u003e\n\u003cp\u003eí‰ê·  í’€ë§: ì»¤ë²„ëœ ì˜ì—­ ë‚´ í”½ì…€ ê°’ì˜ í‰ê· ì´ ì¶œë ¥ ë§¤íŠ¸ë¦­ìŠ¤ë¡œ ì „ë‹¬ë©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eìµœëŒ€ í’€ë§: ì»¤ë²„ëœ ì˜ì—­ ë‚´ í”½ì…€ ê°’ ì¤‘ ê°€ì¥ ë†’ì€ ê°’ì´ ì¶œë ¥ ë§¤íŠ¸ë¦­ìŠ¤ë¡œ ì „ë‹¬ë©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_16.png\" alt=\"ì´ë¯¸ì§€\"\u003e\u003c/p\u003e\n\u003cp\u003eì „ì—­ ìµœëŒ€ í’€ë§(Global Max Pooling) : ëª¨ë“  ì…ë ¥ í¬ê¸°ì˜ í”½ì…€ ê°’ ì¤‘ ê°€ì¥ ë†’ì€ ê°’ì´ ì¶œë ¥ í–‰ë ¬ë¡œ ì „ë‹¬ë©ë‹ˆë‹¤. ì´ ìœ í˜•ì˜ í’€ë§ì—ì„œ í’€ í¬ê¸°ëŠ” ì…ë ¥ í¬ê¸°ì™€ ë™ì¼í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_17.png\" alt=\"ì´ë¯¸ì§€\"\u003e\u003c/p\u003e\n\u003cp\u003esum pooling, average pooling, max poolingê³¼ ê°™ì€ ë‹¤ì–‘í•œ ìœ í˜•ì˜ í’€ë§ì´ ìˆìŠµë‹ˆë‹¤. ìµœëŒ€ í’€ë§ì˜ ì˜ˆëŠ” ì•„ë˜ì— ì œê³µë©ë‹ˆë‹¤. ìµœëŒ€ í’€ë§ì€ 2x2 íŒ¨ì¹˜ì— ìˆ˜í–‰ë©ë‹ˆë‹¤. ê° íŒ¨ì¹˜ì—ì„œ ìµœëŒ“ê°’ì´ ì„ íƒë©ë‹ˆë‹¤.\u003c/p\u003e\n\u003ch2\u003e2.4 â€” í”Œë˜íŠ¼ ë ˆì´ì–´\u003c/h2\u003e\n\u003cp\u003eí”Œë˜íŠ¼ ë ˆì´ì–´ëŠ” ì‹ ê²½ë§ ì•„í‚¤í…ì²˜ì—ì„œ ì¤‘ìš”í•œ êµ¬ì„± ìš”ì†Œì´ë©°, íŠ¹íˆ í•©ì„±ê³± ë ˆì´ì–´ì—ì„œ ì™„ì „íˆ ì—°ê²°ëœ ë ˆì´ì–´ë¡œì˜ ì „í™˜ ì‹œì— ì¤‘ìš”í•©ë‹ˆë‹¤. ì´ ë ˆì´ì–´ëŠ” í•©ì„±ê³± ë° í’€ë§ ë ˆì´ì–´ì—ì„œ ìƒì„±ëœ ë‹¤ì°¨ì› í”¼ì³ ë§µì„ ì¼ì°¨ì› ë²¡í„°ë¡œ ë³€í™˜í•˜ì—¬, ë¶„ë¥˜ ë˜ëŠ” íšŒê·€ ì‘ì—…ì„ ìœ„í•´ í›„ì† ì™„ì „íˆ ì—°ê²°ëœ ë ˆì´ì–´ë¡œ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_18.png\" alt=\"ì´ë¯¸ì§€ ì„¤ëª…\"\u003e\u003c/p\u003e\n\u003cp\u003eë‹¤ìŒì€ í”Œë˜íŠ¼ ë ˆì´ì–´ì˜ ì‘ë™ ë°©ì‹ì…ë‹ˆë‹¤:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eì…ë ¥: í”Œë˜íŠ¼ ë ˆì´ì–´ì˜ ì…ë ¥ì€ ì¼ë°˜ì ìœ¼ë¡œ ì´ì „ í•©ì„±ê³± ë˜ëŠ” í’€ë§ ë ˆì´ì–´ì—ì„œ ìƒì„±ëœ í”¼ì³ ë§µì„ ë‚˜íƒ€ë‚´ëŠ” ë‹¤ì°¨ì› í…ì„œì…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë§ˆì§€ë§‰ í•©ì„±ê³± ë˜ëŠ” í’€ë§ ë ˆì´ì–´ê°€ ë†’ì´, ë„ˆë¹„, ê¹Šì´ì˜ í”¼ì³ ë§µì„ ìƒì„±í•œë‹¤ë©´ ì…ë ¥ í…ì„œëŠ” (ë°°ì¹˜ í¬ê¸°, ë†’ì´, ë„ˆë¹„, ê¹Šì´) í˜•íƒœë¥¼ ê°€ì§ˆ ê²ƒì…ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eí”Œë˜íŒ…: í”Œë˜íŒ… ë ˆì´ì–´ëŠ” ë‹¨ìˆœíˆ í”¼ì³ ë§µì˜ ëª¨ë“  ìš”ì†Œë¥¼ í•˜ë‚˜ì˜ ì°¨ì›ì„ ë”°ë¼ ì—°ê²°í•˜ì—¬ ì…ë ¥ í…ì„œë¥¼ ì¼ì°¨ì› ë²¡í„°ë¡œ ë‹¤ì‹œ í˜•íƒœí™”í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, í”¼ì³ ë§µì´ ë†’ì´, ë„ˆë¹„, ê¹Šì´ì˜ ì°¨ì›ì„ ê°€ì§„ë‹¤ë©´ í”Œë˜íŒ… ë ˆì´ì–´ëŠ” ì´ë¥¼ ë†’ì´ * ë„ˆë¹„ * ê¹Šì´ì˜ ê¸¸ì´ë¥¼ ê°€ì§„ ë²¡í„°ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.\u003c/li\u003e\n\u003cli\u003eì¶œë ¥: í”Œë˜íŒ… ë ˆì´ì–´ì˜ ì¶œë ¥ì€ í”¼ì³ ë§µì„ í”Œë˜íŒ…í•œ ì¼ì°¨ì› ë²¡í„°ì…ë‹ˆë‹¤. ì´ ë²¡í„°ëŠ” ì´í›„ì˜ ì™„ì „íˆ ì—°ê²°ëœ ë ˆì´ì–´ì˜ ì…ë ¥ìœ¼ë¡œ ì „ë‹¬ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eí‰íƒ„í™” ë ˆì´ì–´ì˜ ëª©ì ì€ íŠ¹ì„± ë§µì—ì„œ ìº¡ì²˜ëœ ê³µê°„ ì •ë³´ë¥¼ ì™„ì „ ì—°ê²° ë ˆì´ì–´ì—ì„œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì™„ì „ ì—°ê²° ë ˆì´ì–´ëŠ” ì¼ì°¨ì› ì…ë ¥ ë²¡í„°ë¥¼ í•„ìš”ë¡œí•˜ë¯€ë¡œ íŠ¹ì„± ë§µì„ í‰íƒ„í™”í•¨ìœ¼ë¡œì¨ ì‹ ê²½ë§ì´ ë°ì´í„°ì˜ ë‹¤ì–‘í•œ ê³µê°„ ìœ„ì¹˜ì— ê±¸ì³ ë³µì¡í•œ íŒ¨í„´ê³¼ ê´€ê³„ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ í•™ìŠµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ë” ì •í™•í•œ ì˜ˆì¸¡ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eì´ì „ì˜ í•©ì„±ê³± ë˜ëŠ” í’€ë§ ë ˆì´ì–´ì— ì˜í•´ ìƒì„±ëœ íŠ¹ì„± ë§µ ğ¹ ì§‘í•©ì´ ìˆë‹¤ê³  ê°€ì •í•´ë´…ì‹œë‹¤. ì´ëŸ¬í•œ íŠ¹ì„± ë§µì˜ ì°¨ì›ì„ ë‹¤ìŒê³¼ ê°™ì´ í‘œê¸°í•´ ë´…ì‹œë‹¤:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eğ»: íŠ¹ì„± ë§µì˜ ë†’ì´\u003c/li\u003e\n\u003cli\u003eğ‘Š: íŠ¹ì„± ë§µì˜ ë„ˆë¹„\u003c/li\u003e\n\u003cli\u003eğ·: íŠ¹ì„± ë§µì˜ ê¹Šì´ (ì±„ë„ ìˆ˜)\u003c/li\u003e\n\u003cli\u003eğµ: ë°°ì¹˜ í¬ê¸° (ë°°ì¹˜ì— í¬í•¨ëœ ìƒ˜í”Œ ìˆ˜)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eê·¸ëŸ¬ë©´ íŠ¹ì„± ë§µ ğ¹ì˜ í˜•íƒœëŠ” (B,H,W,D)ê°€ ë©ë‹ˆë‹¤. ì—¬ê¸°ì„œ ğµì€ ë°°ì¹˜ í¬ê¸°ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eì´ëŸ¬í•œ í”¼ì²˜ ë§µì„ ì¼ì°¨ì› ë²¡í„°ë¡œ í‰íƒ„í™”í•˜ê¸° ìœ„í•´, ë‹¨ìˆœíˆ ì´ë¥¼ ê¸¸ì´ ğ»Ã—ğ‘ŠÃ—ğ·ì˜ ë²¡í„°ë¡œ ì¬êµ¬ì„±í•©ë‹ˆë‹¤. ìˆ˜í•™ì ìœ¼ë¡œ í‘œí˜„í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:\u003c/p\u003e\n\u003cp\u003eFlatten(ğ¹)=reshape(ğ¹, (ğµ, ğ»Ã—ğ‘ŠÃ—ğ·))\u003c/p\u003e\n\u003cp\u003eì´ ê²½ìš°, ì¬êµ¬ì„± ì—°ì‚°ì€ (ğµ, ğ», ğ‘Š, ğ·) í…ì„œë¥¼ (ğµ, ğ»Ã—ğ‘ŠÃ—ğ·) í…ì„œë¡œ ì¬êµ¬ì„±í•˜ì—¬ ê³µê°„ ì°¨ì›ì„ í•˜ë‚˜ì˜ ì°¨ì›ìœ¼ë¡œ í¼ì¹˜ê²Œ ë©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eì˜ˆë¥¼ ë“¤ì–´, ë§Œì•½ ğ¹ê°€ ì°¨ì›ì´ (4,5,5,3)ì¸ ê²½ìš° (ë°°ì¹˜ í¬ê¸°ê°€ 4, ë†’ì´ê°€ 5, ë„ˆë¹„ê°€ 5, ê¹Šì´ê°€ 3ì¸ í”¼ì²˜ ë§µ), ê·¸ëŸ¬ë©´ í‰íƒ„í™”ëœ ì¶œë ¥ì€ (4,75) ì°¨ì›ì„ ê°–ê²Œ ë˜ë©°, ê° í–‰ì€ ë°°ì¹˜ì˜ í•œ ìƒ˜í”Œì— ëŒ€í•œ í‰íƒ„í™”ëœ í”¼ì²˜ ë§µì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eì´ í‰íƒ„í™”ëœ ë²¡í„°ëŠ” ì‹ ê²½ë§ì˜ í›„ì† ì™„ì „ ì—°ê²° ë ˆì´ì–´ì— ì…ë ¥ìœ¼ë¡œ ì „ë‹¬ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003ch1\u003e3 â€” TinyML êµ¬í˜„\u003c/h1\u003e\n\u003cp\u003eì´ ì˜ˆì œë¥¼ í†µí•´ ESP32, ì•„ë‘ì´ë…¸, ë¼ì¦ˆë² ë¦¬ íŒŒì´ ë° ê¸°íƒ€ ë‹¤ì–‘í•œ ë§ˆì´í¬ë¡œì»¨íŠ¸ë¡¤ëŸ¬ ë˜ëŠ” IoT ì¥ì¹˜ì—ì„œ ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e3.0 â€” requirements.txt íŒŒì¼ì— ë‚˜ì—´ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e!pip install -r requirements.txt\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e3.1 â€” ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°€ì ¸ì˜¤ê¸°\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e numpy \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e np\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e sklearn.datasets \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e load_digits\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e tensorflow \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e tf\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e tensorflow.keras \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e layers\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e sklearn.metrics \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e accuracy_score\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e sklearn.metrics \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e confusion_matrix\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e matplotlib \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e pyplot \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e plt\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e time\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e seaborn \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e sns\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e os\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e3.2 â€” ë°ì´í„°ì…‹ ë¶ˆëŸ¬ì˜¤ê¸°\u003c/p\u003e\n\u003cp\u003eMNISTì€ Modified National Institute of Standards and Technology databaseì˜ ì¤„ì„ë§ë¡œ, ê¸°ê³µ í•™ìŠµ ë° ì»´í“¨í„° ë¹„ì „ ë¶„ì•¼ì—ì„œ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” ë°ì´í„°ì…‹ì…ë‹ˆë‹¤. ì´ ë°ì´í„°ì…‹ì€ 0ì—ì„œ 9ê¹Œì§€ì˜ ì†ìœ¼ë¡œ ì“´ ìˆ«ìë“¤ì˜ ëª¨ìŒìœ¼ë¡œ, ê° ìˆ«ìëŠ” 28x28 í”½ì…€ í¬ê¸°ì˜ íšŒìƒ‰ ìŒì˜ ì´ë¯¸ì§€ë¡œ í‘œí˜„ë©ë‹ˆë‹¤. ì´ ë°ì´í„°ì…‹ì—ëŠ” ì´ 70,000ê°œì˜ ì´ë¯¸ì§€ê°€ í¬í•¨ë˜ì–´ ìˆìœ¼ë©°, ì´ ì¤‘ 60,000ê°œì˜ ì´ë¯¸ì§€ëŠ” í›ˆë ¨ì— ì‚¬ìš©ë˜ê³  10,000ê°œì˜ ì´ë¯¸ì§€ëŠ” í…ŒìŠ¤íŠ¸ì— ì‚¬ìš©ë©ë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003eë§í¬: \u003ca href=\"https://www.nist.gov/itl/products-and-services/emnist-dataset\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://www.nist.gov/itl/products-and-services/emnist-dataset\u003c/a\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eget_data\u003c/span\u003e():\n    np.random.seed(\u003cspan class=\"hljs-number\"\u003e1337\u003c/span\u003e)\n    x_values, y_values = load_digits(return_X_y=\u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e)\n    x_values /= x_values.\u003cspan class=\"hljs-built_in\"\u003emax\u003c/span\u003e()\n    \u003cspan class=\"hljs-comment\"\u003e# reshape to (8 x 8 x 1)\u003c/span\u003e\n    x_values = x_values.reshape((\u003cspan class=\"hljs-built_in\"\u003elen\u003c/span\u003e(x_values), \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n    \u003cspan class=\"hljs-comment\"\u003e# split into train, validation, test\u003c/span\u003e\n    TRAIN_SPLIT = \u003cspan class=\"hljs-built_in\"\u003eint\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0.6\u003c/span\u003e * \u003cspan class=\"hljs-built_in\"\u003elen\u003c/span\u003e(x_values))\n    TEST_SPLIT = \u003cspan class=\"hljs-built_in\"\u003eint\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0.2\u003c/span\u003e * \u003cspan class=\"hljs-built_in\"\u003elen\u003c/span\u003e(x_values) + TRAIN_SPLIT)\n    x_train, x_test, x_validate = np.split(x_values, [TRAIN_SPLIT, TEST_SPLIT])\n    y_train, y_test, y_validate = np.split(y_values, [TRAIN_SPLIT, TEST_SPLIT])\n\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e x_train, x_test, x_validate, y_train, y_test, y_validate\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e3.3 â€” ë°ì´í„° ë¶„í• \u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eX_train, X_test, X_validate, y_train, y_test, y_validate = \u003cspan class=\"hljs-title function_\"\u003eget_data\u003c/span\u003e()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e3.4 â€” íƒìƒ‰ì  ë°ì´í„° ë¶„ì„\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eX_train__ = X_train.\u003cspan class=\"hljs-title function_\"\u003ereshape\u003c/span\u003e(X_train.\u003cspan class=\"hljs-property\"\u003eshape\u003c/span\u003e[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e], \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e)\n\nfig, axis = plt.\u003cspan class=\"hljs-title function_\"\u003esubplots\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e, figsize=(\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e))\n\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e i, ax \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eenumerate\u003c/span\u003e(axis.\u003cspan class=\"hljs-property\"\u003eflat\u003c/span\u003e):\n    ax.\u003cspan class=\"hljs-title function_\"\u003eimshow\u003c/span\u003e(X_train__[i], cmap=\u003cspan class=\"hljs-string\"\u003e'binary'\u003c/span\u003e)\n    digit = y_train[i]\n    ax.\u003cspan class=\"hljs-title function_\"\u003eset\u003c/span\u003e(title = f\u003cspan class=\"hljs-string\"\u003e\"ì‹¤ì œ ìˆ«ìëŠ” {digit}ì…ë‹ˆë‹¤.\"\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_19.png\" alt=\"ì´ë¯¸ì§€\"\u003e\u003c/p\u003e\n\u003cp\u003e3.5â€” ëª¨ë¸ ì •ì˜í•˜ê¸°\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003emodel = tf.\u003cspan class=\"hljs-property\"\u003ekeras\u003c/span\u003e.\u003cspan class=\"hljs-title class_\"\u003eSequential\u003c/span\u003e()\nmodel.\u003cspan class=\"hljs-title function_\"\u003eadd\u003c/span\u003e(layers.\u003cspan class=\"hljs-title class_\"\u003eConv2D\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e, (\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e), activation=\u003cspan class=\"hljs-string\"\u003e'relu'\u003c/span\u003e, input_shape=(\u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)))\nmodel.\u003cspan class=\"hljs-title function_\"\u003eadd\u003c/span\u003e(layers.\u003cspan class=\"hljs-title class_\"\u003eMaxPooling2D\u003c/span\u003e((\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)))\nmodel.\u003cspan class=\"hljs-title function_\"\u003eadd\u003c/span\u003e(layers.\u003cspan class=\"hljs-title class_\"\u003eFlatten\u003c/span\u003e())\nmodel.\u003cspan class=\"hljs-title function_\"\u003eadd\u003c/span\u003e(layers.\u003cspan class=\"hljs-title class_\"\u003eDense\u003c/span\u003e(\u003cspan class=\"hljs-title function_\"\u003elen\u003c/span\u003e(np.\u003cspan class=\"hljs-title function_\"\u003eunique\u003c/span\u003e(y_train))))\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003emodel.\u003cspan class=\"hljs-title function_\"\u003esummary\u003c/span\u003e()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_20.png\" alt=\"ì´ë¯¸ì§€\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-title function_\"\u003eplot_model\u003c/span\u003e(model, to_file=\u003cspan class=\"hljs-string\"\u003e'./figures/model.png'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_21.png\" alt=\"Plot\"\u003e\u003c/p\u003e\n\u003cp\u003e3.6â€”ëª¨ë¸ ì»´íŒŒì¼í•˜ê¸°\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003emodel.\u003cspan class=\"hljs-title function_\"\u003ecompile\u003c/span\u003e(optimizer=\u003cspan class=\"hljs-string\"\u003e'adam'\u003c/span\u003e, loss=tf.\u003cspan class=\"hljs-property\"\u003ekeras\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003elosses\u003c/span\u003e.\u003cspan class=\"hljs-title class_\"\u003eSparseCategoricalCrossentropy\u003c/span\u003e(from_logits=\u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e), metrics=[\u003cspan class=\"hljs-string\"\u003e'accuracy'\u003c/span\u003e])\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e3.7 â€” ëª¨ë¸ í›ˆë ¨\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003ehistory = model.\u003cspan class=\"hljs-title function_\"\u003efit\u003c/span\u003e(X_train, y_train,\n                    epochs=\u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e,\n                    batch_size=\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e,\n                    validation_data=(X_validate, y_validate))\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003emodel.\u003cspan class=\"hljs-title function_\"\u003esave\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'.\\models\\model.keras'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eloss = history.\u003cspan class=\"hljs-property\"\u003ehistory\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e'loss'\u003c/span\u003e]\nval_loss = history.\u003cspan class=\"hljs-property\"\u003ehistory\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e'val_loss'\u003c/span\u003e]\nepochs = \u003cspan class=\"hljs-title function_\"\u003erange\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-title function_\"\u003elen\u003c/span\u003e(loss) + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\nplt.\u003cspan class=\"hljs-title function_\"\u003eplot\u003c/span\u003e(epochs, loss, \u003cspan class=\"hljs-string\"\u003e'r.'\u003c/span\u003e, label=\u003cspan class=\"hljs-string\"\u003e'í›ˆë ¨ ì†ì‹¤'\u003c/span\u003e)\nplt.\u003cspan class=\"hljs-title function_\"\u003eplot\u003c/span\u003e(epochs, val_loss, \u003cspan class=\"hljs-string\"\u003e'y'\u003c/span\u003e, label=\u003cspan class=\"hljs-string\"\u003e'ê²€ì¦ ì†ì‹¤'\u003c/span\u003e)\nplt.\u003cspan class=\"hljs-title function_\"\u003etitle\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'í›ˆë ¨ ë° ê²€ì¦ ì†ì‹¤'\u003c/span\u003e)\nplt.\u003cspan class=\"hljs-title function_\"\u003exlabel\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'ì—í¬í¬'\u003c/span\u003e)\nplt.\u003cspan class=\"hljs-title function_\"\u003eylabel\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'ì†ì‹¤'\u003c/span\u003e)\nplt.\u003cspan class=\"hljs-title function_\"\u003egrid\u003c/span\u003e()\nplt.\u003cspan class=\"hljs-title function_\"\u003elegend\u003c/span\u003e()\nplt.\u003cspan class=\"hljs-title function_\"\u003esavefig\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'.\\\\figures\\\\history_traing.png'\u003c/span\u003e, dpi=\u003cspan class=\"hljs-number\"\u003e300\u003c/span\u003e, bbox_inches=\u003cspan class=\"hljs-string\"\u003e'tight'\u003c/span\u003e)\nplt.\u003cspan class=\"hljs-title function_\"\u003eshow\u003c/span\u003e()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eëª¨ë¸ í‰ê°€\u003c/p\u003e\n\u003cp\u003eí…ŒìŠ¤íŠ¸ ë°ì´í„°\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003edef \u003cspan class=\"hljs-title function_\"\u003etest_model\u003c/span\u003e(model, x_test, y_test):\n    x_test = (x_test / x_test.\u003cspan class=\"hljs-title function_\"\u003emax\u003c/span\u003e()).\u003cspan class=\"hljs-title function_\"\u003ereshape\u003c/span\u003e((\u003cspan class=\"hljs-title function_\"\u003elen\u003c/span\u003e(x_test), \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n    y_pred = model.\u003cspan class=\"hljs-title function_\"\u003epredict\u003c/span\u003e(x_test).\u003cspan class=\"hljs-title function_\"\u003eargmax\u003c/span\u003e(axis=\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n    \u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'ì •í™•ë„'\u003c/span\u003e, ((y_pred == y_test).\u003cspan class=\"hljs-title function_\"\u003esum\u003c/span\u003e() / \u003cspan class=\"hljs-title function_\"\u003elen\u003c/span\u003e(y_test))*\u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"%\"\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-title function_\"\u003etest_model\u003c/span\u003e(model, X_test, y_test)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_23.png\" alt=\"Image\"\u003e\u003c/p\u003e\n\u003cp\u003e3.8.2 â€” Confusion matrix\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003efig = plt.\u003cspan class=\"hljs-title function_\"\u003efigure\u003c/span\u003e(figsize=(\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e)) # \u003cspan class=\"hljs-title class_\"\u003eSet\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eFigure\u003c/span\u003e\n\ny_pred = model.\u003cspan class=\"hljs-title function_\"\u003epredict\u003c/span\u003e(X_test) # \u003cspan class=\"hljs-title class_\"\u003ePredict\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eprobabilities\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e =\u003e [\u003cspan class=\"hljs-number\"\u003e0.1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0.9\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e]\nY_pred = np.\u003cspan class=\"hljs-title function_\"\u003eargmax\u003c/span\u003e(y_pred, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) # \u003cspan class=\"hljs-title class_\"\u003eDecode\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003ePredicted\u003c/span\u003e labels\nmat = \u003cspan class=\"hljs-title function_\"\u003econfusion_matrix\u003c/span\u003e(y_test, Y_pred) # \u003cspan class=\"hljs-title class_\"\u003eConfusion\u003c/span\u003e matrix\n\n# \u003cspan class=\"hljs-title class_\"\u003ePlot\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eConfusion\u003c/span\u003e matrix\nsns.\u003cspan class=\"hljs-title function_\"\u003eheatmap\u003c/span\u003e(mat.\u003cspan class=\"hljs-property\"\u003eT\u003c/span\u003e, square=\u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e, annot=\u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e, cbar=\u003cspan class=\"hljs-title class_\"\u003eFalse\u003c/span\u003e, cmap=plt.\u003cspan class=\"hljs-property\"\u003ecm\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eBlues\u003c/span\u003e, fmt=\u003cspan class=\"hljs-string\"\u003e'.0f'\u003c/span\u003e, \n            xticklabels=np.\u003cspan class=\"hljs-title function_\"\u003eunique\u003c/span\u003e(y_test), yticklabels=np.\u003cspan class=\"hljs-title function_\"\u003eunique\u003c/span\u003e(y_test), \n            annot_kws={\u003cspan class=\"hljs-string\"\u003e\"fontsize\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e}, linewidths=\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, linecolor=\u003cspan class=\"hljs-string\"\u003e'white'\u003c/span\u003e)\n\nplt.\u003cspan class=\"hljs-title function_\"\u003exlabel\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'Predicted Values'\u003c/span\u003e, fontsize=\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e)\nplt.\u003cspan class=\"hljs-title function_\"\u003eylabel\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'True Values'\u003c/span\u003e, fontsize=\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e)\nplt.\u003cspan class=\"hljs-title function_\"\u003exticks\u003c/span\u003e(fontsize=\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e)\nplt.\u003cspan class=\"hljs-title function_\"\u003eyticks\u003c/span\u003e(fontsize=\u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e)\nplt.\u003cspan class=\"hljs-title function_\"\u003esavefig\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'.\\\\figures\\\\confusion_matrix.png'\u003c/span\u003e, dpi=\u003cspan class=\"hljs-number\"\u003e300\u003c/span\u003e, bbox_inches=\u003cspan class=\"hljs-string\"\u003e'tight'\u003c/span\u003e)\nplt.\u003cspan class=\"hljs-title function_\"\u003eshow\u003c/span\u003e()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_24.png\" alt=\"ì´ë¯¸ì§€\"\u003e\u003c/p\u003e\n\u003cp\u003e3.8.3â€” ì˜ˆì¸¡ ìœ íš¨ì„± ê²€ì‚¬ ê²°ê³¼\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003ey_pred = model.\u003cspan class=\"hljs-title function_\"\u003epredict\u003c/span\u003e(X_test)\nX_test__ = X_test\n\nfig, axis = plt.\u003cspan class=\"hljs-title function_\"\u003esubplots\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e, figsize=(\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e14\u003c/span\u003e))\n\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e i, ax \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eenumerate\u003c/span\u003e(axis.\u003cspan class=\"hljs-property\"\u003eflat\u003c/span\u003e):\n    ax.\u003cspan class=\"hljs-title function_\"\u003eimshow\u003c/span\u003e(X_test__[i], cmap=\u003cspan class=\"hljs-string\"\u003e'binary'\u003c/span\u003e)\n    ax.\u003cspan class=\"hljs-title function_\"\u003eset\u003c/span\u003e(title = f\u003cspan class=\"hljs-string\"\u003e\"ì‹¤ì œ ìˆ«ì: {y_test[i]}\\nì˜ˆì¸¡ ìˆ«ì: {y_pred[i].argmax()}\"\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_25.png\" alt=\"ì´ë¯¸ì§€\"\u003e\u003c/p\u003e\n\u003cp\u003e3.9 â€” ë§ˆì´í¬ë¡œì»¨íŠ¸ë¡¤ëŸ¬ì— êµ¬í˜„í•  ëª¨ë¸ì„ ì–»ê¸°\u003c/p\u003e\n\u003cp\u003e3.9.1 â€” C í”„ë¡œê·¸ë˜ë°ì„ ìœ„í•´ ì¼ë¶€ 16ì§„ìˆ˜ ê°’ì„ ë°°ì—´ë¡œ ë³€í™˜í•˜ê¸°\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# í•¨ìˆ˜: C í”„ë¡œê·¸ë˜ë°ì„ ìœ„í•´ ì¼ë¶€ \u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003eì§„ìˆ˜ ê°’ì„ ë°°ì—´ë¡œ ë³€í™˜\ndef \u003cspan class=\"hljs-title function_\"\u003ehex_to_c_array\u003c/span\u003e(hex_data, var_name):\n\n  c_str = \u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e\n\n  # í—¤ë” ê°€ë“œ ìƒì„±\n  c_str += \u003cspan class=\"hljs-string\"\u003e'#ifdef __has_attribute\\n'\u003c/span\u003e\n  c_str += \u003cspan class=\"hljs-string\"\u003e'#define HAVE_ATTRIBUTE(x) __has_attribute(x)\\n'\u003c/span\u003e\n  c_str += \u003cspan class=\"hljs-string\"\u003e'#else\\n'\u003c/span\u003e\n  c_str += \u003cspan class=\"hljs-string\"\u003e'#define HAVE_ATTRIBUTE(x) 0\\n'\u003c/span\u003e\n  c_str += \u003cspan class=\"hljs-string\"\u003e'#endif\\n'\u003c/span\u003e\n  c_str += \u003cspan class=\"hljs-string\"\u003e'#if HAVE_ATTRIBUTE(aligned) || (defined(__GNUC__) \u0026#x26;\u0026#x26; !defined(__clang__))\\n'\u003c/span\u003e\n  c_str += \u003cspan class=\"hljs-string\"\u003e'#define DATA_ALIGN_ATTRIBUTE __attribute__((aligned(4)))\\n'\u003c/span\u003e\n  c_str += \u003cspan class=\"hljs-string\"\u003e'#else\\n'\u003c/span\u003e\n  c_str += \u003cspan class=\"hljs-string\"\u003e'#define DATA_ALIGN_ATTRIBUTE\\n'\u003c/span\u003e\n  c_str += \u003cspan class=\"hljs-string\"\u003e'#endif\\n\\n'\u003c/span\u003e\n\n  # C ë³€ìˆ˜ ì„ ì–¸\n  c_str += \u003cspan class=\"hljs-string\"\u003e'const unsigned char '\u003c/span\u003e + var_name + \u003cspan class=\"hljs-string\"\u003e'[]  DATA_ALIGN_ATTRIBUTE = {'\u003c/span\u003e\n  hex_array = []\n  \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e i, val \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eenumerate\u003c/span\u003e(hex_data) :\n\n    # \u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003eì§„ìˆ˜ì—ì„œ ë¬¸ìì—´ë¡œ ë³€í™˜\n    hex_str = \u003cspan class=\"hljs-title function_\"\u003eformat\u003c/span\u003e(val, \u003cspan class=\"hljs-string\"\u003e'#04x'\u003c/span\u003e)\n\n    # ê° ì¤„ì´ \u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003eì ì´ë‚´ë¡œ ìœ ì§€ë˜ë„ë¡ ì„œì‹ ì§€ì • ì¶”ê°€\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (i + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) \u0026#x3C; \u003cspan class=\"hljs-title function_\"\u003elen\u003c/span\u003e(hex_data):\n      hex_str += \u003cspan class=\"hljs-string\"\u003e','\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (i + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) % \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e == \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\n      hex_str += \u003cspan class=\"hljs-string\"\u003e'\\n '\u003c/span\u003e\n    hex_array.\u003cspan class=\"hljs-title function_\"\u003eappend\u003c/span\u003e(hex_str)\n\n  # ë§ˆì§€ë§‰ ì¤‘ê´„í˜¸ ì¶”ê°€\n  c_str += \u003cspan class=\"hljs-string\"\u003e'\\n '\u003c/span\u003e + \u003cspan class=\"hljs-title function_\"\u003eformat\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e' '\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003ejoin\u003c/span\u003e(hex_array)) + \u003cspan class=\"hljs-string\"\u003e'\\n};\\n\\n'\u003c/span\u003e\n\n  # í—¤ë” ê°€ë“œ ì¢…ë£Œ\n  c_str += \u003cspan class=\"hljs-string\"\u003e'const int '\u003c/span\u003e + var_name + \u003cspan class=\"hljs-string\"\u003e'_len = '\u003c/span\u003e + \u003cspan class=\"hljs-title function_\"\u003estr\u003c/span\u003e(\u003cspan class=\"hljs-title function_\"\u003elen\u003c/span\u003e(hex_data)) + \u003cspan class=\"hljs-string\"\u003e';\\n'\u003c/span\u003e\n\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e c_str\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e3.9.2â€”ëª¨ë¸ì„ Float32ì™€ Int8í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ê¸°\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003edef \u003cspan class=\"hljs-title function_\"\u003erepresentative_dataset\u003c/span\u003e():\n    \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e i \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003erange\u003c/span\u003e(\u003cspan class=\"hljs-title function_\"\u003elen\u003c/span\u003e(X_train)):\n        input_data = np.\u003cspan class=\"hljs-title function_\"\u003earray\u003c/span\u003e([X_train[i]], dtype=np.\u003cspan class=\"hljs-property\"\u003efloat32\u003c/span\u003e)\n        \u003cspan class=\"hljs-keyword\"\u003eyield\u003c/span\u003e [input_data]\n\ndef \u003cspan class=\"hljs-title function_\"\u003econverter_quantization_model\u003c/span\u003e(model, model_name):\n\n    # \u003cspan class=\"hljs-title class_\"\u003eConvert\u003c/span\u003e the model to float32\n    converter_float32 = tf.\u003cspan class=\"hljs-property\"\u003elite\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eTFLiteConverter\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003efrom_keras_model\u003c/span\u003e(model)\n    converter_float32.\u003cspan class=\"hljs-property\"\u003eoptimizations\u003c/span\u003e = [tf.\u003cspan class=\"hljs-property\"\u003elite\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eOptimize\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eDEFAULT\u003c/span\u003e]\n    converter_float32.\u003cspan class=\"hljs-property\"\u003etarget_spec\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esupported_types\u003c/span\u003e = [tf.\u003cspan class=\"hljs-property\"\u003efloat32\u003c/span\u003e]\n    converter_float32.\u003cspan class=\"hljs-property\"\u003e_experimental_lower_tensor_list_ops\u003c/span\u003e = \u003cspan class=\"hljs-title class_\"\u003eFalse\u003c/span\u003e\n    converter_float32.\u003cspan class=\"hljs-property\"\u003esupported_ops\u003c/span\u003e = [tf.\u003cspan class=\"hljs-property\"\u003elite\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eOpsSet\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eTFLITE_BUILTINS\u003c/span\u003e, tf.\u003cspan class=\"hljs-property\"\u003elite\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eOpsSet\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eSELECT_TF_OPS\u003c/span\u003e]\n    converter_float32.\u003cspan class=\"hljs-property\"\u003erepresentative_dataset\u003c/span\u003e = representative_dataset\n    tflite_model_float32 = converter_float32.\u003cspan class=\"hljs-title function_\"\u003econvert\u003c/span\u003e()\n    \u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(tflite_model_float32)\n    \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eopen\u003c/span\u003e(model_name+\u003cspan class=\"hljs-string\"\u003e'_quant_float32'\u003c/span\u003e + \u003cspan class=\"hljs-string\"\u003e'.h'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'w'\u003c/span\u003e) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003efile\u003c/span\u003e:\n        file.\u003cspan class=\"hljs-title function_\"\u003ewrite\u003c/span\u003e(\u003cspan class=\"hljs-title function_\"\u003ehex_to_c_array\u003c/span\u003e(tflite_model_float32, model_name+\u003cspan class=\"hljs-string\"\u003e'_quant_float32'\u003c/span\u003e))\n    \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eopen\u003c/span\u003e(model_name+\u003cspan class=\"hljs-string\"\u003e'_quant_float32.tflite'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'wb'\u003c/span\u003e) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ef\u003c/span\u003e:\n        f.\u003cspan class=\"hljs-title function_\"\u003ewrite\u003c/span\u003e(tflite_model_float32)\n    size_model_tflite_float32 = os.\u003cspan class=\"hljs-property\"\u003epath\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003egetsize\u003c/span\u003e(model_name+\u003cspan class=\"hljs-string\"\u003e'_quant_float32.tflite'\u003c/span\u003e)\n    \u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(model_name+f\u003cspan class=\"hljs-string\"\u003e'_quant_float32.tflite: {size_model_tflite_float32} Bytes'\u003c/span\u003e)\n\n    # \u003cspan class=\"hljs-title class_\"\u003eConvert\u003c/span\u003e the model to \u003cspan class=\"hljs-title class_\"\u003eInt8\u003c/span\u003e\n    converter_int8 = tf.\u003cspan class=\"hljs-property\"\u003elite\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eTFLiteConverter\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003efrom_keras_model\u003c/span\u003e(model)\n    converter_int8.\u003cspan class=\"hljs-property\"\u003eoptimizations\u003c/span\u003e = [tf.\u003cspan class=\"hljs-property\"\u003elite\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eOptimize\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eDEFAULT\u003c/span\u003e]\n    converter_int8.\u003cspan class=\"hljs-property\"\u003etarget_spec\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esupported_types\u003c/span\u003e = [tf.\u003cspan class=\"hljs-property\"\u003eint8\u003c/span\u003e]\n    converter_int8.\u003cspan class=\"hljs-property\"\u003erepresentative_dataset\u003c/span\u003e = representative_dataset\n    converter_int8.\u003cspan class=\"hljs-property\"\u003etarget_spec\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esupported_ops\u003c/span\u003e = [\n        tf.\u003cspan class=\"hljs-property\"\u003elite\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eOpsSet\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eTFLITE_BUILTINS_INT8\u003c/span\u003e,\n        tf.\u003cspan class=\"hljs-property\"\u003elite\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eOpsSet\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eSELECT_TF_OPS\u003c/span\u003e,\n    ]\n    converter_int8.\u003cspan class=\"hljs-property\"\u003etarget_spec\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esupported_ops\u003c/span\u003e = [tf.\u003cspan class=\"hljs-property\"\u003elite\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eOpsSet\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eTFLITE_BUILTINS\u003c/span\u003e]\n    converter_int8.\u003cspan class=\"hljs-property\"\u003etarget_spec\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esupported_ops\u003c/span\u003e = [tf.\u003cspan class=\"hljs-property\"\u003elite\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eOpsSet\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eTFLITE_BUILTINS_INT8\u003c/span\u003e]\n    converter_int8.\u003cspan class=\"hljs-property\"\u003eexperimental_new_converter\u003c/span\u003e = \u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e\n    converter_int8.\u003cspan class=\"hljs-property\"\u003eexperimental_new_quantizer\u003c/span\u003e = \u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e\n    converter_int8.\u003cspan class=\"hljs-property\"\u003eexperimental_new_calibrator\u003c/span\u003e = \u003cspan class=\"hljs-title class_\"\u003eTrue\u003c/span\u003e\n    tflite_model_int8 = converter_int8.\u003cspan class=\"hljs-title function_\"\u003econvert\u003c/span\u003e()\n    \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eopen\u003c/span\u003e(model_name+\u003cspan class=\"hljs-string\"\u003e'_quant_int8'\u003c/span\u003e + \u003cspan class=\"hljs-string\"\u003e'.h'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'w'\u003c/span\u003e) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003efile\u003c/span\u003e:\n        file.\u003cspan class=\"hljs-title function_\"\u003ewrite\u003c/span\u003e(\u003cspan class=\"hljs-title function_\"\u003ehex_to_c_array\u003c/span\u003e(tflite_model_int8, model_name+\u003cspan class=\"hljs-string\"\u003e'_quant_int8'\u003c/span\u003e))\n    \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eopen\u003c/span\u003e(model_name+\u003cspan class=\"hljs-string\"\u003e'_quant_int8.tflite'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'wb'\u003c/span\u003e) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ef\u003c/span\u003e:\n        f.\u003cspan class=\"hljs-title function_\"\u003ewrite\u003c/span\u003e(tflite_model_int8)\n    size_model_tflite_int8 = os.\u003cspan class=\"hljs-property\"\u003epath\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003egetsize\u003c/span\u003e(model_name+\u003cspan class=\"hljs-string\"\u003e'_quant_int8.tflite'\u003c/span\u003e)\n    \u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(model_name+f\u003cspan class=\"hljs-string\"\u003e'_quant_int8.tflite: {size_model_tflite_int8} Bytes'\u003c/span\u003e)\n\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eNone\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003emodel_name=\u003cspan class=\"hljs-string\"\u003e'.\\models\\model'\u003c/span\u003e\n\u003cspan class=\"hljs-title function_\"\u003econverter_quantization_model\u003c/span\u003e(model, model_name)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e3.10 â€” Quantized Model Evaluation\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003edef evaluate_quantization(model_path, X_test, y_test, quantization_type):\n    interpreter = tf.\u003cspan class=\"hljs-property\"\u003elite\u003c/span\u003e.\u003cspan class=\"hljs-title class_\"\u003eInterpreter\u003c/span\u003e(model_path=model_path)\n    interpreter.\u003cspan class=\"hljs-title function_\"\u003eallocate_tensors\u003c/span\u003e()\n\n    # \u003cspan class=\"hljs-title class_\"\u003eEvaluate\u003c/span\u003e the quantized model\n    input_index = interpreter.\u003cspan class=\"hljs-title function_\"\u003eget_input_details\u003c/span\u003e()[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e'index'\u003c/span\u003e]\n    output_index = interpreter.\u003cspan class=\"hljs-title function_\"\u003eget_output_details\u003c/span\u003e()[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e][\u003cspan class=\"hljs-string\"\u003e'index'\u003c/span\u003e]\n    predictions = []\n    processing_times = []\n\n    X_test = np.\u003cspan class=\"hljs-title function_\"\u003earray\u003c/span\u003e(X_test, dtype=np.\u003cspan class=\"hljs-property\"\u003efloat32\u003c/span\u003e)\n    \n    \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e X \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eX_test\u003c/span\u003e:\n        interpreter.\u003cspan class=\"hljs-title function_\"\u003eset_tensor\u003c/span\u003e(input_index, [X])       \n        start_time = time.\u003cspan class=\"hljs-title function_\"\u003etime\u003c/span\u003e()\n        interpreter.\u003cspan class=\"hljs-title function_\"\u003einvoke\u003c/span\u003e()\n        end_time = time.\u003cspan class=\"hljs-title function_\"\u003etime\u003c/span\u003e()\n        processing_time = end_time - start_time\n        processing_times.\u003cspan class=\"hljs-title function_\"\u003eappend\u003c/span\u003e(processing_time)\n        output = interpreter.\u003cspan class=\"hljs-title function_\"\u003eget_tensor\u003c/span\u003e(output_index).\u003cspan class=\"hljs-title function_\"\u003eargmax\u003c/span\u003e(axis=\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n        predictions.\u003cspan class=\"hljs-title function_\"\u003eappend\u003c/span\u003e(output[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e])\n\n    acc = \u003cspan class=\"hljs-title function_\"\u003eaccuracy_score\u003c/span\u003e(y_test, predictions)\n   \n    # \u003cspan class=\"hljs-title class_\"\u003eCalculate\u003c/span\u003e the average and standard deviation \u003cspan class=\"hljs-keyword\"\u003eof\u003c/span\u003e differences\n    result = { \u003cspan class=\"hljs-string\"\u003e\"Accuracy (%): \"\u003c/span\u003e:acc*\u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e,\n                \u003cspan class=\"hljs-string\"\u003e\"Process time (s): \"\u003c/span\u003e: np.\u003cspan class=\"hljs-title function_\"\u003emean\u003c/span\u003e(processing_times)\n            }\n\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e result\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003emodel_name = \u003cspan class=\"hljs-string\"\u003e'.\\models\\model'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eeval_quant_float32 = evaluate_quantization(model_name + \u003cspan class=\"hljs-string\"\u003e'_quant_float32.tflite'\u003c/span\u003e, X_test, y_test, \u003cspan class=\"hljs-string\"\u003e'float32'\u003c/span\u003e)\neval_quant_float32\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_26.png\" alt=\"Image\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eeval_quant_int8 = evaluate_quantization(model_name + \u003cspan class=\"hljs-string\"\u003e'_quant_int8.tflite'\u003c/span\u003e, X_test, y_test, \u003cspan class=\"hljs-string\"\u003e'int8'\u003c/span\u003e)\neval_quant_int8 \n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e3.11 â€” ëª¨ë¸ ë°°í¬\u003c/h2\u003e\n\u003cp\u003eì´ ì˜ˆì œë¥¼ í†µí•´ ESP32, ì•„ë‘ì´ë…¸, ì•„ë‘ì´ë…¸ Portenta H7 with Vision Shield, ë¼ì¦ˆë² ë¦¬íŒŒì´ ë° ê¸°íƒ€ ë‹¤ì–‘í•œ ë§ˆì´í¬ë¡œì»¨íŠ¸ë¡¤ëŸ¬ ë˜ëŠ” IoT ì¥ì¹˜ì— ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\u003c/p\u003e\n\u003cp\u003e3.11.1 â€” EloquentTinyML ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜\u003c/p\u003e\n\u003cp\u003eë„ì„œê´€ í´ë”ë¡œ ì´ë™í•˜ì—¬ EloquentTinyML-mainì„ ì„¤ì¹˜í•´ì£¼ì„¸ìš”.\u003c/p\u003e\n\u003cp\u003e3.11.2 â€” ì™„ì „í•œ ì•„ë‘ì´ë…¸ ìŠ¤ì¼€ì¹˜\u003c/p\u003e\n\u003cp\u003emodel_quant_float32.h ë˜ëŠ” model_quant_int8.h íŒŒì¼ì„ ì—´ì–´ì„œ ë‹¤ìŒì—ì„œ ëª¨ë“  16ì§„ìˆ˜ ê°’ì„ ë³µì‚¬í•˜ì„¸ìš”:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_28.png\" alt=\"ì´ë¯¸ì§€\"\u003e\u003c/p\u003e\n\u003cp\u003eì•„ë˜ì™€ ê°™ì´ ë³€ê²½í•´ì£¼ì„¸ìš”:\u003c/p\u003e\n\u003cp\u003eand model len\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_29.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003eand cut in model.h:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_30.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003eand\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_31.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003e3.11.2 â€” ì™„ì„±ëœ ì•„ë‘ì´ë…¸ ìŠ¤ì¼€ì¹˜\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e#include \u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eEloquentTinyML\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eh\u003c/span\u003e\u003e\n#include \u0026#x3C;eloquent_tinyml/tensorflow.\u003cspan class=\"hljs-property\"\u003eh\u003c/span\u003e\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e// sine_model.h contains the array you exported from Python with xxd or tinymlgen\u003c/span\u003e\n#include \u003cspan class=\"hljs-string\"\u003e\"model.h\"\u003c/span\u003e\n\n#define \u003cspan class=\"hljs-variable constant_\"\u003eN_INPUTS\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e\n#define \u003cspan class=\"hljs-variable constant_\"\u003eN_OUTPUTS\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// in future projects you may need to tweak this value: it's a trial and error process\u003c/span\u003e\n#define \u003cspan class=\"hljs-variable constant_\"\u003eTENSOR_ARENA_SIZE\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e*\u003cspan class=\"hljs-number\"\u003e1024\u003c/span\u003e\n\n\u003cspan class=\"hljs-title class_\"\u003eEloquent\u003c/span\u003e::\u003cspan class=\"hljs-title class_\"\u003eTinyML\u003c/span\u003e::\u003cspan class=\"hljs-title class_\"\u003eTensorFlow\u003c/span\u003e::\u003cspan class=\"hljs-title class_\"\u003eTensorFlow\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eN_INPUTS\u003c/span\u003e, \u003cspan class=\"hljs-variable constant_\"\u003eN_OUTPUTS\u003c/span\u003e, \u003cspan class=\"hljs-variable constant_\"\u003eTENSOR_ARENA_SIZE\u003c/span\u003e\u003e tf;\n\nfloat input[\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e] = {\u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e12500000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e50000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e56250000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e81250000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e31250000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e87500000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e50000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e43750000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e75000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e31250000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e12500000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e56250000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e43750000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e31250000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e18750000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e31250000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e18750000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e62500000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e12500000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e62500000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e06250000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e81250000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e06250000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e75000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e31250000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e81250000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e31250000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e56250000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e81250000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e56250000000f, \u003cspan class=\"hljs-number\"\u003e1.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e1.\u003c/span\u003e00000000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e43750000000f, \u003cspan class=\"hljs-number\"\u003e0.\u003c/span\u003e00000000000f};\n\nfloat y_pred[\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e] = {\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e};\n\n\u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003esetup\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-title class_\"\u003eSerial\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003ebegin\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e9600\u003c/span\u003e);\n    \u003cspan class=\"hljs-title function_\"\u003edelay\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e4000\u003c/span\u003e);\n    tf.\u003cspan class=\"hljs-title function_\"\u003ebegin\u003c/span\u003e(model);\n\n    \u003cspan class=\"hljs-comment\"\u003e// check if model loaded fine\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (!tf.\u003cspan class=\"hljs-title function_\"\u003eisOk\u003c/span\u003e()) {\n      \u003cspan class=\"hljs-title class_\"\u003eSerial\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"ERROR: \"\u003c/span\u003e);\n      \u003cspan class=\"hljs-title class_\"\u003eSerial\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eprintln\u003c/span\u003e(tf.\u003cspan class=\"hljs-title function_\"\u003egetErrorMessage\u003c/span\u003e());\n\n      \u003cspan class=\"hljs-keyword\"\u003ewhile\u003c/span\u003e (\u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e) \u003cspan class=\"hljs-title function_\"\u003edelay\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e);\n    }\n}\n\n\u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eloop\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n\n        tf.\u003cspan class=\"hljs-title function_\"\u003epredict\u003c/span\u003e(input, y_pred);\n        \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e (int i = \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e; i \u0026#x3C; \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e; i++) {\n            \u003cspan class=\"hljs-title class_\"\u003eSerial\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(y_pred[i]);\n            \u003cspan class=\"hljs-title class_\"\u003eSerial\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(i == \u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e ? \u003cspan class=\"hljs-string\"\u003e'\\n'\u003c/span\u003e : \u003cspan class=\"hljs-string\"\u003e','\u003c/span\u003e);\n        }\n    \u003cspan class=\"hljs-title class_\"\u003eSerial\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Predicted class is: \"\u003c/span\u003e);\n      \u003cspan class=\"hljs-title class_\"\u003eSerial\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eprintln\u003c/span\u003e(tf.\u003cspan class=\"hljs-title function_\"\u003eprobaToClass\u003c/span\u003e(y_pred));\n      \u003cspan class=\"hljs-comment\"\u003e// or you can skip the predict() method and call directly predictClass()\u003c/span\u003e\n      \u003cspan class=\"hljs-title class_\"\u003eSerial\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Sanity check: \"\u003c/span\u003e);\n      \u003cspan class=\"hljs-title class_\"\u003eSerial\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eprintln\u003c/span\u003e(tf.\u003cspan class=\"hljs-title function_\"\u003epredictClass\u003c/span\u003e(input));\n      \u003cspan class=\"hljs-title function_\"\u003edelay\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e2000\u003c/span\u003e);\n\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e3.12 â€” ê²°ê³¼\u003c/p\u003e\n\u003cp\u003e3.12.1 â€” ì–‘ìí™”ëœ ëª¨ë¸ Float32\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_32.png\" alt=\"ì´ë¯¸ì§€\"\u003e\u003c/p\u003e\n\u003cp\u003e3.12.1 â€” ì–‘ìí™”ëœ ëª¨ë¸ Int8\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_33.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003eFull project in: \u003ca href=\"https://github.com/thommaskevin/TinyML\" rel=\"nofollow\" target=\"_blank\"\u003eTinyML/13_CNN at main Â· thommaskevin/TinyML\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003eIf you like it, consider buying my coffee â˜•ï¸ğŸ’° (Bitcoin)\u003c/h2\u003e\n\u003cp\u003ecode: bc1qzydjy4m9yhmjjrkgtrzhsgmkq79qenvcvc7qzn\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e\u0026#x3C;img src=\"/assets/img/2024-06-20-TinyMLConvolutionalNeuralNetworksCNN_34.png\" /\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-06-20-TinyMLConvolutionalNeuralNetworksCNN"},"buildId":"FH3Qr-mLAesqA0X5IFRQr","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>