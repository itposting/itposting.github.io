<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>R에서 Caret 패키지로 분류 모델 생성하기 | itposting</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://itposting.github.io///post/2024-06-20-ClassificationModelinRwithCaretPackage" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="R에서 Caret 패키지로 분류 모델 생성하기 | itposting" data-gatsby-head="true"/><meta property="og:title" content="R에서 Caret 패키지로 분류 모델 생성하기 | itposting" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-06-20-ClassificationModelinRwithCaretPackage_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://itposting.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://itposting.github.io///post/2024-06-20-ClassificationModelinRwithCaretPackage" data-gatsby-head="true"/><meta name="twitter:title" content="R에서 Caret 패키지로 분류 모델 생성하기 | itposting" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-06-20-ClassificationModelinRwithCaretPackage_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | itposting" data-gatsby-head="true"/><meta name="article:published_time" content="2024-06-20 15:59" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-23YXDLKDCL"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-23YXDLKDCL');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-ac4aa08aae62f90e.js" defer=""></script><script src="/_next/static/chunks/463-0429087d4c0b0335.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-d849684d6d83f07a.js" defer=""></script><script src="/_next/static/QYe6gFAUryFKFgjKBoIfo/_buildManifest.js" defer=""></script><script src="/_next/static/QYe6gFAUryFKFgjKBoIfo/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">IT Posting</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">R에서 Caret 패키지로 분류 모델 생성하기</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="R에서 Caret 패키지로 분류 모델 생성하기" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">IT Posting</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Jun 20, 2024</span><span class="posts_reading_time__f7YPP">14<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-06-20-ClassificationModelinRwithCaretPackage&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<p>Classification And Regression Training, 또는 caret으로 줄여서 부르는 것은 R 프로그래밍 패키지로, 예측 모델을 만드는 과정을 간소화하려는 함수를 포함하고 있어요. 이 패키지에는 다음과 같은 기능들이 포함되어 있어요:</p>
<ul>
<li>데이터 분할</li>
<li>데이터 전처리</li>
<li>특성 선택</li>
<li>리샘플링을 이용한 모델 튜닝</li>
<li>변수 중요도 추정</li>
</ul>
<p>또한 다른 기능들도 있답니다.</p>
<p><img src="/assets/img/2024-06-20-ClassificationModelinRwithCaretPackage_0.png" alt="image"></p>
<div class="content-ad"></div>
<p>이 예시에서는 R 프로그래밍 언어를 사용하여 <a href="https://www.kaggle.com/datasets/deepcontractor/smoke-detection-dataset" rel="nofollow" target="_blank">https://www.kaggle.com/datasets/deepcontractor/smoke-detection-dataset</a> 사이트에서 제공하는 데이터셋을 사용하여 Smoke detection을 예측합니다.</p>
<h1>라이브러리</h1>
<p>이 모델에서 사용할 라이브러리는 다음과 같습니다:</p>
<pre><code class="hljs language-js"><span class="hljs-title function_">library</span>(tidyverse)
<span class="hljs-title function_">library</span>(caret)
<span class="hljs-title function_">library</span>(rpart.<span class="hljs-property">plot</span>)
<span class="hljs-title function_">library</span>(corrplot)
<span class="hljs-title function_">library</span>(ggcorrplot)
</code></pre>
<div class="content-ad"></div>
<p>Tidyverse 패키지를 사용하여 데이터 세트를 수정하고 조작하며, 변수들 간의 상관 관계를 찾기 위해 corrplot을 사용할 수 있어요.</p>
<h1>데이터 세트</h1>
<p>데이터 세트는 다음과 같이 구성되어 있어요:</p>




























































<table><thead><tr><th>변수명</th><th>데이터 형태</th><th>예시</th></tr></thead><tbody><tr><td>UTC</td><td>날짜 및 시간 형식(dttm)</td><td>2022-06-09 00:08:51, 2022-06-09 00:08:52, 2022-06-09...</td></tr><tr><td>Temperature[C]</td><td>실수형(double)</td><td>20.000, 20.015, 20.029, 20.044, 20.059, 20.073...</td></tr><tr><td>Humidity[%]</td><td>실수형(double)</td><td>57.36, 56.67, 55.96, 55.28, 54.69, 54.12...</td></tr><tr><td>TVOC[ppb]</td><td>실수형(double)</td><td>0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...</td></tr><tr><td>eCO2[ppm]</td><td>실수형(double)</td><td>400, 400, 400, 400, 400, 400, 400, 400, 400, 400...</td></tr><tr><td>Raw H2</td><td>실수형(double)</td><td>12306, 12345, 12374, 12390, 12403, 12419...</td></tr><tr><td>Raw Ethanol</td><td>실수형(double)</td><td>18520, 18651, 18764, 18849, 18921, 18998...</td></tr><tr><td>Pressure[hPa]</td><td>실수형(double)</td><td>939.735, 939.744, 939.738, 939.736, 939.744...</td></tr><tr><td>PM1.0</td><td>실수형(double)</td><td>0.00, 0.00, 0.00, 0.00, 0.00, 0.00...</td></tr><tr><td>그 외 변수들</td><td>...</td><td>...</td></tr></tbody></table>
<div class="content-ad"></div>
<p>지시하신 데이터셋에 결측 데이터가 없는지 확인하시고 이 데이터셋에 대해 데이터 처리를 수행할 수 있습니다. 데이터셋은 다음과 같은 변수로 구성되어 있습니다:</p>
<ol>
<li>UTC: 실험이 수행된 시간</li>
<li>Temperature[C]: 환경 온도, 섭씨로 측정</li>
<li>Humidity[%]: 실험 중의 대기 습도</li>
<li>TVOC[ppb]: 총 휘발성 유기 화합물, ppb(십억분의 1) 단위로 측정</li>
<li>eCO2[ppm]: CO2 동등 농도, ppm(백만분의 1) 단위로 측정</li>
<li>Raw H2: 주위에 존재하는 생수소의 양 [보정되지 않은 생 분자수소; 바이어스, 온도 등을 보정한 것이 아님]</li>
<li>Raw Ethanol: 주위에 존재하는 생 에탄올의 양</li>
<li>Pressure[hPa]: 대기압, hPa로 측정</li>
<li>PM1.0: 지름이 1.0 마이크로미터 미만인 미립자</li>
<li>PM2.5: 지름이 2.5 마이크로미터 미만인 미립자</li>
<li>NC0.5: 지름이 0.5 마이크로미터 미만인 미립자의 농도</li>
<li>NC1.0: 지름이 1.0 마이크로미터 미만인 미립자의 농도</li>
<li>NC2.5: 지름이 2.5 마이크로미터 미만인 미립자의 농도</li>
<li>CNT: 샘플 카운트. 화재 경보(실제) 화재가 발생했을 경우 값은 1, 그렇지 않으면 0</li>
<li>Fire Alarm: 1은 양성, 0은 양성이 아님</li>
</ol>
<h1>데이터 처리</h1>
<p>모델링을 수행하기 전 데이터셋 처리. 필요한 변수 선택하고 CNT, Sample Count 변수는 선택하지 않습니다.</p>
<div class="content-ad"></div>
<pre><code class="hljs language-js">raw_data %>%
  <span class="hljs-title function_">select</span>(
         temp_c = <span class="hljs-string">`Temperature[C]`</span>,
         humidity = <span class="hljs-string">`Humidity[%]`</span>,
         tvoc = <span class="hljs-string">`TVOC[ppb]`</span>,
         co2 = <span class="hljs-string">`eCO2[ppm]`</span>,
         h2 = <span class="hljs-string">`Raw H2`</span>,
         ethanol = <span class="hljs-string">`Raw Ethanol`</span>,
         pressure = <span class="hljs-string">`Pressure[hPa]`</span>,
         pm1 = <span class="hljs-title class_">PM1</span><span class="hljs-number">.0</span>,
         pm2_5 = <span class="hljs-title class_">PM2</span><span class="hljs-number">.5</span>,
         fire_alarm = <span class="hljs-string">`Fire Alarm`</span>
         ) %>%
  <span class="hljs-title function_">mutate</span>(
    fire_alarm = <span class="hljs-title function_">factor</span>(fire_alarm, levels = <span class="hljs-title function_">c</span>(<span class="hljs-number">1</span>,<span class="hljs-number">0</span>), labels = <span class="hljs-title function_">c</span>(<span class="hljs-string">"yes"</span>, <span class="hljs-string">"no"</span>))
  ) %>%
  <span class="hljs-title function_">glimpse</span>() -> df_data
</code></pre>
<pre><code class="hljs language-js"><span class="hljs-title class_">Rows</span>: <span class="hljs-number">62</span>,<span class="hljs-number">630</span>
<span class="hljs-title class_">Columns</span>: <span class="hljs-number">10</span>
$ temp_c     &#x3C;dbl> <span class="hljs-number">20.000</span>, <span class="hljs-number">20.015</span>, <span class="hljs-number">20.029</span>, <span class="hljs-number">20.044</span>, <span class="hljs-number">20.059</span>, <span class="hljs-number">20.073</span>, <span class="hljs-number">20.08</span>…
$ humidity   &#x3C;dbl> <span class="hljs-number">57.36</span>, <span class="hljs-number">56.67</span>, <span class="hljs-number">55.96</span>, <span class="hljs-number">55.28</span>, <span class="hljs-number">54.69</span>, <span class="hljs-number">54.12</span>, <span class="hljs-number">53.61</span>, <span class="hljs-number">53.2</span>…
$ tvoc       &#x3C;dbl> <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,…
$ co2        &#x3C;dbl> <span class="hljs-number">400</span>, <span class="hljs-number">400</span>, <span class="hljs-number">400</span>, <span class="hljs-number">400</span>, <span class="hljs-number">400</span>, <span class="hljs-number">400</span>, <span class="hljs-number">400</span>, <span class="hljs-number">400</span>, <span class="hljs-number">400</span>, <span class="hljs-number">400</span>, <span class="hljs-number">400</span>…
$ h2         &#x3C;dbl> <span class="hljs-number">12306</span>, <span class="hljs-number">12345</span>, <span class="hljs-number">12374</span>, <span class="hljs-number">12390</span>, <span class="hljs-number">12403</span>, <span class="hljs-number">12419</span>, <span class="hljs-number">12432</span>, <span class="hljs-number">1243</span>…
$ ethanol    &#x3C;dbl> <span class="hljs-number">18520</span>, <span class="hljs-number">18651</span>, <span class="hljs-number">18764</span>, <span class="hljs-number">18849</span>, <span class="hljs-number">18921</span>, <span class="hljs-number">18998</span>, <span class="hljs-number">19058</span>, <span class="hljs-number">1911</span>…
$ pressure   &#x3C;dbl> <span class="hljs-number">939.735</span>, <span class="hljs-number">939.744</span>, <span class="hljs-number">939.738</span>, <span class="hljs-number">939.736</span>, <span class="hljs-number">939.744</span>, <span class="hljs-number">939.725</span>,…
$ pm1        &#x3C;dbl> <span class="hljs-number">0.00</span>, <span class="hljs-number">0.00</span>, <span class="hljs-number">0.00</span>, <span class="hljs-number">0.00</span>, <span class="hljs-number">0.00</span>, <span class="hljs-number">0.00</span>, <span class="hljs-number">0.00</span>, <span class="hljs-number">0.00</span>, <span class="hljs-number">0.00</span>,…
$ pm2_5      &#x3C;dbl> <span class="hljs-number">0.00</span>, <span class="hljs-number">0.00</span>, <span class="hljs-number">0.00</span>, <span class="hljs-number">0.00</span>, <span class="hljs-number">0.00</span>, <span class="hljs-number">0.00</span>, <span class="hljs-number">0.00</span>, <span class="hljs-number">0.00</span>, <span class="hljs-number">0.00</span>,…
$ fire_alarm &#x3C;fct> no, no, no, no, no, no, no, no, no, no, no, no, no, n…
</code></pre>
<p>상관 관계 플롯을 수행</p>
<img src="/assets/img/2024-06-20-ClassificationModelinRwithCaretPackage_1.png">
<div class="content-ad"></div>
<p>상관 행렬을 기반으로 통찰력을 얻을 수 있습니다:</p>
<ul>
<li>대상 특징과 다른 특징 간에는 높은 상관 관계가 없습니다. 대상 특징과 습도, 압력 사이에 약한 양의 상관 관계가 있습니다. 또한 대상 특징과 TVOC, 원무 에탄올 간에는 약한 음의 상관 관계가 있습니다.</li>
<li>eCO2와 TVOC, PM1.0 간에는 높은 양의 상관 관계가 있습니다. 또한 압력과 습도, 원시 H2와 원시 에탄올, PM1.0과 eCO2, PM2.5 간에도 높은 양의 상관 관계가 있습니다.</li>
</ul>
<h1>데이터 분할</h1>
<p>데이터를 학습 및 테스트 데이터셋으로 8:2의 비율로 분할합니다. 일반적으로 더 큰 데이터셋에서 학습하는 모델이 더 정확해지지만, 더 많은 학습 데이터는 모델을 학습하는 데 더 많은 시간이 걸릴 수 있습니다.</p>
<div class="content-ad"></div>
<p>우리의 데이터를 나누기 위해 caret 패키지의 createDataPartition()를 사용할 거에요. 이 함수는 넘겨주는 벡터의 인덱스들을 비례에 따라 랜덤하게 샘플링합니다. 그런 다음 이러한 인덱스를 사용하여 전체 데이터셋을 테스트 및 트레이닝 데이터셋으로 나눌 수 있어요.</p>
<pre><code class="hljs language-js"># 랜덤 시드 설정
set.<span class="hljs-title function_">seed</span>(<span class="hljs-number">123</span>)

# 데이터 분할
train_index &#x3C;- <span class="hljs-title function_">createDataPartition</span>(df_data$fire_alarm, times = <span class="hljs-number">1</span>, p = <span class="hljs-number">0.8</span>, list = <span class="hljs-variable constant_">FALSE</span>)

train_data &#x3C;- df_data[train_index, ] %>% glimpse
</code></pre>
<pre><code class="hljs language-js"># 테스트 데이터
test_data &#x3C;- df_data[-train_index, ] %>% glimpse
</code></pre>
<h1>모델 개발</h1>
<div class="content-ad"></div>
<p>저희가 데이터에 어떤 알고리즘이 잘 동작할지 미리 알 수 없어요. 다양한 방법을 시험해보고 어떤 것이 잘되는지 보고, 그런 방법을 두드려야 해요.</p>
<h2>선형 알고리즘:</h2>
<ol>
<li>로지스틱 회귀 (LG),</li>
<li>선형 판별 분석 (LDA)</li>
<li>정규화된 로지스틱 회귀 (GLMNET)</li>
</ol>
<div class="content-ad"></div>
<h2>비선형 알고리즘:</h2>
<ol>
<li>
<p>k-최근접 이웃 알고리즘(KNN),</p>
</li>
<li>
<p>분류 및 회귀 트리(CART),</p>
</li>
<li>
<p>나이브 베이즈(NB),</p>
</li>
<li>
<p>방사 기저 함수를 사용한 서포트 벡터 머신(SVM).</p>
</li>
</ol>
<div class="content-ad"></div>
<p>데이터가 많으므로 10-fold 교차 검증과 3회 반복을 사용할 것입니다. 이는 표준 테스트 하네스 구성입니다. 여러분의 이진 분류 문제에 대해 간단하게 정확도와 Kappa 지표를 사용할 것입니다. AUC(ROC 곡선 아래 영역)를 선택하고 민감도 및 특이도를 살펴 최적의 알고리즘을 선택할 수도 있었습니다.</p>
<pre><code class="hljs language-js"># <span class="hljs-number">10</span>-fold cross validation <span class="hljs-keyword">with</span> <span class="hljs-number">3</span> repeats
trainControl &#x3C;- <span class="hljs-title function_">trainControl</span>(method=<span class="hljs-string">"repeatedcv"</span>, number=<span class="hljs-number">10</span>, repeats=<span class="hljs-number">3</span>, verboseIter = <span class="hljs-variable constant_">TRUE</span>)

metric &#x3C;- <span class="hljs-string">"Accuracy"</span>
</code></pre>
<p>그런 다음, 각 알고리즘에 대한 모델을 작성합니다.</p>
<pre><code class="hljs language-js"># <span class="hljs-title class_">Bagged</span> <span class="hljs-variable constant_">CART</span>
set.<span class="hljs-title function_">seed</span>(<span class="hljs-number">7</span>)
fit.<span class="hljs-property">treebag</span> &#x3C;- <span class="hljs-title function_">train</span>(fire_alarm~., data = train_data, method = <span class="hljs-string">"treebag"</span>, metric = metric,trControl = trainControl)

# <span class="hljs-variable constant_">RF</span>
set.<span class="hljs-title function_">seed</span>(<span class="hljs-number">7</span>)
fit.<span class="hljs-property">rf</span> &#x3C;- <span class="hljs-title function_">train</span>(fire_alarm~., data = train_data, method = <span class="hljs-string">"rf"</span>, metric = metric,trControl = trainControl)

# <span class="hljs-variable constant_">GBM</span> - <span class="hljs-title class_">Stochastic</span> <span class="hljs-title class_">Gradient</span> <span class="hljs-title class_">Boosting</span>
set.<span class="hljs-title function_">seed</span>(<span class="hljs-number">7</span>)
fit.<span class="hljs-property">gbm</span> &#x3C;- <span class="hljs-title function_">train</span>(fire_alarm~., data = train_data, method = <span class="hljs-string">"gbm"</span>,metric = metric,trControl = trainControl, verbose = <span class="hljs-variable constant_">FALSE</span>)

# <span class="hljs-variable constant_">C5</span><span class="hljs-number">.0</span>
set.<span class="hljs-title function_">seed</span>(<span class="hljs-number">7</span>)
fit.<span class="hljs-property">c50</span> &#x3C;- <span class="hljs-title function_">train</span>(fire_alarm~., data = train_data, method = <span class="hljs-string">"C5.0"</span>, metric = metric,trControl = trainControl)

# <span class="hljs-variable constant_">LG</span> - <span class="hljs-title class_">Logistic</span> <span class="hljs-title class_">Regression</span>
set.<span class="hljs-title function_">seed</span>(<span class="hljs-number">7</span>)
fit.<span class="hljs-property">glm</span> &#x3C;- <span class="hljs-title function_">train</span>(fire_alarm~., data = train_data, method=<span class="hljs-string">"glm"</span>,
                 metric=metric,trControl=trainControl)
# <span class="hljs-variable constant_">LDA</span> - <span class="hljs-title class_">Linear</span> <span class="hljs-title class_">Discriminate</span> <span class="hljs-title class_">Analysis</span>
set.<span class="hljs-title function_">seed</span>(<span class="hljs-number">7</span>)
fit.<span class="hljs-property">lda</span> &#x3C;- <span class="hljs-title function_">train</span>(fire_alarm~., data = train_data, method=<span class="hljs-string">"lda"</span>,
                 metric=metric,trControl=trainControl)

# <span class="hljs-variable constant_">GLMNET</span> - <span class="hljs-title class_">Regularized</span> <span class="hljs-title class_">Logistic</span> <span class="hljs-title class_">Regression</span>
set.<span class="hljs-title function_">seed</span>(<span class="hljs-number">7</span>)
fit.<span class="hljs-property">glmnet</span> &#x3C;- <span class="hljs-title function_">train</span>(fire_alarm~., data = train_data, method=<span class="hljs-string">"glmnet"</span>,
                 metric=metric,trControl=trainControl)

# <span class="hljs-variable constant_">KNN</span> - k-<span class="hljs-title class_">Nearest</span> <span class="hljs-title class_">Neighbors</span> 
set.<span class="hljs-title function_">seed</span>(<span class="hljs-number">7</span>)
fit.<span class="hljs-property">knn</span> &#x3C;- <span class="hljs-title function_">train</span>(fire_alarm~., data = train_data, method=<span class="hljs-string">"knn"</span>,
                 metric=metric,trControl=trainControl)

# <span class="hljs-variable constant_">CART</span> - <span class="hljs-title class_">Classification</span> and <span class="hljs-title class_">Regression</span> <span class="hljs-title class_">Trees</span> (<span class="hljs-variable constant_">CART</span>), 
set.<span class="hljs-title function_">seed</span>(<span class="hljs-number">7</span>)
fit.<span class="hljs-property">cart</span> &#x3C;- <span class="hljs-title function_">train</span>(fire_alarm~., data = train_data, method=<span class="hljs-string">"rpart"</span>,
                 metric=metric,trControl=trainControl)

# <span class="hljs-variable constant_">NB</span> - <span class="hljs-title class_">Naive</span> <span class="hljs-title class_">Bayes</span> (<span class="hljs-variable constant_">NB</span>) 
set.<span class="hljs-title function_">seed</span>(<span class="hljs-number">7</span>)
<span class="hljs-title class_">Grid</span> = expand.<span class="hljs-title function_">grid</span>(usekernel=<span class="hljs-variable constant_">TRUE</span>,adjust=<span class="hljs-number">1</span>,fL=<span class="hljs-title function_">c</span>(<span class="hljs-number">0.2</span>,<span class="hljs-number">0.5</span>,<span class="hljs-number">0.8</span>))
fit.<span class="hljs-property">nb</span> &#x3C;- <span class="hljs-title function_">train</span>(fire_alarm~., data = train_data, method=<span class="hljs-string">"nb"</span>,
                 metric=metric,trControl=trainControl,
                tuneGrid=<span class="hljs-title class_">Grid</span>)
</code></pre>
<div class="content-ad"></div>
<p>모델을 구축한 후에는 모델을 비교하여 더 나은 정확도를 찾을 수 있어요! 😊</p>
<pre><code class="hljs language-js"><span class="hljs-title class_">Call</span>:
summary.<span class="hljs-title function_">resamples</span>(object = ensembleResults)

<span class="hljs-title class_">Models</span>: <span class="hljs-variable constant_">BAG</span>, <span class="hljs-variable constant_">RF</span>, <span class="hljs-variable constant_">GBM</span>, <span class="hljs-variable constant_">C50</span>, <span class="hljs-variable constant_">LG</span>, <span class="hljs-variable constant_">KNN</span>, <span class="hljs-variable constant_">NB</span>, <span class="hljs-variable constant_">CART</span>, <span class="hljs-variable constant_">GLMNET</span> 
<span class="hljs-title class_">Number</span> <span class="hljs-keyword">of</span> <span class="hljs-attr">resamples</span>: <span class="hljs-number">30</span> 

정확도 
            <span class="hljs-title class_">Min</span>.   1st <span class="hljs-title class_">Qu</span>.    <span class="hljs-title class_">Median</span>      <span class="hljs-title class_">Mean</span>   3rd <span class="hljs-title class_">Qu</span>.      <span class="hljs-title class_">Max</span>. <span class="hljs-variable constant_">NA</span><span class="hljs-string">'s
BAG    0.9994013 0.9998004 0.9998004 0.9998337 1.0000000 1.0000000    0
RF     0.9996008 0.9998004 1.0000000 0.9999202 1.0000000 1.0000000    0
GBM    0.9986028 0.9996008 0.9998004 0.9996407 0.9998004 1.0000000    0
C50    0.9992014 0.9996009 0.9998004 0.9998071 1.0000000 1.0000000    0
LG     0.8467372 0.8629515 0.8861393 0.8797790 0.8933134 0.9030134    0
KNN    0.9990018 0.9996007 0.9998004 0.9996341 0.9998004 1.0000000    0
NB     0.9417282 0.9443613 0.9463074 0.9470978 0.9505089 0.9527041    0
CART   0.9590900 0.9654244 0.9809419 0.9754183 0.9829849 0.9896208    0
GLMNET 0.8848303 0.8931245 0.8957294 0.8954128 0.8985681 0.9026142    0

카파 
            Min.   1st Qu.    Median      Mean   3rd Qu.      Max. NA'</span>s
<span class="hljs-variable constant_">BAG</span>    <span class="hljs-number">0.9985319</span> <span class="hljs-number">0.9995105</span> <span class="hljs-number">0.9995106</span> <span class="hljs-number">0.9995922</span> <span class="hljs-number">1.0000000</span> <span class="hljs-number">1.0000000</span>    <span class="hljs-number">0</span>
<span class="hljs-variable constant_">RF</span>     <span class="hljs-number">0.9990214</span> <span class="hljs-number">0.9995107</span> <span class="hljs-number">1.0000000</span> <span class="hljs-number">0.9998043</span> <span class="hljs-number">1.0000000</span> <span class="hljs-number">1.0000000</span>    <span class="hljs-number">0</span>
<span class="hljs-variable constant_">GBM</span>    <span class="hljs-number">0.9965712</span> <span class="hljs-number">0.9990210</span> <span class="hljs-number">0.9995105</span> <span class="hljs-number">0.9991189</span> <span class="hljs-number">0.9995106</span> <span class="hljs-number">1.0000000</span>    <span class="hljs-number">0</span>
<span class="hljs-variable constant_">C50</span>    <span class="hljs-number">0.9980418</span> <span class="hljs-number">0.9990214</span> <span class="hljs-number">0.9995107</span> <span class="hljs-number">0.9995269</span> <span class="hljs-number">1.0000000</span> <span class="hljs-number">1.0000000</span>    <span class="hljs-number">0</span>
<span class="hljs-variable constant_">LG</span>     <span class="hljs-number">0.6691273</span> <span class="hljs-number">0.6941347</span> <span class="hljs-number">0.7051705</span> <span class="hljs-number">0.7105437</span> <span class="hljs-number">0.7312704</span> <span class="hljs-number">0.7512402</span>    <span class="hljs-number">0</span>
<span class="hljs-variable constant_">KNN</span>    <span class="hljs-number">0.9975507</span> <span class="hljs-number">0.9990206</span> <span class="hljs-number">0.9995106</span> <span class="hljs-number">0.9991025</span> <span class="hljs-number">0.9995106</span> <span class="hljs-number">1.0000000</span>    <span class="hljs-number">0</span>
<span class="hljs-variable constant_">NB</span>     <span class="hljs-number">0.8632215</span> <span class="hljs-number">0.8695786</span> <span class="hljs-number">0.8735418</span> <span class="hljs-number">0.8754793</span> <span class="hljs-number">0.8834493</span> <span class="hljs-number">0.8880163</span>    <span class="hljs-number">0</span>
<span class="hljs-variable constant_">CART</span>   <span class="hljs-number">0.8997615</span> <span class="hljs-number">0.9156698</span> <span class="hljs-number">0.9523262</span> <span class="hljs-number">0.9397203</span> <span class="hljs-number">0.9575309</span> <span class="hljs-number">0.9747781</span>    <span class="hljs-number">0</span>
<span class="hljs-variable constant_">GLMNET</span> <span class="hljs-number">0.7052235</span> <span class="hljs-number">0.7262274</span> <span class="hljs-number">0.7346055</span> <span class="hljs-number">0.7332479</span> <span class="hljs-number">0.7403128</span> <span class="hljs-number">0.7496404</span>    <span class="hljs-number">0</span>
</code></pre>
<img src="/assets/img/2024-06-20-ClassificationModelinRwithCaretPackage_2.png">
<p>랜덤 포레스트가 가장 높은 정확도(99.99%)를 보이며, 그 다음으로 BAG (Bagged CART) (99.98%)와 C5.0 (99.93%)이 뒤를 이어요! 🚀🌟</p>
<div class="content-ad"></div>
<h1>모델 완성</h1>
<p>높은 정확도를 가진 트리 알고리즘인 Random Forest, BAG, 그리고 C5.0를 선택하여 예측을 진행할 것이며, 테스트 데이터셋으로 모델 및 정확도를 테스트할 예정입니다.</p>
<pre><code class="hljs language-js"># 모델 저장
<span class="hljs-title function_">saveRDS</span>(fit.<span class="hljs-property">c50</span>, <span class="hljs-attr">here</span>::<span class="hljs-title function_">here</span>(<span class="hljs-string">"finalModel_c50.rds"</span>))
<span class="hljs-title function_">saveRDS</span>(fit.<span class="hljs-property">rf</span>, <span class="hljs-attr">here</span>::<span class="hljs-title function_">here</span>(<span class="hljs-string">"finalModel_rf.rds"</span>))
<span class="hljs-title function_">saveRDS</span>(fit.<span class="hljs-property">treebag</span>, <span class="hljs-attr">here</span>::<span class="hljs-title function_">here</span>(<span class="hljs-string">"finalModel_treebag.rds"</span>))
</code></pre>
<pre><code class="hljs language-js">predict_c50 &#x3C;- <span class="hljs-title function_">predict</span>(model_c50, test_data)
<span class="hljs-title function_">summary</span>(predict_c50)

# 혼동 행렬
cf_c50 &#x3C;- <span class="hljs-title function_">confusionMatrix</span>(predict_c50, test_data$fire_alarm)

cf_c50
</code></pre>
<div class="content-ad"></div>
<pre><code class="hljs language-js">예   아니요 
<span class="hljs-number">8950</span> <span class="hljs-number">3575</span> 
혼동 행렬 및 통계

          참조
예측     예    아니요
       예 <span class="hljs-number">8949</span>    <span class="hljs-number">1</span>
       아니요     <span class="hljs-number">2</span> <span class="hljs-number">3573</span>
                                     
              정확도 : <span class="hljs-number">0.9998</span>     
                 <span class="hljs-number">95</span>% 신뢰구간 : (<span class="hljs-number">0.9993</span>, <span class="hljs-number">1</span>)
    정보 부재율 : <span class="hljs-number">0.7147</span>     
    P-값 [정확도 > 정보 부재율] : <span class="xml">&#x3C;2e-16     
                                     
                  카파 : 0.9994     
                                     
 맥네마의 검정 P-값 : 1          
                                      
            민감도 : 0.9998     
            특이도 : 0.9997     
         양성 예측치 : 0.9999     
         음성 예측치 : 0.9994     
             유병률 : 0.7147     
         발견 비율 : 0.7145     
   발견 유병률 : 0.7146     
      균형 정확도 : 0.9997     
                                     
     '양성' 클래스 : 예
</span></code></pre>
<p>랜덤 포레스트 모델을 로드하고 테스트 데이터로 예측을 생성합니다.</p>
<pre><code class="hljs language-js"># 의사결정 트리 랜덤 포레스트
model_rf &#x3C;- <span class="hljs-title function_">readRDS</span>(<span class="hljs-attr">here</span>::<span class="hljs-title function_">here</span>(<span class="hljs-string">"finalModel_rf.rds"</span>))
<span class="hljs-title function_">print</span>(model_rf)
</code></pre>
<pre><code class="hljs language-js">랜덤 포레스트 

<span class="hljs-number">50105</span> 개 샘플
    <span class="hljs-number">9</span> 예측 변수
    <span class="hljs-number">2</span> 클래스: <span class="hljs-string">'예'</span>, <span class="hljs-string">'아니요'</span> 

사전 처리 없음
샘플링: 교차 검증 (<span class="hljs-number">10</span>-fold, <span class="hljs-number">3</span>회 반복) 
샘플 크기 요약: <span class="hljs-number">45095</span>, <span class="hljs-number">45094</span>, <span class="hljs-number">45094</span>, <span class="hljs-number">45094</span>, <span class="hljs-number">45095</span>, <span class="hljs-number">45094</span>, ... 
튜닝 매개변수에 따른 샘플링 결과:

  mtry  정확도   카파    
  <span class="hljs-number">2</span>     <span class="hljs-number">0.9999202</span>  <span class="hljs-number">0.9998043</span>
  <span class="hljs-number">5</span>     <span class="hljs-number">0.9999202</span>  <span class="hljs-number">0.9998043</span>
  <span class="hljs-number">9</span>     <span class="hljs-number">0.9998736</span>  <span class="hljs-number">0.9996901</span>

가장 큰 값을 사용하여 최적 모델을 선택하는 데 정확도가 사용되었습니다.
모델에 사용된 최종 값은 mtry = <span class="hljs-number">2</span>입니다.
</code></pre>
<div class="content-ad"></div>
<pre><code class="hljs language-R">predict_rf <span class="hljs-operator">&#x3C;-</span> predict<span class="hljs-punctuation">(</span>model_rf<span class="hljs-punctuation">,</span> test_data<span class="hljs-punctuation">)</span>
summary<span class="hljs-punctuation">(</span>predict_rf<span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Confusion Matrix</span>
cf_rf <span class="hljs-operator">&#x3C;-</span> confusionMatrix<span class="hljs-punctuation">(</span>predict_rf<span class="hljs-punctuation">,</span> test_data<span class="hljs-operator">$</span>fire_alarm<span class="hljs-punctuation">)</span>

cf_rf
</code></pre>
<pre><code class="hljs language-R">yes   no 
<span class="hljs-number">8952</span> <span class="hljs-number">3573</span> 
Confusion Matrix and Statistics

          Reference
Prediction  yes   no
       yes <span class="hljs-number">8951</span>    <span class="hljs-number">1</span>
       no     <span class="hljs-number">0</span> <span class="hljs-number">3573</span>
                                     
               Accuracy <span class="hljs-operator">:</span> <span class="hljs-number">0.9999</span>     
                 <span class="hljs-number">95</span>% CI <span class="hljs-operator">:</span> <span class="hljs-punctuation">(</span><span class="hljs-number">0.9996</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span>
    No Information Rate <span class="hljs-operator">:</span> <span class="hljs-number">0.7147</span>     
    P<span class="hljs-operator">-</span>Value <span class="hljs-punctuation">[</span>Acc <span class="hljs-operator">></span> NIR<span class="hljs-punctuation">]</span> <span class="hljs-operator">:</span> <span class="hljs-operator">&#x3C;</span><span class="hljs-number">2e-16</span>     
                                     
                  Kappa <span class="hljs-operator">:</span> <span class="hljs-number">0.9998</span>     
                                     
 Mcnemar<span class="hljs-string">'s Test P-Value : 1          
                                     
            Sensitivity : 1.0000     
            Specificity : 0.9997     
         Pos Pred Value : 0.9999     
         Neg Pred Value : 1.0000     
             Prevalence : 0.7147     
         Detection Rate : 0.7147     
   Detection Prevalence : 0.7147     
      Balanced Accuracy : 0.9999     
                                     
       '</span>Positive<span class="hljs-string">' Class : yes
</span></code></pre>
<p>Bagged CART 모델 로드하기</p>
<pre><code class="hljs language-R"><span class="hljs-comment"># 분류 및 회귀 트리 (CART)</span>
model_treebag <span class="hljs-operator">&#x3C;-</span> readRDS<span class="hljs-punctuation">(</span>here<span class="hljs-operator">::</span>here<span class="hljs-punctuation">(</span><span class="hljs-string">"finalModel_treebag.rds"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>

print<span class="hljs-punctuation">(</span>model_treebag<span class="hljs-punctuation">)</span>
</code></pre>
<div class="content-ad"></div>
<pre><code class="hljs language-js"><span class="hljs-title class_">Bagged</span> <span class="hljs-variable constant_">CART</span> 

<span class="hljs-number">50105</span> 개의 샘플
    <span class="hljs-number">9</span> 개의 예측 변수
    <span class="hljs-number">2</span> 개의 클래스: <span class="hljs-string">'yes'</span>, <span class="hljs-string">'no'</span> 

사전 처리 없음
리샘플링: 교차 확인(<span class="hljs-number">10</span> 폴드, <span class="hljs-number">3</span>회 반복) 
샘플 크기 요약: <span class="hljs-number">45095</span>, <span class="hljs-number">45094</span>, <span class="hljs-number">45094</span>, <span class="hljs-number">45094</span>, <span class="hljs-number">45095</span>, <span class="hljs-number">45094</span>, ... 
리샘플링 결과:

  정확도   카파    
  <span class="hljs-number">0.9998337</span>  <span class="hljs-number">0.9995922</span>
</code></pre>
<pre><code class="hljs language-js">predict_treebag &#x3C;- <span class="hljs-title function_">predict</span>(model_treebag, test_data)
<span class="hljs-title function_">summary</span>(predict_treebag)

# 혼동 행렬
cf_treebag &#x3C;- <span class="hljs-title function_">confusionMatrix</span>(predict_treebag, test_data$fire_alarm)

cf_treebag
</code></pre>
<pre><code class="hljs language-js"><span class="hljs-title class_">Confusion</span> <span class="hljs-title class_">Matrix</span> and <span class="hljs-title class_">Statistics</span>

          실제값
예측값   yes   no
       yes <span class="hljs-number">8951</span>    <span class="hljs-number">2</span>
       no     <span class="hljs-number">0</span> <span class="hljs-number">3572</span>
                                     
               정확도 : <span class="hljs-number">0.9998</span>     
                 <span class="hljs-number">95</span>% 신뢰 구간 : (<span class="hljs-number">0.9994</span>, <span class="hljs-number">1</span>)
    정보 없는 비율 : <span class="hljs-number">0.7147</span>     
    P-값 [정확도 > 정보 없는 비율] : <span class="xml">&#x3C;2e-16     
                                     
                  카파 : 0.9996     
                                     
 맥네머의 테스트 P-값 : 0.4795     
                                     
            민감도 : 1.0000     
            특이도 : 0.9994     
         양성 예측 값 : 0.9998     
         음성 예측 값 : 1.0000     
             유병률 : 0.7147     
         감지율 : 0.7147     
   감지 유병률 : 0.7148     
      균형 정확도 : 0.9997     
                                     
       '양성' 클래스 : yes
</span></code></pre>
<p>자세한 내용은 깃허브 저장소를 방문해 주세요. 이 절을 읽어 주셔서 감사합니다.</p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"R에서 Caret 패키지로 분류 모델 생성하기","description":"","date":"2024-06-20 15:59","slug":"2024-06-20-ClassificationModelinRwithCaretPackage","content":"\n\n\nClassification And Regression Training, 또는 caret으로 줄여서 부르는 것은 R 프로그래밍 패키지로, 예측 모델을 만드는 과정을 간소화하려는 함수를 포함하고 있어요. 이 패키지에는 다음과 같은 기능들이 포함되어 있어요:\n\n- 데이터 분할\n- 데이터 전처리\n- 특성 선택\n- 리샘플링을 이용한 모델 튜닝\n- 변수 중요도 추정\n\n또한 다른 기능들도 있답니다.\n\n![image](/assets/img/2024-06-20-ClassificationModelinRwithCaretPackage_0.png)\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n이 예시에서는 R 프로그래밍 언어를 사용하여 https://www.kaggle.com/datasets/deepcontractor/smoke-detection-dataset 사이트에서 제공하는 데이터셋을 사용하여 Smoke detection을 예측합니다.\n\n# 라이브러리\n\n이 모델에서 사용할 라이브러리는 다음과 같습니다:\n\n```js\nlibrary(tidyverse)\nlibrary(caret)\nlibrary(rpart.plot)\nlibrary(corrplot)\nlibrary(ggcorrplot)\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nTidyverse 패키지를 사용하여 데이터 세트를 수정하고 조작하며, 변수들 간의 상관 관계를 찾기 위해 corrplot을 사용할 수 있어요.\n\n# 데이터 세트\n\n데이터 세트는 다음과 같이 구성되어 있어요:\n\n| 변수명          | 데이터 형태                | 예시                          |\n|----------------|-------------------------|-------------------------------|\n| UTC            | 날짜 및 시간 형식(dttm)    | 2022-06-09 00:08:51, 2022-06-09 00:08:52, 2022-06-09... |\n| Temperature[C] | 실수형(double)             | 20.000, 20.015, 20.029, 20.044, 20.059, 20.073...         |\n| Humidity[%]    | 실수형(double)             | 57.36, 56.67, 55.96, 55.28, 54.69, 54.12...            |\n| TVOC[ppb]      | 실수형(double)             | 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...               |\n| eCO2[ppm]      | 실수형(double)             | 400, 400, 400, 400, 400, 400, 400, 400, 400, 400...      |\n| Raw H2         | 실수형(double)             | 12306, 12345, 12374, 12390, 12403, 12419...           |\n| Raw Ethanol    | 실수형(double)             | 18520, 18651, 18764, 18849, 18921, 18998...           |\n| Pressure[hPa]  | 실수형(double)             | 939.735, 939.744, 939.738, 939.736, 939.744...        |\n| PM1.0          | 실수형(double)             | 0.00, 0.00, 0.00, 0.00, 0.00, 0.00...              |\n| 그 외 변수들     | ...                       | ...                           |\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n지시하신 데이터셋에 결측 데이터가 없는지 확인하시고 이 데이터셋에 대해 데이터 처리를 수행할 수 있습니다. 데이터셋은 다음과 같은 변수로 구성되어 있습니다:\n\n1. UTC: 실험이 수행된 시간\n2. Temperature[C]: 환경 온도, 섭씨로 측정\n3. Humidity[%]: 실험 중의 대기 습도\n4. TVOC[ppb]: 총 휘발성 유기 화합물, ppb(십억분의 1) 단위로 측정\n5. eCO2[ppm]: CO2 동등 농도, ppm(백만분의 1) 단위로 측정\n6. Raw H2: 주위에 존재하는 생수소의 양 [보정되지 않은 생 분자수소; 바이어스, 온도 등을 보정한 것이 아님]\n7. Raw Ethanol: 주위에 존재하는 생 에탄올의 양\n8. Pressure[hPa]: 대기압, hPa로 측정\n9. PM1.0: 지름이 1.0 마이크로미터 미만인 미립자\n10. PM2.5: 지름이 2.5 마이크로미터 미만인 미립자\n11. NC0.5: 지름이 0.5 마이크로미터 미만인 미립자의 농도\n12. NC1.0: 지름이 1.0 마이크로미터 미만인 미립자의 농도\n13. NC2.5: 지름이 2.5 마이크로미터 미만인 미립자의 농도\n14. CNT: 샘플 카운트. 화재 경보(실제) 화재가 발생했을 경우 값은 1, 그렇지 않으면 0\n15. Fire Alarm: 1은 양성, 0은 양성이 아님\n\n# 데이터 처리\n\n모델링을 수행하기 전 데이터셋 처리. 필요한 변수 선택하고 CNT, Sample Count 변수는 선택하지 않습니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\nraw_data %\u003e%\n  select(\n         temp_c = `Temperature[C]`,\n         humidity = `Humidity[%]`,\n         tvoc = `TVOC[ppb]`,\n         co2 = `eCO2[ppm]`,\n         h2 = `Raw H2`,\n         ethanol = `Raw Ethanol`,\n         pressure = `Pressure[hPa]`,\n         pm1 = PM1.0,\n         pm2_5 = PM2.5,\n         fire_alarm = `Fire Alarm`\n         ) %\u003e%\n  mutate(\n    fire_alarm = factor(fire_alarm, levels = c(1,0), labels = c(\"yes\", \"no\"))\n  ) %\u003e%\n  glimpse() -\u003e df_data\n```\n\n```js\nRows: 62,630\nColumns: 10\n$ temp_c     \u003cdbl\u003e 20.000, 20.015, 20.029, 20.044, 20.059, 20.073, 20.08…\n$ humidity   \u003cdbl\u003e 57.36, 56.67, 55.96, 55.28, 54.69, 54.12, 53.61, 53.2…\n$ tvoc       \u003cdbl\u003e 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ co2        \u003cdbl\u003e 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400…\n$ h2         \u003cdbl\u003e 12306, 12345, 12374, 12390, 12403, 12419, 12432, 1243…\n$ ethanol    \u003cdbl\u003e 18520, 18651, 18764, 18849, 18921, 18998, 19058, 1911…\n$ pressure   \u003cdbl\u003e 939.735, 939.744, 939.738, 939.736, 939.744, 939.725,…\n$ pm1        \u003cdbl\u003e 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,…\n$ pm2_5      \u003cdbl\u003e 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,…\n$ fire_alarm \u003cfct\u003e no, no, no, no, no, no, no, no, no, no, no, no, no, n…\n```\n\n상관 관계 플롯을 수행\n\n\u003cimg src=\"/assets/img/2024-06-20-ClassificationModelinRwithCaretPackage_1.png\" /\u003e\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n상관 행렬을 기반으로 통찰력을 얻을 수 있습니다:\n\n- 대상 특징과 다른 특징 간에는 높은 상관 관계가 없습니다. 대상 특징과 습도, 압력 사이에 약한 양의 상관 관계가 있습니다. 또한 대상 특징과 TVOC, 원무 에탄올 간에는 약한 음의 상관 관계가 있습니다.\n- eCO2와 TVOC, PM1.0 간에는 높은 양의 상관 관계가 있습니다. 또한 압력과 습도, 원시 H2와 원시 에탄올, PM1.0과 eCO2, PM2.5 간에도 높은 양의 상관 관계가 있습니다.\n\n# 데이터 분할\n\n데이터를 학습 및 테스트 데이터셋으로 8:2의 비율로 분할합니다. 일반적으로 더 큰 데이터셋에서 학습하는 모델이 더 정확해지지만, 더 많은 학습 데이터는 모델을 학습하는 데 더 많은 시간이 걸릴 수 있습니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n우리의 데이터를 나누기 위해 caret 패키지의 createDataPartition()를 사용할 거에요. 이 함수는 넘겨주는 벡터의 인덱스들을 비례에 따라 랜덤하게 샘플링합니다. 그런 다음 이러한 인덱스를 사용하여 전체 데이터셋을 테스트 및 트레이닝 데이터셋으로 나눌 수 있어요.\n\n```js\n# 랜덤 시드 설정\nset.seed(123)\n\n# 데이터 분할\ntrain_index \u003c- createDataPartition(df_data$fire_alarm, times = 1, p = 0.8, list = FALSE)\n\ntrain_data \u003c- df_data[train_index, ] %\u003e% glimpse\n```\n\n```js\n# 테스트 데이터\ntest_data \u003c- df_data[-train_index, ] %\u003e% glimpse\n```\n\n# 모델 개발\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n저희가 데이터에 어떤 알고리즘이 잘 동작할지 미리 알 수 없어요. 다양한 방법을 시험해보고 어떤 것이 잘되는지 보고, 그런 방법을 두드려야 해요.\n\n## 선형 알고리즘:\n1. 로지스틱 회귀 (LG),\n2. 선형 판별 분석 (LDA)\n3. 정규화된 로지스틱 회귀 (GLMNET)\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n## 비선형 알고리즘:\n1. k-최근접 이웃 알고리즘(KNN),\n\n2. 분류 및 회귀 트리(CART),\n\n3. 나이브 베이즈(NB),\n\n4. 방사 기저 함수를 사용한 서포트 벡터 머신(SVM).\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n데이터가 많으므로 10-fold 교차 검증과 3회 반복을 사용할 것입니다. 이는 표준 테스트 하네스 구성입니다. 여러분의 이진 분류 문제에 대해 간단하게 정확도와 Kappa 지표를 사용할 것입니다. AUC(ROC 곡선 아래 영역)를 선택하고 민감도 및 특이도를 살펴 최적의 알고리즘을 선택할 수도 있었습니다.\n\n```js\n# 10-fold cross validation with 3 repeats\ntrainControl \u003c- trainControl(method=\"repeatedcv\", number=10, repeats=3, verboseIter = TRUE)\n\nmetric \u003c- \"Accuracy\"\n```\n\n그런 다음, 각 알고리즘에 대한 모델을 작성합니다.\n\n```js\n# Bagged CART\nset.seed(7)\nfit.treebag \u003c- train(fire_alarm~., data = train_data, method = \"treebag\", metric = metric,trControl = trainControl)\n\n# RF\nset.seed(7)\nfit.rf \u003c- train(fire_alarm~., data = train_data, method = \"rf\", metric = metric,trControl = trainControl)\n\n# GBM - Stochastic Gradient Boosting\nset.seed(7)\nfit.gbm \u003c- train(fire_alarm~., data = train_data, method = \"gbm\",metric = metric,trControl = trainControl, verbose = FALSE)\n\n# C5.0\nset.seed(7)\nfit.c50 \u003c- train(fire_alarm~., data = train_data, method = \"C5.0\", metric = metric,trControl = trainControl)\n\n# LG - Logistic Regression\nset.seed(7)\nfit.glm \u003c- train(fire_alarm~., data = train_data, method=\"glm\",\n                 metric=metric,trControl=trainControl)\n# LDA - Linear Discriminate Analysis\nset.seed(7)\nfit.lda \u003c- train(fire_alarm~., data = train_data, method=\"lda\",\n                 metric=metric,trControl=trainControl)\n\n# GLMNET - Regularized Logistic Regression\nset.seed(7)\nfit.glmnet \u003c- train(fire_alarm~., data = train_data, method=\"glmnet\",\n                 metric=metric,trControl=trainControl)\n\n# KNN - k-Nearest Neighbors \nset.seed(7)\nfit.knn \u003c- train(fire_alarm~., data = train_data, method=\"knn\",\n                 metric=metric,trControl=trainControl)\n\n# CART - Classification and Regression Trees (CART), \nset.seed(7)\nfit.cart \u003c- train(fire_alarm~., data = train_data, method=\"rpart\",\n                 metric=metric,trControl=trainControl)\n\n# NB - Naive Bayes (NB) \nset.seed(7)\nGrid = expand.grid(usekernel=TRUE,adjust=1,fL=c(0.2,0.5,0.8))\nfit.nb \u003c- train(fire_alarm~., data = train_data, method=\"nb\",\n                 metric=metric,trControl=trainControl,\n                tuneGrid=Grid)\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n모델을 구축한 후에는 모델을 비교하여 더 나은 정확도를 찾을 수 있어요! 😊\n\n```js\nCall:\nsummary.resamples(object = ensembleResults)\n\nModels: BAG, RF, GBM, C50, LG, KNN, NB, CART, GLMNET \nNumber of resamples: 30 \n\n정확도 \n            Min.   1st Qu.    Median      Mean   3rd Qu.      Max. NA's\nBAG    0.9994013 0.9998004 0.9998004 0.9998337 1.0000000 1.0000000    0\nRF     0.9996008 0.9998004 1.0000000 0.9999202 1.0000000 1.0000000    0\nGBM    0.9986028 0.9996008 0.9998004 0.9996407 0.9998004 1.0000000    0\nC50    0.9992014 0.9996009 0.9998004 0.9998071 1.0000000 1.0000000    0\nLG     0.8467372 0.8629515 0.8861393 0.8797790 0.8933134 0.9030134    0\nKNN    0.9990018 0.9996007 0.9998004 0.9996341 0.9998004 1.0000000    0\nNB     0.9417282 0.9443613 0.9463074 0.9470978 0.9505089 0.9527041    0\nCART   0.9590900 0.9654244 0.9809419 0.9754183 0.9829849 0.9896208    0\nGLMNET 0.8848303 0.8931245 0.8957294 0.8954128 0.8985681 0.9026142    0\n\n카파 \n            Min.   1st Qu.    Median      Mean   3rd Qu.      Max. NA's\nBAG    0.9985319 0.9995105 0.9995106 0.9995922 1.0000000 1.0000000    0\nRF     0.9990214 0.9995107 1.0000000 0.9998043 1.0000000 1.0000000    0\nGBM    0.9965712 0.9990210 0.9995105 0.9991189 0.9995106 1.0000000    0\nC50    0.9980418 0.9990214 0.9995107 0.9995269 1.0000000 1.0000000    0\nLG     0.6691273 0.6941347 0.7051705 0.7105437 0.7312704 0.7512402    0\nKNN    0.9975507 0.9990206 0.9995106 0.9991025 0.9995106 1.0000000    0\nNB     0.8632215 0.8695786 0.8735418 0.8754793 0.8834493 0.8880163    0\nCART   0.8997615 0.9156698 0.9523262 0.9397203 0.9575309 0.9747781    0\nGLMNET 0.7052235 0.7262274 0.7346055 0.7332479 0.7403128 0.7496404    0\n```\n\n\u003cimg src=\"/assets/img/2024-06-20-ClassificationModelinRwithCaretPackage_2.png\" /\u003e\n\n랜덤 포레스트가 가장 높은 정확도(99.99%)를 보이며, 그 다음으로 BAG (Bagged CART) (99.98%)와 C5.0 (99.93%)이 뒤를 이어요! 🚀🌟\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# 모델 완성\n\n높은 정확도를 가진 트리 알고리즘인 Random Forest, BAG, 그리고 C5.0를 선택하여 예측을 진행할 것이며, 테스트 데이터셋으로 모델 및 정확도를 테스트할 예정입니다.\n\n```js\n# 모델 저장\nsaveRDS(fit.c50, here::here(\"finalModel_c50.rds\"))\nsaveRDS(fit.rf, here::here(\"finalModel_rf.rds\"))\nsaveRDS(fit.treebag, here::here(\"finalModel_treebag.rds\"))\r\n```\n\n```js\npredict_c50 \u003c- predict(model_c50, test_data)\nsummary(predict_c50)\n\n# 혼동 행렬\ncf_c50 \u003c- confusionMatrix(predict_c50, test_data$fire_alarm)\n\ncf_c50\r\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\n예   아니요 \n8950 3575 \n혼동 행렬 및 통계\n\n          참조\n예측     예    아니요\n       예 8949    1\n       아니요     2 3573\n                                     \n              정확도 : 0.9998     \n                 95% 신뢰구간 : (0.9993, 1)\n    정보 부재율 : 0.7147     \n    P-값 [정확도 \u003e 정보 부재율] : \u003c2e-16     \n                                     \n                  카파 : 0.9994     \n                                     \n 맥네마의 검정 P-값 : 1          \n                                      \n            민감도 : 0.9998     \n            특이도 : 0.9997     \n         양성 예측치 : 0.9999     \n         음성 예측치 : 0.9994     \n             유병률 : 0.7147     \n         발견 비율 : 0.7145     \n   발견 유병률 : 0.7146     \n      균형 정확도 : 0.9997     \n                                     \n     '양성' 클래스 : 예\n```\n\n랜덤 포레스트 모델을 로드하고 테스트 데이터로 예측을 생성합니다.\n\n```js\n# 의사결정 트리 랜덤 포레스트\nmodel_rf \u003c- readRDS(here::here(\"finalModel_rf.rds\"))\nprint(model_rf)\r\n```\n\n```js\n랜덤 포레스트 \n\n50105 개 샘플\n    9 예측 변수\n    2 클래스: '예', '아니요' \n\n사전 처리 없음\n샘플링: 교차 검증 (10-fold, 3회 반복) \n샘플 크기 요약: 45095, 45094, 45094, 45094, 45095, 45094, ... \n튜닝 매개변수에 따른 샘플링 결과:\n\n  mtry  정확도   카파    \n  2     0.9999202  0.9998043\n  5     0.9999202  0.9998043\n  9     0.9998736  0.9996901\n\n가장 큰 값을 사용하여 최적 모델을 선택하는 데 정확도가 사용되었습니다.\n모델에 사용된 최종 값은 mtry = 2입니다.\r\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```R\npredict_rf \u003c- predict(model_rf, test_data)\nsummary(predict_rf)\n\n# Confusion Matrix\ncf_rf \u003c- confusionMatrix(predict_rf, test_data$fire_alarm)\n\ncf_rf\n```\n\n```R\nyes   no \n8952 3573 \nConfusion Matrix and Statistics\n\n          Reference\nPrediction  yes   no\n       yes 8951    1\n       no     0 3573\n                                     \n               Accuracy : 0.9999     \n                 95% CI : (0.9996, 1)\n    No Information Rate : 0.7147     \n    P-Value [Acc \u003e NIR] : \u003c2e-16     \n                                     \n                  Kappa : 0.9998     \n                                     \n Mcnemar's Test P-Value : 1          \n                                     \n            Sensitivity : 1.0000     \n            Specificity : 0.9997     \n         Pos Pred Value : 0.9999     \n         Neg Pred Value : 1.0000     \n             Prevalence : 0.7147     \n         Detection Rate : 0.7147     \n   Detection Prevalence : 0.7147     \n      Balanced Accuracy : 0.9999     \n                                     \n       'Positive' Class : yes\n```\n\nBagged CART 모델 로드하기\n\n```R\n# 분류 및 회귀 트리 (CART)\nmodel_treebag \u003c- readRDS(here::here(\"finalModel_treebag.rds\"))\n\nprint(model_treebag)\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\nBagged CART \n\n50105 개의 샘플\n    9 개의 예측 변수\n    2 개의 클래스: 'yes', 'no' \n\n사전 처리 없음\n리샘플링: 교차 확인(10 폴드, 3회 반복) \n샘플 크기 요약: 45095, 45094, 45094, 45094, 45095, 45094, ... \n리샘플링 결과:\n\n  정확도   카파    \n  0.9998337  0.9995922\n```\n\n```js\npredict_treebag \u003c- predict(model_treebag, test_data)\nsummary(predict_treebag)\n\n# 혼동 행렬\ncf_treebag \u003c- confusionMatrix(predict_treebag, test_data$fire_alarm)\n\ncf_treebag\n```\n\n```js\nConfusion Matrix and Statistics\n\n          실제값\n예측값   yes   no\n       yes 8951    2\n       no     0 3572\n                                     \n               정확도 : 0.9998     \n                 95% 신뢰 구간 : (0.9994, 1)\n    정보 없는 비율 : 0.7147     \n    P-값 [정확도 \u003e 정보 없는 비율] : \u003c2e-16     \n                                     \n                  카파 : 0.9996     \n                                     \n 맥네머의 테스트 P-값 : 0.4795     \n                                     \n            민감도 : 1.0000     \n            특이도 : 0.9994     \n         양성 예측 값 : 0.9998     \n         음성 예측 값 : 1.0000     \n             유병률 : 0.7147     \n         감지율 : 0.7147     \n   감지 유병률 : 0.7148     \n      균형 정확도 : 0.9997     \n                                     \n       '양성' 클래스 : yes\n```\n\n자세한 내용은 깃허브 저장소를 방문해 주세요. 이 절을 읽어 주셔서 감사합니다.","ogImage":{"url":"/assets/img/2024-06-20-ClassificationModelinRwithCaretPackage_0.png"},"coverImage":"/assets/img/2024-06-20-ClassificationModelinRwithCaretPackage_0.png","tag":["Tech"],"readingTime":14},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003eClassification And Regression Training, 또는 caret으로 줄여서 부르는 것은 R 프로그래밍 패키지로, 예측 모델을 만드는 과정을 간소화하려는 함수를 포함하고 있어요. 이 패키지에는 다음과 같은 기능들이 포함되어 있어요:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e데이터 분할\u003c/li\u003e\n\u003cli\u003e데이터 전처리\u003c/li\u003e\n\u003cli\u003e특성 선택\u003c/li\u003e\n\u003cli\u003e리샘플링을 이용한 모델 튜닝\u003c/li\u003e\n\u003cli\u003e변수 중요도 추정\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e또한 다른 기능들도 있답니다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-ClassificationModelinRwithCaretPackage_0.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e이 예시에서는 R 프로그래밍 언어를 사용하여 \u003ca href=\"https://www.kaggle.com/datasets/deepcontractor/smoke-detection-dataset\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://www.kaggle.com/datasets/deepcontractor/smoke-detection-dataset\u003c/a\u003e 사이트에서 제공하는 데이터셋을 사용하여 Smoke detection을 예측합니다.\u003c/p\u003e\n\u003ch1\u003e라이브러리\u003c/h1\u003e\n\u003cp\u003e이 모델에서 사용할 라이브러리는 다음과 같습니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-title function_\"\u003elibrary\u003c/span\u003e(tidyverse)\n\u003cspan class=\"hljs-title function_\"\u003elibrary\u003c/span\u003e(caret)\n\u003cspan class=\"hljs-title function_\"\u003elibrary\u003c/span\u003e(rpart.\u003cspan class=\"hljs-property\"\u003eplot\u003c/span\u003e)\n\u003cspan class=\"hljs-title function_\"\u003elibrary\u003c/span\u003e(corrplot)\n\u003cspan class=\"hljs-title function_\"\u003elibrary\u003c/span\u003e(ggcorrplot)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003eTidyverse 패키지를 사용하여 데이터 세트를 수정하고 조작하며, 변수들 간의 상관 관계를 찾기 위해 corrplot을 사용할 수 있어요.\u003c/p\u003e\n\u003ch1\u003e데이터 세트\u003c/h1\u003e\n\u003cp\u003e데이터 세트는 다음과 같이 구성되어 있어요:\u003c/p\u003e\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003ctable\u003e\u003cthead\u003e\u003ctr\u003e\u003cth\u003e변수명\u003c/th\u003e\u003cth\u003e데이터 형태\u003c/th\u003e\u003cth\u003e예시\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd\u003eUTC\u003c/td\u003e\u003ctd\u003e날짜 및 시간 형식(dttm)\u003c/td\u003e\u003ctd\u003e2022-06-09 00:08:51, 2022-06-09 00:08:52, 2022-06-09...\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eTemperature[C]\u003c/td\u003e\u003ctd\u003e실수형(double)\u003c/td\u003e\u003ctd\u003e20.000, 20.015, 20.029, 20.044, 20.059, 20.073...\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eHumidity[%]\u003c/td\u003e\u003ctd\u003e실수형(double)\u003c/td\u003e\u003ctd\u003e57.36, 56.67, 55.96, 55.28, 54.69, 54.12...\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eTVOC[ppb]\u003c/td\u003e\u003ctd\u003e실수형(double)\u003c/td\u003e\u003ctd\u003e0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eeCO2[ppm]\u003c/td\u003e\u003ctd\u003e실수형(double)\u003c/td\u003e\u003ctd\u003e400, 400, 400, 400, 400, 400, 400, 400, 400, 400...\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eRaw H2\u003c/td\u003e\u003ctd\u003e실수형(double)\u003c/td\u003e\u003ctd\u003e12306, 12345, 12374, 12390, 12403, 12419...\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eRaw Ethanol\u003c/td\u003e\u003ctd\u003e실수형(double)\u003c/td\u003e\u003ctd\u003e18520, 18651, 18764, 18849, 18921, 18998...\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003ePressure[hPa]\u003c/td\u003e\u003ctd\u003e실수형(double)\u003c/td\u003e\u003ctd\u003e939.735, 939.744, 939.738, 939.736, 939.744...\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003ePM1.0\u003c/td\u003e\u003ctd\u003e실수형(double)\u003c/td\u003e\u003ctd\u003e0.00, 0.00, 0.00, 0.00, 0.00, 0.00...\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e그 외 변수들\u003c/td\u003e\u003ctd\u003e...\u003c/td\u003e\u003ctd\u003e...\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e지시하신 데이터셋에 결측 데이터가 없는지 확인하시고 이 데이터셋에 대해 데이터 처리를 수행할 수 있습니다. 데이터셋은 다음과 같은 변수로 구성되어 있습니다:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eUTC: 실험이 수행된 시간\u003c/li\u003e\n\u003cli\u003eTemperature[C]: 환경 온도, 섭씨로 측정\u003c/li\u003e\n\u003cli\u003eHumidity[%]: 실험 중의 대기 습도\u003c/li\u003e\n\u003cli\u003eTVOC[ppb]: 총 휘발성 유기 화합물, ppb(십억분의 1) 단위로 측정\u003c/li\u003e\n\u003cli\u003eeCO2[ppm]: CO2 동등 농도, ppm(백만분의 1) 단위로 측정\u003c/li\u003e\n\u003cli\u003eRaw H2: 주위에 존재하는 생수소의 양 [보정되지 않은 생 분자수소; 바이어스, 온도 등을 보정한 것이 아님]\u003c/li\u003e\n\u003cli\u003eRaw Ethanol: 주위에 존재하는 생 에탄올의 양\u003c/li\u003e\n\u003cli\u003ePressure[hPa]: 대기압, hPa로 측정\u003c/li\u003e\n\u003cli\u003ePM1.0: 지름이 1.0 마이크로미터 미만인 미립자\u003c/li\u003e\n\u003cli\u003ePM2.5: 지름이 2.5 마이크로미터 미만인 미립자\u003c/li\u003e\n\u003cli\u003eNC0.5: 지름이 0.5 마이크로미터 미만인 미립자의 농도\u003c/li\u003e\n\u003cli\u003eNC1.0: 지름이 1.0 마이크로미터 미만인 미립자의 농도\u003c/li\u003e\n\u003cli\u003eNC2.5: 지름이 2.5 마이크로미터 미만인 미립자의 농도\u003c/li\u003e\n\u003cli\u003eCNT: 샘플 카운트. 화재 경보(실제) 화재가 발생했을 경우 값은 1, 그렇지 않으면 0\u003c/li\u003e\n\u003cli\u003eFire Alarm: 1은 양성, 0은 양성이 아님\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch1\u003e데이터 처리\u003c/h1\u003e\n\u003cp\u003e모델링을 수행하기 전 데이터셋 처리. 필요한 변수 선택하고 CNT, Sample Count 변수는 선택하지 않습니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eraw_data %\u003e%\n  \u003cspan class=\"hljs-title function_\"\u003eselect\u003c/span\u003e(\n         temp_c = \u003cspan class=\"hljs-string\"\u003e`Temperature[C]`\u003c/span\u003e,\n         humidity = \u003cspan class=\"hljs-string\"\u003e`Humidity[%]`\u003c/span\u003e,\n         tvoc = \u003cspan class=\"hljs-string\"\u003e`TVOC[ppb]`\u003c/span\u003e,\n         co2 = \u003cspan class=\"hljs-string\"\u003e`eCO2[ppm]`\u003c/span\u003e,\n         h2 = \u003cspan class=\"hljs-string\"\u003e`Raw H2`\u003c/span\u003e,\n         ethanol = \u003cspan class=\"hljs-string\"\u003e`Raw Ethanol`\u003c/span\u003e,\n         pressure = \u003cspan class=\"hljs-string\"\u003e`Pressure[hPa]`\u003c/span\u003e,\n         pm1 = \u003cspan class=\"hljs-title class_\"\u003ePM1\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e,\n         pm2_5 = \u003cspan class=\"hljs-title class_\"\u003ePM2\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.5\u003c/span\u003e,\n         fire_alarm = \u003cspan class=\"hljs-string\"\u003e`Fire Alarm`\u003c/span\u003e\n         ) %\u003e%\n  \u003cspan class=\"hljs-title function_\"\u003emutate\u003c/span\u003e(\n    fire_alarm = \u003cspan class=\"hljs-title function_\"\u003efactor\u003c/span\u003e(fire_alarm, levels = \u003cspan class=\"hljs-title function_\"\u003ec\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e), labels = \u003cspan class=\"hljs-title function_\"\u003ec\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"yes\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"no\"\u003c/span\u003e))\n  ) %\u003e%\n  \u003cspan class=\"hljs-title function_\"\u003eglimpse\u003c/span\u003e() -\u003e df_data\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-title class_\"\u003eRows\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e62\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e630\u003c/span\u003e\n\u003cspan class=\"hljs-title class_\"\u003eColumns\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e\n$ temp_c     \u0026#x3C;dbl\u003e \u003cspan class=\"hljs-number\"\u003e20.000\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e20.015\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e20.029\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e20.044\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e20.059\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e20.073\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e20.08\u003c/span\u003e…\n$ humidity   \u0026#x3C;dbl\u003e \u003cspan class=\"hljs-number\"\u003e57.36\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e56.67\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e55.96\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e55.28\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e54.69\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e54.12\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e53.61\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e53.2\u003c/span\u003e…\n$ tvoc       \u0026#x3C;dbl\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e,…\n$ co2        \u0026#x3C;dbl\u003e \u003cspan class=\"hljs-number\"\u003e400\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e400\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e400\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e400\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e400\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e400\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e400\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e400\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e400\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e400\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e400\u003c/span\u003e…\n$ h2         \u0026#x3C;dbl\u003e \u003cspan class=\"hljs-number\"\u003e12306\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e12345\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e12374\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e12390\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e12403\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e12419\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e12432\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1243\u003c/span\u003e…\n$ ethanol    \u0026#x3C;dbl\u003e \u003cspan class=\"hljs-number\"\u003e18520\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e18651\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e18764\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e18849\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e18921\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e18998\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e19058\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1911\u003c/span\u003e…\n$ pressure   \u0026#x3C;dbl\u003e \u003cspan class=\"hljs-number\"\u003e939.735\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e939.744\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e939.738\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e939.736\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e939.744\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e939.725\u003c/span\u003e,…\n$ pm1        \u0026#x3C;dbl\u003e \u003cspan class=\"hljs-number\"\u003e0.00\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0.00\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0.00\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0.00\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0.00\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0.00\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0.00\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0.00\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0.00\u003c/span\u003e,…\n$ pm2_5      \u0026#x3C;dbl\u003e \u003cspan class=\"hljs-number\"\u003e0.00\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0.00\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0.00\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0.00\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0.00\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0.00\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0.00\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0.00\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0.00\u003c/span\u003e,…\n$ fire_alarm \u0026#x3C;fct\u003e no, no, no, no, no, no, no, no, no, no, no, no, no, n…\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e상관 관계 플롯을 수행\u003c/p\u003e\n\u003cimg src=\"/assets/img/2024-06-20-ClassificationModelinRwithCaretPackage_1.png\"\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e상관 행렬을 기반으로 통찰력을 얻을 수 있습니다:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e대상 특징과 다른 특징 간에는 높은 상관 관계가 없습니다. 대상 특징과 습도, 압력 사이에 약한 양의 상관 관계가 있습니다. 또한 대상 특징과 TVOC, 원무 에탄올 간에는 약한 음의 상관 관계가 있습니다.\u003c/li\u003e\n\u003cli\u003eeCO2와 TVOC, PM1.0 간에는 높은 양의 상관 관계가 있습니다. 또한 압력과 습도, 원시 H2와 원시 에탄올, PM1.0과 eCO2, PM2.5 간에도 높은 양의 상관 관계가 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1\u003e데이터 분할\u003c/h1\u003e\n\u003cp\u003e데이터를 학습 및 테스트 데이터셋으로 8:2의 비율로 분할합니다. 일반적으로 더 큰 데이터셋에서 학습하는 모델이 더 정확해지지만, 더 많은 학습 데이터는 모델을 학습하는 데 더 많은 시간이 걸릴 수 있습니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e우리의 데이터를 나누기 위해 caret 패키지의 createDataPartition()를 사용할 거에요. 이 함수는 넘겨주는 벡터의 인덱스들을 비례에 따라 랜덤하게 샘플링합니다. 그런 다음 이러한 인덱스를 사용하여 전체 데이터셋을 테스트 및 트레이닝 데이터셋으로 나눌 수 있어요.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# 랜덤 시드 설정\nset.\u003cspan class=\"hljs-title function_\"\u003eseed\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e123\u003c/span\u003e)\n\n# 데이터 분할\ntrain_index \u0026#x3C;- \u003cspan class=\"hljs-title function_\"\u003ecreateDataPartition\u003c/span\u003e(df_data$fire_alarm, times = \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, p = \u003cspan class=\"hljs-number\"\u003e0.8\u003c/span\u003e, list = \u003cspan class=\"hljs-variable constant_\"\u003eFALSE\u003c/span\u003e)\n\ntrain_data \u0026#x3C;- df_data[train_index, ] %\u003e% glimpse\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# 테스트 데이터\ntest_data \u0026#x3C;- df_data[-train_index, ] %\u003e% glimpse\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch1\u003e모델 개발\u003c/h1\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e저희가 데이터에 어떤 알고리즘이 잘 동작할지 미리 알 수 없어요. 다양한 방법을 시험해보고 어떤 것이 잘되는지 보고, 그런 방법을 두드려야 해요.\u003c/p\u003e\n\u003ch2\u003e선형 알고리즘:\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e로지스틱 회귀 (LG),\u003c/li\u003e\n\u003cli\u003e선형 판별 분석 (LDA)\u003c/li\u003e\n\u003cli\u003e정규화된 로지스틱 회귀 (GLMNET)\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003ch2\u003e비선형 알고리즘:\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003ek-최근접 이웃 알고리즘(KNN),\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e분류 및 회귀 트리(CART),\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e나이브 베이즈(NB),\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e방사 기저 함수를 사용한 서포트 벡터 머신(SVM).\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e데이터가 많으므로 10-fold 교차 검증과 3회 반복을 사용할 것입니다. 이는 표준 테스트 하네스 구성입니다. 여러분의 이진 분류 문제에 대해 간단하게 정확도와 Kappa 지표를 사용할 것입니다. AUC(ROC 곡선 아래 영역)를 선택하고 민감도 및 특이도를 살펴 최적의 알고리즘을 선택할 수도 있었습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e-fold cross validation \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e repeats\ntrainControl \u0026#x3C;- \u003cspan class=\"hljs-title function_\"\u003etrainControl\u003c/span\u003e(method=\u003cspan class=\"hljs-string\"\u003e\"repeatedcv\"\u003c/span\u003e, number=\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e, repeats=\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e, verboseIter = \u003cspan class=\"hljs-variable constant_\"\u003eTRUE\u003c/span\u003e)\n\nmetric \u0026#x3C;- \u003cspan class=\"hljs-string\"\u003e\"Accuracy\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e그런 다음, 각 알고리즘에 대한 모델을 작성합니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# \u003cspan class=\"hljs-title class_\"\u003eBagged\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eCART\u003c/span\u003e\nset.\u003cspan class=\"hljs-title function_\"\u003eseed\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e)\nfit.\u003cspan class=\"hljs-property\"\u003etreebag\u003c/span\u003e \u0026#x3C;- \u003cspan class=\"hljs-title function_\"\u003etrain\u003c/span\u003e(fire_alarm~., data = train_data, method = \u003cspan class=\"hljs-string\"\u003e\"treebag\"\u003c/span\u003e, metric = metric,trControl = trainControl)\n\n# \u003cspan class=\"hljs-variable constant_\"\u003eRF\u003c/span\u003e\nset.\u003cspan class=\"hljs-title function_\"\u003eseed\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e)\nfit.\u003cspan class=\"hljs-property\"\u003erf\u003c/span\u003e \u0026#x3C;- \u003cspan class=\"hljs-title function_\"\u003etrain\u003c/span\u003e(fire_alarm~., data = train_data, method = \u003cspan class=\"hljs-string\"\u003e\"rf\"\u003c/span\u003e, metric = metric,trControl = trainControl)\n\n# \u003cspan class=\"hljs-variable constant_\"\u003eGBM\u003c/span\u003e - \u003cspan class=\"hljs-title class_\"\u003eStochastic\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eGradient\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eBoosting\u003c/span\u003e\nset.\u003cspan class=\"hljs-title function_\"\u003eseed\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e)\nfit.\u003cspan class=\"hljs-property\"\u003egbm\u003c/span\u003e \u0026#x3C;- \u003cspan class=\"hljs-title function_\"\u003etrain\u003c/span\u003e(fire_alarm~., data = train_data, method = \u003cspan class=\"hljs-string\"\u003e\"gbm\"\u003c/span\u003e,metric = metric,trControl = trainControl, verbose = \u003cspan class=\"hljs-variable constant_\"\u003eFALSE\u003c/span\u003e)\n\n# \u003cspan class=\"hljs-variable constant_\"\u003eC5\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\nset.\u003cspan class=\"hljs-title function_\"\u003eseed\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e)\nfit.\u003cspan class=\"hljs-property\"\u003ec50\u003c/span\u003e \u0026#x3C;- \u003cspan class=\"hljs-title function_\"\u003etrain\u003c/span\u003e(fire_alarm~., data = train_data, method = \u003cspan class=\"hljs-string\"\u003e\"C5.0\"\u003c/span\u003e, metric = metric,trControl = trainControl)\n\n# \u003cspan class=\"hljs-variable constant_\"\u003eLG\u003c/span\u003e - \u003cspan class=\"hljs-title class_\"\u003eLogistic\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eRegression\u003c/span\u003e\nset.\u003cspan class=\"hljs-title function_\"\u003eseed\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e)\nfit.\u003cspan class=\"hljs-property\"\u003eglm\u003c/span\u003e \u0026#x3C;- \u003cspan class=\"hljs-title function_\"\u003etrain\u003c/span\u003e(fire_alarm~., data = train_data, method=\u003cspan class=\"hljs-string\"\u003e\"glm\"\u003c/span\u003e,\n                 metric=metric,trControl=trainControl)\n# \u003cspan class=\"hljs-variable constant_\"\u003eLDA\u003c/span\u003e - \u003cspan class=\"hljs-title class_\"\u003eLinear\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eDiscriminate\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eAnalysis\u003c/span\u003e\nset.\u003cspan class=\"hljs-title function_\"\u003eseed\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e)\nfit.\u003cspan class=\"hljs-property\"\u003elda\u003c/span\u003e \u0026#x3C;- \u003cspan class=\"hljs-title function_\"\u003etrain\u003c/span\u003e(fire_alarm~., data = train_data, method=\u003cspan class=\"hljs-string\"\u003e\"lda\"\u003c/span\u003e,\n                 metric=metric,trControl=trainControl)\n\n# \u003cspan class=\"hljs-variable constant_\"\u003eGLMNET\u003c/span\u003e - \u003cspan class=\"hljs-title class_\"\u003eRegularized\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eLogistic\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eRegression\u003c/span\u003e\nset.\u003cspan class=\"hljs-title function_\"\u003eseed\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e)\nfit.\u003cspan class=\"hljs-property\"\u003eglmnet\u003c/span\u003e \u0026#x3C;- \u003cspan class=\"hljs-title function_\"\u003etrain\u003c/span\u003e(fire_alarm~., data = train_data, method=\u003cspan class=\"hljs-string\"\u003e\"glmnet\"\u003c/span\u003e,\n                 metric=metric,trControl=trainControl)\n\n# \u003cspan class=\"hljs-variable constant_\"\u003eKNN\u003c/span\u003e - k-\u003cspan class=\"hljs-title class_\"\u003eNearest\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eNeighbors\u003c/span\u003e \nset.\u003cspan class=\"hljs-title function_\"\u003eseed\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e)\nfit.\u003cspan class=\"hljs-property\"\u003eknn\u003c/span\u003e \u0026#x3C;- \u003cspan class=\"hljs-title function_\"\u003etrain\u003c/span\u003e(fire_alarm~., data = train_data, method=\u003cspan class=\"hljs-string\"\u003e\"knn\"\u003c/span\u003e,\n                 metric=metric,trControl=trainControl)\n\n# \u003cspan class=\"hljs-variable constant_\"\u003eCART\u003c/span\u003e - \u003cspan class=\"hljs-title class_\"\u003eClassification\u003c/span\u003e and \u003cspan class=\"hljs-title class_\"\u003eRegression\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eTrees\u003c/span\u003e (\u003cspan class=\"hljs-variable constant_\"\u003eCART\u003c/span\u003e), \nset.\u003cspan class=\"hljs-title function_\"\u003eseed\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e)\nfit.\u003cspan class=\"hljs-property\"\u003ecart\u003c/span\u003e \u0026#x3C;- \u003cspan class=\"hljs-title function_\"\u003etrain\u003c/span\u003e(fire_alarm~., data = train_data, method=\u003cspan class=\"hljs-string\"\u003e\"rpart\"\u003c/span\u003e,\n                 metric=metric,trControl=trainControl)\n\n# \u003cspan class=\"hljs-variable constant_\"\u003eNB\u003c/span\u003e - \u003cspan class=\"hljs-title class_\"\u003eNaive\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eBayes\u003c/span\u003e (\u003cspan class=\"hljs-variable constant_\"\u003eNB\u003c/span\u003e) \nset.\u003cspan class=\"hljs-title function_\"\u003eseed\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e)\n\u003cspan class=\"hljs-title class_\"\u003eGrid\u003c/span\u003e = expand.\u003cspan class=\"hljs-title function_\"\u003egrid\u003c/span\u003e(usekernel=\u003cspan class=\"hljs-variable constant_\"\u003eTRUE\u003c/span\u003e,adjust=\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,fL=\u003cspan class=\"hljs-title function_\"\u003ec\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0.2\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e0.5\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e0.8\u003c/span\u003e))\nfit.\u003cspan class=\"hljs-property\"\u003enb\u003c/span\u003e \u0026#x3C;- \u003cspan class=\"hljs-title function_\"\u003etrain\u003c/span\u003e(fire_alarm~., data = train_data, method=\u003cspan class=\"hljs-string\"\u003e\"nb\"\u003c/span\u003e,\n                 metric=metric,trControl=trainControl,\n                tuneGrid=\u003cspan class=\"hljs-title class_\"\u003eGrid\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e모델을 구축한 후에는 모델을 비교하여 더 나은 정확도를 찾을 수 있어요! 😊\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-title class_\"\u003eCall\u003c/span\u003e:\nsummary.\u003cspan class=\"hljs-title function_\"\u003eresamples\u003c/span\u003e(object = ensembleResults)\n\n\u003cspan class=\"hljs-title class_\"\u003eModels\u003c/span\u003e: \u003cspan class=\"hljs-variable constant_\"\u003eBAG\u003c/span\u003e, \u003cspan class=\"hljs-variable constant_\"\u003eRF\u003c/span\u003e, \u003cspan class=\"hljs-variable constant_\"\u003eGBM\u003c/span\u003e, \u003cspan class=\"hljs-variable constant_\"\u003eC50\u003c/span\u003e, \u003cspan class=\"hljs-variable constant_\"\u003eLG\u003c/span\u003e, \u003cspan class=\"hljs-variable constant_\"\u003eKNN\u003c/span\u003e, \u003cspan class=\"hljs-variable constant_\"\u003eNB\u003c/span\u003e, \u003cspan class=\"hljs-variable constant_\"\u003eCART\u003c/span\u003e, \u003cspan class=\"hljs-variable constant_\"\u003eGLMNET\u003c/span\u003e \n\u003cspan class=\"hljs-title class_\"\u003eNumber\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eof\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eresamples\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e \n\n정확도 \n            \u003cspan class=\"hljs-title class_\"\u003eMin\u003c/span\u003e.   1st \u003cspan class=\"hljs-title class_\"\u003eQu\u003c/span\u003e.    \u003cspan class=\"hljs-title class_\"\u003eMedian\u003c/span\u003e      \u003cspan class=\"hljs-title class_\"\u003eMean\u003c/span\u003e   3rd \u003cspan class=\"hljs-title class_\"\u003eQu\u003c/span\u003e.      \u003cspan class=\"hljs-title class_\"\u003eMax\u003c/span\u003e. \u003cspan class=\"hljs-variable constant_\"\u003eNA\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e's\nBAG    0.9994013 0.9998004 0.9998004 0.9998337 1.0000000 1.0000000    0\nRF     0.9996008 0.9998004 1.0000000 0.9999202 1.0000000 1.0000000    0\nGBM    0.9986028 0.9996008 0.9998004 0.9996407 0.9998004 1.0000000    0\nC50    0.9992014 0.9996009 0.9998004 0.9998071 1.0000000 1.0000000    0\nLG     0.8467372 0.8629515 0.8861393 0.8797790 0.8933134 0.9030134    0\nKNN    0.9990018 0.9996007 0.9998004 0.9996341 0.9998004 1.0000000    0\nNB     0.9417282 0.9443613 0.9463074 0.9470978 0.9505089 0.9527041    0\nCART   0.9590900 0.9654244 0.9809419 0.9754183 0.9829849 0.9896208    0\nGLMNET 0.8848303 0.8931245 0.8957294 0.8954128 0.8985681 0.9026142    0\n\n카파 \n            Min.   1st Qu.    Median      Mean   3rd Qu.      Max. NA'\u003c/span\u003es\n\u003cspan class=\"hljs-variable constant_\"\u003eBAG\u003c/span\u003e    \u003cspan class=\"hljs-number\"\u003e0.9985319\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.9995105\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.9995106\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.9995922\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1.0000000\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1.0000000\u003c/span\u003e    \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eRF\u003c/span\u003e     \u003cspan class=\"hljs-number\"\u003e0.9990214\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.9995107\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1.0000000\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.9998043\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1.0000000\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1.0000000\u003c/span\u003e    \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eGBM\u003c/span\u003e    \u003cspan class=\"hljs-number\"\u003e0.9965712\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.9990210\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.9995105\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.9991189\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.9995106\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1.0000000\u003c/span\u003e    \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eC50\u003c/span\u003e    \u003cspan class=\"hljs-number\"\u003e0.9980418\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.9990214\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.9995107\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.9995269\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1.0000000\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1.0000000\u003c/span\u003e    \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eLG\u003c/span\u003e     \u003cspan class=\"hljs-number\"\u003e0.6691273\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.6941347\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.7051705\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.7105437\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.7312704\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.7512402\u003c/span\u003e    \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eKNN\u003c/span\u003e    \u003cspan class=\"hljs-number\"\u003e0.9975507\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.9990206\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.9995106\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.9991025\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.9995106\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1.0000000\u003c/span\u003e    \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eNB\u003c/span\u003e     \u003cspan class=\"hljs-number\"\u003e0.8632215\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.8695786\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.8735418\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.8754793\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.8834493\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.8880163\u003c/span\u003e    \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eCART\u003c/span\u003e   \u003cspan class=\"hljs-number\"\u003e0.8997615\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.9156698\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.9523262\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.9397203\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.9575309\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.9747781\u003c/span\u003e    \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003cspan class=\"hljs-variable constant_\"\u003eGLMNET\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.7052235\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.7262274\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.7346055\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.7332479\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.7403128\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.7496404\u003c/span\u003e    \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cimg src=\"/assets/img/2024-06-20-ClassificationModelinRwithCaretPackage_2.png\"\u003e\n\u003cp\u003e랜덤 포레스트가 가장 높은 정확도(99.99%)를 보이며, 그 다음으로 BAG (Bagged CART) (99.98%)와 C5.0 (99.93%)이 뒤를 이어요! 🚀🌟\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003ch1\u003e모델 완성\u003c/h1\u003e\n\u003cp\u003e높은 정확도를 가진 트리 알고리즘인 Random Forest, BAG, 그리고 C5.0를 선택하여 예측을 진행할 것이며, 테스트 데이터셋으로 모델 및 정확도를 테스트할 예정입니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# 모델 저장\n\u003cspan class=\"hljs-title function_\"\u003esaveRDS\u003c/span\u003e(fit.\u003cspan class=\"hljs-property\"\u003ec50\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ehere\u003c/span\u003e::\u003cspan class=\"hljs-title function_\"\u003ehere\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"finalModel_c50.rds\"\u003c/span\u003e))\n\u003cspan class=\"hljs-title function_\"\u003esaveRDS\u003c/span\u003e(fit.\u003cspan class=\"hljs-property\"\u003erf\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ehere\u003c/span\u003e::\u003cspan class=\"hljs-title function_\"\u003ehere\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"finalModel_rf.rds\"\u003c/span\u003e))\n\u003cspan class=\"hljs-title function_\"\u003esaveRDS\u003c/span\u003e(fit.\u003cspan class=\"hljs-property\"\u003etreebag\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ehere\u003c/span\u003e::\u003cspan class=\"hljs-title function_\"\u003ehere\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"finalModel_treebag.rds\"\u003c/span\u003e))\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003epredict_c50 \u0026#x3C;- \u003cspan class=\"hljs-title function_\"\u003epredict\u003c/span\u003e(model_c50, test_data)\n\u003cspan class=\"hljs-title function_\"\u003esummary\u003c/span\u003e(predict_c50)\n\n# 혼동 행렬\ncf_c50 \u0026#x3C;- \u003cspan class=\"hljs-title function_\"\u003econfusionMatrix\u003c/span\u003e(predict_c50, test_data$fire_alarm)\n\ncf_c50\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e예   아니요 \n\u003cspan class=\"hljs-number\"\u003e8950\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3575\u003c/span\u003e \n혼동 행렬 및 통계\n\n          참조\n예측     예    아니요\n       예 \u003cspan class=\"hljs-number\"\u003e8949\u003c/span\u003e    \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n       아니요     \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3573\u003c/span\u003e\n                                     \n              정확도 : \u003cspan class=\"hljs-number\"\u003e0.9998\u003c/span\u003e     \n                 \u003cspan class=\"hljs-number\"\u003e95\u003c/span\u003e% 신뢰구간 : (\u003cspan class=\"hljs-number\"\u003e0.9993\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n    정보 부재율 : \u003cspan class=\"hljs-number\"\u003e0.7147\u003c/span\u003e     \n    P-값 [정확도 \u003e 정보 부재율] : \u003cspan class=\"xml\"\u003e\u0026#x3C;2e-16     \n                                     \n                  카파 : 0.9994     \n                                     \n 맥네마의 검정 P-값 : 1          \n                                      \n            민감도 : 0.9998     \n            특이도 : 0.9997     \n         양성 예측치 : 0.9999     \n         음성 예측치 : 0.9994     \n             유병률 : 0.7147     \n         발견 비율 : 0.7145     \n   발견 유병률 : 0.7146     \n      균형 정확도 : 0.9997     \n                                     \n     '양성' 클래스 : 예\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e랜덤 포레스트 모델을 로드하고 테스트 데이터로 예측을 생성합니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# 의사결정 트리 랜덤 포레스트\nmodel_rf \u0026#x3C;- \u003cspan class=\"hljs-title function_\"\u003ereadRDS\u003c/span\u003e(\u003cspan class=\"hljs-attr\"\u003ehere\u003c/span\u003e::\u003cspan class=\"hljs-title function_\"\u003ehere\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"finalModel_rf.rds\"\u003c/span\u003e))\n\u003cspan class=\"hljs-title function_\"\u003eprint\u003c/span\u003e(model_rf)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e랜덤 포레스트 \n\n\u003cspan class=\"hljs-number\"\u003e50105\u003c/span\u003e 개 샘플\n    \u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e 예측 변수\n    \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e 클래스: \u003cspan class=\"hljs-string\"\u003e'예'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'아니요'\u003c/span\u003e \n\n사전 처리 없음\n샘플링: 교차 검증 (\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e-fold, \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e회 반복) \n샘플 크기 요약: \u003cspan class=\"hljs-number\"\u003e45095\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e45094\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e45094\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e45094\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e45095\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e45094\u003c/span\u003e, ... \n튜닝 매개변수에 따른 샘플링 결과:\n\n  mtry  정확도   카파    \n  \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e     \u003cspan class=\"hljs-number\"\u003e0.9999202\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e0.9998043\u003c/span\u003e\n  \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e     \u003cspan class=\"hljs-number\"\u003e0.9999202\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e0.9998043\u003c/span\u003e\n  \u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e     \u003cspan class=\"hljs-number\"\u003e0.9998736\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e0.9996901\u003c/span\u003e\n\n가장 큰 값을 사용하여 최적 모델을 선택하는 데 정확도가 사용되었습니다.\n모델에 사용된 최종 값은 mtry = \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e입니다.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-R\"\u003epredict_rf \u003cspan class=\"hljs-operator\"\u003e\u0026#x3C;-\u003c/span\u003e predict\u003cspan class=\"hljs-punctuation\"\u003e(\u003c/span\u003emodel_rf\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e test_data\u003cspan class=\"hljs-punctuation\"\u003e)\u003c/span\u003e\nsummary\u003cspan class=\"hljs-punctuation\"\u003e(\u003c/span\u003epredict_rf\u003cspan class=\"hljs-punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e# Confusion Matrix\u003c/span\u003e\ncf_rf \u003cspan class=\"hljs-operator\"\u003e\u0026#x3C;-\u003c/span\u003e confusionMatrix\u003cspan class=\"hljs-punctuation\"\u003e(\u003c/span\u003epredict_rf\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e test_data\u003cspan class=\"hljs-operator\"\u003e$\u003c/span\u003efire_alarm\u003cspan class=\"hljs-punctuation\"\u003e)\u003c/span\u003e\n\ncf_rf\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-R\"\u003eyes   no \n\u003cspan class=\"hljs-number\"\u003e8952\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3573\u003c/span\u003e \nConfusion Matrix and Statistics\n\n          Reference\nPrediction  yes   no\n       yes \u003cspan class=\"hljs-number\"\u003e8951\u003c/span\u003e    \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n       no     \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3573\u003c/span\u003e\n                                     \n               Accuracy \u003cspan class=\"hljs-operator\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.9999\u003c/span\u003e     \n                 \u003cspan class=\"hljs-number\"\u003e95\u003c/span\u003e% CI \u003cspan class=\"hljs-operator\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e0.9996\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e)\u003c/span\u003e\n    No Information Rate \u003cspan class=\"hljs-operator\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.7147\u003c/span\u003e     \n    P\u003cspan class=\"hljs-operator\"\u003e-\u003c/span\u003eValue \u003cspan class=\"hljs-punctuation\"\u003e[\u003c/span\u003eAcc \u003cspan class=\"hljs-operator\"\u003e\u003e\u003c/span\u003e NIR\u003cspan class=\"hljs-punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e2e-16\u003c/span\u003e     \n                                     \n                  Kappa \u003cspan class=\"hljs-operator\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.9998\u003c/span\u003e     \n                                     \n Mcnemar\u003cspan class=\"hljs-string\"\u003e's Test P-Value : 1          \n                                     \n            Sensitivity : 1.0000     \n            Specificity : 0.9997     \n         Pos Pred Value : 0.9999     \n         Neg Pred Value : 1.0000     \n             Prevalence : 0.7147     \n         Detection Rate : 0.7147     \n   Detection Prevalence : 0.7147     \n      Balanced Accuracy : 0.9999     \n                                     \n       '\u003c/span\u003ePositive\u003cspan class=\"hljs-string\"\u003e' Class : yes\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eBagged CART 모델 로드하기\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-R\"\u003e\u003cspan class=\"hljs-comment\"\u003e# 분류 및 회귀 트리 (CART)\u003c/span\u003e\nmodel_treebag \u003cspan class=\"hljs-operator\"\u003e\u0026#x3C;-\u003c/span\u003e readRDS\u003cspan class=\"hljs-punctuation\"\u003e(\u003c/span\u003ehere\u003cspan class=\"hljs-operator\"\u003e::\u003c/span\u003ehere\u003cspan class=\"hljs-punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e\"finalModel_treebag.rds\"\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e)\u003c/span\u003e\n\nprint\u003cspan class=\"hljs-punctuation\"\u003e(\u003c/span\u003emodel_treebag\u003cspan class=\"hljs-punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-title class_\"\u003eBagged\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eCART\u003c/span\u003e \n\n\u003cspan class=\"hljs-number\"\u003e50105\u003c/span\u003e 개의 샘플\n    \u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e 개의 예측 변수\n    \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e 개의 클래스: \u003cspan class=\"hljs-string\"\u003e'yes'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'no'\u003c/span\u003e \n\n사전 처리 없음\n리샘플링: 교차 확인(\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e 폴드, \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e회 반복) \n샘플 크기 요약: \u003cspan class=\"hljs-number\"\u003e45095\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e45094\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e45094\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e45094\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e45095\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e45094\u003c/span\u003e, ... \n리샘플링 결과:\n\n  정확도   카파    \n  \u003cspan class=\"hljs-number\"\u003e0.9998337\u003c/span\u003e  \u003cspan class=\"hljs-number\"\u003e0.9995922\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003epredict_treebag \u0026#x3C;- \u003cspan class=\"hljs-title function_\"\u003epredict\u003c/span\u003e(model_treebag, test_data)\n\u003cspan class=\"hljs-title function_\"\u003esummary\u003c/span\u003e(predict_treebag)\n\n# 혼동 행렬\ncf_treebag \u0026#x3C;- \u003cspan class=\"hljs-title function_\"\u003econfusionMatrix\u003c/span\u003e(predict_treebag, test_data$fire_alarm)\n\ncf_treebag\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-title class_\"\u003eConfusion\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eMatrix\u003c/span\u003e and \u003cspan class=\"hljs-title class_\"\u003eStatistics\u003c/span\u003e\n\n          실제값\n예측값   yes   no\n       yes \u003cspan class=\"hljs-number\"\u003e8951\u003c/span\u003e    \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\n       no     \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3572\u003c/span\u003e\n                                     \n               정확도 : \u003cspan class=\"hljs-number\"\u003e0.9998\u003c/span\u003e     \n                 \u003cspan class=\"hljs-number\"\u003e95\u003c/span\u003e% 신뢰 구간 : (\u003cspan class=\"hljs-number\"\u003e0.9994\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n    정보 없는 비율 : \u003cspan class=\"hljs-number\"\u003e0.7147\u003c/span\u003e     \n    P-값 [정확도 \u003e 정보 없는 비율] : \u003cspan class=\"xml\"\u003e\u0026#x3C;2e-16     \n                                     \n                  카파 : 0.9996     \n                                     \n 맥네머의 테스트 P-값 : 0.4795     \n                                     \n            민감도 : 1.0000     \n            특이도 : 0.9994     \n         양성 예측 값 : 0.9998     \n         음성 예측 값 : 1.0000     \n             유병률 : 0.7147     \n         감지율 : 0.7147     \n   감지 유병률 : 0.7148     \n      균형 정확도 : 0.9997     \n                                     \n       '양성' 클래스 : yes\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e자세한 내용은 깃허브 저장소를 방문해 주세요. 이 절을 읽어 주셔서 감사합니다.\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-06-20-ClassificationModelinRwithCaretPackage"},"buildId":"QYe6gFAUryFKFgjKBoIfo","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>