<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>홈 어시스턴트의 템플릿 파워 언락하기 | itposting</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://itposting.github.io///post/2024-05-27-UnlockingthePowerofTemplatesinHomeAssistant" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="홈 어시스턴트의 템플릿 파워 언락하기 | itposting" data-gatsby-head="true"/><meta property="og:title" content="홈 어시스턴트의 템플릿 파워 언락하기 | itposting" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-05-27-UnlockingthePowerofTemplatesinHomeAssistant_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://itposting.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://itposting.github.io///post/2024-05-27-UnlockingthePowerofTemplatesinHomeAssistant" data-gatsby-head="true"/><meta name="twitter:title" content="홈 어시스턴트의 템플릿 파워 언락하기 | itposting" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-05-27-UnlockingthePowerofTemplatesinHomeAssistant_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | itposting" data-gatsby-head="true"/><meta name="article:published_time" content="2024-05-27 13:20" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-23YXDLKDCL"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-23YXDLKDCL');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/acd99c507555fdc6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/acd99c507555fdc6.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-4a646156c659a948.js" defer=""></script><script src="/_next/static/chunks/348-d11c34b645b13f5b.js" defer=""></script><script src="/_next/static/chunks/162-4172e84c8e2aa747.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-0fd008072af5a644.js" defer=""></script><script src="/_next/static/O5JVeK6TDhbvSxBlchQwM/_buildManifest.js" defer=""></script><script src="/_next/static/O5JVeK6TDhbvSxBlchQwM/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">IT Posting</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">홈 어시스턴트의 템플릿 파워 언락하기</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="홈 어시스턴트의 템플릿 파워 언락하기" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">IT Posting</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On May 27, 2024</span><span class="posts_reading_time__f7YPP">6<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-05-27-UnlockingthePowerofTemplatesinHomeAssistant&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<p><img src="/assets/img/2024-05-27-UnlockingthePowerofTemplatesinHomeAssistant_0.png" alt="2024-05-27-UnlockingthePowerofTemplatesinHomeAssistant_0.png"></p>
<p>템플릿은 홈 어시스턴트에서 제공되는 가장 강력한 도구 중 하나입니다. 센서를 생성하거나 자동화 트리거를 설정하고 자동화 조건을 정의하며 등등 다양한 용도로 활용할 수 있습니다. 그러나 많은 홈 어시스턴트 사용자들이 잠재력을 충분히 활용하지 못하고 있습니다. 최근 몇 년간 홈 어시스턴트팀이 더 사용자 친화적이고 UI 기반의 설정으로 진화함에 따라 대부분의 사용자들이 템플릿을 더 적게 사용하게 되었습니다. 그러나 템플릿은 UI만으로는 어려운 사용자 정의 및 자동화 수준을 제공합니다.</p>
<p>홈 어시스턴트의 포괄적인 문서는 템플릿의 여러 일반적인 사용 사례를 다루고 있습니다. 게다가 홈 어시스턴트의 "개발자 도구" 섹션에 전용 템플릿 편집기가 있어 실시간으로 템플릿을 테스트할 수 있습니다. 이 도구는 설정을 배포하기 전에 템플릿을 문제 해결하고 정교화하는 데 매우 유용합니다.</p>
<p>템플릿의 다양성과 강력함을 보여주기 위해 저 자신이 집에서 사용하는 몇 가지 예시를 소개하겠습니다:</p>
<h2>1. 사용자 정의 센서 만들기</h2>
<p>템플릿의 주요 용도 중 하나는 사용자 정의 센서를 만드는 것입니다. 예를 들어, 저는 여러 방의 다른 센서에서 평균 온도를 계산하는 템플릿 센서를 사용합니다. 이는 단일 측정 지점이 아닌 전체 집 온도에 기반한 난방이나 냉방 시스템을 작동하는 데 매우 유용합니다.</p>
<p>간단한 센서 버전부터 시작해 봅시다:</p>
<pre><code class="hljs language-js"><span class="hljs-attr">template</span>:
  - <span class="hljs-attr">sensor</span>:
      - <span class="hljs-attr">name</span>: <span class="hljs-string">"Home Temperature"</span>
        <span class="hljs-attr">unit_of_measurement</span>: <span class="hljs-string">"°C"</span>
        <span class="hljs-attr">state</span>: >
          { (<span class="hljs-title function_">states</span>(<span class="hljs-string">'sensor.living_room_temperature'</span>) | float + 
              <span class="hljs-title function_">states</span>(<span class="hljs-string">'sensor.bedroom_temperature'</span>) | float + 
              <span class="hljs-title function_">states</span>(<span class="hljs-string">'sensor.kitchen_temperature'</span>) | float) / <span class="hljs-number">3</span> }
</code></pre>
<p>이 예제에서는 각각의 온도 센서 상태를 얻어와서 float 숫자 유형으로 변환한 다음 값들을 더하고, 센서의 개수로 나누어 평균을 구하는 방법에 대해 설명합니다. Home Assistant는 모든 센서 값을 문자열로 저장하기 때문에 먼저 이를 숫자 값으로 변환해야 합니다. "| float"는 정확히 그 역할을 합니다. 템플릿 센서에 익숙하지 않은 경우 Home Assistant 공식 통합 페이지에서 기본 사항을 읽어볼 수 있습니다.</p>
<p>우리가 만든 센서는 매우 유연하지 않습니다. 집에 더 많은 온도 센서를 설치하면 해당 센서를 포함하는 템플릿을 수정해야 합니다. 비슷한 센서가 많을 경우 이를 추적하고 수동으로 업데이트하는 것은 항상 쉽지 않습니다. 이상적으로, 템플릿 센서는 Home Assistant에 추가한 모든 온도 센서를 식별하고 템플릿 센서를 동적으로 조정할 수 있어야 합니다. 재밌는 점은, 템플릿으로 이를 할 수 있다는 것입니다:</p>
<pre><code class="hljs language-js"><span class="hljs-attr">template</span>:
  - <span class="hljs-attr">sensor</span>:
      - <span class="hljs-attr">name</span>: <span class="hljs-string">"Home Temperature"</span>
        <span class="hljs-attr">unit_of_measurement</span>: <span class="hljs-string">"°C"</span>
        <span class="hljs-attr">state</span>: >
          { (states.<span class="hljs-property">sensor</span> 
            | <span class="hljs-title function_">selectattr</span>(<span class="hljs-string">'attributes.device_class'</span>, <span class="hljs-string">'eq'</span>,<span class="hljs-string">'temperature'</span>)
            |<span class="hljs-title function_">rejectattr</span>(<span class="hljs-string">'state'</span>,<span class="hljs-string">'in'</span>,<span class="hljs-string">'unavailable,unknown'</span>)
            | <span class="hljs-title function_">map</span>(attribute=<span class="hljs-string">'state'</span>) | <span class="hljs-title function_">map</span>(<span class="hljs-string">'float'</span>, <span class="hljs-number">0</span>)| average)|<span class="hljs-title function_">round</span>(<span class="hljs-number">2</span>) }
</code></pre>
<p>위 코드가 그 역할을 합니다. 먼저 템플릿은 'states.sensor'를 통해 센서 도메인의 모든 엔티티의 상태를 선택한 다음 두 개의 필터를 적용합니다: 첫 번째 필터는 'device_class'가 'temperature'인 엔티티만 포함하고, 두 번째 필터는 'unavailable' 또는 'unknown'인 엔티티를 거부합니다. 해당 엔티티들의 상태를 'float' 숫자로 매핑하고 해당 숫자들의 평균을 취합니다. 마지막으로 결과를 표시하기 전에 소수점 둘째 자리까지 반올림합니다. 따라서 새로운 센서가 추가되거나 어느 하나의 센서가 오프라인 상태가 되면 템플릿이 즉시 재계산되어 센서 값을 변경합니다.</p>
<p>그러나 여기에 작은 문제가 있습니다. 프로세서용 온도 센서도 설정한 경우를 상상해 보죠. 위 템플릿에는 해당 센서의 디바이스 클래스도 'temperature'이기 때문에 이를 평균에 포함시킬 것입니다. 이 문제를 해결할 수 있는 다양한 방법이 있습니다. 이 중 하나는 아래와 같습니다:</p>
<pre><code class="hljs language-js"><span class="hljs-attr">template</span>:
  - <span class="hljs-attr">sensor</span>:
      - <span class="hljs-attr">name</span>: <span class="hljs-string">"Home Temperature"</span>
        <span class="hljs-attr">unit_of_measurement</span>: <span class="hljs-string">"°C"</span>
        <span class="hljs-attr">state</span>: >
          { (states.<span class="hljs-property">sensor</span> 
            | <span class="hljs-title function_">selectattr</span>(<span class="hljs-string">'attributes.device_class'</span>, <span class="hljs-string">'eq'</span>,<span class="hljs-string">'temperature'</span>)
            | <span class="hljs-title function_">rejectattr</span>(<span class="hljs-string">'state'</span>,<span class="hljs-string">'in'</span>,<span class="hljs-string">'unavailable,unknown'</span>)
            | <span class="hljs-title function_">selectattr</span>(<span class="hljs-string">'entity_id'</span>,<span class="hljs-string">'search'</span>,<span class="hljs-string">'room|kitchen'</span>)
            | <span class="hljs-title function_">map</span>(attribute=<span class="hljs-string">'state'</span>) | <span class="hljs-title function_">map</span>(<span class="hljs-string">'float'</span>, <span class="hljs-number">0</span>) | average) | <span class="hljs-title function_">round</span>(<span class="hljs-number">2</span>) }
</code></pre>
<p>내가 한 일은 entity ID에 'room'이나 'kitchen'이 포함된 엔티티만 선택하는 필터를 추가한 것입니다.</p>
<h2>2. 자동화에서</h2>
<pre><code class="hljs language-js">    - 별칭: 배터리 부족 알림
      <span class="hljs-attr">id</span>: <span class="hljs-string">"ag2i86995uix9vt84a6g7699h"</span>
      <span class="hljs-attr">trigger</span>:
        - <span class="hljs-attr">platform</span>: time
          <span class="hljs-attr">at</span>: <span class="hljs-string">"20:00:00"</span>
      <span class="hljs-attr">mode</span>: single
      <span class="hljs-attr">max_exceeded</span>: silent
      <span class="hljs-attr">condition</span>:
        - <span class="hljs-attr">condition</span>: template
          <span class="hljs-attr">value_template</span>: >
            { (states.<span class="hljs-property">sensor</span> 
              | <span class="hljs-title function_">selectattr</span>(<span class="hljs-string">'attributes.device_class'</span>, <span class="hljs-string">'eq'</span>,<span class="hljs-string">'battery'</span>)
              | <span class="hljs-title function_">selectattr</span>(<span class="hljs-string">'attributes.unit_of_measurement'</span>, <span class="hljs-string">'=='</span>, <span class="hljs-string">'%'</span>) 
              |<span class="hljs-title function_">rejectattr</span>(<span class="hljs-string">'state'</span>,<span class="hljs-string">'in'</span>,<span class="hljs-string">'unavailable,unknown'</span>)
              | <span class="hljs-title function_">map</span>(attribute=<span class="hljs-string">'state'</span>) | <span class="hljs-title function_">map</span>(<span class="hljs-string">'int'</span>)
              |<span class="hljs-title function_">select</span>(<span class="hljs-string">'&#x3C;='</span>,<span class="hljs-number">5</span>) |list|length)><span class="hljs-number">0</span> }           
      <span class="hljs-attr">action</span>:
        - <span class="hljs-attr">delay</span>: <span class="hljs-string">"00:30:00"</span>
        - <span class="hljs-attr">service</span>: notify.<span class="hljs-property">telegram_vm</span>
          <span class="hljs-attr">data</span>:
            <span class="hljs-attr">title</span>: <span class="hljs-string">"{ '\U0001F50B' } *낮은 배터리*"</span>
            <span class="hljs-attr">message</span>: >
              { set batteries = states.<span class="hljs-property">sensor</span> 
                | <span class="hljs-title function_">selectattr</span>(<span class="hljs-string">'entity_id'</span>, <span class="hljs-string">'has_value'</span>) 
                |<span class="hljs-title function_">rejectattr</span>(<span class="hljs-string">'state'</span>,<span class="hljs-string">'in'</span>,<span class="hljs-string">'unavailable,unknown'</span>)
                | <span class="hljs-title function_">selectattr</span>(<span class="hljs-string">'attributes.device_class'</span>, <span class="hljs-string">'=='</span>, <span class="hljs-string">'battery'</span>) 
                | <span class="hljs-title function_">selectattr</span>(<span class="hljs-string">'attributes.unit_of_measurement'</span>, <span class="hljs-string">'=='</span>, <span class="hljs-string">'%'</span>) | list }
              { set low_battery = batteries | <span class="hljs-title function_">map</span>(attribute=<span class="hljs-string">'state'</span>) | <span class="hljs-title function_">map</span>(<span class="hljs-string">'int'</span>) | <span class="hljs-title function_">select</span>(<span class="hljs-string">'&#x3C;='</span>, <span class="hljs-number">5</span>) | <span class="hljs-title function_">map</span>(<span class="hljs-string">'string'</span>) | list }
              { batteries | <span class="hljs-title function_">selectattr</span>(<span class="hljs-string">'state'</span>, <span class="hljs-string">'in'</span>, low_battery) | <span class="hljs-title function_">map</span>(attribute=<span class="hljs-string">'name'</span>) | list | <span class="hljs-title function_">join</span>(<span class="hljs-string">'\n'</span>) }
</code></pre>
<p>이 자동화는 매일 오후 8시에 전원이 낮은 장치 목록과 함께 제 텔레그램 메신저로 알림을 보냅니다. (5% 이하의 경우). 조건 부분 및 알림 메시지 만들기 위해 템플릿을 사용합니다. 센서 예제와 마찬가지로 템플릿을 사용하면 동적인 장점이 있습니다. 장치를 추가하거나 제거할 때 아무 것도 변경할 필요가 없습니다.</p>
<p>조건 부분에서는 우선 5% 이하로 충전된 배터리가 있는지 확인하는 템플릿 조건을 사용합니다. 첫째로 템플릿은 '배터리' 장치 클래스 속성과 '%'(율) 단위 측정 속성을 가진 센서를 선택한 후 '이용 불가능' 또는 '알 수 없음'인 센서를 제거합니다. 마지막으로 이러한 센서의 상태를 정수로 매핑하고 값이 5 이하인 센서를 필터링합니다. 다음으로 템플릿은 'length' 필터를 사용하여 해당 센서 수를 계산합니다. 마지막으로 길이가 0보다 큰지(5 미만의 배터리 값을 가진 엔티티가 있는지) 확인합니다.</p>
<p>액션 부분에서 메시지도 유사한 방법을 사용하여 생성됩니다. Home Assistant는 센서 상태를 문자열로 저장하므로 먼저 저전력 배터리 센서 목록을 가져 와서 두 번째 단계에서 해당 센서 이름을 다시 필터링해야 합니다.</p>
<h1>결론</h1>
<p>템플릿은 홈 어시스턴트(Home Assistant)에서 매우 강력한 기능으로, 맞춤화와 유연성을 가능하게 합니다. UI 중심의 설정 트렌드가 홈 어시스턴트를 보다 접근하기 쉽게 만들었지만, 템플릿의 잠재력을 간과해서는 안 됩니다. 템플릿을 활용하여, 반응성이 향상되고 똑똑하며 개인화된 스마트 홈 환경을 만들 수 있습니다.</p>
<p>더 자세한 안내와 예제를 보려면 공식 홈 어시스턴트 문서와 개발자 도구 섹션의 템플릿 편집기를 확인하세요. 템플릿의 힘을 받아들이고, 홈 어시스턴트 설정의 모든 잠재력을 끌어내세요. 템플릿에 관한 질문이나 도움이 필요하다면, 아래에 댓글을 남겨주세요! 기꺼이 도와드리겠습니다.</p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"홈 어시스턴트의 템플릿 파워 언락하기","description":"","date":"2024-05-27 13:20","slug":"2024-05-27-UnlockingthePowerofTemplatesinHomeAssistant","content":"\n\n![2024-05-27-UnlockingthePowerofTemplatesinHomeAssistant_0.png](/assets/img/2024-05-27-UnlockingthePowerofTemplatesinHomeAssistant_0.png)\n\n템플릿은 홈 어시스턴트에서 제공되는 가장 강력한 도구 중 하나입니다. 센서를 생성하거나 자동화 트리거를 설정하고 자동화 조건을 정의하며 등등 다양한 용도로 활용할 수 있습니다. 그러나 많은 홈 어시스턴트 사용자들이 잠재력을 충분히 활용하지 못하고 있습니다. 최근 몇 년간 홈 어시스턴트팀이 더 사용자 친화적이고 UI 기반의 설정으로 진화함에 따라 대부분의 사용자들이 템플릿을 더 적게 사용하게 되었습니다. 그러나 템플릿은 UI만으로는 어려운 사용자 정의 및 자동화 수준을 제공합니다.\n\n홈 어시스턴트의 포괄적인 문서는 템플릿의 여러 일반적인 사용 사례를 다루고 있습니다. 게다가 홈 어시스턴트의 \"개발자 도구\" 섹션에 전용 템플릿 편집기가 있어 실시간으로 템플릿을 테스트할 수 있습니다. 이 도구는 설정을 배포하기 전에 템플릿을 문제 해결하고 정교화하는 데 매우 유용합니다.\n\n템플릿의 다양성과 강력함을 보여주기 위해 저 자신이 집에서 사용하는 몇 가지 예시를 소개하겠습니다:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n## 1. 사용자 정의 센서 만들기\n\n템플릿의 주요 용도 중 하나는 사용자 정의 센서를 만드는 것입니다. 예를 들어, 저는 여러 방의 다른 센서에서 평균 온도를 계산하는 템플릿 센서를 사용합니다. 이는 단일 측정 지점이 아닌 전체 집 온도에 기반한 난방이나 냉방 시스템을 작동하는 데 매우 유용합니다.\n\n간단한 센서 버전부터 시작해 봅시다:\n\n```js\ntemplate:\n  - sensor:\n      - name: \"Home Temperature\"\n        unit_of_measurement: \"°C\"\n        state: \u003e\n          { (states('sensor.living_room_temperature') | float + \n              states('sensor.bedroom_temperature') | float + \n              states('sensor.kitchen_temperature') | float) / 3 }\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n이 예제에서는 각각의 온도 센서 상태를 얻어와서 float 숫자 유형으로 변환한 다음 값들을 더하고, 센서의 개수로 나누어 평균을 구하는 방법에 대해 설명합니다. Home Assistant는 모든 센서 값을 문자열로 저장하기 때문에 먼저 이를 숫자 값으로 변환해야 합니다. \"| float\"는 정확히 그 역할을 합니다. 템플릿 센서에 익숙하지 않은 경우 Home Assistant 공식 통합 페이지에서 기본 사항을 읽어볼 수 있습니다.\n\n우리가 만든 센서는 매우 유연하지 않습니다. 집에 더 많은 온도 센서를 설치하면 해당 센서를 포함하는 템플릿을 수정해야 합니다. 비슷한 센서가 많을 경우 이를 추적하고 수동으로 업데이트하는 것은 항상 쉽지 않습니다. 이상적으로, 템플릿 센서는 Home Assistant에 추가한 모든 온도 센서를 식별하고 템플릿 센서를 동적으로 조정할 수 있어야 합니다. 재밌는 점은, 템플릿으로 이를 할 수 있다는 것입니다:\n\n```js\ntemplate:\n  - sensor:\n      - name: \"Home Temperature\"\n        unit_of_measurement: \"°C\"\n        state: \u003e\n          { (states.sensor \n            | selectattr('attributes.device_class', 'eq','temperature')\n            |rejectattr('state','in','unavailable,unknown')\n            | map(attribute='state') | map('float', 0)| average)|round(2) }\n```\n\n위 코드가 그 역할을 합니다. 먼저 템플릿은 'states.sensor'를 통해 센서 도메인의 모든 엔티티의 상태를 선택한 다음 두 개의 필터를 적용합니다: 첫 번째 필터는 'device_class'가 'temperature'인 엔티티만 포함하고, 두 번째 필터는 'unavailable' 또는 'unknown'인 엔티티를 거부합니다. 해당 엔티티들의 상태를 'float' 숫자로 매핑하고 해당 숫자들의 평균을 취합니다. 마지막으로 결과를 표시하기 전에 소수점 둘째 자리까지 반올림합니다. 따라서 새로운 센서가 추가되거나 어느 하나의 센서가 오프라인 상태가 되면 템플릿이 즉시 재계산되어 센서 값을 변경합니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n그러나 여기에 작은 문제가 있습니다. 프로세서용 온도 센서도 설정한 경우를 상상해 보죠. 위 템플릿에는 해당 센서의 디바이스 클래스도 'temperature'이기 때문에 이를 평균에 포함시킬 것입니다. 이 문제를 해결할 수 있는 다양한 방법이 있습니다. 이 중 하나는 아래와 같습니다:\n\n```js\ntemplate:\n  - sensor:\n      - name: \"Home Temperature\"\n        unit_of_measurement: \"°C\"\n        state: \u003e\n          { (states.sensor \n            | selectattr('attributes.device_class', 'eq','temperature')\n            | rejectattr('state','in','unavailable,unknown')\n            | selectattr('entity_id','search','room|kitchen')\n            | map(attribute='state') | map('float', 0) | average) | round(2) }\n```\n\n내가 한 일은 entity ID에 'room'이나 'kitchen'이 포함된 엔티티만 선택하는 필터를 추가한 것입니다.\n\n## 2. 자동화에서\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\n    - 별칭: 배터리 부족 알림\n      id: \"ag2i86995uix9vt84a6g7699h\"\n      trigger:\n        - platform: time\n          at: \"20:00:00\"\n      mode: single\n      max_exceeded: silent\n      condition:\n        - condition: template\n          value_template: \u003e\n            { (states.sensor \n              | selectattr('attributes.device_class', 'eq','battery')\n              | selectattr('attributes.unit_of_measurement', '==', '%') \n              |rejectattr('state','in','unavailable,unknown')\n              | map(attribute='state') | map('int')\n              |select('\u003c=',5) |list|length)\u003e0 }           \n      action:\n        - delay: \"00:30:00\"\n        - service: notify.telegram_vm\n          data:\n            title: \"{ '\\U0001F50B' } *낮은 배터리*\"\n            message: \u003e\n              { set batteries = states.sensor \n                | selectattr('entity_id', 'has_value') \n                |rejectattr('state','in','unavailable,unknown')\n                | selectattr('attributes.device_class', '==', 'battery') \n                | selectattr('attributes.unit_of_measurement', '==', '%') | list }\n              { set low_battery = batteries | map(attribute='state') | map('int') | select('\u003c=', 5) | map('string') | list }\n              { batteries | selectattr('state', 'in', low_battery) | map(attribute='name') | list | join('\\n') }\n```\n\n이 자동화는 매일 오후 8시에 전원이 낮은 장치 목록과 함께 제 텔레그램 메신저로 알림을 보냅니다. (5% 이하의 경우). 조건 부분 및 알림 메시지 만들기 위해 템플릿을 사용합니다. 센서 예제와 마찬가지로 템플릿을 사용하면 동적인 장점이 있습니다. 장치를 추가하거나 제거할 때 아무 것도 변경할 필요가 없습니다.\n\n조건 부분에서는 우선 5% 이하로 충전된 배터리가 있는지 확인하는 템플릿 조건을 사용합니다. 첫째로 템플릿은 '배터리' 장치 클래스 속성과 '%'(율) 단위 측정 속성을 가진 센서를 선택한 후 '이용 불가능' 또는 '알 수 없음'인 센서를 제거합니다. 마지막으로 이러한 센서의 상태를 정수로 매핑하고 값이 5 이하인 센서를 필터링합니다. 다음으로 템플릿은 'length' 필터를 사용하여 해당 센서 수를 계산합니다. 마지막으로 길이가 0보다 큰지(5 미만의 배터리 값을 가진 엔티티가 있는지) 확인합니다.\n\n액션 부분에서 메시지도 유사한 방법을 사용하여 생성됩니다. Home Assistant는 센서 상태를 문자열로 저장하므로 먼저 저전력 배터리 센서 목록을 가져 와서 두 번째 단계에서 해당 센서 이름을 다시 필터링해야 합니다.\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# 결론\n\n템플릿은 홈 어시스턴트(Home Assistant)에서 매우 강력한 기능으로, 맞춤화와 유연성을 가능하게 합니다. UI 중심의 설정 트렌드가 홈 어시스턴트를 보다 접근하기 쉽게 만들었지만, 템플릿의 잠재력을 간과해서는 안 됩니다. 템플릿을 활용하여, 반응성이 향상되고 똑똑하며 개인화된 스마트 홈 환경을 만들 수 있습니다.\n\n더 자세한 안내와 예제를 보려면 공식 홈 어시스턴트 문서와 개발자 도구 섹션의 템플릿 편집기를 확인하세요. 템플릿의 힘을 받아들이고, 홈 어시스턴트 설정의 모든 잠재력을 끌어내세요. 템플릿에 관한 질문이나 도움이 필요하다면, 아래에 댓글을 남겨주세요! 기꺼이 도와드리겠습니다.","ogImage":{"url":"/assets/img/2024-05-27-UnlockingthePowerofTemplatesinHomeAssistant_0.png"},"coverImage":"/assets/img/2024-05-27-UnlockingthePowerofTemplatesinHomeAssistant_0.png","tag":["Tech"],"readingTime":6},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-05-27-UnlockingthePowerofTemplatesinHomeAssistant_0.png\" alt=\"2024-05-27-UnlockingthePowerofTemplatesinHomeAssistant_0.png\"\u003e\u003c/p\u003e\n\u003cp\u003e템플릿은 홈 어시스턴트에서 제공되는 가장 강력한 도구 중 하나입니다. 센서를 생성하거나 자동화 트리거를 설정하고 자동화 조건을 정의하며 등등 다양한 용도로 활용할 수 있습니다. 그러나 많은 홈 어시스턴트 사용자들이 잠재력을 충분히 활용하지 못하고 있습니다. 최근 몇 년간 홈 어시스턴트팀이 더 사용자 친화적이고 UI 기반의 설정으로 진화함에 따라 대부분의 사용자들이 템플릿을 더 적게 사용하게 되었습니다. 그러나 템플릿은 UI만으로는 어려운 사용자 정의 및 자동화 수준을 제공합니다.\u003c/p\u003e\n\u003cp\u003e홈 어시스턴트의 포괄적인 문서는 템플릿의 여러 일반적인 사용 사례를 다루고 있습니다. 게다가 홈 어시스턴트의 \"개발자 도구\" 섹션에 전용 템플릿 편집기가 있어 실시간으로 템플릿을 테스트할 수 있습니다. 이 도구는 설정을 배포하기 전에 템플릿을 문제 해결하고 정교화하는 데 매우 유용합니다.\u003c/p\u003e\n\u003cp\u003e템플릿의 다양성과 강력함을 보여주기 위해 저 자신이 집에서 사용하는 몇 가지 예시를 소개하겠습니다:\u003c/p\u003e\n\u003ch2\u003e1. 사용자 정의 센서 만들기\u003c/h2\u003e\n\u003cp\u003e템플릿의 주요 용도 중 하나는 사용자 정의 센서를 만드는 것입니다. 예를 들어, 저는 여러 방의 다른 센서에서 평균 온도를 계산하는 템플릿 센서를 사용합니다. 이는 단일 측정 지점이 아닌 전체 집 온도에 기반한 난방이나 냉방 시스템을 작동하는 데 매우 유용합니다.\u003c/p\u003e\n\u003cp\u003e간단한 센서 버전부터 시작해 봅시다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-attr\"\u003etemplate\u003c/span\u003e:\n  - \u003cspan class=\"hljs-attr\"\u003esensor\u003c/span\u003e:\n      - \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"Home Temperature\"\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003eunit_of_measurement\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"°C\"\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003estate\u003c/span\u003e: \u003e\n          { (\u003cspan class=\"hljs-title function_\"\u003estates\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'sensor.living_room_temperature'\u003c/span\u003e) | float + \n              \u003cspan class=\"hljs-title function_\"\u003estates\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'sensor.bedroom_temperature'\u003c/span\u003e) | float + \n              \u003cspan class=\"hljs-title function_\"\u003estates\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'sensor.kitchen_temperature'\u003c/span\u003e) | float) / \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e }\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e이 예제에서는 각각의 온도 센서 상태를 얻어와서 float 숫자 유형으로 변환한 다음 값들을 더하고, 센서의 개수로 나누어 평균을 구하는 방법에 대해 설명합니다. Home Assistant는 모든 센서 값을 문자열로 저장하기 때문에 먼저 이를 숫자 값으로 변환해야 합니다. \"| float\"는 정확히 그 역할을 합니다. 템플릿 센서에 익숙하지 않은 경우 Home Assistant 공식 통합 페이지에서 기본 사항을 읽어볼 수 있습니다.\u003c/p\u003e\n\u003cp\u003e우리가 만든 센서는 매우 유연하지 않습니다. 집에 더 많은 온도 센서를 설치하면 해당 센서를 포함하는 템플릿을 수정해야 합니다. 비슷한 센서가 많을 경우 이를 추적하고 수동으로 업데이트하는 것은 항상 쉽지 않습니다. 이상적으로, 템플릿 센서는 Home Assistant에 추가한 모든 온도 센서를 식별하고 템플릿 센서를 동적으로 조정할 수 있어야 합니다. 재밌는 점은, 템플릿으로 이를 할 수 있다는 것입니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-attr\"\u003etemplate\u003c/span\u003e:\n  - \u003cspan class=\"hljs-attr\"\u003esensor\u003c/span\u003e:\n      - \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"Home Temperature\"\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003eunit_of_measurement\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"°C\"\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003estate\u003c/span\u003e: \u003e\n          { (states.\u003cspan class=\"hljs-property\"\u003esensor\u003c/span\u003e \n            | \u003cspan class=\"hljs-title function_\"\u003eselectattr\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'attributes.device_class'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'eq'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'temperature'\u003c/span\u003e)\n            |\u003cspan class=\"hljs-title function_\"\u003erejectattr\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'state'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'in'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'unavailable,unknown'\u003c/span\u003e)\n            | \u003cspan class=\"hljs-title function_\"\u003emap\u003c/span\u003e(attribute=\u003cspan class=\"hljs-string\"\u003e'state'\u003c/span\u003e) | \u003cspan class=\"hljs-title function_\"\u003emap\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'float'\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)| average)|\u003cspan class=\"hljs-title function_\"\u003eround\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e) }\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e위 코드가 그 역할을 합니다. 먼저 템플릿은 'states.sensor'를 통해 센서 도메인의 모든 엔티티의 상태를 선택한 다음 두 개의 필터를 적용합니다: 첫 번째 필터는 'device_class'가 'temperature'인 엔티티만 포함하고, 두 번째 필터는 'unavailable' 또는 'unknown'인 엔티티를 거부합니다. 해당 엔티티들의 상태를 'float' 숫자로 매핑하고 해당 숫자들의 평균을 취합니다. 마지막으로 결과를 표시하기 전에 소수점 둘째 자리까지 반올림합니다. 따라서 새로운 센서가 추가되거나 어느 하나의 센서가 오프라인 상태가 되면 템플릿이 즉시 재계산되어 센서 값을 변경합니다.\u003c/p\u003e\n\u003cp\u003e그러나 여기에 작은 문제가 있습니다. 프로세서용 온도 센서도 설정한 경우를 상상해 보죠. 위 템플릿에는 해당 센서의 디바이스 클래스도 'temperature'이기 때문에 이를 평균에 포함시킬 것입니다. 이 문제를 해결할 수 있는 다양한 방법이 있습니다. 이 중 하나는 아래와 같습니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-attr\"\u003etemplate\u003c/span\u003e:\n  - \u003cspan class=\"hljs-attr\"\u003esensor\u003c/span\u003e:\n      - \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"Home Temperature\"\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003eunit_of_measurement\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"°C\"\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003estate\u003c/span\u003e: \u003e\n          { (states.\u003cspan class=\"hljs-property\"\u003esensor\u003c/span\u003e \n            | \u003cspan class=\"hljs-title function_\"\u003eselectattr\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'attributes.device_class'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'eq'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'temperature'\u003c/span\u003e)\n            | \u003cspan class=\"hljs-title function_\"\u003erejectattr\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'state'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'in'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'unavailable,unknown'\u003c/span\u003e)\n            | \u003cspan class=\"hljs-title function_\"\u003eselectattr\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'entity_id'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'search'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'room|kitchen'\u003c/span\u003e)\n            | \u003cspan class=\"hljs-title function_\"\u003emap\u003c/span\u003e(attribute=\u003cspan class=\"hljs-string\"\u003e'state'\u003c/span\u003e) | \u003cspan class=\"hljs-title function_\"\u003emap\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'float'\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) | average) | \u003cspan class=\"hljs-title function_\"\u003eround\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e) }\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e내가 한 일은 entity ID에 'room'이나 'kitchen'이 포함된 엔티티만 선택하는 필터를 추가한 것입니다.\u003c/p\u003e\n\u003ch2\u003e2. 자동화에서\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e    - 별칭: 배터리 부족 알림\n      \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"ag2i86995uix9vt84a6g7699h\"\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003etrigger\u003c/span\u003e:\n        - \u003cspan class=\"hljs-attr\"\u003eplatform\u003c/span\u003e: time\n          \u003cspan class=\"hljs-attr\"\u003eat\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"20:00:00\"\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003emode\u003c/span\u003e: single\n      \u003cspan class=\"hljs-attr\"\u003emax_exceeded\u003c/span\u003e: silent\n      \u003cspan class=\"hljs-attr\"\u003econdition\u003c/span\u003e:\n        - \u003cspan class=\"hljs-attr\"\u003econdition\u003c/span\u003e: template\n          \u003cspan class=\"hljs-attr\"\u003evalue_template\u003c/span\u003e: \u003e\n            { (states.\u003cspan class=\"hljs-property\"\u003esensor\u003c/span\u003e \n              | \u003cspan class=\"hljs-title function_\"\u003eselectattr\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'attributes.device_class'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'eq'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'battery'\u003c/span\u003e)\n              | \u003cspan class=\"hljs-title function_\"\u003eselectattr\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'attributes.unit_of_measurement'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'=='\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'%'\u003c/span\u003e) \n              |\u003cspan class=\"hljs-title function_\"\u003erejectattr\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'state'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'in'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'unavailable,unknown'\u003c/span\u003e)\n              | \u003cspan class=\"hljs-title function_\"\u003emap\u003c/span\u003e(attribute=\u003cspan class=\"hljs-string\"\u003e'state'\u003c/span\u003e) | \u003cspan class=\"hljs-title function_\"\u003emap\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'int'\u003c/span\u003e)\n              |\u003cspan class=\"hljs-title function_\"\u003eselect\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'\u0026#x3C;='\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e) |list|length)\u003e\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e }           \n      \u003cspan class=\"hljs-attr\"\u003eaction\u003c/span\u003e:\n        - \u003cspan class=\"hljs-attr\"\u003edelay\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"00:30:00\"\u003c/span\u003e\n        - \u003cspan class=\"hljs-attr\"\u003eservice\u003c/span\u003e: notify.\u003cspan class=\"hljs-property\"\u003etelegram_vm\u003c/span\u003e\n          \u003cspan class=\"hljs-attr\"\u003edata\u003c/span\u003e:\n            \u003cspan class=\"hljs-attr\"\u003etitle\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"{ '\\U0001F50B' } *낮은 배터리*\"\u003c/span\u003e\n            \u003cspan class=\"hljs-attr\"\u003emessage\u003c/span\u003e: \u003e\n              { set batteries = states.\u003cspan class=\"hljs-property\"\u003esensor\u003c/span\u003e \n                | \u003cspan class=\"hljs-title function_\"\u003eselectattr\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'entity_id'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'has_value'\u003c/span\u003e) \n                |\u003cspan class=\"hljs-title function_\"\u003erejectattr\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'state'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'in'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'unavailable,unknown'\u003c/span\u003e)\n                | \u003cspan class=\"hljs-title function_\"\u003eselectattr\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'attributes.device_class'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'=='\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'battery'\u003c/span\u003e) \n                | \u003cspan class=\"hljs-title function_\"\u003eselectattr\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'attributes.unit_of_measurement'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'=='\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'%'\u003c/span\u003e) | list }\n              { set low_battery = batteries | \u003cspan class=\"hljs-title function_\"\u003emap\u003c/span\u003e(attribute=\u003cspan class=\"hljs-string\"\u003e'state'\u003c/span\u003e) | \u003cspan class=\"hljs-title function_\"\u003emap\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'int'\u003c/span\u003e) | \u003cspan class=\"hljs-title function_\"\u003eselect\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'\u0026#x3C;='\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e) | \u003cspan class=\"hljs-title function_\"\u003emap\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'string'\u003c/span\u003e) | list }\n              { batteries | \u003cspan class=\"hljs-title function_\"\u003eselectattr\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'state'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'in'\u003c/span\u003e, low_battery) | \u003cspan class=\"hljs-title function_\"\u003emap\u003c/span\u003e(attribute=\u003cspan class=\"hljs-string\"\u003e'name'\u003c/span\u003e) | list | \u003cspan class=\"hljs-title function_\"\u003ejoin\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'\\n'\u003c/span\u003e) }\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e이 자동화는 매일 오후 8시에 전원이 낮은 장치 목록과 함께 제 텔레그램 메신저로 알림을 보냅니다. (5% 이하의 경우). 조건 부분 및 알림 메시지 만들기 위해 템플릿을 사용합니다. 센서 예제와 마찬가지로 템플릿을 사용하면 동적인 장점이 있습니다. 장치를 추가하거나 제거할 때 아무 것도 변경할 필요가 없습니다.\u003c/p\u003e\n\u003cp\u003e조건 부분에서는 우선 5% 이하로 충전된 배터리가 있는지 확인하는 템플릿 조건을 사용합니다. 첫째로 템플릿은 '배터리' 장치 클래스 속성과 '%'(율) 단위 측정 속성을 가진 센서를 선택한 후 '이용 불가능' 또는 '알 수 없음'인 센서를 제거합니다. 마지막으로 이러한 센서의 상태를 정수로 매핑하고 값이 5 이하인 센서를 필터링합니다. 다음으로 템플릿은 'length' 필터를 사용하여 해당 센서 수를 계산합니다. 마지막으로 길이가 0보다 큰지(5 미만의 배터리 값을 가진 엔티티가 있는지) 확인합니다.\u003c/p\u003e\n\u003cp\u003e액션 부분에서 메시지도 유사한 방법을 사용하여 생성됩니다. Home Assistant는 센서 상태를 문자열로 저장하므로 먼저 저전력 배터리 센서 목록을 가져 와서 두 번째 단계에서 해당 센서 이름을 다시 필터링해야 합니다.\u003c/p\u003e\n\u003ch1\u003e결론\u003c/h1\u003e\n\u003cp\u003e템플릿은 홈 어시스턴트(Home Assistant)에서 매우 강력한 기능으로, 맞춤화와 유연성을 가능하게 합니다. UI 중심의 설정 트렌드가 홈 어시스턴트를 보다 접근하기 쉽게 만들었지만, 템플릿의 잠재력을 간과해서는 안 됩니다. 템플릿을 활용하여, 반응성이 향상되고 똑똑하며 개인화된 스마트 홈 환경을 만들 수 있습니다.\u003c/p\u003e\n\u003cp\u003e더 자세한 안내와 예제를 보려면 공식 홈 어시스턴트 문서와 개발자 도구 섹션의 템플릿 편집기를 확인하세요. 템플릿의 힘을 받아들이고, 홈 어시스턴트 설정의 모든 잠재력을 끌어내세요. 템플릿에 관한 질문이나 도움이 필요하다면, 아래에 댓글을 남겨주세요! 기꺼이 도와드리겠습니다.\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-05-27-UnlockingthePowerofTemplatesinHomeAssistant"},"buildId":"O5JVeK6TDhbvSxBlchQwM","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>