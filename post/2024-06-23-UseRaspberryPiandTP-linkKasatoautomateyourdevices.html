<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>Raspberry Pi와 TP-link Kasa로 기기 자동화하는 방법 | itposting</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://itposting.github.io///post/2024-06-23-UseRaspberryPiandTP-linkKasatoautomateyourdevices" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="Raspberry Pi와 TP-link Kasa로 기기 자동화하는 방법 | itposting" data-gatsby-head="true"/><meta property="og:title" content="Raspberry Pi와 TP-link Kasa로 기기 자동화하는 방법 | itposting" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-06-23-UseRaspberryPiandTP-linkKasatoautomateyourdevices_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://itposting.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://itposting.github.io///post/2024-06-23-UseRaspberryPiandTP-linkKasatoautomateyourdevices" data-gatsby-head="true"/><meta name="twitter:title" content="Raspberry Pi와 TP-link Kasa로 기기 자동화하는 방법 | itposting" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-06-23-UseRaspberryPiandTP-linkKasatoautomateyourdevices_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | itposting" data-gatsby-head="true"/><meta name="article:published_time" content="2024-06-23 17:10" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-23YXDLKDCL"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-23YXDLKDCL');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-ac4aa08aae62f90e.js" defer=""></script><script src="/_next/static/chunks/463-0429087d4c0b0335.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-d849684d6d83f07a.js" defer=""></script><script src="/_next/static/CYQjEY3HhSkRTiL0gewc0/_buildManifest.js" defer=""></script><script src="/_next/static/CYQjEY3HhSkRTiL0gewc0/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">IT Posting</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">Raspberry Pi와 TP-link Kasa로 기기 자동화하는 방법</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="Raspberry Pi와 TP-link Kasa로 기기 자동화하는 방법" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">IT Posting</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Jun 23, 2024</span><span class="posts_reading_time__f7YPP">4<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-06-23-UseRaspberryPiandTP-linkKasatoautomateyourdevices&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<p><strong>판매 프로모션 아님</strong></p>
<p>2022년이 왔고, 요즘에는 많은 스마트 홈 기기와 생태계가 있어요. TP-link의 Kasa 시스템은 오래전부터 있었는데, 파이썬 SDK가 있어서 제가 좋아해요. 또한, 에너지 모니터링이 가능한 스마트 플러그를 만든다는 점이 꽤 독창적이죠. Kasa 제품군을 라즈베리 파이(또는 다른 Linux/Windows 서버)와 결합하면 가능성이 무한해져요. 아래는 할 수 있는 일들입니다.</p>
<ul>
<li>[이 블로그 게시물에 표시됨] "펄스 모드"와 같이 복잡한 일정으로 장치를 실행할 수 있어요. 예를 들어, 특정 시간대에 매 15분마다 켜고 꺼지는 수도 펌프와 같은 장치를 실행할 수 있어요. 이 설정은 Kasa 스마트 콘센트에 꽂힌 Taco Hot-link 수도 펌프에 대해 구성되어 있어요.</li>
</ul>
<p><img src="/assets/img/2024-06-23-UseRaspberryPiandTP-linkKasatoautomateyourdevices_0.png" alt="RaspberryPi와TP-linkKas를사용하여장치를자동화하는2024년6월23일의이미지"></p>
<div class="content-ad"></div>
<ul>
<li>[이 블로그 포스트에서 보여짐] 크론을 통해 모든 일정 장치 제어하기. Kasa 앱은 멋지지만, 현재 각 장치당 31개의 일정 제한이 있습니다. 그리고 어떤 GUI 인터페이스든 복잡한 일정을 설정하려면 많은 "클릭/터치"가 필요합니다.</li>
<li>[곧 블로그 포스트에서 곧] 외부 이벤트에 기반하여 장치 제어하기. 예를 들어 오늘 주식 시장이나 암호화폐의 상황, 날씨, 또는 트윗 감정에 따라 led 색상을 조절합니다.</li>
</ul>
<p>만약 이러한 자동화가 흥미롭게 들리면 계속 읽어보세요. 처음 두 가지는 크론 잡을 통해 할 예정입니다. 세 번째는 웹사이트나 API를 주기적으로 확인하고, 그 후 장치를 적절하게 제어하기 위해 프로그램을 작성해야 합니다. 이 시나리오는 곧 미래의 블로그 포스트에서 다룰 것입니다.</p>
<ul>
<li>python-kasa 설치하기:</li>
</ul>
<p>Python-kasa는 TP-link Kasa에서 사용하는 API를 감싸는 Python 래퍼입니다. 2022년 기준으로 활발하게 개발 중인 프로젝트로, 여기에서 확인하고 기여할 수 있습니다: <a href="https://github.com/python-kasa/python-kasa" rel="nofollow" target="_blank">https://github.com/python-kasa/python-kasa</a>.</p>
<div class="content-ad"></div>
<p>아래 명령어를 실행하여 설치할 수 있어요.</p>
<pre><code class="hljs language-js">pip3 install python-kasa
</code></pre>
<p>명령이 완료되면 새 터미널 세션을 시작하거나 기존 세션을 로그아웃하고 다시 로그인한 후 kasa 명령을 실행하세요. 잘 된다면 kasa 명령을 실행하여 네트워크에 있는 장치들을 발견할 수 있을 거예요 (주의: 가끔 발견 오류가 발생할 수 있지만 대부분 무시해도 괜찮아요).</p>
<p>명령어 which kasa를 실행하면 파이썬 프로그램이 설치된 위치를 보여줄 거예요. 예를 들어, 제 경우에는 /home/pi/.local/bin/kasa에 설치되어 있었는데, 이미 PATH 변수에 포함되어 있어요.</p>
<div class="content-ad"></div>
<p>이제 장치 별칭을 사용하여 상태를 확실히 볼 수 있도록 좀 더 구체적인 명령어를 실행하세요. 아래 명령어에서 제 장치 이름은 "워터 펌프"이며, 이를 적절히 대체해주세요.</p>
<pre><code class="hljs language-js">kasa --type plug --alias <span class="hljs-string">"워터 펌프"</span>
</code></pre>
<p>다른 옵션을 보려면 kasa --help 명령어를 실행하세요. 예를 들어 전구의 색상을 조정하려면 다음과 같은 명령어를 실행할 수 있습니다 (자세한 내용은 다음 블로그 포스트에서 확인할 수 있습니다).</p>
<pre><code class="hljs language-js">kasa --type bulb --alias <span class="hljs-string">"컬러 램프"</span> hsv <span class="hljs-number">118</span> <span class="hljs-number">100</span> <span class="hljs-number">73</span>
</code></pre>
<div class="content-ad"></div>
<ol start="2">
<li>컨트롤러 스크립트 작성하기:</li>
</ol>
<p>이제 장치를 켜거나 끌 수 있는 간단한 스크립트를 작성해야 합니다. 아래 스크립트를 사용할 수 있습니다. 이 파일을 저장하고 아래와 같이 적절한 권한을 부여해주세요.</p>
<pre><code class="hljs language-js"># 파일 작성
echo &#x3C;&#x3C;<span class="hljs-variable constant_">EOF</span>>kasa-pump.<span class="hljs-property">sh</span>
#!<span class="hljs-regexp">/bin/</span>bash
<span class="hljs-keyword">if</span> [[ ! -z $1 ]]; then
  operation=$1
<span class="hljs-keyword">else</span>
  operation=state
fi
<span class="hljs-keyword">export</span> <span class="hljs-variable constant_">PATH</span>=<span class="hljs-regexp">/home/</span>pi/.<span class="hljs-property">local</span>/<span class="hljs-attr">bin</span>:$PATH
kasa --type plug --alias <span class="hljs-string">"water pump"</span> ${operation}
<span class="hljs-variable constant_">EOF</span>
# 권한 조정
sudo cp kasa-pump.<span class="hljs-property">sh</span> /usr/local/bin/kasa-pump.<span class="hljs-property">sh</span>
sudo chown <span class="hljs-attr">pi</span>:pi /usr/local/bin/kasa-pump.<span class="hljs-property">sh</span>
sudo chmod +x /usr/local/bin/kasa-pump.<span class="hljs-property">sh</span>
</code></pre>
<p>아래와 같은 명령어로 스크립트를 테스트해보세요. 장치가 켜지거나 꺼지는 것을 확인할 수 있어야 합니다.</p>
<div class="content-ad"></div>
<p>kasa-pump.sh를 켭니다
kasa-pump.sh를 끕니다</p>
<ol start="3">
<li>크론 작업을 작성하세요:</li>
</ol>
<p>크론 작업은 OG Linux의 하나이며 이에 대한 많은 자습서가 있습니다. 펄스 모드인 5분 켜기, 10분 끄기로 크론을 설정하는 방법에 대한 코드 스니펫을 여기에 제공하겠습니다.</p>
<h1>크론 일정을 작성/업데이트하려면 이 명령을 사용하세요</h1>
<p>crontab -e</p>
<h1>펄스 모드 펌프.</h1>
<p>*/15 5,6,7,10,11,12,13,16,17,20,21,22 * * * /usr/local/bin/kasa-pump.sh on
5,20,35,50 5,6,7,10,11,12,13,16,17,20,21,22 * * * /usr/local/bin/kasa-pump.sh off</p>
<div class="content-ad"></div>
<p>위의 표현은 선택된 주간 시간 동안 매 15분마다 kasa-pump.sh 명령을 실행합니다.</p>
<p>*/15 5,6,7,10,11,12,13,16,17,20,21,22 * * * /usr/local/bin/kasa-pump.sh on</p>
<p>아래의 표현은 매 시간 5, 20, 35 및 50분에 kasa-pump.sh off 명령을 실행합니다.</p>
<p>5,20,35,50 5,6,7,10,11,12,13,16,17,20,21,22 * * * /usr/local/bin/kasa-pump.sh off</p>
<div class="content-ad"></div>
<p>물론, 전 완전히 사용자 정의된 일정을 선택할 것으로 예상합니다. Cron을 사용하면 Kasa App으로 할 수 있는 것보다 더 세밀하게 일정을 조정할 수 있어요.</p>
<p>이젠 남은 일은 cron 작업이 성공적으로 실행되고 있는지 확인하는 것뿐이에요. 아래 명령어를 사용하여 cron에서 출력을 확인해주세요.</p>
<pre><code class="hljs language-js"># <span class="hljs-title class_">Cron</span> 서비스가 제대로 실행 중인지 확인하기
sudo systemctl status cron.<span class="hljs-property">service</span>
# cat /<span class="hljs-keyword">var</span>/mail/pi | grep -i pump
</code></pre>
<p>마무리</p>
<div class="content-ad"></div>
<p>안녕하세요! 이 게시물에서는 Raspberry Pi에서 cron 작업을 사용하여 "펌프"라는 장치를 자동화하는 방법을 살펴보았어요. 기기가 많아지면 이 방법으로 일정을 설정하는 것이 "App"보다 쉽습니다. "touches/clicks"을 많이 할 필요가 없죠.</p>
<p>다음 블로그 게시물에서는 외부 이벤트에 따라 색상을 조정하는 것과 같은 더 흥미로운 것을 살펴볼 거에요.</p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Raspberry Pi와 TP-link Kasa로 기기 자동화하는 방법","description":"","date":"2024-06-23 17:10","slug":"2024-06-23-UseRaspberryPiandTP-linkKasatoautomateyourdevices","content":"\n\n**판매 프로모션 아님**\n\n2022년이 왔고, 요즘에는 많은 스마트 홈 기기와 생태계가 있어요. TP-link의 Kasa 시스템은 오래전부터 있었는데, 파이썬 SDK가 있어서 제가 좋아해요. 또한, 에너지 모니터링이 가능한 스마트 플러그를 만든다는 점이 꽤 독창적이죠. Kasa 제품군을 라즈베리 파이(또는 다른 Linux/Windows 서버)와 결합하면 가능성이 무한해져요. 아래는 할 수 있는 일들입니다.\n\n- [이 블로그 게시물에 표시됨] \"펄스 모드\"와 같이 복잡한 일정으로 장치를 실행할 수 있어요. 예를 들어, 특정 시간대에 매 15분마다 켜고 꺼지는 수도 펌프와 같은 장치를 실행할 수 있어요. 이 설정은 Kasa 스마트 콘센트에 꽂힌 Taco Hot-link 수도 펌프에 대해 구성되어 있어요.\n\n![RaspberryPi와TP-linkKas를사용하여장치를자동화하는2024년6월23일의이미지](/assets/img/2024-06-23-UseRaspberryPiandTP-linkKasatoautomateyourdevices_0.png)\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n- [이 블로그 포스트에서 보여짐] 크론을 통해 모든 일정 장치 제어하기. Kasa 앱은 멋지지만, 현재 각 장치당 31개의 일정 제한이 있습니다. 그리고 어떤 GUI 인터페이스든 복잡한 일정을 설정하려면 많은 \"클릭/터치\"가 필요합니다.\n- [곧 블로그 포스트에서 곧] 외부 이벤트에 기반하여 장치 제어하기. 예를 들어 오늘 주식 시장이나 암호화폐의 상황, 날씨, 또는 트윗 감정에 따라 led 색상을 조절합니다.\n\n만약 이러한 자동화가 흥미롭게 들리면 계속 읽어보세요. 처음 두 가지는 크론 잡을 통해 할 예정입니다. 세 번째는 웹사이트나 API를 주기적으로 확인하고, 그 후 장치를 적절하게 제어하기 위해 프로그램을 작성해야 합니다. 이 시나리오는 곧 미래의 블로그 포스트에서 다룰 것입니다.\n\n- python-kasa 설치하기:\n\nPython-kasa는 TP-link Kasa에서 사용하는 API를 감싸는 Python 래퍼입니다. 2022년 기준으로 활발하게 개발 중인 프로젝트로, 여기에서 확인하고 기여할 수 있습니다: https://github.com/python-kasa/python-kasa.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n아래 명령어를 실행하여 설치할 수 있어요.\n\n```js\npip3 install python-kasa\n```\n\n명령이 완료되면 새 터미널 세션을 시작하거나 기존 세션을 로그아웃하고 다시 로그인한 후 kasa 명령을 실행하세요. 잘 된다면 kasa 명령을 실행하여 네트워크에 있는 장치들을 발견할 수 있을 거예요 (주의: 가끔 발견 오류가 발생할 수 있지만 대부분 무시해도 괜찮아요). \n\n명령어 which kasa를 실행하면 파이썬 프로그램이 설치된 위치를 보여줄 거예요. 예를 들어, 제 경우에는 /home/pi/.local/bin/kasa에 설치되어 있었는데, 이미 PATH 변수에 포함되어 있어요.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n이제 장치 별칭을 사용하여 상태를 확실히 볼 수 있도록 좀 더 구체적인 명령어를 실행하세요. 아래 명령어에서 제 장치 이름은 \"워터 펌프\"이며, 이를 적절히 대체해주세요.\n\n```js\nkasa --type plug --alias \"워터 펌프\"\n```\n\n다른 옵션을 보려면 kasa --help 명령어를 실행하세요. 예를 들어 전구의 색상을 조정하려면 다음과 같은 명령어를 실행할 수 있습니다 (자세한 내용은 다음 블로그 포스트에서 확인할 수 있습니다).\n\n```js\nkasa --type bulb --alias \"컬러 램프\" hsv 118 100 73\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n2. 컨트롤러 스크립트 작성하기:\n\n이제 장치를 켜거나 끌 수 있는 간단한 스크립트를 작성해야 합니다. 아래 스크립트를 사용할 수 있습니다. 이 파일을 저장하고 아래와 같이 적절한 권한을 부여해주세요.\n\n```js\n# 파일 작성\necho \u003c\u003cEOF\u003ekasa-pump.sh\n#!/bin/bash\nif [[ ! -z $1 ]]; then\n  operation=$1\nelse\n  operation=state\nfi\nexport PATH=/home/pi/.local/bin:$PATH\nkasa --type plug --alias \"water pump\" ${operation}\nEOF\n# 권한 조정\nsudo cp kasa-pump.sh /usr/local/bin/kasa-pump.sh\nsudo chown pi:pi /usr/local/bin/kasa-pump.sh\nsudo chmod +x /usr/local/bin/kasa-pump.sh\n```\n\n아래와 같은 명령어로 스크립트를 테스트해보세요. 장치가 켜지거나 꺼지는 것을 확인할 수 있어야 합니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\nkasa-pump.sh를 켭니다\nkasa-pump.sh를 끕니다\n\n\n3. 크론 작업을 작성하세요:\n\n크론 작업은 OG Linux의 하나이며 이에 대한 많은 자습서가 있습니다. 펄스 모드인 5분 켜기, 10분 끄기로 크론을 설정하는 방법에 대한 코드 스니펫을 여기에 제공하겠습니다.\n\n\n# 크론 일정을 작성/업데이트하려면 이 명령을 사용하세요\ncrontab -e\n# 펄스 모드 펌프.\n*/15 5,6,7,10,11,12,13,16,17,20,21,22 * * * /usr/local/bin/kasa-pump.sh on\n5,20,35,50 5,6,7,10,11,12,13,16,17,20,21,22 * * * /usr/local/bin/kasa-pump.sh off\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n위의 표현은 선택된 주간 시간 동안 매 15분마다 kasa-pump.sh 명령을 실행합니다.\n\n*/15 5,6,7,10,11,12,13,16,17,20,21,22 * * * /usr/local/bin/kasa-pump.sh on\n\n아래의 표현은 매 시간 5, 20, 35 및 50분에 kasa-pump.sh off 명령을 실행합니다.\n\n5,20,35,50 5,6,7,10,11,12,13,16,17,20,21,22 * * * /usr/local/bin/kasa-pump.sh off\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n물론, 전 완전히 사용자 정의된 일정을 선택할 것으로 예상합니다. Cron을 사용하면 Kasa App으로 할 수 있는 것보다 더 세밀하게 일정을 조정할 수 있어요.\n\n이젠 남은 일은 cron 작업이 성공적으로 실행되고 있는지 확인하는 것뿐이에요. 아래 명령어를 사용하여 cron에서 출력을 확인해주세요.\n\n```js\n# Cron 서비스가 제대로 실행 중인지 확인하기\nsudo systemctl status cron.service\n# cat /var/mail/pi | grep -i pump\n```\n\n마무리\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n안녕하세요! 이 게시물에서는 Raspberry Pi에서 cron 작업을 사용하여 \"펌프\"라는 장치를 자동화하는 방법을 살펴보았어요. 기기가 많아지면 이 방법으로 일정을 설정하는 것이 \"App\"보다 쉽습니다. \"touches/clicks\"을 많이 할 필요가 없죠.\n\n다음 블로그 게시물에서는 외부 이벤트에 따라 색상을 조정하는 것과 같은 더 흥미로운 것을 살펴볼 거에요.","ogImage":{"url":"/assets/img/2024-06-23-UseRaspberryPiandTP-linkKasatoautomateyourdevices_0.png"},"coverImage":"/assets/img/2024-06-23-UseRaspberryPiandTP-linkKasatoautomateyourdevices_0.png","tag":["Tech"],"readingTime":4},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003e\u003cstrong\u003e판매 프로모션 아님\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e2022년이 왔고, 요즘에는 많은 스마트 홈 기기와 생태계가 있어요. TP-link의 Kasa 시스템은 오래전부터 있었는데, 파이썬 SDK가 있어서 제가 좋아해요. 또한, 에너지 모니터링이 가능한 스마트 플러그를 만든다는 점이 꽤 독창적이죠. Kasa 제품군을 라즈베리 파이(또는 다른 Linux/Windows 서버)와 결합하면 가능성이 무한해져요. 아래는 할 수 있는 일들입니다.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e[이 블로그 게시물에 표시됨] \"펄스 모드\"와 같이 복잡한 일정으로 장치를 실행할 수 있어요. 예를 들어, 특정 시간대에 매 15분마다 켜고 꺼지는 수도 펌프와 같은 장치를 실행할 수 있어요. 이 설정은 Kasa 스마트 콘센트에 꽂힌 Taco Hot-link 수도 펌프에 대해 구성되어 있어요.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-23-UseRaspberryPiandTP-linkKasatoautomateyourdevices_0.png\" alt=\"RaspberryPi와TP-linkKas를사용하여장치를자동화하는2024년6월23일의이미지\"\u003e\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e[이 블로그 포스트에서 보여짐] 크론을 통해 모든 일정 장치 제어하기. Kasa 앱은 멋지지만, 현재 각 장치당 31개의 일정 제한이 있습니다. 그리고 어떤 GUI 인터페이스든 복잡한 일정을 설정하려면 많은 \"클릭/터치\"가 필요합니다.\u003c/li\u003e\n\u003cli\u003e[곧 블로그 포스트에서 곧] 외부 이벤트에 기반하여 장치 제어하기. 예를 들어 오늘 주식 시장이나 암호화폐의 상황, 날씨, 또는 트윗 감정에 따라 led 색상을 조절합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e만약 이러한 자동화가 흥미롭게 들리면 계속 읽어보세요. 처음 두 가지는 크론 잡을 통해 할 예정입니다. 세 번째는 웹사이트나 API를 주기적으로 확인하고, 그 후 장치를 적절하게 제어하기 위해 프로그램을 작성해야 합니다. 이 시나리오는 곧 미래의 블로그 포스트에서 다룰 것입니다.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003epython-kasa 설치하기:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ePython-kasa는 TP-link Kasa에서 사용하는 API를 감싸는 Python 래퍼입니다. 2022년 기준으로 활발하게 개발 중인 프로젝트로, 여기에서 확인하고 기여할 수 있습니다: \u003ca href=\"https://github.com/python-kasa/python-kasa\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://github.com/python-kasa/python-kasa\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e아래 명령어를 실행하여 설치할 수 있어요.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003epip3 install python-kasa\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e명령이 완료되면 새 터미널 세션을 시작하거나 기존 세션을 로그아웃하고 다시 로그인한 후 kasa 명령을 실행하세요. 잘 된다면 kasa 명령을 실행하여 네트워크에 있는 장치들을 발견할 수 있을 거예요 (주의: 가끔 발견 오류가 발생할 수 있지만 대부분 무시해도 괜찮아요).\u003c/p\u003e\n\u003cp\u003e명령어 which kasa를 실행하면 파이썬 프로그램이 설치된 위치를 보여줄 거예요. 예를 들어, 제 경우에는 /home/pi/.local/bin/kasa에 설치되어 있었는데, 이미 PATH 변수에 포함되어 있어요.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e이제 장치 별칭을 사용하여 상태를 확실히 볼 수 있도록 좀 더 구체적인 명령어를 실행하세요. 아래 명령어에서 제 장치 이름은 \"워터 펌프\"이며, 이를 적절히 대체해주세요.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003ekasa --type plug --alias \u003cspan class=\"hljs-string\"\u003e\"워터 펌프\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e다른 옵션을 보려면 kasa --help 명령어를 실행하세요. 예를 들어 전구의 색상을 조정하려면 다음과 같은 명령어를 실행할 수 있습니다 (자세한 내용은 다음 블로그 포스트에서 확인할 수 있습니다).\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003ekasa --type bulb --alias \u003cspan class=\"hljs-string\"\u003e\"컬러 램프\"\u003c/span\u003e hsv \u003cspan class=\"hljs-number\"\u003e118\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e73\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003e컨트롤러 스크립트 작성하기:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e이제 장치를 켜거나 끌 수 있는 간단한 스크립트를 작성해야 합니다. 아래 스크립트를 사용할 수 있습니다. 이 파일을 저장하고 아래와 같이 적절한 권한을 부여해주세요.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# 파일 작성\necho \u0026#x3C;\u0026#x3C;\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\u003ekasa-pump.\u003cspan class=\"hljs-property\"\u003esh\u003c/span\u003e\n#!\u003cspan class=\"hljs-regexp\"\u003e/bin/\u003c/span\u003ebash\n\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e [[ ! -z $1 ]]; then\n  operation=$1\n\u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e\n  operation=state\nfi\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003ePATH\u003c/span\u003e=\u003cspan class=\"hljs-regexp\"\u003e/home/\u003c/span\u003epi/.\u003cspan class=\"hljs-property\"\u003elocal\u003c/span\u003e/\u003cspan class=\"hljs-attr\"\u003ebin\u003c/span\u003e:$PATH\nkasa --type plug --alias \u003cspan class=\"hljs-string\"\u003e\"water pump\"\u003c/span\u003e ${operation}\n\u003cspan class=\"hljs-variable constant_\"\u003eEOF\u003c/span\u003e\n# 권한 조정\nsudo cp kasa-pump.\u003cspan class=\"hljs-property\"\u003esh\u003c/span\u003e /usr/local/bin/kasa-pump.\u003cspan class=\"hljs-property\"\u003esh\u003c/span\u003e\nsudo chown \u003cspan class=\"hljs-attr\"\u003epi\u003c/span\u003e:pi /usr/local/bin/kasa-pump.\u003cspan class=\"hljs-property\"\u003esh\u003c/span\u003e\nsudo chmod +x /usr/local/bin/kasa-pump.\u003cspan class=\"hljs-property\"\u003esh\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e아래와 같은 명령어로 스크립트를 테스트해보세요. 장치가 켜지거나 꺼지는 것을 확인할 수 있어야 합니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003ekasa-pump.sh를 켭니다\nkasa-pump.sh를 끕니다\u003c/p\u003e\n\u003col start=\"3\"\u003e\n\u003cli\u003e크론 작업을 작성하세요:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e크론 작업은 OG Linux의 하나이며 이에 대한 많은 자습서가 있습니다. 펄스 모드인 5분 켜기, 10분 끄기로 크론을 설정하는 방법에 대한 코드 스니펫을 여기에 제공하겠습니다.\u003c/p\u003e\n\u003ch1\u003e크론 일정을 작성/업데이트하려면 이 명령을 사용하세요\u003c/h1\u003e\n\u003cp\u003ecrontab -e\u003c/p\u003e\n\u003ch1\u003e펄스 모드 펌프.\u003c/h1\u003e\n\u003cp\u003e*/15 5,6,7,10,11,12,13,16,17,20,21,22 * * * /usr/local/bin/kasa-pump.sh on\n5,20,35,50 5,6,7,10,11,12,13,16,17,20,21,22 * * * /usr/local/bin/kasa-pump.sh off\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e위의 표현은 선택된 주간 시간 동안 매 15분마다 kasa-pump.sh 명령을 실행합니다.\u003c/p\u003e\n\u003cp\u003e*/15 5,6,7,10,11,12,13,16,17,20,21,22 * * * /usr/local/bin/kasa-pump.sh on\u003c/p\u003e\n\u003cp\u003e아래의 표현은 매 시간 5, 20, 35 및 50분에 kasa-pump.sh off 명령을 실행합니다.\u003c/p\u003e\n\u003cp\u003e5,20,35,50 5,6,7,10,11,12,13,16,17,20,21,22 * * * /usr/local/bin/kasa-pump.sh off\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e물론, 전 완전히 사용자 정의된 일정을 선택할 것으로 예상합니다. Cron을 사용하면 Kasa App으로 할 수 있는 것보다 더 세밀하게 일정을 조정할 수 있어요.\u003c/p\u003e\n\u003cp\u003e이젠 남은 일은 cron 작업이 성공적으로 실행되고 있는지 확인하는 것뿐이에요. 아래 명령어를 사용하여 cron에서 출력을 확인해주세요.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# \u003cspan class=\"hljs-title class_\"\u003eCron\u003c/span\u003e 서비스가 제대로 실행 중인지 확인하기\nsudo systemctl status cron.\u003cspan class=\"hljs-property\"\u003eservice\u003c/span\u003e\n# cat /\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e/mail/pi | grep -i pump\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e마무리\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e안녕하세요! 이 게시물에서는 Raspberry Pi에서 cron 작업을 사용하여 \"펌프\"라는 장치를 자동화하는 방법을 살펴보았어요. 기기가 많아지면 이 방법으로 일정을 설정하는 것이 \"App\"보다 쉽습니다. \"touches/clicks\"을 많이 할 필요가 없죠.\u003c/p\u003e\n\u003cp\u003e다음 블로그 게시물에서는 외부 이벤트에 따라 색상을 조정하는 것과 같은 더 흥미로운 것을 살펴볼 거에요.\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-06-23-UseRaspberryPiandTP-linkKasatoautomateyourdevices"},"buildId":"CYQjEY3HhSkRTiL0gewc0","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>