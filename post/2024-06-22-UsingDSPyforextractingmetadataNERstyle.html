<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>DSPy를 사용하여 메타데이터 추출하는 방법 - NER 스타일 가이드 | itposting</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://itposting.github.io///post/2024-06-22-UsingDSPyforextractingmetadataNERstyle" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="DSPy를 사용하여 메타데이터 추출하는 방법 - NER 스타일 가이드 | itposting" data-gatsby-head="true"/><meta property="og:title" content="DSPy를 사용하여 메타데이터 추출하는 방법 - NER 스타일 가이드 | itposting" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-06-22-UsingDSPyforextractingmetadataNERstyle_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://itposting.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://itposting.github.io///post/2024-06-22-UsingDSPyforextractingmetadataNERstyle" data-gatsby-head="true"/><meta name="twitter:title" content="DSPy를 사용하여 메타데이터 추출하는 방법 - NER 스타일 가이드 | itposting" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-06-22-UsingDSPyforextractingmetadataNERstyle_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | itposting" data-gatsby-head="true"/><meta name="article:published_time" content="2024-06-22 20:47" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-23YXDLKDCL"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-23YXDLKDCL');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-ac4aa08aae62f90e.js" defer=""></script><script src="/_next/static/chunks/463-0429087d4c0b0335.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-d849684d6d83f07a.js" defer=""></script><script src="/_next/static/CYQjEY3HhSkRTiL0gewc0/_buildManifest.js" defer=""></script><script src="/_next/static/CYQjEY3HhSkRTiL0gewc0/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">IT Posting</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">DSPy를 사용하여 메타데이터 추출하는 방법 - NER 스타일 가이드</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="DSPy를 사용하여 메타데이터 추출하는 방법 - NER 스타일 가이드" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">IT Posting</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Jun 22, 2024</span><span class="posts_reading_time__f7YPP">15<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-06-22-UsingDSPyforextractingmetadataNERstyle&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<p>DSPy는 프로그래밍을 장려하는 "선언적" 방식을 통해 LLMs를 가르치는 것을 선호하여 커뮤니티에서 빠르게 큰 관심을 얻었습니다. 이 글에서는 DSPy를 사용하여 Named Entity Recognition (NER) 또는 구조화된 데이터 추출을 얼마나 쉽게 할 수 있는지 살펴보겠습니다. 이를 통해 자신감을 가지고 기능을 활용할 수 있습니다.</p>
<p>자세한 내용은 아래의 원문을 확인해주세요:</p>
<p>시작해봅시다 😎!</p>
<h1>소개</h1>
<div class="content-ad"></div>
<p>요즘 대형 언어 모델(Large Language Models, LLM)과 작업한 사람들은 프롬프트(prompt)의 중요성을 강조할 것입니다. 프롬프트를 조금만 바꿔도 출력물에 예상치 못한 변화가 연쇄적으로 발생할 수 있습니다. 또한 다른 LLM 제공업체 간에 프롬프트를 이전하거나 재사용하는 일이 까다로운 경우도 많습니다. 예를 들어, OpenAI에서 Claude 3를 통해 Antrophic을 사용하는 함수 호출 로직을 이동하는 경우 프롬프트를 재설계해야 할 필요가 있죠 😅.</p>
<p>따라서 프롬프트를 다시 작성하고, 평가를 재평가하며, 출력물을 디버깅하는 데 많은 시간 ⏰을 투자해야 합니다. 이를 보다 똑똑하게 처리할 수 있는 방법이 있다면 좋을텐데요? 다행히도, DSPs와 같은 흥미로운 프레임워크는 LLM 제공자에 관계없이 프로그래밍에 중점을 둡니다. 자세한 내용은 참조할 자료에서 DSPy에 대해 더 깊이있게 알아볼 수 있습니다.</p>
<h1>Declarative Self-Improving Language Programs (DSPy)</h1>
<p>DSPy 또는 선언적 자기 개선 언어 프로그램(Declarative Self-improving Language Programs, Khattab et al, 2023)은 처음으로 [2]에서 소개되었습니다. DSPy는 PyTorch와 같은 신경망 프레임워크에서 영감을 받아, 프롬프트보다는 프로그래밍에 중점을 둡니다.</p>
<div class="content-ad"></div>
<p>간단히 말하자면, DSPy 프로그래밍 모델은 다음과 같은 추상화를 가지고 있습니다:</p>
<ul>
<li>필요한 손쓰기 프롬프트/세밀 조정을 대체할 서명.</li>
<li>Cot, REACT 등 다양한 프롬프트 엔지니어링 기술을 구현한 모듈.</li>
<li>주어진 메트릭스를 기반으로 한 수동 프롬프트 엔지니어링을 자동화하는 옵티마이저</li>
</ul>
<p>더 자세한 설명은 참조 사항 중 [1]을 참고하십시오.</p>
<h1>음식 관련 엔티티에 DSPy를 사용한 NER</h1>
<div class="content-ad"></div>
<p>다음 섹션에서는 DSPy를 사용하여 NER 사용 사례를 살펴볼 것입니다.</p>
<h2>데이터</h2>
<p>사용할 데이터는 라면 🍜 한 그릇을 만들기 위한 차슈 돼지고기 레시피입니다. 아래 게시물에서 자세한 내용을 확인하세요:</p>
<p>예시 데이터:</p>
<div class="content-ad"></div>
<pre><code class="hljs language-js">### 차슈 돼지고기 (라면 및 기타 용도)
차슈 돼지고기는 라멘과 같은 일본 요리에 사용되는 돼지 배를 준비하는 전통적인 방법입니다.
다소 시간이 걸릴 수 있지만 비교적 손쉽고 맛있는 결과물이 나옵니다.

### 재료
<span class="hljs-number">2</span> 파운드의 돼지 배 또는 조금 더/적게
<span class="hljs-number">2</span>개의 대파 또는 작은 경우 <span class="hljs-number">3</span>개
<span class="hljs-number">1</span>인치 크기의 생 생강 (약 <span class="hljs-number">4</span>-<span class="hljs-number">6</span>조각 나오는 양)
<span class="hljs-number">2</span>쪽의 마늘
⅔컵의 사케
⅔컵의 간장
¼컵의 미린
½컵의 설탕
필요에 따라 조절 가능한 <span class="hljs-number">2</span>컵의 물
### 요령
돼지고기를 준비하기 전에 줄 또는 부엌 실을 준비하고 가위 한 켤레를 준비하세요.
해당 사항이 있다면 돼지고기의 외부 지방을 다듬어주세요. 그럼에도 불구하고 이후에는 여전히
...
</code></pre>
<p>위의 데이터 외에도 TypedPredictor와 함께 사용할 Pydantic 데이터 모델을 설정해야 합니다:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">FoodMetaData</span>(<span class="hljs-title class_">BaseModel</span>):
    <span class="hljs-attr">reasoning</span>: str = <span class="hljs-title class_">Field</span>(description=<span class="hljs-string">"엔티티가 정확한 이유"</span>)
    <span class="hljs-attr">value</span>: <span class="hljs-title class_">Union</span>[str, int] = <span class="hljs-title class_">Field</span>(description=<span class="hljs-string">"엔티티의 값"</span>)
    <span class="hljs-attr">entity</span>: str = <span class="hljs-title class_">Field</span>(description=<span class="hljs-string">"실제 엔티티 즉, 돼지고기, 양파 등"</span>)

<span class="hljs-keyword">class</span> <span class="hljs-title class_">FoodMetaDatas</span>(<span class="hljs-title class_">BaseModel</span>):
    <span class="hljs-attr">context</span>: <span class="hljs-title class_">List</span>[<span class="hljs-title class_">FoodMetaData</span>]
</code></pre>
<pre><code class="hljs language-js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">FoodEntity</span>(<span class="hljs-title class_">BaseModel</span>):
    <span class="hljs-attr">food</span>: str = <span class="hljs-title class_">Field</span>(description=<span class="hljs-string">"유체 및 고체 음식, 즉 고기, 채소, 주류 등이 될 수 있습니다."</span>)
    <span class="hljs-attr">quantity</span>: int = <span class="hljs-title class_">Field</span>(description=<span class="hljs-string">"레시피에 사용해야 하는 실제 양 또는 양"</span>)
    <span class="hljs-attr">unit</span>: str = <span class="hljs-title class_">Field</span>(description=<span class="hljs-string">"사용 중인 단위, 예를 들어 그램, 밀리리터, 파운드 등"</span>)
    <span class="hljs-attr">physical_quality</span>: <span class="hljs-title class_">Optional</span>[str] = <span class="hljs-title class_">Field</span>(description=<span class="hljs-string">"재료의 특성"</span>)
    <span class="hljs-attr">color</span>: str = <span class="hljs-title class_">Field</span>(description=<span class="hljs-string">"음식의 색상"</span>)
<span class="hljs-keyword">class</span> <span class="hljs-title class_">FoodEntities</span>(<span class="hljs-title class_">BaseModel</span>):
    <span class="hljs-attr">entities</span>: <span class="hljs-title class_">List</span>[<span class="hljs-title class_">FoodEntity</span>]
</code></pre>
<div class="content-ad"></div>
<ul>
<li>FoodMetadatas는 각 엔티티의 컨텍스트 추출 + 추론 흐름의 일부입니다.</li>
<li>FoodEntities는 우리가 원하는 엔티티를 추출하는 데 사용됩니다.</li>
</ul>
<p>마지막으로, DSPy 프로그램이 옵티마이저를 위해 컴파일될 때, 우리는 dspy.Examplemodule을 사용하여 일부 훈련 예제를 만들 것입니다:</p>
<pre><code class="hljs language-js">trainset = [
    dspy.<span class="hljs-title class_">Example</span>(
        recipe=<span class="hljs-string">"2개의 계란, 500그램 버터 및 10그램 그리르치즈로 프렌치 오믈렛 만들기"</span>, 
        entities=[
            <span class="hljs-title class_">FoodEntity</span>(food=<span class="hljs-string">"계란"</span>, quantity=<span class="hljs-number">2</span>, unit=<span class="hljs-string">""</span>, physical_quality=<span class="hljs-string">""</span>, color=<span class="hljs-string">"흰색"</span>),
            <span class="hljs-title class_">FoodEntity</span>(food=<span class="hljs-string">"버터"</span>, quantity=<span class="hljs-number">500</span>, unit=<span class="hljs-string">"그램"</span>, physical_quality=<span class="hljs-string">""</span>, color=<span class="hljs-string">"노랑"</span>),
            <span class="hljs-title class_">FoodEntity</span>(food=<span class="hljs-string">"치즈"</span>, quantity=<span class="hljs-number">10</span>, unit=<span class="hljs-string">"그램"</span>, physical_quality=<span class="hljs-string">"그리레"</span>, color=<span class="hljs-string">"노랑"</span>)
        ]
    ).<span class="hljs-title function_">with_inputs</span>(<span class="hljs-string">"recipe"</span>),
        ...
    dspy.<span class="hljs-title class_">Example</span>(
        recipe=<span class="hljs-string">"250g 밀가루, 1큰술 베이킹 파우더, 1그램 소금, 10g 설탕, 100ml 신선우유로 아메리칸 팬케이크 만들기"</span>, 
        entities=[
            <span class="hljs-title class_">FoodEntity</span>(food=<span class="hljs-string">"밀가루"</span>, quantity=<span class="hljs-number">250</span>, unit=<span class="hljs-string">"그램"</span>, physical_quality=<span class="hljs-string">""</span>, color=<span class="hljs-string">"흰색"</span>),
            <span class="hljs-title class_">FoodEntity</span>(food=<span class="hljs-string">"베이킹 파우더"</span>, quantity=<span class="hljs-number">1</span>, unit=<span class="hljs-string">"큰술"</span>, physical_quality=<span class="hljs-string">""</span>, color=<span class="hljs-string">"흰색"</span>),
            <span class="hljs-title class_">FoodEntity</span>(food=<span class="hljs-string">"소금"</span>, quantity=<span class="hljs-number">1</span>, unit=<span class="hljs-string">"그램"</span>, physical_quality=<span class="hljs-string">"짠맛"</span>, color=<span class="hljs-string">"흰색"</span>),
            <span class="hljs-title class_">FoodEntity</span>(food=<span class="hljs-string">"우유"</span>, quantity=<span class="hljs-number">100</span>, unit=<span class="hljs-string">"밀"</span>, physical_quality=<span class="hljs-string">"지방"</span>, color=<span class="hljs-string">"흰색"</span>),
        ]
    ).<span class="hljs-title function_">with_inputs</span>(<span class="hljs-string">"recipe"</span>)
]
</code></pre>
<h2>서명</h2>
<div class="content-ad"></div>
<p>데이터셋을 만들거나 수집한 후의 다음 단계는 DSPy 프로그램에 대한 서명을 작성하는 것입니다. 이것을 입력/출력 동작에 대한 선언적 명세로 생각할 수 있습니다:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">RecipeToFoodContext</span>(dspy.<span class="hljs-property">Signature</span>):
    <span class="hljs-string">""</span><span class="hljs-string">"당신은 음식 AI 어시스턴트입니다. 엔티티, 엔티티의 값 및 추출된 값이 올바른 값인 이유를 추출하는 작업을 수행해야 합니다. 
    엔티티를 추출할 수 없는 경우 null을 추가하십시오"</span><span class="hljs-string">""</span>
    <span class="hljs-attr">recipe</span>: str = dspy.<span class="hljs-title class_">InputField</span>()
    <span class="hljs-attr">context</span>: <span class="hljs-title class_">FoodMetaDatas</span> = dspy.<span class="hljs-title class_">OutputField</span>()
</code></pre>
<pre><code class="hljs language-js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">RecipeToFoodEntities</span>(dspy.<span class="hljs-property">Signature</span>):
    <span class="hljs-string">""</span><span class="hljs-string">"당신은 음식 AI 어시스턴트입니다. 레시피에서 음식과 관련된 메타데이터를 추출해야 합니다."</span><span class="hljs-string">""</span>
    <span class="hljs-attr">recipe</span>: str = dspy.<span class="hljs-title class_">InputField</span>()
    <span class="hljs-attr">entities</span>: <span class="hljs-title class_">FoodEntities</span> = dspy.<span class="hljs-title class_">OutputField</span>()
</code></pre>
<ul>
<li>RecipeToFoodContext은 문맥 + 추론 호출에 사용되는 서명입니다. 여기에서 문자열 설명을 사용하여 LLM에 초기 지침을 제공했다는 점에 유의하십시오.</li>
<li>RecipeFoodEntities는 실제로 식별된 엔티티를 추출하는 서명에 해당합니다.</li>
</ul>
<div class="content-ad"></div>
<p>지금까지는 특별한 공학 작업이 아니라 Python 클래스/객체를 명시하는 것이었습니다 🐍. 코드는 또한 이해하기 비교적 쉽습니다. 무엇을 하는지, 입력이나 출력 등이 뭔지 잘 알 수 있죠.</p>
<h2>Modules</h2>
<p>데이터셋을 생성하고 서명을 지정한 후에는 모듈을 작성할 준비가 되었습니다. 각 모듈은 Chain-of-Thought, ReAct 등 다양한 프롬프팅 기술을 "추상화"하는 멋진 기능이 있습니다. 또한 신경망 프레임워크에 익숙한 독자들을 위해 아래의 forward 메서드에 주목해주세요:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ExtractFoodEntities</span>(dspy.<span class="hljs-property">Module</span>):
    def <span class="hljs-title function_">__init__</span>(self, <span class="hljs-attr">temperature</span>: int = <span class="hljs-number">0</span>, <span class="hljs-attr">seed</span>: int = <span class="hljs-number">123</span>):
        <span class="hljs-variable language_">super</span>().<span class="hljs-title function_">__init__</span>()
        self.<span class="hljs-property">temperature</span> = temperature
        self.<span class="hljs-property">seed</span> = seed
        self.<span class="hljs-property">extract_food_context</span> = dspy.<span class="hljs-title class_">TypedPredictor</span>(<span class="hljs-title class_">RecipeToFoodContext</span>)
        self.<span class="hljs-property">extract_food_context_cot</span> = dspy.<span class="hljs-title class_">TypedChainOfThought</span>(<span class="hljs-title class_">RecipeToFoodContext</span>)
        self.<span class="hljs-property">extract_food_entities</span> = dspy.<span class="hljs-title class_">TypedPredictor</span>(<span class="hljs-title class_">RecipeToFoodEntities</span>)
        
    def <span class="hljs-title function_">forward</span>(self, <span class="hljs-attr">recipe</span>: str) -> <span class="hljs-title class_">FoodEntities</span>:
        food_context = self.<span class="hljs-title function_">extract_food_context</span>(recipe=recipe).<span class="hljs-property">context</span>
        parsed_context = <span class="hljs-title function_">parse_context</span>(food_context.<span class="hljs-property">context</span>)
        food_entities = self.<span class="hljs-title function_">extract_food_entities</span>(recipe=parsed_context)
        <span class="hljs-keyword">return</span> food_entities.<span class="hljs-property">entities</span>
</code></pre>
<div class="content-ad"></div>
<p>위 모듈은 dspy.Module 인터페이스를 사용하고 있습니다. dspy.Functional 인터페이스를 사용하여 모듈을 지정할 수도 있습니다:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">from</span> dspy.<span class="hljs-property">functional</span> <span class="hljs-keyword">import</span> <span class="hljs-title class_">FunctionalModule</span>, predictor, cot

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ExtractFoodEntitiesV2</span>(<span class="hljs-title class_">FunctionalModule</span>):
    def <span class="hljs-title function_">__init__</span>(self, <span class="hljs-attr">temperature</span>: int = <span class="hljs-number">0</span>, <span class="hljs-attr">seed</span>: int = <span class="hljs-number">123</span>):
        <span class="hljs-variable language_">super</span>().<span class="hljs-title function_">__init__</span>()
        self.<span class="hljs-property">temperature</span> = temperature
        self.<span class="hljs-property">seed</span> = seed
    @predictor
    def <span class="hljs-title function_">extract_food_context</span>(self, <span class="hljs-attr">recipe</span>: str) -> <span class="hljs-title class_">FoodMetaData</span>:
        <span class="hljs-string">""</span><span class="hljs-string">"당신은 음식 AI 어시스턴트입니다. 엔티티, 엔티티의 값 및 추출된 값이 올바른 값인 이유를 추출하는 것이 작업입니다. 
        엔티티를 추출할 수 없는 경우 null을 추가하세요."</span><span class="hljs-string">""</span>
        pass
    @cot
    def <span class="hljs-title function_">extract_food_context_cot</span>(self, <span class="hljs-attr">recipe</span>: str) -> <span class="hljs-title class_">FoodMetaData</span>:
        <span class="hljs-string">""</span><span class="hljs-string">"당신은 음식 AI 어시스턴트입니다. 엔티티, 엔티티의 값 및 추출된 값이 올바른 값인 이유를 추출하는 것이 작업입니다. 
        엔티티를 추출할 수 없는 경우 null을 추가하세요."</span><span class="hljs-string">""</span>
        pass
    
    @predictor
    def <span class="hljs-title function_">extract_food_entities</span>(self, <span class="hljs-attr">recipe</span>: str) -> <span class="hljs-title class_">FoodEntities</span>:
        <span class="hljs-string">""</span><span class="hljs-string">"당신은 음식 AI 어시스턴트입니다. 작업은 레시피에서 음식 엔티티를 추출하는 것입니다."</span><span class="hljs-string">""</span>
        pass
        
    def <span class="hljs-title function_">forward</span>(self, <span class="hljs-attr">recipe</span>: str) -> <span class="hljs-title class_">FoodEntities</span>:
        food_context = self.<span class="hljs-title function_">extract_food_context</span>(recipe=recipe)
        parsed_context = <span class="hljs-title function_">parse_context</span>(food_context.<span class="hljs-property">context</span>)
        food_entities = self.<span class="hljs-title function_">extract_food_entities</span>(recipe=parsed_context)
        <span class="hljs-keyword">return</span> food_entities
</code></pre>
<p>이를 통해 데코레이터 함수를 사용하여 표준 프롬프트 엔지니어링 기술을 지정할 수 있으며, 이는 매우 깔끔합니다. 또한 모듈에서 사용된 parse_context 메서드는 결과 JSON 콘텍스트를 문자열로 구문 분석하는 유틸리티 함수이며, 체인의 다음 단계에 대한 입력으로 사용될 것입니다.</p>
<h2>DSPy 프로그램 실행하기</h2>
<div class="content-ad"></div>
<p>프로그램을 실행하려면 모듈의 인스턴스를 만들고 입력값을 사용하여 호출하십시오. 그러나 DSPy의 또 다른 멋진 기능은 모듈에 대한 dspy.Context를 지정할 수 있다는 것입니다:</p>
<pre><code class="hljs language-js">extract_food_entities = <span class="hljs-title class_">ExtractFoodEntities</span>()

<span class="hljs-keyword">with</span> dspy.<span class="hljs-title function_">context</span>(lm=gpt4):
    entities = <span class="hljs-title function_">extract_food_entities</span>(recipe=<span class="hljs-string">"Ten grams of orange dutch cheese,  \
    2 liters of water and 5 ml of ice"</span>)
    <span class="hljs-title function_">pprint</span>(entities)
</code></pre>
<p>위의 프로그램은 다음 출력을 보여줍니다:</p>
<pre><code class="hljs language-js"><span class="hljs-title class_">FoodEntities</span>(
    entities=[
        <span class="hljs-title class_">FoodEntity</span>(
            food=<span class="hljs-string">'orange dutch cheese'</span>,
            quantity=<span class="hljs-number">10</span>,
            unit=<span class="hljs-string">'grams'</span>,
            physical_quality=<span class="hljs-title class_">None</span>,
            color=<span class="hljs-string">'orange'</span>,
        ),
        <span class="hljs-title class_">FoodEntity</span>(
            food=<span class="hljs-string">'water'</span>,
            quantity=<span class="hljs-number">2000</span>,
            unit=<span class="hljs-string">'milliliters'</span>,
            physical_quality=<span class="hljs-title class_">None</span>,
            color=<span class="hljs-string">'clear'</span>,
        ),
        <span class="hljs-title class_">FoodEntity</span>(
            food=<span class="hljs-string">'ice'</span>,
            quantity=<span class="hljs-number">5</span>,
            unit=<span class="hljs-string">'milliliters'</span>,
            physical_quality=<span class="hljs-title class_">None</span>,
            color=<span class="hljs-string">'clear'</span>,
        ),
    ],
)
</code></pre>
<div class="content-ad"></div>
<p>이것은 다른 LLM(모델 상의 큰 언어 모델)을 시험해보거나, 예를 들어 DEV에는 gpt-3.5-turbo를 사용하고, PROD에서는 더 강인한 모델인 gpt-4-turbo-preview를 사용한다면 유용할 것입니다.</p>
<h2>DSPy 프로그램 최적화하기</h2>
<p>이제 프로그램을 최적화하는 데 필요한 모든 구성 요소가 준비되었습니다 🎉. DSPy에서 최적화자는 DSPy 프로그램의 매개변수인 프롬프트와/또는 LM(언어 모델) 가중치를 조정할 수 있는 알고리즘입니다. 프로그램을 최적화하려면 최대화할 메트릭을 제공합니다.</p>
<p>최적화 단계에서는 BootstrapFewShot 최적화자를 사용합니다. 그리고 최대화하려는 메트릭(어떤 파이썬 함수도 될 수 있음)은 아래에 표시되어 있습니다:</p>
<div class="content-ad"></div>
<pre><code class="hljs language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">validate_entities</span>(<span class="hljs-params">example, pred, trace=<span class="hljs-literal">None</span></span>):
    <span class="hljs-string">"""두 객체가 동일한지 확인합니다."""</span>
    <span class="hljs-keyword">return</span> example.entities == pred
</code></pre>
<p>최적화를 실행하려면 compile 메서드를 사용합니다:</p>
<pre><code class="hljs language-python"><span class="hljs-keyword">from</span> dspy.teleprompt <span class="hljs-keyword">import</span> BootstrapFewShot

teleprompter = BootstrapFewShot(metric=validate_entities)
compiled_ner = teleprompter.<span class="hljs-built_in">compile</span>(ExtractFoodEntitiesV2(), trainset=trainset)
</code></pre>
<p>저희 데이터셋에서 컴파일된 프로그램을 실행한 결과는 다음과 같습니다:</p>
<div class="content-ad"></div>
<pre><code class="hljs language-js"><span class="hljs-title class_">FoodEntities</span>(
    entities=[
        <span class="hljs-title class_">FoodEntity</span>(
            food=<span class="hljs-string">'삼겹살'</span>,
            quantity=<span class="hljs-number">2</span>,
            unit=<span class="hljs-string">'lb'</span>,
            physical_quality=<span class="hljs-title class_">None</span>,
            color=<span class="hljs-string">''</span>,
        ),
        <span class="hljs-title class_">FoodEntity</span>(
            food=<span class="hljs-string">'파'</span>,
            quantity=<span class="hljs-number">2</span>,
            unit=<span class="hljs-string">'개'</span>,
            physical_quality=<span class="hljs-string">'작을 경우 3개'</span>,
            color=<span class="hljs-string">''</span>,
        ),
        <span class="hljs-title class_">FoodEntity</span>(
            food=<span class="hljs-string">'생강'</span>,
            quantity=<span class="hljs-number">1</span>,
            unit=<span class="hljs-string">'인치'</span>,
            physical_quality=<span class="hljs-string">'한 조각'</span>,
            color=<span class="hljs-string">''</span>,
        ),
        <span class="hljs-title class_">FoodEntity</span>(
            food=<span class="hljs-string">'마늘'</span>,
            quantity=<span class="hljs-number">2</span>,
            unit=<span class="hljs-string">'쪽'</span>,
            physical_quality=<span class="hljs-title class_">None</span>,
            color=<span class="hljs-string">''</span>,
        ),
        <span class="hljs-title class_">FoodEntity</span>(
            food=<span class="hljs-string">'술'</span>,
            quantity=<span class="hljs-number">2</span>,
            unit=<span class="hljs-string">'⅔ 컵'</span>,
            physical_quality=<span class="hljs-title class_">None</span>,
            color=<span class="hljs-string">''</span>,
        ),
        <span class="hljs-title class_">FoodEntity</span>(
            food=<span class="hljs-string">'간장'</span>,
            quantity=<span class="hljs-number">2</span>,
            unit=<span class="hljs-string">'⅔ 컵'</span>,
            physical_quality=<span class="hljs-title class_">None</span>,
            color=<span class="hljs-string">''</span>,
        ),
        <span class="hljs-title class_">FoodEntity</span>(
            food=<span class="hljs-string">'미린'</span>,
            quantity=<span class="hljs-number">1</span>,
            unit=<span class="hljs-string">'¼ 컵'</span>,
            physical_quality=<span class="hljs-title class_">None</span>,
            color=<span class="hljs-string">''</span>,
        ),
        <span class="hljs-title class_">FoodEntity</span>(
            food=<span class="hljs-string">'설탕'</span>,
            quantity=<span class="hljs-number">1</span>,
            unit=<span class="hljs-string">'½ 컵'</span>,
            physical_quality=<span class="hljs-title class_">None</span>,
            color=<span class="hljs-string">''</span>,
        ),
        <span class="hljs-title class_">FoodEntity</span>(
            food=<span class="hljs-string">'물'</span>,
            quantity=<span class="hljs-number">2</span>,
            unit=<span class="hljs-string">'컵'</span>,
            physical_quality=<span class="hljs-string">'필요에 따라 약간 더'</span>,
            color=<span class="hljs-string">''</span>,
        ),
    ],
)
</code></pre>
<p>프롬프트 엔지니어링에 반이나하 며 살짝 봐두 시간 정도만 투자한 것에 대해서 꽤 괜찮지 않나요? 💪!</p>
<h2>LLM 검사</h2>
<p>프로그램을 이렇게 선언하는 것도 좋지만 LLM이 사용하는 기본 프롬프트를 확인하려면 어떻게 해야 할까요? 걱정 마세요. inspect_history를 사용해 보세요:</p>
<div class="content-ad"></div>
<pre><code class="hljs language-js">gpt4.<span class="hljs-title function_">inspect_history</span>(n=<span class="hljs-number">1</span>)
</code></pre>
<p>아래와 같은 출력이 나왔습니다:</p>
<pre><code class="hljs language-js">당신은 음식 <span class="hljs-variable constant_">AI</span> 어시스턴트입니다. 레시피에서 음식 엔티티를 추출하는 것이 당신의 임무입니다.

---

다음 형식을 따르세요.
레시피: ${recipe}
음식 엔티티 추출: ${extract_food_entities}. 단일 <span class="hljs-title class_">JSON</span> 객체로 응답하세요. <span class="hljs-title class_">JSON</span> 스키마: {<span class="hljs-string">"$defs"</span>: {<span class="hljs-string">"FoodEntity"</span>: {<span class="hljs-string">"properties"</span>: {<span class="hljs-string">"food"</span>: {<span class="hljs-string">"description"</span>: <span class="hljs-string">"고기, 채소, 주류 등과 같이 고체 및 액체 음식일 수 있습니다"</span>, <span class="hljs-string">"title"</span>: <span class="hljs-string">"음식"</span>, <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>}, <span class="hljs-string">"quantity"</span>: {<span class="hljs-string">"description"</span>: <span class="hljs-string">"레시피에 사용해야 하는 음식의 정확한 양 또는 분량"</span>, <span class="hljs-string">"title"</span>: <span class="hljs-string">"분량"</span>, <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>}, <span class="hljs-string">"unit"</span>: {<span class="hljs-string">"description"</span>: <span class="hljs-string">"사용 중인 단위 (예: 그램, 밀리리터, 파운드 등)"</span>, <span class="hljs-string">"title"</span>: <span class="hljs-string">"단위"</span>, <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>}, <span class="hljs-string">"physical_quality"</span>: {<span class="hljs-string">"anyOf"</span>: [{<span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>}, {<span class="hljs-string">"type"</span>: <span class="hljs-string">"null"</span>}], <span class="hljs-string">"description"</span>: <span class="hljs-string">"재료의 특성"</span>, <span class="hljs-string">"title"</span>: <span class="hljs-string">"물리적 품질"</span>}, <span class="hljs-string">"color"</span>: {<span class="hljs-string">"description"</span>: <span class="hljs-string">"음식의 색깔"</span>, <span class="hljs-string">"title"</span>: <span class="hljs-string">"색깔"</span>, <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>}, <span class="hljs-string">"required"</span>: [<span class="hljs-string">"food"</span>, <span class="hljs-string">"quantity"</span>, <span class="hljs-string">"unit"</span>, <span class="hljs-string">"physical_quality"</span>, <span class="hljs-string">"color"</span>], <span class="hljs-string">"title"</span>: <span class="hljs-string">"FoodEntity"</span>, <span class="hljs-string">"type"</span>: <span class="hljs-string">"object"</span>}, <span class="hljs-string">"properties"</span>: {<span class="hljs-string">"entities"</span>: {<span class="hljs-string">"items"</span>: {<span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#/$defs/FoodEntity"</span>}, <span class="hljs-string">"title"</span>: <span class="hljs-string">"Entities"</span>, <span class="hljs-string">"type"</span>: <span class="hljs-string">"array"</span>}, <span class="hljs-string">"required"</span>: [<span class="hljs-string">"entities"</span>], <span class="hljs-string">"title"</span>: <span class="hljs-string">"FoodEntities"</span>, <span class="hljs-string">"type"</span>: <span class="hljs-string">"object"</span>}
---
레시피:
pork <span class="hljs-attr">belly</span>:
{
<span class="hljs-string">"reasoning"</span>: <span class="hljs-string">"차슈 포크의 주 재료로 2 파운드의 삼겹살을 사용하도록 레시피에서 명시되어 있습니다."</span>,
<span class="hljs-string">"value"</span>: <span class="hljs-string">"2 파운드"</span>,
<span class="hljs-string">"entity"</span>: <span class="hljs-string">"삼겹살"</span>
}
green <span class="hljs-attr">onions</span>:
{
<span class="hljs-string">"reasoning"</span>: <span class="hljs-string">"2개의 대파가 필요하며, 작은 대파인 경우 3개를 사용합니다."</span>,
<span class="hljs-string">"value"</span>: <span class="hljs-string">"2 또는 3"</span>,
<span class="hljs-string">"entity"</span>: <span class="hljs-string">"대파"</span>
}
fresh <span class="hljs-attr">ginger</span>:
{
<span class="hljs-string">"reasoning"</span>: <span class="hljs-string">"레시피에는 신선한 생강 1인치가 필요하며, 이는 레시피에 대략 4~6개의 조각을 제공합니다."</span>,
<span class="hljs-string">"value"</span>: <span class="hljs-string">"1인치"</span>,
<span class="hljs-string">"entity"</span>: <span class="hljs-string">"생강"</span>
}
<span class="hljs-attr">garlic</span>:
{ 
<span class="hljs-string">"reasoning"</span>: <span class="hljs-string">"재료 중에는 마늘 2쪽이 필요합니다."</span>,
<span class="hljs-string">"value"</span>: <span class="hljs-string">"2쪽"</span>,
<span class="hljs-string">"entity"</span>: <span class="hljs-string">"마늘"</span>
}
<span class="hljs-attr">sake</span>:
{
<span class="hljs-string">"reasoning"</span>: <span class="hljs-string">"풍미를 위해 요리 액체에 ⅔컵의 사케가 사용됩니다."</span>,
<span class="hljs-string">"value"</span>: <span class="hljs-string">"⅔컵"</span>,
<span class="hljs-string">"entity"</span>: <span class="hljs-string">"사케"</span>
}
soy <span class="hljs-attr">sauce</span>:
{
<span class="hljs-string">"reasoning"</span>: <span class="hljs-string">"요리 액체에 ⅔컵의 간장이 추가되어 요리의 맛을 더합니다."</span>,
<span class="hljs-string">"value"</span>: <span class="hljs-string">"⅔컵"</span>,
<span class="hljs-string">"entity"</span>: <span class="hljs-string">"간장"</span>
}
<span class="hljs-attr">mirin</span>:
{
<span class="hljs-string">"reasoning"</span>: <span class="hljs-string">"달콤하고 깊은 맛을 위해 레시피에 ¼컵의 미린이 포함됩니다."</span>,
<span class="hljs-string">"value"</span>: <span class="hljs-string">"¼컵"</span>,
<span class="hljs-string">"entity"</span>: <span class="hljs-string">"미린"</span>
}
<span class="hljs-attr">sugar</span>:
{
<span class="hljs-string">"reasoning"</span>: <span class="hljs-string">"요리 액체를 달게하기 위해 ½컵의 설탕을 사용합니다."</span>,
<span class="hljs-string">"value"</span>: <span class="hljs-string">"½컵"</span>,
<span class="hljs-string">"entity"</span>: <span class="hljs-string">"설탕"</span>
}
<span class="hljs-attr">water</span>:
{
<span class="hljs-string">"reasoning"</span>: <span class="hljs-string">"삼겹살을 위한 요리 액체를 만들기 위해 2컵의 물(필요에 따라 더 추가 가능)이 필요합니다."</span>,
<span class="hljs-string">"value"</span>: <span class="hljs-string">"2컵"</span>,
<span class="hljs-string">"entity"</span>: <span class="hljs-string">"물"</span>
}
음식 엔티티 추출: json
{
<span class="hljs-string">"entities"</span>: [
{
<span class="hljs-string">"food"</span>: <span class="hljs-string">"삼겹살"</span>,
<span class="hljs-string">"quantity"</span>: <span class="hljs-number">2</span>,
<span class="hljs-string">"unit"</span>: <span class="hljs-string">"파운드"</span>,
<span class="hljs-string">"physical_quality"</span>: <span class="hljs-literal">null</span>,
<span class="hljs-string">"color"</span>: <span class="hljs-string">""</span>
},
{
<span class="hljs-string">"food"</span>: <span class="hljs-string">"대파"</span>,
<span class="hljs-string">"quantity"</span>: <span class="hljs-number">2</span>,
<span class="hljs-string">"unit"</span>: <span class="hljs-string">"개"</span>,
<span class="hljs-string">"physical_quality"</span>: <span class="hljs-string">"작으면 3개"</span>,
<span class="hljs-string">"color"</span>: <span class="hljs-string">""</span>
},
{
<span class="hljs-string">"food"</span>: <span class="hljs-string">"생강"</span>,
<span class="hljs-string">"quantity"</span>: <span class="hljs-number">1</span>,
<span class="hljs-string">"unit"</span>: <span class="hljs-string">"인치"</span>,
<span class="hljs-string">"physical_quality"</span>: <span class="hljs-string">"조각"</span>,
<span class="hljs-string">"color"</span>: <span class="hljs-string">""</span>
},
{
<span class="hljs-string">"food"</span>: <span class="hljs-string">"마늘"</span>,
<span class="hljs-string">"quantity"</span>: <span class="hljs-number">2</span>,
<span class="hljs-string">"unit"</span>: <span class="hljs-string">"쪽"</span>,
<span class="hljs-string">"physical_quality"</span>: <span class="hljs-literal">null</span>,
<span class="hljs-string">"color"</span>: <span class="hljs-string">""</span>
},
{
<span class="hljs-string">"food"</span>: <span class="hljs-string">"사케"</span>,
<span class="hljs-string">"quantity"</span>: <span class="hljs-number">2</span>,
<span class="hljs-string">"unit"</span>: <span class="hljs-string">"⅔컵"</span>,
<span class="hljs-string">"physical_quality"</span>: <span class="hljs-literal">null</span>,
<span class="hljs-string">"color"</span>: <span class="hljs-string">""</span>
},
{
<span class="hljs-string">"food"</span>: <span class="hljs-string">"간장"</span>,
<span class="hljs-string">"quantity"</span>: <span class="hljs-number">2</span>,
<span class="hljs-string">"unit"</span>: <span class="hljs-string">"⅔컵"</span>,
<span class="hljs-string">"physical_quality"</span>: <span class="hljs-literal">null</span>,
<span class="hljs-string">"color"</span>: <span class="hljs-string">""</span>
},
{
<span class="hljs-string">"food"</span>: <span class="hljs-string">"미린"</span>,
<span class="hljs-string">"quantity"</span>: <span class="hljs-number">1</span>,
<span class="hljs-string">"unit"</span>: <span class="hljs-string">"¼컵"</span>,
<span class="hljs-string">"physical_quality"</span>: <span class="hljs-literal">null</span>,
<span class="hljs-string">"color"</span>: <span class="hljs-string">""</span>
},
{
<span class="hljs-string">"food"</span>: <span class="hljs-string">"설탕"</span>,
<span class="hljs-string">"quantity"</span>: <span class="hljs-number">1</span>,
<span class="hljs-string">"unit"</span>: <span class="hljs-string">"½컵"</span>,
<span class="hljs-string">"physical_quality"</span>: <span class="hljs-literal">null</span>,
<span class="hljs-string">"color"</span>: <span class="hljs-string">""</span>
},
{
<span class="hljs-string">"food"</span>: <span class="hljs-string">"물"</span>,
<span class="hljs-string">"quantity"</span>: <span class="hljs-number">2</span>,
<span class="hljs-string">"unit"</span>: <span class="hljs-string">"컵"</span>,
<span class="hljs-string">"physical_quality"</span>: <span class="hljs-string">"필요에 따라 추가"</span>,
<span class="hljs-string">"color"</span>: <span class="hljs-string">""</span>
}
]
}
<span class="hljs-string">``</span>
</code></pre>
<h1>마무리말</h1>
<div class="content-ad"></div>
<p>이 게시물의 목적은 DSPy 라이브러리를 익히고 TypedPredictor 클래스를 주로 NER 사용 사례에 사용하는 방법을 살펴보는 것이었습니다. 이제 여러분도 더 나은 이해를 하셨으면 좋겠습니다!</p>
<p>첫 인상을 요약하면 다음과 같습니다:</p>
<ul>
<li>DSPy는 사용하기 쉽고 시작하기 쉽습니다 ✅</li>
<li>프롬프트 엔지니어링에 시간을 낭비하는 대신, 프레임워크가 대신 처리해 주는 것이 아주 좋습니다 ✅</li>
<li>LLM을 최적화 및 PyTorch와 같은 아이디어를 사용하여 "전형적인" ML 문제로 다루는 것이 매우 좋습니다 ✅</li>
<li>여전히 발전 중이며 아마도 "운영"에 준비가 되지는 않았습니다 ❌</li>
<li>프로그램을 디버깅할 때 무슨 일이 일어나고 있는지 이해하기 쉽도록 더 나은 로깅/추적이 필요합니다 ❌</li>
</ul>
<p>그러나 프롬프트를하는 대신 LLM을 프로그래밍하는 접근 방식을 좋아합니다. 이것은 분야에서 흥미로운 발전이며 예를 들어, 미래의 복합 AI 시스템에 대한 것입니다.</p>
<div class="content-ad"></div>
<p>DSPY의 채택 및 추가 개발을 기대하고 있어요.</p>
<h1>참고 자료</h1>
<ul>
<li>💻 DSPy 소개: 인사 대신 프로그래밍으로!</li>
<li>💻 DSPy: 선언형 언어 모델 호출을 자가 개선 파이프라인으로 컴파일하기</li>
<li>💻 DSPy 심층 탐구</li>
</ul>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"DSPy를 사용하여 메타데이터 추출하는 방법 - NER 스타일 가이드","description":"","date":"2024-06-22 20:47","slug":"2024-06-22-UsingDSPyforextractingmetadataNERstyle","content":"\n\nDSPy는 프로그래밍을 장려하는 \"선언적\" 방식을 통해 LLMs를 가르치는 것을 선호하여 커뮤니티에서 빠르게 큰 관심을 얻었습니다. 이 글에서는 DSPy를 사용하여 Named Entity Recognition (NER) 또는 구조화된 데이터 추출을 얼마나 쉽게 할 수 있는지 살펴보겠습니다. 이를 통해 자신감을 가지고 기능을 활용할 수 있습니다.\n\n자세한 내용은 아래의 원문을 확인해주세요:\n\n시작해봅시다 😎!\n\n# 소개\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n요즘 대형 언어 모델(Large Language Models, LLM)과 작업한 사람들은 프롬프트(prompt)의 중요성을 강조할 것입니다. 프롬프트를 조금만 바꿔도 출력물에 예상치 못한 변화가 연쇄적으로 발생할 수 있습니다. 또한 다른 LLM 제공업체 간에 프롬프트를 이전하거나 재사용하는 일이 까다로운 경우도 많습니다. 예를 들어, OpenAI에서 Claude 3를 통해 Antrophic을 사용하는 함수 호출 로직을 이동하는 경우 프롬프트를 재설계해야 할 필요가 있죠 😅.\n\n따라서 프롬프트를 다시 작성하고, 평가를 재평가하며, 출력물을 디버깅하는 데 많은 시간 ⏰을 투자해야 합니다. 이를 보다 똑똑하게 처리할 수 있는 방법이 있다면 좋을텐데요? 다행히도, DSPs와 같은 흥미로운 프레임워크는 LLM 제공자에 관계없이 프로그래밍에 중점을 둡니다. 자세한 내용은 참조할 자료에서 DSPy에 대해 더 깊이있게 알아볼 수 있습니다.\n\n# Declarative Self-Improving Language Programs (DSPy)\n\nDSPy 또는 선언적 자기 개선 언어 프로그램(Declarative Self-improving Language Programs, Khattab et al, 2023)은 처음으로 [2]에서 소개되었습니다. DSPy는 PyTorch와 같은 신경망 프레임워크에서 영감을 받아, 프롬프트보다는 프로그래밍에 중점을 둡니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n간단히 말하자면, DSPy 프로그래밍 모델은 다음과 같은 추상화를 가지고 있습니다:\n\n- 필요한 손쓰기 프롬프트/세밀 조정을 대체할 서명.\n- Cot, REACT 등 다양한 프롬프트 엔지니어링 기술을 구현한 모듈.\n- 주어진 메트릭스를 기반으로 한 수동 프롬프트 엔지니어링을 자동화하는 옵티마이저\n\n더 자세한 설명은 참조 사항 중 [1]을 참고하십시오.\n\n# 음식 관련 엔티티에 DSPy를 사용한 NER\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n다음 섹션에서는 DSPy를 사용하여 NER 사용 사례를 살펴볼 것입니다.\n\n## 데이터\n\n사용할 데이터는 라면 🍜 한 그릇을 만들기 위한 차슈 돼지고기 레시피입니다. 아래 게시물에서 자세한 내용을 확인하세요:\n\n예시 데이터:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\n### 차슈 돼지고기 (라면 및 기타 용도)\n차슈 돼지고기는 라멘과 같은 일본 요리에 사용되는 돼지 배를 준비하는 전통적인 방법입니다.\n다소 시간이 걸릴 수 있지만 비교적 손쉽고 맛있는 결과물이 나옵니다.\n\n### 재료\n2 파운드의 돼지 배 또는 조금 더/적게\n2개의 대파 또는 작은 경우 3개\n1인치 크기의 생 생강 (약 4-6조각 나오는 양)\n2쪽의 마늘\n⅔컵의 사케\n⅔컵의 간장\n¼컵의 미린\n½컵의 설탕\n필요에 따라 조절 가능한 2컵의 물\n### 요령\n돼지고기를 준비하기 전에 줄 또는 부엌 실을 준비하고 가위 한 켤레를 준비하세요.\n해당 사항이 있다면 돼지고기의 외부 지방을 다듬어주세요. 그럼에도 불구하고 이후에는 여전히\n...\n```\n\n위의 데이터 외에도 TypedPredictor와 함께 사용할 Pydantic 데이터 모델을 설정해야 합니다:\n\n```js\nclass FoodMetaData(BaseModel):\n    reasoning: str = Field(description=\"엔티티가 정확한 이유\")\n    value: Union[str, int] = Field(description=\"엔티티의 값\")\n    entity: str = Field(description=\"실제 엔티티 즉, 돼지고기, 양파 등\")\n\nclass FoodMetaDatas(BaseModel):\n    context: List[FoodMetaData]\n```\n\n```js\nclass FoodEntity(BaseModel):\n    food: str = Field(description=\"유체 및 고체 음식, 즉 고기, 채소, 주류 등이 될 수 있습니다.\")\n    quantity: int = Field(description=\"레시피에 사용해야 하는 실제 양 또는 양\")\n    unit: str = Field(description=\"사용 중인 단위, 예를 들어 그램, 밀리리터, 파운드 등\")\n    physical_quality: Optional[str] = Field(description=\"재료의 특성\")\n    color: str = Field(description=\"음식의 색상\")\nclass FoodEntities(BaseModel):\n    entities: List[FoodEntity]\n```  \n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n- FoodMetadatas는 각 엔티티의 컨텍스트 추출 + 추론 흐름의 일부입니다.\n- FoodEntities는 우리가 원하는 엔티티를 추출하는 데 사용됩니다.\n\n마지막으로, DSPy 프로그램이 옵티마이저를 위해 컴파일될 때, 우리는 dspy.Examplemodule을 사용하여 일부 훈련 예제를 만들 것입니다:\n\n```js\ntrainset = [\n    dspy.Example(\n        recipe=\"2개의 계란, 500그램 버터 및 10그램 그리르치즈로 프렌치 오믈렛 만들기\", \n        entities=[\n            FoodEntity(food=\"계란\", quantity=2, unit=\"\", physical_quality=\"\", color=\"흰색\"),\n            FoodEntity(food=\"버터\", quantity=500, unit=\"그램\", physical_quality=\"\", color=\"노랑\"),\n            FoodEntity(food=\"치즈\", quantity=10, unit=\"그램\", physical_quality=\"그리레\", color=\"노랑\")\n        ]\n    ).with_inputs(\"recipe\"),\n        ...\n    dspy.Example(\n        recipe=\"250g 밀가루, 1큰술 베이킹 파우더, 1그램 소금, 10g 설탕, 100ml 신선우유로 아메리칸 팬케이크 만들기\", \n        entities=[\n            FoodEntity(food=\"밀가루\", quantity=250, unit=\"그램\", physical_quality=\"\", color=\"흰색\"),\n            FoodEntity(food=\"베이킹 파우더\", quantity=1, unit=\"큰술\", physical_quality=\"\", color=\"흰색\"),\n            FoodEntity(food=\"소금\", quantity=1, unit=\"그램\", physical_quality=\"짠맛\", color=\"흰색\"),\n            FoodEntity(food=\"우유\", quantity=100, unit=\"밀\", physical_quality=\"지방\", color=\"흰색\"),\n        ]\n    ).with_inputs(\"recipe\")\n]\r\n```\n\n## 서명\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n데이터셋을 만들거나 수집한 후의 다음 단계는 DSPy 프로그램에 대한 서명을 작성하는 것입니다. 이것을 입력/출력 동작에 대한 선언적 명세로 생각할 수 있습니다:\n\n```js\nclass RecipeToFoodContext(dspy.Signature):\n    \"\"\"당신은 음식 AI 어시스턴트입니다. 엔티티, 엔티티의 값 및 추출된 값이 올바른 값인 이유를 추출하는 작업을 수행해야 합니다. \n    엔티티를 추출할 수 없는 경우 null을 추가하십시오\"\"\"\n    recipe: str = dspy.InputField()\n    context: FoodMetaDatas = dspy.OutputField()\n```\n\n```js\nclass RecipeToFoodEntities(dspy.Signature):\n    \"\"\"당신은 음식 AI 어시스턴트입니다. 레시피에서 음식과 관련된 메타데이터를 추출해야 합니다.\"\"\"\n    recipe: str = dspy.InputField()\n    entities: FoodEntities = dspy.OutputField()\n```\n\n- RecipeToFoodContext은 문맥 + 추론 호출에 사용되는 서명입니다. 여기에서 문자열 설명을 사용하여 LLM에 초기 지침을 제공했다는 점에 유의하십시오.\n- RecipeFoodEntities는 실제로 식별된 엔티티를 추출하는 서명에 해당합니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n지금까지는 특별한 공학 작업이 아니라 Python 클래스/객체를 명시하는 것이었습니다 🐍. 코드는 또한 이해하기 비교적 쉽습니다. 무엇을 하는지, 입력이나 출력 등이 뭔지 잘 알 수 있죠.\n\n## Modules\n\n데이터셋을 생성하고 서명을 지정한 후에는 모듈을 작성할 준비가 되었습니다. 각 모듈은 Chain-of-Thought, ReAct 등 다양한 프롬프팅 기술을 \"추상화\"하는 멋진 기능이 있습니다. 또한 신경망 프레임워크에 익숙한 독자들을 위해 아래의 forward 메서드에 주목해주세요:\n\n```js\nclass ExtractFoodEntities(dspy.Module):\n    def __init__(self, temperature: int = 0, seed: int = 123):\n        super().__init__()\n        self.temperature = temperature\n        self.seed = seed\n        self.extract_food_context = dspy.TypedPredictor(RecipeToFoodContext)\n        self.extract_food_context_cot = dspy.TypedChainOfThought(RecipeToFoodContext)\n        self.extract_food_entities = dspy.TypedPredictor(RecipeToFoodEntities)\n        \n    def forward(self, recipe: str) -\u003e FoodEntities:\n        food_context = self.extract_food_context(recipe=recipe).context\n        parsed_context = parse_context(food_context.context)\n        food_entities = self.extract_food_entities(recipe=parsed_context)\n        return food_entities.entities\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n위 모듈은 dspy.Module 인터페이스를 사용하고 있습니다. dspy.Functional 인터페이스를 사용하여 모듈을 지정할 수도 있습니다:\n\n```js\nfrom dspy.functional import FunctionalModule, predictor, cot\n\nclass ExtractFoodEntitiesV2(FunctionalModule):\n    def __init__(self, temperature: int = 0, seed: int = 123):\n        super().__init__()\n        self.temperature = temperature\n        self.seed = seed\n    @predictor\n    def extract_food_context(self, recipe: str) -\u003e FoodMetaData:\n        \"\"\"당신은 음식 AI 어시스턴트입니다. 엔티티, 엔티티의 값 및 추출된 값이 올바른 값인 이유를 추출하는 것이 작업입니다. \n        엔티티를 추출할 수 없는 경우 null을 추가하세요.\"\"\"\n        pass\n    @cot\n    def extract_food_context_cot(self, recipe: str) -\u003e FoodMetaData:\n        \"\"\"당신은 음식 AI 어시스턴트입니다. 엔티티, 엔티티의 값 및 추출된 값이 올바른 값인 이유를 추출하는 것이 작업입니다. \n        엔티티를 추출할 수 없는 경우 null을 추가하세요.\"\"\"\n        pass\n    \n    @predictor\n    def extract_food_entities(self, recipe: str) -\u003e FoodEntities:\n        \"\"\"당신은 음식 AI 어시스턴트입니다. 작업은 레시피에서 음식 엔티티를 추출하는 것입니다.\"\"\"\n        pass\n        \n    def forward(self, recipe: str) -\u003e FoodEntities:\n        food_context = self.extract_food_context(recipe=recipe)\n        parsed_context = parse_context(food_context.context)\n        food_entities = self.extract_food_entities(recipe=parsed_context)\n        return food_entities\n```\n\n이를 통해 데코레이터 함수를 사용하여 표준 프롬프트 엔지니어링 기술을 지정할 수 있으며, 이는 매우 깔끔합니다. 또한 모듈에서 사용된 parse_context 메서드는 결과 JSON 콘텍스트를 문자열로 구문 분석하는 유틸리티 함수이며, 체인의 다음 단계에 대한 입력으로 사용될 것입니다.\n\n## DSPy 프로그램 실행하기\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n프로그램을 실행하려면 모듈의 인스턴스를 만들고 입력값을 사용하여 호출하십시오. 그러나 DSPy의 또 다른 멋진 기능은 모듈에 대한 dspy.Context를 지정할 수 있다는 것입니다:\n\n```js\nextract_food_entities = ExtractFoodEntities()\n\nwith dspy.context(lm=gpt4):\n    entities = extract_food_entities(recipe=\"Ten grams of orange dutch cheese,  \\\n    2 liters of water and 5 ml of ice\")\n    pprint(entities)\n```\n\n위의 프로그램은 다음 출력을 보여줍니다:\n\n```js\nFoodEntities(\n    entities=[\n        FoodEntity(\n            food='orange dutch cheese',\n            quantity=10,\n            unit='grams',\n            physical_quality=None,\n            color='orange',\n        ),\n        FoodEntity(\n            food='water',\n            quantity=2000,\n            unit='milliliters',\n            physical_quality=None,\n            color='clear',\n        ),\n        FoodEntity(\n            food='ice',\n            quantity=5,\n            unit='milliliters',\n            physical_quality=None,\n            color='clear',\n        ),\n    ],\n)\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n이것은 다른 LLM(모델 상의 큰 언어 모델)을 시험해보거나, 예를 들어 DEV에는 gpt-3.5-turbo를 사용하고, PROD에서는 더 강인한 모델인 gpt-4-turbo-preview를 사용한다면 유용할 것입니다.\n\n## DSPy 프로그램 최적화하기\n\n이제 프로그램을 최적화하는 데 필요한 모든 구성 요소가 준비되었습니다 🎉. DSPy에서 최적화자는 DSPy 프로그램의 매개변수인 프롬프트와/또는 LM(언어 모델) 가중치를 조정할 수 있는 알고리즘입니다. 프로그램을 최적화하려면 최대화할 메트릭을 제공합니다.\n\n최적화 단계에서는 BootstrapFewShot 최적화자를 사용합니다. 그리고 최대화하려는 메트릭(어떤 파이썬 함수도 될 수 있음)은 아래에 표시되어 있습니다:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```python\ndef validate_entities(example, pred, trace=None):\n    \"\"\"두 객체가 동일한지 확인합니다.\"\"\"\n    return example.entities == pred\n```\n\n최적화를 실행하려면 compile 메서드를 사용합니다:\n\n```python\nfrom dspy.teleprompt import BootstrapFewShot\n\nteleprompter = BootstrapFewShot(metric=validate_entities)\ncompiled_ner = teleprompter.compile(ExtractFoodEntitiesV2(), trainset=trainset)\n```\n\n저희 데이터셋에서 컴파일된 프로그램을 실행한 결과는 다음과 같습니다:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\nFoodEntities(\n    entities=[\n        FoodEntity(\n            food='삼겹살',\n            quantity=2,\n            unit='lb',\n            physical_quality=None,\n            color='',\n        ),\n        FoodEntity(\n            food='파',\n            quantity=2,\n            unit='개',\n            physical_quality='작을 경우 3개',\n            color='',\n        ),\n        FoodEntity(\n            food='생강',\n            quantity=1,\n            unit='인치',\n            physical_quality='한 조각',\n            color='',\n        ),\n        FoodEntity(\n            food='마늘',\n            quantity=2,\n            unit='쪽',\n            physical_quality=None,\n            color='',\n        ),\n        FoodEntity(\n            food='술',\n            quantity=2,\n            unit='⅔ 컵',\n            physical_quality=None,\n            color='',\n        ),\n        FoodEntity(\n            food='간장',\n            quantity=2,\n            unit='⅔ 컵',\n            physical_quality=None,\n            color='',\n        ),\n        FoodEntity(\n            food='미린',\n            quantity=1,\n            unit='¼ 컵',\n            physical_quality=None,\n            color='',\n        ),\n        FoodEntity(\n            food='설탕',\n            quantity=1,\n            unit='½ 컵',\n            physical_quality=None,\n            color='',\n        ),\n        FoodEntity(\n            food='물',\n            quantity=2,\n            unit='컵',\n            physical_quality='필요에 따라 약간 더',\n            color='',\n        ),\n    ],\n)\r\n```\n\n프롬프트 엔지니어링에 반이나하 며 살짝 봐두 시간 정도만 투자한 것에 대해서 꽤 괜찮지 않나요? 💪!\n\n## LLM 검사\n\n프로그램을 이렇게 선언하는 것도 좋지만 LLM이 사용하는 기본 프롬프트를 확인하려면 어떻게 해야 할까요? 걱정 마세요. inspect_history를 사용해 보세요:\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\r\ngpt4.inspect_history(n=1)\r\n```\r\n\r\n아래와 같은 출력이 나왔습니다:\r\n\r\n```js\r\n당신은 음식 AI 어시스턴트입니다. 레시피에서 음식 엔티티를 추출하는 것이 당신의 임무입니다.\r\n\r\n---\r\n\r\n다음 형식을 따르세요.\r\n레시피: ${recipe}\r\n음식 엔티티 추출: ${extract_food_entities}. 단일 JSON 객체로 응답하세요. JSON 스키마: {\"$defs\": {\"FoodEntity\": {\"properties\": {\"food\": {\"description\": \"고기, 채소, 주류 등과 같이 고체 및 액체 음식일 수 있습니다\", \"title\": \"음식\", \"type\": \"string\"}, \"quantity\": {\"description\": \"레시피에 사용해야 하는 음식의 정확한 양 또는 분량\", \"title\": \"분량\", \"type\": \"integer\"}, \"unit\": {\"description\": \"사용 중인 단위 (예: 그램, 밀리리터, 파운드 등)\", \"title\": \"단위\", \"type\": \"string\"}, \"physical_quality\": {\"anyOf\": [{\"type\": \"string\"}, {\"type\": \"null\"}], \"description\": \"재료의 특성\", \"title\": \"물리적 품질\"}, \"color\": {\"description\": \"음식의 색깔\", \"title\": \"색깔\", \"type\": \"string\"}, \"required\": [\"food\", \"quantity\", \"unit\", \"physical_quality\", \"color\"], \"title\": \"FoodEntity\", \"type\": \"object\"}, \"properties\": {\"entities\": {\"items\": {\"$ref\": \"#/$defs/FoodEntity\"}, \"title\": \"Entities\", \"type\": \"array\"}, \"required\": [\"entities\"], \"title\": \"FoodEntities\", \"type\": \"object\"}\r\n---\r\n레시피:\r\npork belly:\r\n{\r\n\"reasoning\": \"차슈 포크의 주 재료로 2 파운드의 삼겹살을 사용하도록 레시피에서 명시되어 있습니다.\",\r\n\"value\": \"2 파운드\",\r\n\"entity\": \"삼겹살\"\r\n}\r\ngreen onions:\r\n{\r\n\"reasoning\": \"2개의 대파가 필요하며, 작은 대파인 경우 3개를 사용합니다.\",\r\n\"value\": \"2 또는 3\",\r\n\"entity\": \"대파\"\r\n}\r\nfresh ginger:\r\n{\r\n\"reasoning\": \"레시피에는 신선한 생강 1인치가 필요하며, 이는 레시피에 대략 4~6개의 조각을 제공합니다.\",\r\n\"value\": \"1인치\",\r\n\"entity\": \"생강\"\r\n}\r\ngarlic:\r\n{ \r\n\"reasoning\": \"재료 중에는 마늘 2쪽이 필요합니다.\",\r\n\"value\": \"2쪽\",\r\n\"entity\": \"마늘\"\r\n}\r\nsake:\r\n{\r\n\"reasoning\": \"풍미를 위해 요리 액체에 ⅔컵의 사케가 사용됩니다.\",\r\n\"value\": \"⅔컵\",\r\n\"entity\": \"사케\"\r\n}\r\nsoy sauce:\r\n{\r\n\"reasoning\": \"요리 액체에 ⅔컵의 간장이 추가되어 요리의 맛을 더합니다.\",\r\n\"value\": \"⅔컵\",\r\n\"entity\": \"간장\"\r\n}\r\nmirin:\r\n{\r\n\"reasoning\": \"달콤하고 깊은 맛을 위해 레시피에 ¼컵의 미린이 포함됩니다.\",\r\n\"value\": \"¼컵\",\r\n\"entity\": \"미린\"\r\n}\r\nsugar:\r\n{\r\n\"reasoning\": \"요리 액체를 달게하기 위해 ½컵의 설탕을 사용합니다.\",\r\n\"value\": \"½컵\",\r\n\"entity\": \"설탕\"\r\n}\r\nwater:\r\n{\r\n\"reasoning\": \"삼겹살을 위한 요리 액체를 만들기 위해 2컵의 물(필요에 따라 더 추가 가능)이 필요합니다.\",\r\n\"value\": \"2컵\",\r\n\"entity\": \"물\"\r\n}\r\n음식 엔티티 추출: json\r\n{\r\n\"entities\": [\r\n{\r\n\"food\": \"삼겹살\",\r\n\"quantity\": 2,\r\n\"unit\": \"파운드\",\r\n\"physical_quality\": null,\r\n\"color\": \"\"\r\n},\r\n{\r\n\"food\": \"대파\",\r\n\"quantity\": 2,\r\n\"unit\": \"개\",\r\n\"physical_quality\": \"작으면 3개\",\r\n\"color\": \"\"\r\n},\r\n{\r\n\"food\": \"생강\",\r\n\"quantity\": 1,\r\n\"unit\": \"인치\",\r\n\"physical_quality\": \"조각\",\r\n\"color\": \"\"\r\n},\r\n{\r\n\"food\": \"마늘\",\r\n\"quantity\": 2,\r\n\"unit\": \"쪽\",\r\n\"physical_quality\": null,\r\n\"color\": \"\"\r\n},\r\n{\r\n\"food\": \"사케\",\r\n\"quantity\": 2,\r\n\"unit\": \"⅔컵\",\r\n\"physical_quality\": null,\r\n\"color\": \"\"\r\n},\r\n{\r\n\"food\": \"간장\",\r\n\"quantity\": 2,\r\n\"unit\": \"⅔컵\",\r\n\"physical_quality\": null,\r\n\"color\": \"\"\r\n},\r\n{\r\n\"food\": \"미린\",\r\n\"quantity\": 1,\r\n\"unit\": \"¼컵\",\r\n\"physical_quality\": null,\r\n\"color\": \"\"\r\n},\r\n{\r\n\"food\": \"설탕\",\r\n\"quantity\": 1,\r\n\"unit\": \"½컵\",\r\n\"physical_quality\": null,\r\n\"color\": \"\"\r\n},\r\n{\r\n\"food\": \"물\",\r\n\"quantity\": 2,\r\n\"unit\": \"컵\",\r\n\"physical_quality\": \"필요에 따라 추가\",\r\n\"color\": \"\"\r\n}\r\n]\r\n}\r\n``\r\n```\r\n\r\n# 마무리말\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n이 게시물의 목적은 DSPy 라이브러리를 익히고 TypedPredictor 클래스를 주로 NER 사용 사례에 사용하는 방법을 살펴보는 것이었습니다. 이제 여러분도 더 나은 이해를 하셨으면 좋겠습니다!\n\n첫 인상을 요약하면 다음과 같습니다:\n\n- DSPy는 사용하기 쉽고 시작하기 쉽습니다 ✅\n- 프롬프트 엔지니어링에 시간을 낭비하는 대신, 프레임워크가 대신 처리해 주는 것이 아주 좋습니다 ✅\n- LLM을 최적화 및 PyTorch와 같은 아이디어를 사용하여 \"전형적인\" ML 문제로 다루는 것이 매우 좋습니다 ✅\n- 여전히 발전 중이며 아마도 \"운영\"에 준비가 되지는 않았습니다 ❌\n- 프로그램을 디버깅할 때 무슨 일이 일어나고 있는지 이해하기 쉽도록 더 나은 로깅/추적이 필요합니다 ❌\n\n그러나 프롬프트를하는 대신 LLM을 프로그래밍하는 접근 방식을 좋아합니다. 이것은 분야에서 흥미로운 발전이며 예를 들어, 미래의 복합 AI 시스템에 대한 것입니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nDSPY의 채택 및 추가 개발을 기대하고 있어요.\n\n# 참고 자료\n\n- 💻 DSPy 소개: 인사 대신 프로그래밍으로!\n- 💻 DSPy: 선언형 언어 모델 호출을 자가 개선 파이프라인으로 컴파일하기\n- 💻 DSPy 심층 탐구","ogImage":{"url":"/assets/img/2024-06-22-UsingDSPyforextractingmetadataNERstyle_0.png"},"coverImage":"/assets/img/2024-06-22-UsingDSPyforextractingmetadataNERstyle_0.png","tag":["Tech"],"readingTime":15},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003eDSPy는 프로그래밍을 장려하는 \"선언적\" 방식을 통해 LLMs를 가르치는 것을 선호하여 커뮤니티에서 빠르게 큰 관심을 얻었습니다. 이 글에서는 DSPy를 사용하여 Named Entity Recognition (NER) 또는 구조화된 데이터 추출을 얼마나 쉽게 할 수 있는지 살펴보겠습니다. 이를 통해 자신감을 가지고 기능을 활용할 수 있습니다.\u003c/p\u003e\n\u003cp\u003e자세한 내용은 아래의 원문을 확인해주세요:\u003c/p\u003e\n\u003cp\u003e시작해봅시다 😎!\u003c/p\u003e\n\u003ch1\u003e소개\u003c/h1\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e요즘 대형 언어 모델(Large Language Models, LLM)과 작업한 사람들은 프롬프트(prompt)의 중요성을 강조할 것입니다. 프롬프트를 조금만 바꿔도 출력물에 예상치 못한 변화가 연쇄적으로 발생할 수 있습니다. 또한 다른 LLM 제공업체 간에 프롬프트를 이전하거나 재사용하는 일이 까다로운 경우도 많습니다. 예를 들어, OpenAI에서 Claude 3를 통해 Antrophic을 사용하는 함수 호출 로직을 이동하는 경우 프롬프트를 재설계해야 할 필요가 있죠 😅.\u003c/p\u003e\n\u003cp\u003e따라서 프롬프트를 다시 작성하고, 평가를 재평가하며, 출력물을 디버깅하는 데 많은 시간 ⏰을 투자해야 합니다. 이를 보다 똑똑하게 처리할 수 있는 방법이 있다면 좋을텐데요? 다행히도, DSPs와 같은 흥미로운 프레임워크는 LLM 제공자에 관계없이 프로그래밍에 중점을 둡니다. 자세한 내용은 참조할 자료에서 DSPy에 대해 더 깊이있게 알아볼 수 있습니다.\u003c/p\u003e\n\u003ch1\u003eDeclarative Self-Improving Language Programs (DSPy)\u003c/h1\u003e\n\u003cp\u003eDSPy 또는 선언적 자기 개선 언어 프로그램(Declarative Self-improving Language Programs, Khattab et al, 2023)은 처음으로 [2]에서 소개되었습니다. DSPy는 PyTorch와 같은 신경망 프레임워크에서 영감을 받아, 프롬프트보다는 프로그래밍에 중점을 둡니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e간단히 말하자면, DSPy 프로그래밍 모델은 다음과 같은 추상화를 가지고 있습니다:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e필요한 손쓰기 프롬프트/세밀 조정을 대체할 서명.\u003c/li\u003e\n\u003cli\u003eCot, REACT 등 다양한 프롬프트 엔지니어링 기술을 구현한 모듈.\u003c/li\u003e\n\u003cli\u003e주어진 메트릭스를 기반으로 한 수동 프롬프트 엔지니어링을 자동화하는 옵티마이저\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e더 자세한 설명은 참조 사항 중 [1]을 참고하십시오.\u003c/p\u003e\n\u003ch1\u003e음식 관련 엔티티에 DSPy를 사용한 NER\u003c/h1\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e다음 섹션에서는 DSPy를 사용하여 NER 사용 사례를 살펴볼 것입니다.\u003c/p\u003e\n\u003ch2\u003e데이터\u003c/h2\u003e\n\u003cp\u003e사용할 데이터는 라면 🍜 한 그릇을 만들기 위한 차슈 돼지고기 레시피입니다. 아래 게시물에서 자세한 내용을 확인하세요:\u003c/p\u003e\n\u003cp\u003e예시 데이터:\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e### 차슈 돼지고기 (라면 및 기타 용도)\n차슈 돼지고기는 라멘과 같은 일본 요리에 사용되는 돼지 배를 준비하는 전통적인 방법입니다.\n다소 시간이 걸릴 수 있지만 비교적 손쉽고 맛있는 결과물이 나옵니다.\n\n### 재료\n\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e 파운드의 돼지 배 또는 조금 더/적게\n\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e개의 대파 또는 작은 경우 \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e개\n\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e인치 크기의 생 생강 (약 \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e-\u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e조각 나오는 양)\n\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e쪽의 마늘\n⅔컵의 사케\n⅔컵의 간장\n¼컵의 미린\n½컵의 설탕\n필요에 따라 조절 가능한 \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e컵의 물\n### 요령\n돼지고기를 준비하기 전에 줄 또는 부엌 실을 준비하고 가위 한 켤레를 준비하세요.\n해당 사항이 있다면 돼지고기의 외부 지방을 다듬어주세요. 그럼에도 불구하고 이후에는 여전히\n...\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e위의 데이터 외에도 TypedPredictor와 함께 사용할 Pydantic 데이터 모델을 설정해야 합니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eFoodMetaData\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eBaseModel\u003c/span\u003e):\n    \u003cspan class=\"hljs-attr\"\u003ereasoning\u003c/span\u003e: str = \u003cspan class=\"hljs-title class_\"\u003eField\u003c/span\u003e(description=\u003cspan class=\"hljs-string\"\u003e\"엔티티가 정확한 이유\"\u003c/span\u003e)\n    \u003cspan class=\"hljs-attr\"\u003evalue\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eUnion\u003c/span\u003e[str, int] = \u003cspan class=\"hljs-title class_\"\u003eField\u003c/span\u003e(description=\u003cspan class=\"hljs-string\"\u003e\"엔티티의 값\"\u003c/span\u003e)\n    \u003cspan class=\"hljs-attr\"\u003eentity\u003c/span\u003e: str = \u003cspan class=\"hljs-title class_\"\u003eField\u003c/span\u003e(description=\u003cspan class=\"hljs-string\"\u003e\"실제 엔티티 즉, 돼지고기, 양파 등\"\u003c/span\u003e)\n\n\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eFoodMetaDatas\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eBaseModel\u003c/span\u003e):\n    \u003cspan class=\"hljs-attr\"\u003econtext\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eList\u003c/span\u003e[\u003cspan class=\"hljs-title class_\"\u003eFoodMetaData\u003c/span\u003e]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eFoodEntity\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eBaseModel\u003c/span\u003e):\n    \u003cspan class=\"hljs-attr\"\u003efood\u003c/span\u003e: str = \u003cspan class=\"hljs-title class_\"\u003eField\u003c/span\u003e(description=\u003cspan class=\"hljs-string\"\u003e\"유체 및 고체 음식, 즉 고기, 채소, 주류 등이 될 수 있습니다.\"\u003c/span\u003e)\n    \u003cspan class=\"hljs-attr\"\u003equantity\u003c/span\u003e: int = \u003cspan class=\"hljs-title class_\"\u003eField\u003c/span\u003e(description=\u003cspan class=\"hljs-string\"\u003e\"레시피에 사용해야 하는 실제 양 또는 양\"\u003c/span\u003e)\n    \u003cspan class=\"hljs-attr\"\u003eunit\u003c/span\u003e: str = \u003cspan class=\"hljs-title class_\"\u003eField\u003c/span\u003e(description=\u003cspan class=\"hljs-string\"\u003e\"사용 중인 단위, 예를 들어 그램, 밀리리터, 파운드 등\"\u003c/span\u003e)\n    \u003cspan class=\"hljs-attr\"\u003ephysical_quality\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eOptional\u003c/span\u003e[str] = \u003cspan class=\"hljs-title class_\"\u003eField\u003c/span\u003e(description=\u003cspan class=\"hljs-string\"\u003e\"재료의 특성\"\u003c/span\u003e)\n    \u003cspan class=\"hljs-attr\"\u003ecolor\u003c/span\u003e: str = \u003cspan class=\"hljs-title class_\"\u003eField\u003c/span\u003e(description=\u003cspan class=\"hljs-string\"\u003e\"음식의 색상\"\u003c/span\u003e)\n\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eFoodEntities\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eBaseModel\u003c/span\u003e):\n    \u003cspan class=\"hljs-attr\"\u003eentities\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eList\u003c/span\u003e[\u003cspan class=\"hljs-title class_\"\u003eFoodEntity\u003c/span\u003e]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eFoodMetadatas는 각 엔티티의 컨텍스트 추출 + 추론 흐름의 일부입니다.\u003c/li\u003e\n\u003cli\u003eFoodEntities는 우리가 원하는 엔티티를 추출하는 데 사용됩니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e마지막으로, DSPy 프로그램이 옵티마이저를 위해 컴파일될 때, 우리는 dspy.Examplemodule을 사용하여 일부 훈련 예제를 만들 것입니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003etrainset = [\n    dspy.\u003cspan class=\"hljs-title class_\"\u003eExample\u003c/span\u003e(\n        recipe=\u003cspan class=\"hljs-string\"\u003e\"2개의 계란, 500그램 버터 및 10그램 그리르치즈로 프렌치 오믈렛 만들기\"\u003c/span\u003e, \n        entities=[\n            \u003cspan class=\"hljs-title class_\"\u003eFoodEntity\u003c/span\u003e(food=\u003cspan class=\"hljs-string\"\u003e\"계란\"\u003c/span\u003e, quantity=\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e, unit=\u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e, physical_quality=\u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e, color=\u003cspan class=\"hljs-string\"\u003e\"흰색\"\u003c/span\u003e),\n            \u003cspan class=\"hljs-title class_\"\u003eFoodEntity\u003c/span\u003e(food=\u003cspan class=\"hljs-string\"\u003e\"버터\"\u003c/span\u003e, quantity=\u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e, unit=\u003cspan class=\"hljs-string\"\u003e\"그램\"\u003c/span\u003e, physical_quality=\u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e, color=\u003cspan class=\"hljs-string\"\u003e\"노랑\"\u003c/span\u003e),\n            \u003cspan class=\"hljs-title class_\"\u003eFoodEntity\u003c/span\u003e(food=\u003cspan class=\"hljs-string\"\u003e\"치즈\"\u003c/span\u003e, quantity=\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e, unit=\u003cspan class=\"hljs-string\"\u003e\"그램\"\u003c/span\u003e, physical_quality=\u003cspan class=\"hljs-string\"\u003e\"그리레\"\u003c/span\u003e, color=\u003cspan class=\"hljs-string\"\u003e\"노랑\"\u003c/span\u003e)\n        ]\n    ).\u003cspan class=\"hljs-title function_\"\u003ewith_inputs\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"recipe\"\u003c/span\u003e),\n        ...\n    dspy.\u003cspan class=\"hljs-title class_\"\u003eExample\u003c/span\u003e(\n        recipe=\u003cspan class=\"hljs-string\"\u003e\"250g 밀가루, 1큰술 베이킹 파우더, 1그램 소금, 10g 설탕, 100ml 신선우유로 아메리칸 팬케이크 만들기\"\u003c/span\u003e, \n        entities=[\n            \u003cspan class=\"hljs-title class_\"\u003eFoodEntity\u003c/span\u003e(food=\u003cspan class=\"hljs-string\"\u003e\"밀가루\"\u003c/span\u003e, quantity=\u003cspan class=\"hljs-number\"\u003e250\u003c/span\u003e, unit=\u003cspan class=\"hljs-string\"\u003e\"그램\"\u003c/span\u003e, physical_quality=\u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e, color=\u003cspan class=\"hljs-string\"\u003e\"흰색\"\u003c/span\u003e),\n            \u003cspan class=\"hljs-title class_\"\u003eFoodEntity\u003c/span\u003e(food=\u003cspan class=\"hljs-string\"\u003e\"베이킹 파우더\"\u003c/span\u003e, quantity=\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, unit=\u003cspan class=\"hljs-string\"\u003e\"큰술\"\u003c/span\u003e, physical_quality=\u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e, color=\u003cspan class=\"hljs-string\"\u003e\"흰색\"\u003c/span\u003e),\n            \u003cspan class=\"hljs-title class_\"\u003eFoodEntity\u003c/span\u003e(food=\u003cspan class=\"hljs-string\"\u003e\"소금\"\u003c/span\u003e, quantity=\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, unit=\u003cspan class=\"hljs-string\"\u003e\"그램\"\u003c/span\u003e, physical_quality=\u003cspan class=\"hljs-string\"\u003e\"짠맛\"\u003c/span\u003e, color=\u003cspan class=\"hljs-string\"\u003e\"흰색\"\u003c/span\u003e),\n            \u003cspan class=\"hljs-title class_\"\u003eFoodEntity\u003c/span\u003e(food=\u003cspan class=\"hljs-string\"\u003e\"우유\"\u003c/span\u003e, quantity=\u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e, unit=\u003cspan class=\"hljs-string\"\u003e\"밀\"\u003c/span\u003e, physical_quality=\u003cspan class=\"hljs-string\"\u003e\"지방\"\u003c/span\u003e, color=\u003cspan class=\"hljs-string\"\u003e\"흰색\"\u003c/span\u003e),\n        ]\n    ).\u003cspan class=\"hljs-title function_\"\u003ewith_inputs\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"recipe\"\u003c/span\u003e)\n]\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e서명\u003c/h2\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e데이터셋을 만들거나 수집한 후의 다음 단계는 DSPy 프로그램에 대한 서명을 작성하는 것입니다. 이것을 입력/출력 동작에 대한 선언적 명세로 생각할 수 있습니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eRecipeToFoodContext\u003c/span\u003e(dspy.\u003cspan class=\"hljs-property\"\u003eSignature\u003c/span\u003e):\n    \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e\"당신은 음식 AI 어시스턴트입니다. 엔티티, 엔티티의 값 및 추출된 값이 올바른 값인 이유를 추출하는 작업을 수행해야 합니다. \n    엔티티를 추출할 수 없는 경우 null을 추가하십시오\"\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003erecipe\u003c/span\u003e: str = dspy.\u003cspan class=\"hljs-title class_\"\u003eInputField\u003c/span\u003e()\n    \u003cspan class=\"hljs-attr\"\u003econtext\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eFoodMetaDatas\u003c/span\u003e = dspy.\u003cspan class=\"hljs-title class_\"\u003eOutputField\u003c/span\u003e()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eRecipeToFoodEntities\u003c/span\u003e(dspy.\u003cspan class=\"hljs-property\"\u003eSignature\u003c/span\u003e):\n    \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e\"당신은 음식 AI 어시스턴트입니다. 레시피에서 음식과 관련된 메타데이터를 추출해야 합니다.\"\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003erecipe\u003c/span\u003e: str = dspy.\u003cspan class=\"hljs-title class_\"\u003eInputField\u003c/span\u003e()\n    \u003cspan class=\"hljs-attr\"\u003eentities\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eFoodEntities\u003c/span\u003e = dspy.\u003cspan class=\"hljs-title class_\"\u003eOutputField\u003c/span\u003e()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eRecipeToFoodContext은 문맥 + 추론 호출에 사용되는 서명입니다. 여기에서 문자열 설명을 사용하여 LLM에 초기 지침을 제공했다는 점에 유의하십시오.\u003c/li\u003e\n\u003cli\u003eRecipeFoodEntities는 실제로 식별된 엔티티를 추출하는 서명에 해당합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e지금까지는 특별한 공학 작업이 아니라 Python 클래스/객체를 명시하는 것이었습니다 🐍. 코드는 또한 이해하기 비교적 쉽습니다. 무엇을 하는지, 입력이나 출력 등이 뭔지 잘 알 수 있죠.\u003c/p\u003e\n\u003ch2\u003eModules\u003c/h2\u003e\n\u003cp\u003e데이터셋을 생성하고 서명을 지정한 후에는 모듈을 작성할 준비가 되었습니다. 각 모듈은 Chain-of-Thought, ReAct 등 다양한 프롬프팅 기술을 \"추상화\"하는 멋진 기능이 있습니다. 또한 신경망 프레임워크에 익숙한 독자들을 위해 아래의 forward 메서드에 주목해주세요:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eExtractFoodEntities\u003c/span\u003e(dspy.\u003cspan class=\"hljs-property\"\u003eModule\u003c/span\u003e):\n    def \u003cspan class=\"hljs-title function_\"\u003e__init__\u003c/span\u003e(self, \u003cspan class=\"hljs-attr\"\u003etemperature\u003c/span\u003e: int = \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eseed\u003c/span\u003e: int = \u003cspan class=\"hljs-number\"\u003e123\u003c/span\u003e):\n        \u003cspan class=\"hljs-variable language_\"\u003esuper\u003c/span\u003e().\u003cspan class=\"hljs-title function_\"\u003e__init__\u003c/span\u003e()\n        self.\u003cspan class=\"hljs-property\"\u003etemperature\u003c/span\u003e = temperature\n        self.\u003cspan class=\"hljs-property\"\u003eseed\u003c/span\u003e = seed\n        self.\u003cspan class=\"hljs-property\"\u003eextract_food_context\u003c/span\u003e = dspy.\u003cspan class=\"hljs-title class_\"\u003eTypedPredictor\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eRecipeToFoodContext\u003c/span\u003e)\n        self.\u003cspan class=\"hljs-property\"\u003eextract_food_context_cot\u003c/span\u003e = dspy.\u003cspan class=\"hljs-title class_\"\u003eTypedChainOfThought\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eRecipeToFoodContext\u003c/span\u003e)\n        self.\u003cspan class=\"hljs-property\"\u003eextract_food_entities\u003c/span\u003e = dspy.\u003cspan class=\"hljs-title class_\"\u003eTypedPredictor\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eRecipeToFoodEntities\u003c/span\u003e)\n        \n    def \u003cspan class=\"hljs-title function_\"\u003eforward\u003c/span\u003e(self, \u003cspan class=\"hljs-attr\"\u003erecipe\u003c/span\u003e: str) -\u003e \u003cspan class=\"hljs-title class_\"\u003eFoodEntities\u003c/span\u003e:\n        food_context = self.\u003cspan class=\"hljs-title function_\"\u003eextract_food_context\u003c/span\u003e(recipe=recipe).\u003cspan class=\"hljs-property\"\u003econtext\u003c/span\u003e\n        parsed_context = \u003cspan class=\"hljs-title function_\"\u003eparse_context\u003c/span\u003e(food_context.\u003cspan class=\"hljs-property\"\u003econtext\u003c/span\u003e)\n        food_entities = self.\u003cspan class=\"hljs-title function_\"\u003eextract_food_entities\u003c/span\u003e(recipe=parsed_context)\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e food_entities.\u003cspan class=\"hljs-property\"\u003eentities\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e위 모듈은 dspy.Module 인터페이스를 사용하고 있습니다. dspy.Functional 인터페이스를 사용하여 모듈을 지정할 수도 있습니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e dspy.\u003cspan class=\"hljs-property\"\u003efunctional\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eFunctionalModule\u003c/span\u003e, predictor, cot\n\n\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eExtractFoodEntitiesV2\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eFunctionalModule\u003c/span\u003e):\n    def \u003cspan class=\"hljs-title function_\"\u003e__init__\u003c/span\u003e(self, \u003cspan class=\"hljs-attr\"\u003etemperature\u003c/span\u003e: int = \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eseed\u003c/span\u003e: int = \u003cspan class=\"hljs-number\"\u003e123\u003c/span\u003e):\n        \u003cspan class=\"hljs-variable language_\"\u003esuper\u003c/span\u003e().\u003cspan class=\"hljs-title function_\"\u003e__init__\u003c/span\u003e()\n        self.\u003cspan class=\"hljs-property\"\u003etemperature\u003c/span\u003e = temperature\n        self.\u003cspan class=\"hljs-property\"\u003eseed\u003c/span\u003e = seed\n    @predictor\n    def \u003cspan class=\"hljs-title function_\"\u003eextract_food_context\u003c/span\u003e(self, \u003cspan class=\"hljs-attr\"\u003erecipe\u003c/span\u003e: str) -\u003e \u003cspan class=\"hljs-title class_\"\u003eFoodMetaData\u003c/span\u003e:\n        \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e\"당신은 음식 AI 어시스턴트입니다. 엔티티, 엔티티의 값 및 추출된 값이 올바른 값인 이유를 추출하는 것이 작업입니다. \n        엔티티를 추출할 수 없는 경우 null을 추가하세요.\"\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\n        pass\n    @cot\n    def \u003cspan class=\"hljs-title function_\"\u003eextract_food_context_cot\u003c/span\u003e(self, \u003cspan class=\"hljs-attr\"\u003erecipe\u003c/span\u003e: str) -\u003e \u003cspan class=\"hljs-title class_\"\u003eFoodMetaData\u003c/span\u003e:\n        \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e\"당신은 음식 AI 어시스턴트입니다. 엔티티, 엔티티의 값 및 추출된 값이 올바른 값인 이유를 추출하는 것이 작업입니다. \n        엔티티를 추출할 수 없는 경우 null을 추가하세요.\"\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\n        pass\n    \n    @predictor\n    def \u003cspan class=\"hljs-title function_\"\u003eextract_food_entities\u003c/span\u003e(self, \u003cspan class=\"hljs-attr\"\u003erecipe\u003c/span\u003e: str) -\u003e \u003cspan class=\"hljs-title class_\"\u003eFoodEntities\u003c/span\u003e:\n        \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e\"당신은 음식 AI 어시스턴트입니다. 작업은 레시피에서 음식 엔티티를 추출하는 것입니다.\"\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\n        pass\n        \n    def \u003cspan class=\"hljs-title function_\"\u003eforward\u003c/span\u003e(self, \u003cspan class=\"hljs-attr\"\u003erecipe\u003c/span\u003e: str) -\u003e \u003cspan class=\"hljs-title class_\"\u003eFoodEntities\u003c/span\u003e:\n        food_context = self.\u003cspan class=\"hljs-title function_\"\u003eextract_food_context\u003c/span\u003e(recipe=recipe)\n        parsed_context = \u003cspan class=\"hljs-title function_\"\u003eparse_context\u003c/span\u003e(food_context.\u003cspan class=\"hljs-property\"\u003econtext\u003c/span\u003e)\n        food_entities = self.\u003cspan class=\"hljs-title function_\"\u003eextract_food_entities\u003c/span\u003e(recipe=parsed_context)\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e food_entities\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e이를 통해 데코레이터 함수를 사용하여 표준 프롬프트 엔지니어링 기술을 지정할 수 있으며, 이는 매우 깔끔합니다. 또한 모듈에서 사용된 parse_context 메서드는 결과 JSON 콘텍스트를 문자열로 구문 분석하는 유틸리티 함수이며, 체인의 다음 단계에 대한 입력으로 사용될 것입니다.\u003c/p\u003e\n\u003ch2\u003eDSPy 프로그램 실행하기\u003c/h2\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e프로그램을 실행하려면 모듈의 인스턴스를 만들고 입력값을 사용하여 호출하십시오. 그러나 DSPy의 또 다른 멋진 기능은 모듈에 대한 dspy.Context를 지정할 수 있다는 것입니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003eextract_food_entities = \u003cspan class=\"hljs-title class_\"\u003eExtractFoodEntities\u003c/span\u003e()\n\n\u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e dspy.\u003cspan class=\"hljs-title function_\"\u003econtext\u003c/span\u003e(lm=gpt4):\n    entities = \u003cspan class=\"hljs-title function_\"\u003eextract_food_entities\u003c/span\u003e(recipe=\u003cspan class=\"hljs-string\"\u003e\"Ten grams of orange dutch cheese,  \\\n    2 liters of water and 5 ml of ice\"\u003c/span\u003e)\n    \u003cspan class=\"hljs-title function_\"\u003epprint\u003c/span\u003e(entities)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e위의 프로그램은 다음 출력을 보여줍니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-title class_\"\u003eFoodEntities\u003c/span\u003e(\n    entities=[\n        \u003cspan class=\"hljs-title class_\"\u003eFoodEntity\u003c/span\u003e(\n            food=\u003cspan class=\"hljs-string\"\u003e'orange dutch cheese'\u003c/span\u003e,\n            quantity=\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e,\n            unit=\u003cspan class=\"hljs-string\"\u003e'grams'\u003c/span\u003e,\n            physical_quality=\u003cspan class=\"hljs-title class_\"\u003eNone\u003c/span\u003e,\n            color=\u003cspan class=\"hljs-string\"\u003e'orange'\u003c/span\u003e,\n        ),\n        \u003cspan class=\"hljs-title class_\"\u003eFoodEntity\u003c/span\u003e(\n            food=\u003cspan class=\"hljs-string\"\u003e'water'\u003c/span\u003e,\n            quantity=\u003cspan class=\"hljs-number\"\u003e2000\u003c/span\u003e,\n            unit=\u003cspan class=\"hljs-string\"\u003e'milliliters'\u003c/span\u003e,\n            physical_quality=\u003cspan class=\"hljs-title class_\"\u003eNone\u003c/span\u003e,\n            color=\u003cspan class=\"hljs-string\"\u003e'clear'\u003c/span\u003e,\n        ),\n        \u003cspan class=\"hljs-title class_\"\u003eFoodEntity\u003c/span\u003e(\n            food=\u003cspan class=\"hljs-string\"\u003e'ice'\u003c/span\u003e,\n            quantity=\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e,\n            unit=\u003cspan class=\"hljs-string\"\u003e'milliliters'\u003c/span\u003e,\n            physical_quality=\u003cspan class=\"hljs-title class_\"\u003eNone\u003c/span\u003e,\n            color=\u003cspan class=\"hljs-string\"\u003e'clear'\u003c/span\u003e,\n        ),\n    ],\n)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e이것은 다른 LLM(모델 상의 큰 언어 모델)을 시험해보거나, 예를 들어 DEV에는 gpt-3.5-turbo를 사용하고, PROD에서는 더 강인한 모델인 gpt-4-turbo-preview를 사용한다면 유용할 것입니다.\u003c/p\u003e\n\u003ch2\u003eDSPy 프로그램 최적화하기\u003c/h2\u003e\n\u003cp\u003e이제 프로그램을 최적화하는 데 필요한 모든 구성 요소가 준비되었습니다 🎉. DSPy에서 최적화자는 DSPy 프로그램의 매개변수인 프롬프트와/또는 LM(언어 모델) 가중치를 조정할 수 있는 알고리즘입니다. 프로그램을 최적화하려면 최대화할 메트릭을 제공합니다.\u003c/p\u003e\n\u003cp\u003e최적화 단계에서는 BootstrapFewShot 최적화자를 사용합니다. 그리고 최대화하려는 메트릭(어떤 파이썬 함수도 될 수 있음)은 아래에 표시되어 있습니다:\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003evalidate_entities\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eexample, pred, trace=\u003cspan class=\"hljs-literal\"\u003eNone\u003c/span\u003e\u003c/span\u003e):\n    \u003cspan class=\"hljs-string\"\u003e\"\"\"두 객체가 동일한지 확인합니다.\"\"\"\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e example.entities == pred\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e최적화를 실행하려면 compile 메서드를 사용합니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e dspy.teleprompt \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e BootstrapFewShot\n\nteleprompter = BootstrapFewShot(metric=validate_entities)\ncompiled_ner = teleprompter.\u003cspan class=\"hljs-built_in\"\u003ecompile\u003c/span\u003e(ExtractFoodEntitiesV2(), trainset=trainset)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e저희 데이터셋에서 컴파일된 프로그램을 실행한 결과는 다음과 같습니다:\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-title class_\"\u003eFoodEntities\u003c/span\u003e(\n    entities=[\n        \u003cspan class=\"hljs-title class_\"\u003eFoodEntity\u003c/span\u003e(\n            food=\u003cspan class=\"hljs-string\"\u003e'삼겹살'\u003c/span\u003e,\n            quantity=\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e,\n            unit=\u003cspan class=\"hljs-string\"\u003e'lb'\u003c/span\u003e,\n            physical_quality=\u003cspan class=\"hljs-title class_\"\u003eNone\u003c/span\u003e,\n            color=\u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e,\n        ),\n        \u003cspan class=\"hljs-title class_\"\u003eFoodEntity\u003c/span\u003e(\n            food=\u003cspan class=\"hljs-string\"\u003e'파'\u003c/span\u003e,\n            quantity=\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e,\n            unit=\u003cspan class=\"hljs-string\"\u003e'개'\u003c/span\u003e,\n            physical_quality=\u003cspan class=\"hljs-string\"\u003e'작을 경우 3개'\u003c/span\u003e,\n            color=\u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e,\n        ),\n        \u003cspan class=\"hljs-title class_\"\u003eFoodEntity\u003c/span\u003e(\n            food=\u003cspan class=\"hljs-string\"\u003e'생강'\u003c/span\u003e,\n            quantity=\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n            unit=\u003cspan class=\"hljs-string\"\u003e'인치'\u003c/span\u003e,\n            physical_quality=\u003cspan class=\"hljs-string\"\u003e'한 조각'\u003c/span\u003e,\n            color=\u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e,\n        ),\n        \u003cspan class=\"hljs-title class_\"\u003eFoodEntity\u003c/span\u003e(\n            food=\u003cspan class=\"hljs-string\"\u003e'마늘'\u003c/span\u003e,\n            quantity=\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e,\n            unit=\u003cspan class=\"hljs-string\"\u003e'쪽'\u003c/span\u003e,\n            physical_quality=\u003cspan class=\"hljs-title class_\"\u003eNone\u003c/span\u003e,\n            color=\u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e,\n        ),\n        \u003cspan class=\"hljs-title class_\"\u003eFoodEntity\u003c/span\u003e(\n            food=\u003cspan class=\"hljs-string\"\u003e'술'\u003c/span\u003e,\n            quantity=\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e,\n            unit=\u003cspan class=\"hljs-string\"\u003e'⅔ 컵'\u003c/span\u003e,\n            physical_quality=\u003cspan class=\"hljs-title class_\"\u003eNone\u003c/span\u003e,\n            color=\u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e,\n        ),\n        \u003cspan class=\"hljs-title class_\"\u003eFoodEntity\u003c/span\u003e(\n            food=\u003cspan class=\"hljs-string\"\u003e'간장'\u003c/span\u003e,\n            quantity=\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e,\n            unit=\u003cspan class=\"hljs-string\"\u003e'⅔ 컵'\u003c/span\u003e,\n            physical_quality=\u003cspan class=\"hljs-title class_\"\u003eNone\u003c/span\u003e,\n            color=\u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e,\n        ),\n        \u003cspan class=\"hljs-title class_\"\u003eFoodEntity\u003c/span\u003e(\n            food=\u003cspan class=\"hljs-string\"\u003e'미린'\u003c/span\u003e,\n            quantity=\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n            unit=\u003cspan class=\"hljs-string\"\u003e'¼ 컵'\u003c/span\u003e,\n            physical_quality=\u003cspan class=\"hljs-title class_\"\u003eNone\u003c/span\u003e,\n            color=\u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e,\n        ),\n        \u003cspan class=\"hljs-title class_\"\u003eFoodEntity\u003c/span\u003e(\n            food=\u003cspan class=\"hljs-string\"\u003e'설탕'\u003c/span\u003e,\n            quantity=\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n            unit=\u003cspan class=\"hljs-string\"\u003e'½ 컵'\u003c/span\u003e,\n            physical_quality=\u003cspan class=\"hljs-title class_\"\u003eNone\u003c/span\u003e,\n            color=\u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e,\n        ),\n        \u003cspan class=\"hljs-title class_\"\u003eFoodEntity\u003c/span\u003e(\n            food=\u003cspan class=\"hljs-string\"\u003e'물'\u003c/span\u003e,\n            quantity=\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e,\n            unit=\u003cspan class=\"hljs-string\"\u003e'컵'\u003c/span\u003e,\n            physical_quality=\u003cspan class=\"hljs-string\"\u003e'필요에 따라 약간 더'\u003c/span\u003e,\n            color=\u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e,\n        ),\n    ],\n)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e프롬프트 엔지니어링에 반이나하 며 살짝 봐두 시간 정도만 투자한 것에 대해서 꽤 괜찮지 않나요? 💪!\u003c/p\u003e\n\u003ch2\u003eLLM 검사\u003c/h2\u003e\n\u003cp\u003e프로그램을 이렇게 선언하는 것도 좋지만 LLM이 사용하는 기본 프롬프트를 확인하려면 어떻게 해야 할까요? 걱정 마세요. inspect_history를 사용해 보세요:\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003egpt4.\u003cspan class=\"hljs-title function_\"\u003einspect_history\u003c/span\u003e(n=\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e아래와 같은 출력이 나왔습니다:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e당신은 음식 \u003cspan class=\"hljs-variable constant_\"\u003eAI\u003c/span\u003e 어시스턴트입니다. 레시피에서 음식 엔티티를 추출하는 것이 당신의 임무입니다.\r\n\r\n---\r\n\r\n다음 형식을 따르세요.\r\n레시피: ${recipe}\r\n음식 엔티티 추출: ${extract_food_entities}. 단일 \u003cspan class=\"hljs-title class_\"\u003eJSON\u003c/span\u003e 객체로 응답하세요. \u003cspan class=\"hljs-title class_\"\u003eJSON\u003c/span\u003e 스키마: {\u003cspan class=\"hljs-string\"\u003e\"$defs\"\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e\"FoodEntity\"\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e\"properties\"\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e\"food\"\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e\"description\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"고기, 채소, 주류 등과 같이 고체 및 액체 음식일 수 있습니다\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"title\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"음식\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"type\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"string\"\u003c/span\u003e}, \u003cspan class=\"hljs-string\"\u003e\"quantity\"\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e\"description\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"레시피에 사용해야 하는 음식의 정확한 양 또는 분량\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"title\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"분량\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"type\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"integer\"\u003c/span\u003e}, \u003cspan class=\"hljs-string\"\u003e\"unit\"\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e\"description\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"사용 중인 단위 (예: 그램, 밀리리터, 파운드 등)\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"title\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"단위\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"type\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"string\"\u003c/span\u003e}, \u003cspan class=\"hljs-string\"\u003e\"physical_quality\"\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e\"anyOf\"\u003c/span\u003e: [{\u003cspan class=\"hljs-string\"\u003e\"type\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"string\"\u003c/span\u003e}, {\u003cspan class=\"hljs-string\"\u003e\"type\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"null\"\u003c/span\u003e}], \u003cspan class=\"hljs-string\"\u003e\"description\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"재료의 특성\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"title\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"물리적 품질\"\u003c/span\u003e}, \u003cspan class=\"hljs-string\"\u003e\"color\"\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e\"description\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"음식의 색깔\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"title\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"색깔\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"type\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"string\"\u003c/span\u003e}, \u003cspan class=\"hljs-string\"\u003e\"required\"\u003c/span\u003e: [\u003cspan class=\"hljs-string\"\u003e\"food\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"quantity\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"unit\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"physical_quality\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"color\"\u003c/span\u003e], \u003cspan class=\"hljs-string\"\u003e\"title\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"FoodEntity\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"type\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"object\"\u003c/span\u003e}, \u003cspan class=\"hljs-string\"\u003e\"properties\"\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e\"entities\"\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e\"items\"\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e\"$ref\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"#/$defs/FoodEntity\"\u003c/span\u003e}, \u003cspan class=\"hljs-string\"\u003e\"title\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"Entities\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"type\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"array\"\u003c/span\u003e}, \u003cspan class=\"hljs-string\"\u003e\"required\"\u003c/span\u003e: [\u003cspan class=\"hljs-string\"\u003e\"entities\"\u003c/span\u003e], \u003cspan class=\"hljs-string\"\u003e\"title\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"FoodEntities\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"type\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"object\"\u003c/span\u003e}\r\n---\r\n레시피:\r\npork \u003cspan class=\"hljs-attr\"\u003ebelly\u003c/span\u003e:\r\n{\r\n\u003cspan class=\"hljs-string\"\u003e\"reasoning\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"차슈 포크의 주 재료로 2 파운드의 삼겹살을 사용하도록 레시피에서 명시되어 있습니다.\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"value\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"2 파운드\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"entity\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"삼겹살\"\u003c/span\u003e\r\n}\r\ngreen \u003cspan class=\"hljs-attr\"\u003eonions\u003c/span\u003e:\r\n{\r\n\u003cspan class=\"hljs-string\"\u003e\"reasoning\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"2개의 대파가 필요하며, 작은 대파인 경우 3개를 사용합니다.\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"value\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"2 또는 3\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"entity\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"대파\"\u003c/span\u003e\r\n}\r\nfresh \u003cspan class=\"hljs-attr\"\u003eginger\u003c/span\u003e:\r\n{\r\n\u003cspan class=\"hljs-string\"\u003e\"reasoning\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"레시피에는 신선한 생강 1인치가 필요하며, 이는 레시피에 대략 4~6개의 조각을 제공합니다.\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"value\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"1인치\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"entity\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"생강\"\u003c/span\u003e\r\n}\r\n\u003cspan class=\"hljs-attr\"\u003egarlic\u003c/span\u003e:\r\n{ \r\n\u003cspan class=\"hljs-string\"\u003e\"reasoning\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"재료 중에는 마늘 2쪽이 필요합니다.\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"value\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"2쪽\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"entity\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"마늘\"\u003c/span\u003e\r\n}\r\n\u003cspan class=\"hljs-attr\"\u003esake\u003c/span\u003e:\r\n{\r\n\u003cspan class=\"hljs-string\"\u003e\"reasoning\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"풍미를 위해 요리 액체에 ⅔컵의 사케가 사용됩니다.\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"value\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"⅔컵\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"entity\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"사케\"\u003c/span\u003e\r\n}\r\nsoy \u003cspan class=\"hljs-attr\"\u003esauce\u003c/span\u003e:\r\n{\r\n\u003cspan class=\"hljs-string\"\u003e\"reasoning\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"요리 액체에 ⅔컵의 간장이 추가되어 요리의 맛을 더합니다.\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"value\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"⅔컵\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"entity\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"간장\"\u003c/span\u003e\r\n}\r\n\u003cspan class=\"hljs-attr\"\u003emirin\u003c/span\u003e:\r\n{\r\n\u003cspan class=\"hljs-string\"\u003e\"reasoning\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"달콤하고 깊은 맛을 위해 레시피에 ¼컵의 미린이 포함됩니다.\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"value\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"¼컵\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"entity\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"미린\"\u003c/span\u003e\r\n}\r\n\u003cspan class=\"hljs-attr\"\u003esugar\u003c/span\u003e:\r\n{\r\n\u003cspan class=\"hljs-string\"\u003e\"reasoning\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"요리 액체를 달게하기 위해 ½컵의 설탕을 사용합니다.\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"value\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"½컵\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"entity\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"설탕\"\u003c/span\u003e\r\n}\r\n\u003cspan class=\"hljs-attr\"\u003ewater\u003c/span\u003e:\r\n{\r\n\u003cspan class=\"hljs-string\"\u003e\"reasoning\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"삼겹살을 위한 요리 액체를 만들기 위해 2컵의 물(필요에 따라 더 추가 가능)이 필요합니다.\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"value\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"2컵\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"entity\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"물\"\u003c/span\u003e\r\n}\r\n음식 엔티티 추출: json\r\n{\r\n\u003cspan class=\"hljs-string\"\u003e\"entities\"\u003c/span\u003e: [\r\n{\r\n\u003cspan class=\"hljs-string\"\u003e\"food\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"삼겹살\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"quantity\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"unit\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"파운드\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"physical_quality\"\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"color\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\r\n},\r\n{\r\n\u003cspan class=\"hljs-string\"\u003e\"food\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"대파\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"quantity\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"unit\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"개\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"physical_quality\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"작으면 3개\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"color\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\r\n},\r\n{\r\n\u003cspan class=\"hljs-string\"\u003e\"food\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"생강\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"quantity\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"unit\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"인치\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"physical_quality\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"조각\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"color\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\r\n},\r\n{\r\n\u003cspan class=\"hljs-string\"\u003e\"food\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"마늘\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"quantity\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"unit\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"쪽\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"physical_quality\"\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"color\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\r\n},\r\n{\r\n\u003cspan class=\"hljs-string\"\u003e\"food\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"사케\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"quantity\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"unit\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"⅔컵\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"physical_quality\"\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"color\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\r\n},\r\n{\r\n\u003cspan class=\"hljs-string\"\u003e\"food\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"간장\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"quantity\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"unit\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"⅔컵\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"physical_quality\"\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"color\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\r\n},\r\n{\r\n\u003cspan class=\"hljs-string\"\u003e\"food\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"미린\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"quantity\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"unit\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"¼컵\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"physical_quality\"\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"color\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\r\n},\r\n{\r\n\u003cspan class=\"hljs-string\"\u003e\"food\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"설탕\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"quantity\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"unit\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"½컵\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"physical_quality\"\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"color\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\r\n},\r\n{\r\n\u003cspan class=\"hljs-string\"\u003e\"food\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"물\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"quantity\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"unit\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"컵\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"physical_quality\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"필요에 따라 추가\"\u003c/span\u003e,\r\n\u003cspan class=\"hljs-string\"\u003e\"color\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e\r\n}\r\n]\r\n}\r\n\u003cspan class=\"hljs-string\"\u003e``\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch1\u003e마무리말\u003c/h1\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e이 게시물의 목적은 DSPy 라이브러리를 익히고 TypedPredictor 클래스를 주로 NER 사용 사례에 사용하는 방법을 살펴보는 것이었습니다. 이제 여러분도 더 나은 이해를 하셨으면 좋겠습니다!\u003c/p\u003e\n\u003cp\u003e첫 인상을 요약하면 다음과 같습니다:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eDSPy는 사용하기 쉽고 시작하기 쉽습니다 ✅\u003c/li\u003e\n\u003cli\u003e프롬프트 엔지니어링에 시간을 낭비하는 대신, 프레임워크가 대신 처리해 주는 것이 아주 좋습니다 ✅\u003c/li\u003e\n\u003cli\u003eLLM을 최적화 및 PyTorch와 같은 아이디어를 사용하여 \"전형적인\" ML 문제로 다루는 것이 매우 좋습니다 ✅\u003c/li\u003e\n\u003cli\u003e여전히 발전 중이며 아마도 \"운영\"에 준비가 되지는 않았습니다 ❌\u003c/li\u003e\n\u003cli\u003e프로그램을 디버깅할 때 무슨 일이 일어나고 있는지 이해하기 쉽도록 더 나은 로깅/추적이 필요합니다 ❌\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e그러나 프롬프트를하는 대신 LLM을 프로그래밍하는 접근 방식을 좋아합니다. 이것은 분야에서 흥미로운 발전이며 예를 들어, 미래의 복합 AI 시스템에 대한 것입니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003eDSPY의 채택 및 추가 개발을 기대하고 있어요.\u003c/p\u003e\n\u003ch1\u003e참고 자료\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003e💻 DSPy 소개: 인사 대신 프로그래밍으로!\u003c/li\u003e\n\u003cli\u003e💻 DSPy: 선언형 언어 모델 호출을 자가 개선 파이프라인으로 컴파일하기\u003c/li\u003e\n\u003cli\u003e💻 DSPy 심층 탐구\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-06-22-UsingDSPyforextractingmetadataNERstyle"},"buildId":"CYQjEY3HhSkRTiL0gewc0","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>