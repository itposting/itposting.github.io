<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>SQL과 Power BI를 활용한 고객 세분화 보고서 | itposting</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://itposting.github.io///post/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="SQL과 Power BI를 활용한 고객 세분화 보고서 | itposting" data-gatsby-head="true"/><meta property="og:title" content="SQL과 Power BI를 활용한 고객 세분화 보고서 | itposting" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://itposting.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://itposting.github.io///post/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI" data-gatsby-head="true"/><meta name="twitter:title" content="SQL과 Power BI를 활용한 고객 세분화 보고서 | itposting" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | itposting" data-gatsby-head="true"/><meta name="article:published_time" content="2024-06-19 09:28" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-23YXDLKDCL"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-23YXDLKDCL');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-ac4aa08aae62f90e.js" defer=""></script><script src="/_next/static/chunks/463-0429087d4c0b0335.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-d849684d6d83f07a.js" defer=""></script><script src="/_next/static/QYe6gFAUryFKFgjKBoIfo/_buildManifest.js" defer=""></script><script src="/_next/static/QYe6gFAUryFKFgjKBoIfo/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">IT Posting</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">SQL과 Power BI를 활용한 고객 세분화 보고서</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="SQL과 Power BI를 활용한 고객 세분화 보고서" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">IT Posting</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Jun 19, 2024</span><span class="posts_reading_time__f7YPP">11<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<p>이 프로젝트에서는 RFM(Recency, Frequency, Monetary) 개념을 사용하여 판매 데이터 세트를 분석할 것입니다. 저의 목표는 고객을 세분화하여 최상위 구매자와 무시되고 있을 수 있는 고객 및 그들을 유지하기 위해 타겟 광고 노력이 더 필요한 사람들을 식별하는 것입니다.</p>
<p>RFM 보고서는 세 가지 주요 지표를 사용하여 고객을 세분화하는 방법입니다:</p>
<ol>
<li>
<p>Recency(최근성): 고객의 마지막 구매가 얼마나 오래되었나요?</p>
</li>
<li>
<p>Frequency(빈도): 고객이 얼마나 자주 구매하나요?</p>
</li>
</ol>
<div class="content-ad"></div>
<p>3: 금액: 고객이 구매에 얼마나 지출하는가?</p>
<h2>프로젝트 계획</h2>
<ul>
<li>데이터 정리</li>
<li>데이터셋 개요</li>
<li>분석</li>
<li>최근성, 빈도, 금액 (RFM) 보고서</li>
<li>RFM을 사용한 고객 세분화</li>
<li>Power BI 대시보드</li>
</ul>
<h2>1. 데이터 정리</h2>
<div class="content-ad"></div>
<p>데이터를 조사한 결과 특정 기능에 누락된 값이 있는 것을 발견했어요. 그래서 이를 "없음"으로 대체해 주었어요. 다행히도, 저가 분석할 주요 기능들에는 누락된 값이 없었어요.</p>
<pre><code class="hljs language-js">-- 데이터 확인하기 --
select*
<span class="hljs-keyword">from</span> [dbo].[sales_data];

-- 데이터 정리하기 --

-- <span class="hljs-title class_">Addressline2</span>, <span class="hljs-title class_">Postalcode</span> 및 <span class="hljs-title class_">State</span> 열의 누락된 값 찾기
select *
<span class="hljs-keyword">from</span> [dbo].[sales_data]
where <span class="hljs-title class_">ADDRESSLINE2</span> <span class="hljs-variable constant_">IS</span> <span class="hljs-variable constant_">NULL</span> <span class="hljs-variable constant_">OR</span> <span class="hljs-variable constant_">STATE</span> <span class="hljs-variable constant_">IS</span> <span class="hljs-variable constant_">NULL</span> <span class="hljs-variable constant_">OR</span> <span class="hljs-variable constant_">POSTALCODE</span> <span class="hljs-variable constant_">IS</span> <span class="hljs-variable constant_">NULL</span>;

-- 누락된 값 처리하기
update [dbo].[sales_data]
set <span class="hljs-title class_">ADDRESSLINE2</span> = <span class="hljs-keyword">case</span> when <span class="hljs-title class_">ADDRESSLINE2</span> <span class="hljs-variable constant_">IS</span> <span class="hljs-variable constant_">NULL</span> then <span class="hljs-string">'None'</span> <span class="hljs-keyword">else</span> <span class="hljs-title class_">ADDRESSLINE2</span> end,
    <span class="hljs-variable constant_">STATE</span> = <span class="hljs-keyword">case</span> when <span class="hljs-variable constant_">STATE</span> <span class="hljs-variable constant_">IS</span> <span class="hljs-variable constant_">NULL</span> then <span class="hljs-string">'Unknown States'</span> <span class="hljs-keyword">else</span> <span class="hljs-variable constant_">STATE</span> end,
    <span class="hljs-variable constant_">POSTALCODE</span> = <span class="hljs-keyword">case</span> when <span class="hljs-variable constant_">POSTALCODE</span> <span class="hljs-variable constant_">IS</span> <span class="hljs-variable constant_">NULL</span> then <span class="hljs-string">'None'</span> <span class="hljs-keyword">else</span> <span class="hljs-variable constant_">POSTALCODE</span> end;
</code></pre>
<p><img src="/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_0.png" alt="이미지"></p>
<h2>2. 데이터셋 개요</h2>
<div class="content-ad"></div>
<p>2.1 몇 가지 변수에서의 독특한 관찰</p>
<p>회사는 "Productline" 열에서 나타나는 것처럼 열차, 오토바이, 비행기, 클래식 자동차 등의 판매에 특화되어 있습니다. 데이터는 2003년부터 2005년까지의 기간을 다룹니다.</p>
<pre><code class="hljs language-js">-- 일부 특성의 고유 관측치
select distinct <span class="hljs-variable constant_">STATUS</span> <span class="hljs-keyword">from</span> [dbo].[sales_data]
select distinct <span class="hljs-variable constant_">YEAR_ID</span> <span class="hljs-keyword">from</span> [dbo].[sales_data]
select distinct <span class="hljs-variable constant_">PRODUCTLINE</span> <span class="hljs-keyword">from</span> [dbo].[sales_data]
select distinct <span class="hljs-variable constant_">COUNTRY</span> <span class="hljs-keyword">from</span> [dbo].[sales_data]
select distinct <span class="hljs-variable constant_">DEALSIZE</span> <span class="hljs-keyword">from</span> [dbo].[sales_data]
select distinct <span class="hljs-variable constant_">TERRITORY</span> <span class="hljs-keyword">from</span> [dbo].[sales_data]
</code></pre>
<img src="/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_1.png">
<div class="content-ad"></div>
<p>1.2 각 연도별 고유한 월</p>
<p>2005년의 월만 표시한 것은 그렇다고 하더라도, 2003년과 2004년은 둘 다 모든 12개월을 포함했다는 것을 기억하는 것이 중요합니다. 아래 출력에서 확인할 수 있듯이, 2005년 데이터는 5월까지만 있는 것을 알 수 있습니다.</p>
<pre><code class="hljs language-js">-- 각 연도별 고유한 월
select distinct <span class="hljs-variable constant_">MONTH_ID</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">Month</span>_Id_2003  <span class="hljs-keyword">from</span> [dbo].[sales_data]  where <span class="hljs-variable constant_">YEAR_ID</span> = <span class="hljs-number">2003</span> order by <span class="hljs-variable constant_">MONTH_ID</span> <span class="hljs-variable constant_">ASC</span>;

select <span class="hljs-variable constant_">MONTH_ID</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">Month</span>_Id_2004 <span class="hljs-keyword">from</span> [dbo].[sales_data]  where <span class="hljs-variable constant_">YEAR_ID</span> = <span class="hljs-number">2004</span> order by <span class="hljs-variable constant_">MONTH_ID</span> <span class="hljs-variable constant_">ASC</span>;

select distinct <span class="hljs-variable constant_">MONTH_ID</span>  <span class="hljs-keyword">as</span> <span class="hljs-title class_">Month</span>_Id_2005 <span class="hljs-keyword">from</span> [dbo].[sales_data]  where <span class="hljs-variable constant_">YEAR_ID</span> = <span class="hljs-number">2005</span> order by <span class="hljs-variable constant_">MONTH_ID</span> <span class="hljs-variable constant_">ASC</span>;
</code></pre>
<img src="/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_2.png">
<div class="content-ad"></div>
<h2>2. 분석</h2>
<p>2.1 각 제품 라인에서 얼마나 벌고 있나요?</p>
<p>클래식 자동차가 가장 많은 구매를 했고, 가장 적은 구매는 기차였습니다.</p>
<pre><code class="hljs language-js">--- 제품 라인별로 매출을 그룹화하여 계산해 봅시다
select <span class="hljs-variable constant_">PRODUCTLINE</span>, <span class="hljs-title function_">SUM</span>(sales) <span class="hljs-title class_">Revenue</span> 
<span class="hljs-keyword">from</span>   [dbo].[sales_data]
group by <span class="hljs-variable constant_">PRODUCTLINE</span>
order by <span class="hljs-number">2</span> desc
</code></pre>
<div class="content-ad"></div>
<img src="/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_3.png">
<p>2.2 매년 매출액은 어떻게 되나요?</p>
<p>결과를 통해 2004년이 가장 높은 매출을 기록했으며, 2003년이 이어서 나왔으며, 2005년의 매출액은 가장 낮았다는 것을 알 수 있습니다. 이 차이는 2005년이 단 5개월에 불과하기 때문에 전체 매출량이 2003년과 2004년의 연간 데이터와 비교하여 상대적으로 작기 때문입니다.</p>
<pre><code class="hljs language-js">-- 매년 매출액
select <span class="hljs-variable constant_">YEAR_ID</span>, <span class="hljs-title function_">SUM</span>(sales) <span class="hljs-title class_">Revenue</span> 
<span class="hljs-keyword">from</span> [dbo].[sales_data]
group by <span class="hljs-variable constant_">YEAR_ID</span>
order by <span class="hljs-number">2</span> desc 
</code></pre>
<div class="content-ad"></div>
<p><img src="/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_4.png" alt="Customer Segmentation Report"></p>
<p>2.3. What was the best month for sales in a specific year and how much was earned that month?</p>
<p>In 2003</p>
<p>There were more purchases in November and the next highest sales was October.</p>
<div class="content-ad"></div>
<pre><code class="hljs language-js">-- <span class="hljs-number">2003</span>년 정보에 대하여
select <span class="hljs-variable constant_">MONTH_ID</span>, <span class="hljs-title function_">sum</span>(sales) <span class="hljs-keyword">as</span> 수익, <span class="hljs-title function_">count</span>(ordernumber) <span class="hljs-keyword">as</span> 빈도 
<span class="hljs-keyword">from</span> [dbo].[sales_data]
where <span class="hljs-variable constant_">YEAR_ID</span> = <span class="hljs-number">2003</span>
group by <span class="hljs-variable constant_">MONTH_ID</span>
order by <span class="hljs-number">2</span> desc
</code></pre>
<p><img src="/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_5.png" alt="고객 세분화 보고서"></p>
<p>2004년에도</p>
<p>2004년에도 11월에 가장 높은 매출이 있었으며, 다음으로 10월에 높은 매출이 있었습니다.</p>
<div class="content-ad"></div>
<pre><code class="hljs language-js">-- <span class="hljs-number">2004</span> 년도를 위한
select <span class="hljs-variable constant_">MONTH_ID</span>, <span class="hljs-title function_">sum</span>(sales) <span class="hljs-keyword">as</span> <span class="hljs-title class_">Revenue</span>, <span class="hljs-title function_">count</span>(ordernumber) <span class="hljs-keyword">as</span> <span class="hljs-title class_">Frequency</span> 
<span class="hljs-keyword">from</span> [dbo].[sales_data]
where <span class="hljs-variable constant_">YEAR_ID</span> = <span class="hljs-number">2004</span>
group by <span class="hljs-variable constant_">MONTH_ID</span>
order by <span class="hljs-number">2</span> desc
</code></pre>
<img src="/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_6.png">
<p>2005년도에</p>
<p>2005년에는 최다 구매가 5월에 발생하여 올해의 판매 정점을 나타냈습니다. 세 연도 동안의 처음 다섯 개월 구매를 비교하면, 2005년의 판매량이 비교적 높고, 그 다음이 2004년이며, 가장 낮은 것은 2003년입니다. 이는 회사의 매출이 연도를 통틀어 꾸준히 증가하고 있다는 것을 시사합니다.</p>
<div class="content-ad"></div>
<pre><code class="hljs language-js">-- <span class="hljs-number">2005</span>년 기준
select <span class="hljs-variable constant_">MONTH_ID</span>, <span class="hljs-title function_">sum</span>(sales) <span class="hljs-keyword">as</span> 매출액, <span class="hljs-title function_">count</span>(ordernumber) <span class="hljs-keyword">as</span> 주문빈도
<span class="hljs-keyword">from</span> [dbo].[sales_data]
where <span class="hljs-variable constant_">YEAR_ID</span> = <span class="hljs-number">2005</span>
group by <span class="hljs-variable constant_">MONTH_ID</span>
order by <span class="hljs-number">2</span> desc
</code></pre>
<p><img src="/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_7.png" alt="이미지"></p>
<p>2.4. 회사가 11월에 일반적으로 가장 높은 매출액을 기록하는 제품은 무엇인가요?</p>
<p>11월에는 클래식 및 빈티지 자동차의 구매가 두드러지게 증가하여 2003년부터 2004년까지 전반적인 높은 매출에 크게 기여했습니다. 반면에 기차는 동일한 달에 회사의 수익 최소화를 보여주었습니다.</p>
<div class="content-ad"></div>
<pre><code class="hljs language-js">-- <span class="hljs-number">2003</span>년 <span class="hljs-number">11</span>월
select <span class="hljs-variable constant_">MONTH_ID</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">November</span>_2003, <span class="hljs-variable constant_">PRODUCTLINE</span>, <span class="hljs-title function_">sum</span>(sales) <span class="hljs-keyword">as</span> <span class="hljs-title class_">Revenue</span>, <span class="hljs-title function_">count</span>(ordernumber) <span class="hljs-keyword">as</span> <span class="hljs-title class_">Frequency</span> 
<span class="hljs-keyword">from</span> [dbo].[sales_data]
where <span class="hljs-variable constant_">YEAR_ID</span> = <span class="hljs-number">2003</span> and <span class="hljs-variable constant_">MONTH_ID</span>=<span class="hljs-number">11</span>
group by <span class="hljs-variable constant_">MONTH_ID</span>, <span class="hljs-variable constant_">PRODUCTLINE</span>
order by <span class="hljs-number">3</span> desc

-- <span class="hljs-number">2004</span>년 <span class="hljs-number">11</span>월
select <span class="hljs-variable constant_">MONTH_ID</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">November</span>_2004,<span class="hljs-variable constant_">PRODUCTLINE</span>, <span class="hljs-title function_">sum</span>(sales) <span class="hljs-keyword">as</span> <span class="hljs-title class_">Revenue</span>, <span class="hljs-title function_">count</span>(ordernumber) <span class="hljs-keyword">as</span> <span class="hljs-title class_">Frequency</span> 
<span class="hljs-keyword">from</span> [dbo].[sales_data]
where <span class="hljs-variable constant_">YEAR_ID</span> = <span class="hljs-number">2004</span> and <span class="hljs-variable constant_">MONTH_ID</span>=<span class="hljs-number">11</span>
group by <span class="hljs-variable constant_">MONTH_ID</span>, <span class="hljs-variable constant_">PRODUCTLINE</span>
order by <span class="hljs-number">3</span> desc
</code></pre>
<img src="/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_8.png">
<h2>4. 최근성, 주파수 및 금액 (RFM) 보고서</h2>
<p>최근성은 마지막 주문 또는 구매 이후 경과한 일 수를 나타내며, Euro Shopping Channel과 La Rochelle Gifts는 데이터에서 가장 최근 구매를 한 날짜에 해당합니다(최대 날짜). 최근성 값이 높을수록 마지막 구매 이후의 기간이 길어집니다. RFM 결과에 따르면 Toys of Finland. Co는 데이터 집합에서 현재 또는 최대 날짜로부터 100일 이상이 지난 마지막 구매를 했습니다.
또한, 주문 사이의 평균 일 수를 살펴보면 고객들이 얼마나 자주 구매를 하는지에 대한 통찰을 제공합니다. Euro Shopping Channel은 평균 3일 간격으로 가장 꾸준한 고객 중 하나로 나타납니다.
마찬가지로, 고객 당 금액 값을 검토하면 Euro Shopping Channel이 가장 많이 지출한 것을 확인할 수 있습니다.</p>
<div class="content-ad"></div>
<pre><code class="hljs language-sql"><span class="hljs-comment">-- RFM 분석</span>
<span class="hljs-keyword">select</span> CUSTOMERNAME,
   <span class="hljs-built_in">sum</span>(sales) <span class="hljs-keyword">as</span> MonetaryValue,
   <span class="hljs-built_in">avg</span>(sales) <span class="hljs-keyword">as</span> AvgMonetaryValue,
   <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">as</span> Frequency_of_orders,
   <span class="hljs-built_in">count</span>(<span class="hljs-keyword">distinct</span> <span class="hljs-keyword">convert</span>(<span class="hljs-type">DATE</span>, orderdate)) <span class="hljs-keyword">AS</span> Number_of_unique_order_dates,
   <span class="hljs-keyword">convert</span>(<span class="hljs-type">INT</span>, round(<span class="hljs-built_in">cast</span>(datediff(dd, <span class="hljs-built_in">min</span>(ORDERDATE), <span class="hljs-built_in">max</span>(ORDERDATE)) <span class="hljs-keyword">as</span> <span class="hljs-type">decimal</span>)<span class="hljs-operator">/</span>(<span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>)<span class="hljs-number">-1</span>),<span class="hljs-number">0</span>)) <span class="hljs-keyword">as</span> [Aveg_day_between_orders],
   datediff(DD,<span class="hljs-built_in">max</span>(orderdate),( <span class="hljs-keyword">select</span> <span class="hljs-built_in">max</span>(orderdate) <span class="hljs-keyword">from</span> [dbo].[sales_data])) <span class="hljs-keyword">as</span> recency 
<span class="hljs-keyword">from</span> [dbo].[sales_data]
<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> CUSTOMERNAME
<span class="hljs-keyword">having</span> <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>)<span class="hljs-operator">></span><span class="hljs-number">1</span>
<span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> recency
</code></pre>
<p><img src="/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_9.png" alt="RFM Analysis"></p>
<h2>5.0 RFM 보고서 기반의 고객 세분화</h2>
<p>제공된 결과는 RFM 기준에 따른 고객 세분화에 대한 통찰을 제공합니다. rfm_recency=1에 속한 고객은 최근 구매 이후 지난 기간이 길어서, 데이터 세트에서 최대 날짜로부터 112일까지 구매를 한 Boards &#x26; Toys Co.와 같이 특징 지어집니다. 반면, rfm_recency=4는 최근 구매를 나타내며, 데이터 세트에서 가장 최근 구매가 14일 전인 Salzburg Collectables과 같은 상황입니다. 이는 rfm_recency=1 또는 2에 속한 고객이 마지막 주문 이후 상당한 시간이 지나자 "잠재적 이탈 고객"일 수 있다는 것을 나타냅니다.</p>
<div class="content-ad"></div>
<p>비슷하게, rfm_monetary에 대해서는 소비가 높은 고객이 rfm_monetary=4로 분류되며, 소비가 적은 고객은 rfm_monetary=1로 분류됩니다. rfm_frequency에 대해, rfm_frequency=4인 고객은 가장 많은 주문을 보유하고 있으며, rfm_frequency=1은 가장 적은 주문을 가진 고객을 나타냅니다.</p>
<p>이러한 RFM 카테고리를 분석하여, 최근 구매를 보유한 최고의 고객은(rfm_recency=4), 가장 높은 금액을 지출한 고객(rfm_monetary=4) 및 가장 많은 주문을 가진 고객(rfm_frequency=4)으로 식별할 수 있습니다.</p>
<p>---고객을 네 가지 세분류로 분류합니다.</p>
<p>with customer_segment as
(
select
CUSTOMERNAME,
sum(sales) as MonetaryValue,
count(ordernumber) as Frequency_of_orders,
max (orderdate) as last_order_date,
(select max(orderdate) from [dbo].[sales_data]) as max_order_date,
datediff(dd, max(orderdate),(select max(orderdate) from [dbo].[sales_data])) as Recency
from [dbo].[sales_data]
group by CUSTOMERNAME
)
select*,
NTILE(4) OVER (order by Recency desc) as rfm_recency,
NTILE(4) OVER (order by Frequency_of_orders) as rfm_frequency,
NTILE(4) OVER (order by MonetaryValue) as rfm_monetary
from customer_segment</p>
<p><img src="/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_10.png" alt="Customer Segmentation Report"></p>
<div class="content-ad"></div>
<img src="/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_11.png">
<p>5.1 상기 Segmentation을 기반으로 고객에게 Segment 이름 할당하기.
고객 Segmentation을 고려할 때, 복합 코드가 444인 고객이 최고의 고객을 대표합니다. 첫 번째 4는 rfm_recency 그룹 4에 속한 고객을 나타내며 최근 구매를 의미합니다. 두 번째 4는 rfm_frequency 그룹 4에 속한 고객을 나타내어 많은 주문을 했음을 의미합니다. 마지막 4는 rfm_monetary 그룹 4에 속한 고객들을 나타내어 더 많은 돈을 소비했다는 것을 의미합니다.</p>
<p>반대로, 복합 그룹이 111인 고객들은 오랜 시간 구매를 하지 않은, 주문 수가 적고 지금까지 가장 적은 금액을 소비한 고객들입니다.</p>
<pre><code class="hljs language-js">-- 우리 최고의 고객은 누구인가요?

<span class="hljs-variable constant_">DROP</span> <span class="hljs-variable constant_">TABLE</span> <span class="hljs-variable constant_">IF</span> <span class="hljs-variable constant_">EXISTS</span> #customer_segment; -- 테이블 #rfm 생성
<span class="hljs-keyword">with</span> customer_segment <span class="hljs-keyword">as</span>
(
 select 
 <span class="hljs-variable constant_">CUSTOMERNAME</span>,
 <span class="hljs-title function_">sum</span>(sales) <span class="hljs-keyword">as</span> <span class="hljs-title class_">MonetaryValue</span>,
 <span class="hljs-title function_">avg</span>(sales) <span class="hljs-keyword">as</span> <span class="hljs-title class_">AvgMonetaryValue</span>,
 <span class="hljs-title function_">COUNT</span>(ordernumber) <span class="hljs-keyword">as</span> <span class="hljs-title class_">Frequency</span>,
 <span class="hljs-title function_">MAX</span>(orderdate) <span class="hljs-keyword">as</span> last_order_date,
 (select <span class="hljs-title function_">max</span>(orderdate) <span class="hljs-keyword">from</span> [dbo].[sales_data]) <span class="hljs-keyword">as</span> max_oder_date,
 <span class="hljs-title function_">DATEDIFF</span>(<span class="hljs-variable constant_">DD</span>, <span class="hljs-title function_">MAX</span>(orderdate),(select <span class="hljs-title function_">max</span>(orderdate) <span class="hljs-keyword">from</span> [dbo].[sales_data])) <span class="hljs-keyword">as</span> <span class="hljs-title class_">Recency</span> 
 <span class="hljs-keyword">from</span> [dbo].[sales_data]
 group by <span class="hljs-variable constant_">CUSTOMERNAME</span> 
),

rfm_segmentation <span class="hljs-keyword">as</span> 
  (
  select*,
  <span class="hljs-title function_">NTILE</span>(<span class="hljs-number">4</span>) <span class="hljs-variable constant_">OVER</span> (order by <span class="hljs-title class_">Recency</span> desc)<span class="hljs-keyword">as</span> rfm_recency,
  <span class="hljs-title function_">NTILE</span>(<span class="hljs-number">4</span>) <span class="hljs-variable constant_">OVER</span> (order by <span class="hljs-title class_">Frequency</span>) <span class="hljs-keyword">as</span> rfm_frequency,
  <span class="hljs-title function_">NTILE</span>(<span class="hljs-number">4</span>) <span class="hljs-variable constant_">OVER</span> (order by <span class="hljs-title class_">MonetaryValue</span>) <span class="hljs-keyword">as</span> rfm_monetary
   --(<span class="hljs-title function_">NTILE</span>(<span class="hljs-number">4</span>) <span class="hljs-variable constant_">OVER</span> (order by <span class="hljs-title class_">Recency</span>)) + (<span class="hljs-title function_">NTILE</span>(<span class="hljs-number">4</span>) <span class="hljs-variable constant_">OVER</span> (order by <span class="hljs-title class_">Frequency</span>)) + (<span class="hljs-title function_">NTILE</span>(<span class="hljs-number">4</span>) <span class="hljs-variable constant_">OVER</span> (order by <span class="hljs-title class_">AvgMonetaryValue</span>)) <span class="hljs-variable constant_">AS</span> <span class="hljs-title class_">CompositeScore</span>
  <span class="hljs-keyword">from</span> customer_segment 
 )

select 
 c.*, rfm_recency + rfm_frequency + rfm_monetary <span class="hljs-keyword">as</span> rfm_cell,
 <span class="hljs-title function_">CAST</span>(rfm_recency <span class="hljs-keyword">as</span> varchar)+ <span class="hljs-title function_">CAST</span>(rfm_frequency <span class="hljs-keyword">as</span> varchar)+ <span class="hljs-title function_">CAST</span>(rfm_monetary <span class="hljs-keyword">as</span> varchar) <span class="hljs-keyword">as</span> rfm_cell_string

into #customer_segment -- 스크립트를 실행하면서 테이블을 생성하는 데 도움이 됩니다. 맨 위에 #rfm 테이블이 이미 생성되었습니다.
<span class="hljs-keyword">from</span> rfm_segmentation c



select <span class="hljs-variable constant_">CUSTOMERNAME</span>, rfm_recency,rfm_frequency, rfm_monetary,rfm_cell_string,
  <span class="hljs-variable constant_">CASE</span>
  when rfm_cell_string <span class="hljs-keyword">in</span> (<span class="hljs-number">111</span>, <span class="hljs-number">112</span>, <span class="hljs-number">121</span>, <span class="hljs-number">122</span>, <span class="hljs-number">211</span>, <span class="hljs-number">212</span>, <span class="hljs-number">114</span>, <span class="hljs-number">141</span>, <span class="hljs-number">123</span>, <span class="hljs-number">131</span>,<span class="hljs-number">132</span>,<span class="hljs-number">141</span>,<span class="hljs-number">142</span>,<span class="hljs-number">221</span>, <span class="hljs-number">231</span>,<span class="hljs-number">232</span>,<span class="hljs-number">242</span>,<span class="hljs-number">241</span>) then <span class="hljs-string">'잃어버린 나 새로운 고객'</span>
  when rfm_cell_string <span class="hljs-keyword">in</span> (<span class="hljs-number">222</span>,<span class="hljs-number">223</span>, <span class="hljs-number">233</span>,<span class="hljs-number">134</span>,<span class="hljs-number">143</span>,<span class="hljs-number">133</span>,<span class="hljs-number">144</span>,<span class="hljs-number">234</span>,<span class="hljs-number">232</span>,<span class="hljs-number">244</span>) then <span class="hljs-string">'사라져가지만 돈을 많이 쓰는 고객'</span> -- 회사는 그들이 떠나는 것을 방치해서는 안됩니다
  when rfm_cell_string <span class="hljs-keyword">in</span> (<span class="hljs-number">411</span>,<span class="hljs-number">412</span>,<span class="hljs-number">421</span>,<span class="hljs-number">422</span>,<span class="hljs-number">342</span>,<span class="hljs-number">442</span>,<span class="hljs-number">322</span>,<span class="hljs-number">332</span>,<span class="hljs-number">311</span>) then <span class="hljs-string">'정기적이지만 소비가 적은 고객'</span>
  when rfm_cell_string <span class="hljs-keyword">in</span> (<span class="hljs-number">424</span>,<span class="hljs-number">423</span>,<span class="hljs-number">432</span>,<span class="hljs-number">324</span>,<span class="hljs-number">414</span>,<span class="hljs-number">324</span>,<span class="hljs-number">331</span>) then <span class="hljs-string">'좋은 고객들'</span> 
  when rfm_cell_string <span class="hljs-keyword">in</span> (<span class="hljs-number">444</span>,<span class="hljs-number">443</span>,<span class="hljs-number">434</span>,<span class="hljs-number">344</span>,<span class="hljs-number">333</span>,<span class="hljs-number">334</span>, <span class="hljs-number">343</span>,<span class="hljs-number">433</span>) then <span class="hljs-string">'최고의 고객들'</span> 
  end rfm_segment

<span class="hljs-keyword">from</span> #customer_segment
</code></pre>
<div class="content-ad"></div>
<p><img src="/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_12.png" alt="RFM Report with Power BI"></p>
<p><img src="/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_13.png" alt="RFM Report with Power BI"></p>
<h2>6. Power BI를 사용한 RFM 보고서</h2>
<p>Power BI 대시보드를 통해 Euro Shopping Channel이 최고의 성과를 거두었음이 명확히 드러납니다. 해당 채널은 가장 많은 고유 주문을 하여 총 25개를 달성하였고, 또한 최근 구매자 중에서도 속해 있습니다.</p>
<div class="content-ad"></div>
<p>대시보드에서 주목할 만한 관찰 중 하나는 고객 세그먼트별 매출을 분석할 때 "우수 고객"으로 표시된 범주가 의외로 가장 낮은 매출을 보인다는 것입니다. 이는 세분화 규칙을 적용한 후 이 범주에 속하는 고객이 단 하나뿐이기 때문입니다. 따라서 이 한 명의 고객으로부터 발생한 총 매출이 다른 세그먼트에 속한 여러 고객들의 집계 매출보다 낮을 수밖에 없는 것입니다.</p>
<p><img src="/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_14.png" alt="이미지"></p>
<p>끝
프로젝트를 읽어 주셔서 감사합니다.
LinkedIn: <a href="http://www.linkedin.com/in/kofi-duodu-siriboe-a184021b2" rel="nofollow" target="_blank">www.linkedin.com/in/kofi-duodu-siriboe-a184021b2</a></p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"SQL과 Power BI를 활용한 고객 세분화 보고서","description":"","date":"2024-06-19 09:28","slug":"2024-06-19-CustomerSegmentationReportwithSQLandPowerBI","content":"\n\n이 프로젝트에서는 RFM(Recency, Frequency, Monetary) 개념을 사용하여 판매 데이터 세트를 분석할 것입니다. 저의 목표는 고객을 세분화하여 최상위 구매자와 무시되고 있을 수 있는 고객 및 그들을 유지하기 위해 타겟 광고 노력이 더 필요한 사람들을 식별하는 것입니다.\n\nRFM 보고서는 세 가지 주요 지표를 사용하여 고객을 세분화하는 방법입니다:\n\n1. Recency(최근성): 고객의 마지막 구매가 얼마나 오래되었나요?\n   \n2. Frequency(빈도): 고객이 얼마나 자주 구매하나요?\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n3: 금액: 고객이 구매에 얼마나 지출하는가?\n\n## 프로젝트 계획\n\n- 데이터 정리\n- 데이터셋 개요\n- 분석\n- 최근성, 빈도, 금액 (RFM) 보고서\n- RFM을 사용한 고객 세분화\n- Power BI 대시보드\n\n## 1. 데이터 정리\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n데이터를 조사한 결과 특정 기능에 누락된 값이 있는 것을 발견했어요. 그래서 이를 \"없음\"으로 대체해 주었어요. 다행히도, 저가 분석할 주요 기능들에는 누락된 값이 없었어요.\n\n```js\n-- 데이터 확인하기 --\nselect*\nfrom [dbo].[sales_data];\n\n-- 데이터 정리하기 --\n\n-- Addressline2, Postalcode 및 State 열의 누락된 값 찾기\nselect *\nfrom [dbo].[sales_data]\nwhere ADDRESSLINE2 IS NULL OR STATE IS NULL OR POSTALCODE IS NULL;\n\n-- 누락된 값 처리하기\nupdate [dbo].[sales_data]\nset ADDRESSLINE2 = case when ADDRESSLINE2 IS NULL then 'None' else ADDRESSLINE2 end,\n    STATE = case when STATE IS NULL then 'Unknown States' else STATE end,\n    POSTALCODE = case when POSTALCODE IS NULL then 'None' else POSTALCODE end;\n```\n\n![이미지](/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_0.png)\n\n## 2. 데이터셋 개요\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n2.1 몇 가지 변수에서의 독특한 관찰\n\n회사는 \"Productline\" 열에서 나타나는 것처럼 열차, 오토바이, 비행기, 클래식 자동차 등의 판매에 특화되어 있습니다. 데이터는 2003년부터 2005년까지의 기간을 다룹니다.\n\n```js\n-- 일부 특성의 고유 관측치\nselect distinct STATUS from [dbo].[sales_data]\nselect distinct YEAR_ID from [dbo].[sales_data]\nselect distinct PRODUCTLINE from [dbo].[sales_data]\nselect distinct COUNTRY from [dbo].[sales_data]\nselect distinct DEALSIZE from [dbo].[sales_data]\nselect distinct TERRITORY from [dbo].[sales_data]\n```\n\n\u003cimg src=\"/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_1.png\" /\u003e\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n1.2 각 연도별 고유한 월\n\n2005년의 월만 표시한 것은 그렇다고 하더라도, 2003년과 2004년은 둘 다 모든 12개월을 포함했다는 것을 기억하는 것이 중요합니다. 아래 출력에서 확인할 수 있듯이, 2005년 데이터는 5월까지만 있는 것을 알 수 있습니다.\n\n```js\n-- 각 연도별 고유한 월\nselect distinct MONTH_ID as Month_Id_2003  from [dbo].[sales_data]  where YEAR_ID = 2003 order by MONTH_ID ASC;\n\nselect MONTH_ID as Month_Id_2004 from [dbo].[sales_data]  where YEAR_ID = 2004 order by MONTH_ID ASC;\n\nselect distinct MONTH_ID  as Month_Id_2005 from [dbo].[sales_data]  where YEAR_ID = 2005 order by MONTH_ID ASC;\n```\n\n\u003cimg src=\"/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_2.png\" /\u003e\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n## 2. 분석\n\n2.1 각 제품 라인에서 얼마나 벌고 있나요?\n\n클래식 자동차가 가장 많은 구매를 했고, 가장 적은 구매는 기차였습니다.\n\n```js\n--- 제품 라인별로 매출을 그룹화하여 계산해 봅시다\nselect PRODUCTLINE, SUM(sales) Revenue \nfrom   [dbo].[sales_data]\ngroup by PRODUCTLINE\norder by 2 desc\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\u003cimg src=\"/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_3.png\" /\u003e\n\n2.2 매년 매출액은 어떻게 되나요?\n\n결과를 통해 2004년이 가장 높은 매출을 기록했으며, 2003년이 이어서 나왔으며, 2005년의 매출액은 가장 낮았다는 것을 알 수 있습니다. 이 차이는 2005년이 단 5개월에 불과하기 때문에 전체 매출량이 2003년과 2004년의 연간 데이터와 비교하여 상대적으로 작기 때문입니다.\n\n```js\n-- 매년 매출액\nselect YEAR_ID, SUM(sales) Revenue \nfrom [dbo].[sales_data]\ngroup by YEAR_ID\norder by 2 desc \n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\n![Customer Segmentation Report](/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_4.png)\n\n2.3. What was the best month for sales in a specific year and how much was earned that month?\n\nIn 2003\n\nThere were more purchases in November and the next highest sales was October.\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\n-- 2003년 정보에 대하여\nselect MONTH_ID, sum(sales) as 수익, count(ordernumber) as 빈도 \nfrom [dbo].[sales_data]\nwhere YEAR_ID = 2003\ngroup by MONTH_ID\norder by 2 desc\n```\n\n![고객 세분화 보고서](/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_5.png)\n\n2004년에도\n\n2004년에도 11월에 가장 높은 매출이 있었으며, 다음으로 10월에 높은 매출이 있었습니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\n-- 2004 년도를 위한\nselect MONTH_ID, sum(sales) as Revenue, count(ordernumber) as Frequency \nfrom [dbo].[sales_data]\nwhere YEAR_ID = 2004\ngroup by MONTH_ID\norder by 2 desc\n```\n\n\u003cimg src=\"/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_6.png\" /\u003e\n\n2005년도에\n\n2005년에는 최다 구매가 5월에 발생하여 올해의 판매 정점을 나타냈습니다. 세 연도 동안의 처음 다섯 개월 구매를 비교하면, 2005년의 판매량이 비교적 높고, 그 다음이 2004년이며, 가장 낮은 것은 2003년입니다. 이는 회사의 매출이 연도를 통틀어 꾸준히 증가하고 있다는 것을 시사합니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\n-- 2005년 기준\nselect MONTH_ID, sum(sales) as 매출액, count(ordernumber) as 주문빈도\nfrom [dbo].[sales_data]\nwhere YEAR_ID = 2005\ngroup by MONTH_ID\norder by 2 desc\n```\n\n![이미지](/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_7.png)\n\n2.4. 회사가 11월에 일반적으로 가장 높은 매출액을 기록하는 제품은 무엇인가요?\n\n11월에는 클래식 및 빈티지 자동차의 구매가 두드러지게 증가하여 2003년부터 2004년까지 전반적인 높은 매출에 크게 기여했습니다. 반면에 기차는 동일한 달에 회사의 수익 최소화를 보여주었습니다.\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\n-- 2003년 11월\nselect MONTH_ID as November_2003, PRODUCTLINE, sum(sales) as Revenue, count(ordernumber) as Frequency \nfrom [dbo].[sales_data]\nwhere YEAR_ID = 2003 and MONTH_ID=11\ngroup by MONTH_ID, PRODUCTLINE\norder by 3 desc\n\n-- 2004년 11월\nselect MONTH_ID as November_2004,PRODUCTLINE, sum(sales) as Revenue, count(ordernumber) as Frequency \nfrom [dbo].[sales_data]\nwhere YEAR_ID = 2004 and MONTH_ID=11\ngroup by MONTH_ID, PRODUCTLINE\norder by 3 desc\n```\n\n\u003cimg src=\"/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_8.png\" /\u003e\n\n## 4. 최근성, 주파수 및 금액 (RFM) 보고서\n\n최근성은 마지막 주문 또는 구매 이후 경과한 일 수를 나타내며, Euro Shopping Channel과 La Rochelle Gifts는 데이터에서 가장 최근 구매를 한 날짜에 해당합니다(최대 날짜). 최근성 값이 높을수록 마지막 구매 이후의 기간이 길어집니다. RFM 결과에 따르면 Toys of Finland. Co는 데이터 집합에서 현재 또는 최대 날짜로부터 100일 이상이 지난 마지막 구매를 했습니다.\n또한, 주문 사이의 평균 일 수를 살펴보면 고객들이 얼마나 자주 구매를 하는지에 대한 통찰을 제공합니다. Euro Shopping Channel은 평균 3일 간격으로 가장 꾸준한 고객 중 하나로 나타납니다.\n마찬가지로, 고객 당 금액 값을 검토하면 Euro Shopping Channel이 가장 많이 지출한 것을 확인할 수 있습니다.\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```sql\n-- RFM 분석\nselect CUSTOMERNAME,\n   sum(sales) as MonetaryValue,\n   avg(sales) as AvgMonetaryValue,\n   count(*) as Frequency_of_orders,\n   count(distinct convert(DATE, orderdate)) AS Number_of_unique_order_dates,\n   convert(INT, round(cast(datediff(dd, min(ORDERDATE), max(ORDERDATE)) as decimal)/(count(*)-1),0)) as [Aveg_day_between_orders],\n   datediff(DD,max(orderdate),( select max(orderdate) from [dbo].[sales_data])) as recency \nfrom [dbo].[sales_data]\ngroup by CUSTOMERNAME\nhaving count(*)\u003e1\norder by recency\n```\n\n![RFM Analysis](/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_9.png)\n\n## 5.0 RFM 보고서 기반의 고객 세분화\n\n제공된 결과는 RFM 기준에 따른 고객 세분화에 대한 통찰을 제공합니다. rfm_recency=1에 속한 고객은 최근 구매 이후 지난 기간이 길어서, 데이터 세트에서 최대 날짜로부터 112일까지 구매를 한 Boards \u0026 Toys Co.와 같이 특징 지어집니다. 반면, rfm_recency=4는 최근 구매를 나타내며, 데이터 세트에서 가장 최근 구매가 14일 전인 Salzburg Collectables과 같은 상황입니다. 이는 rfm_recency=1 또는 2에 속한 고객이 마지막 주문 이후 상당한 시간이 지나자 \"잠재적 이탈 고객\"일 수 있다는 것을 나타냅니다.\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n비슷하게, rfm_monetary에 대해서는 소비가 높은 고객이 rfm_monetary=4로 분류되며, 소비가 적은 고객은 rfm_monetary=1로 분류됩니다. rfm_frequency에 대해, rfm_frequency=4인 고객은 가장 많은 주문을 보유하고 있으며, rfm_frequency=1은 가장 적은 주문을 가진 고객을 나타냅니다.\n\n이러한 RFM 카테고리를 분석하여, 최근 구매를 보유한 최고의 고객은(rfm_recency=4), 가장 높은 금액을 지출한 고객(rfm_monetary=4) 및 가장 많은 주문을 가진 고객(rfm_frequency=4)으로 식별할 수 있습니다.\n\n\n---고객을 네 가지 세분류로 분류합니다.\n\nwith customer_segment as\n(\n select \n   CUSTOMERNAME,\n   sum(sales) as MonetaryValue,\n   count(ordernumber) as Frequency_of_orders,\n   max (orderdate) as last_order_date,\n   (select max(orderdate) from [dbo].[sales_data]) as max_order_date,\n   datediff(dd, max(orderdate),(select max(orderdate) from [dbo].[sales_data])) as Recency \n from [dbo].[sales_data]\n group by CUSTOMERNAME \n)\nselect*,\n  NTILE(4) OVER (order by Recency desc) as rfm_recency,\n  NTILE(4) OVER (order by Frequency_of_orders) as rfm_frequency,\n  NTILE(4) OVER (order by MonetaryValue) as rfm_monetary\nfrom customer_segment \n\n\n![Customer Segmentation Report](/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_10.png)\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\u003cimg src=\"/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_11.png\" /\u003e\n\n5.1 상기 Segmentation을 기반으로 고객에게 Segment 이름 할당하기.\n고객 Segmentation을 고려할 때, 복합 코드가 444인 고객이 최고의 고객을 대표합니다. 첫 번째 4는 rfm_recency 그룹 4에 속한 고객을 나타내며 최근 구매를 의미합니다. 두 번째 4는 rfm_frequency 그룹 4에 속한 고객을 나타내어 많은 주문을 했음을 의미합니다. 마지막 4는 rfm_monetary 그룹 4에 속한 고객들을 나타내어 더 많은 돈을 소비했다는 것을 의미합니다.\n\n반대로, 복합 그룹이 111인 고객들은 오랜 시간 구매를 하지 않은, 주문 수가 적고 지금까지 가장 적은 금액을 소비한 고객들입니다.\n\n```js\n-- 우리 최고의 고객은 누구인가요?\n\nDROP TABLE IF EXISTS #customer_segment; -- 테이블 #rfm 생성\nwith customer_segment as\n(\n select \n CUSTOMERNAME,\n sum(sales) as MonetaryValue,\n avg(sales) as AvgMonetaryValue,\n COUNT(ordernumber) as Frequency,\n MAX(orderdate) as last_order_date,\n (select max(orderdate) from [dbo].[sales_data]) as max_oder_date,\n DATEDIFF(DD, MAX(orderdate),(select max(orderdate) from [dbo].[sales_data])) as Recency \n from [dbo].[sales_data]\n group by CUSTOMERNAME \n),\n\nrfm_segmentation as \n  (\n  select*,\n  NTILE(4) OVER (order by Recency desc)as rfm_recency,\n  NTILE(4) OVER (order by Frequency) as rfm_frequency,\n  NTILE(4) OVER (order by MonetaryValue) as rfm_monetary\n   --(NTILE(4) OVER (order by Recency)) + (NTILE(4) OVER (order by Frequency)) + (NTILE(4) OVER (order by AvgMonetaryValue)) AS CompositeScore\n  from customer_segment \n )\n\nselect \n c.*, rfm_recency + rfm_frequency + rfm_monetary as rfm_cell,\n CAST(rfm_recency as varchar)+ CAST(rfm_frequency as varchar)+ CAST(rfm_monetary as varchar) as rfm_cell_string\n\ninto #customer_segment -- 스크립트를 실행하면서 테이블을 생성하는 데 도움이 됩니다. 맨 위에 #rfm 테이블이 이미 생성되었습니다.\nfrom rfm_segmentation c\n\n\n\nselect CUSTOMERNAME, rfm_recency,rfm_frequency, rfm_monetary,rfm_cell_string,\n  CASE\n  when rfm_cell_string in (111, 112, 121, 122, 211, 212, 114, 141, 123, 131,132,141,142,221, 231,232,242,241) then '잃어버린 나 새로운 고객'\n  when rfm_cell_string in (222,223, 233,134,143,133,144,234,232,244) then '사라져가지만 돈을 많이 쓰는 고객' -- 회사는 그들이 떠나는 것을 방치해서는 안됩니다\n  when rfm_cell_string in (411,412,421,422,342,442,322,332,311) then '정기적이지만 소비가 적은 고객'\n  when rfm_cell_string in (424,423,432,324,414,324,331) then '좋은 고객들' \n  when rfm_cell_string in (444,443,434,344,333,334, 343,433) then '최고의 고객들' \n  end rfm_segment\n\nfrom #customer_segment\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n![RFM Report with Power BI](/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_12.png) \n\n![RFM Report with Power BI](/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_13.png) \n\n## 6. Power BI를 사용한 RFM 보고서\n\nPower BI 대시보드를 통해 Euro Shopping Channel이 최고의 성과를 거두었음이 명확히 드러납니다. 해당 채널은 가장 많은 고유 주문을 하여 총 25개를 달성하였고, 또한 최근 구매자 중에서도 속해 있습니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n대시보드에서 주목할 만한 관찰 중 하나는 고객 세그먼트별 매출을 분석할 때 \"우수 고객\"으로 표시된 범주가 의외로 가장 낮은 매출을 보인다는 것입니다. 이는 세분화 규칙을 적용한 후 이 범주에 속하는 고객이 단 하나뿐이기 때문입니다. 따라서 이 한 명의 고객으로부터 발생한 총 매출이 다른 세그먼트에 속한 여러 고객들의 집계 매출보다 낮을 수밖에 없는 것입니다.\n\n![이미지](/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_14.png)\n\n끝\n프로젝트를 읽어 주셔서 감사합니다.\nLinkedIn: www.linkedin.com/in/kofi-duodu-siriboe-a184021b2","ogImage":{"url":"/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_0.png"},"coverImage":"/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_0.png","tag":["Tech"],"readingTime":11},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003e이 프로젝트에서는 RFM(Recency, Frequency, Monetary) 개념을 사용하여 판매 데이터 세트를 분석할 것입니다. 저의 목표는 고객을 세분화하여 최상위 구매자와 무시되고 있을 수 있는 고객 및 그들을 유지하기 위해 타겟 광고 노력이 더 필요한 사람들을 식별하는 것입니다.\u003c/p\u003e\n\u003cp\u003eRFM 보고서는 세 가지 주요 지표를 사용하여 고객을 세분화하는 방법입니다:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eRecency(최근성): 고객의 마지막 구매가 얼마나 오래되었나요?\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eFrequency(빈도): 고객이 얼마나 자주 구매하나요?\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e3: 금액: 고객이 구매에 얼마나 지출하는가?\u003c/p\u003e\n\u003ch2\u003e프로젝트 계획\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e데이터 정리\u003c/li\u003e\n\u003cli\u003e데이터셋 개요\u003c/li\u003e\n\u003cli\u003e분석\u003c/li\u003e\n\u003cli\u003e최근성, 빈도, 금액 (RFM) 보고서\u003c/li\u003e\n\u003cli\u003eRFM을 사용한 고객 세분화\u003c/li\u003e\n\u003cli\u003ePower BI 대시보드\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e1. 데이터 정리\u003c/h2\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e데이터를 조사한 결과 특정 기능에 누락된 값이 있는 것을 발견했어요. 그래서 이를 \"없음\"으로 대체해 주었어요. 다행히도, 저가 분석할 주요 기능들에는 누락된 값이 없었어요.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e-- 데이터 확인하기 --\nselect*\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e [dbo].[sales_data];\n\n-- 데이터 정리하기 --\n\n-- \u003cspan class=\"hljs-title class_\"\u003eAddressline2\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003ePostalcode\u003c/span\u003e 및 \u003cspan class=\"hljs-title class_\"\u003eState\u003c/span\u003e 열의 누락된 값 찾기\nselect *\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e [dbo].[sales_data]\nwhere \u003cspan class=\"hljs-title class_\"\u003eADDRESSLINE2\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eIS\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eNULL\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eOR\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eSTATE\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eIS\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eNULL\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eOR\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003ePOSTALCODE\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eIS\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eNULL\u003c/span\u003e;\n\n-- 누락된 값 처리하기\nupdate [dbo].[sales_data]\nset \u003cspan class=\"hljs-title class_\"\u003eADDRESSLINE2\u003c/span\u003e = \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e when \u003cspan class=\"hljs-title class_\"\u003eADDRESSLINE2\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eIS\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eNULL\u003c/span\u003e then \u003cspan class=\"hljs-string\"\u003e'None'\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eADDRESSLINE2\u003c/span\u003e end,\n    \u003cspan class=\"hljs-variable constant_\"\u003eSTATE\u003c/span\u003e = \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e when \u003cspan class=\"hljs-variable constant_\"\u003eSTATE\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eIS\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eNULL\u003c/span\u003e then \u003cspan class=\"hljs-string\"\u003e'Unknown States'\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eSTATE\u003c/span\u003e end,\n    \u003cspan class=\"hljs-variable constant_\"\u003ePOSTALCODE\u003c/span\u003e = \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e when \u003cspan class=\"hljs-variable constant_\"\u003ePOSTALCODE\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eIS\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eNULL\u003c/span\u003e then \u003cspan class=\"hljs-string\"\u003e'None'\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003ePOSTALCODE\u003c/span\u003e end;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_0.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003ch2\u003e2. 데이터셋 개요\u003c/h2\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e2.1 몇 가지 변수에서의 독특한 관찰\u003c/p\u003e\n\u003cp\u003e회사는 \"Productline\" 열에서 나타나는 것처럼 열차, 오토바이, 비행기, 클래식 자동차 등의 판매에 특화되어 있습니다. 데이터는 2003년부터 2005년까지의 기간을 다룹니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e-- 일부 특성의 고유 관측치\nselect distinct \u003cspan class=\"hljs-variable constant_\"\u003eSTATUS\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e [dbo].[sales_data]\nselect distinct \u003cspan class=\"hljs-variable constant_\"\u003eYEAR_ID\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e [dbo].[sales_data]\nselect distinct \u003cspan class=\"hljs-variable constant_\"\u003ePRODUCTLINE\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e [dbo].[sales_data]\nselect distinct \u003cspan class=\"hljs-variable constant_\"\u003eCOUNTRY\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e [dbo].[sales_data]\nselect distinct \u003cspan class=\"hljs-variable constant_\"\u003eDEALSIZE\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e [dbo].[sales_data]\nselect distinct \u003cspan class=\"hljs-variable constant_\"\u003eTERRITORY\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e [dbo].[sales_data]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cimg src=\"/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_1.png\"\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e1.2 각 연도별 고유한 월\u003c/p\u003e\n\u003cp\u003e2005년의 월만 표시한 것은 그렇다고 하더라도, 2003년과 2004년은 둘 다 모든 12개월을 포함했다는 것을 기억하는 것이 중요합니다. 아래 출력에서 확인할 수 있듯이, 2005년 데이터는 5월까지만 있는 것을 알 수 있습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e-- 각 연도별 고유한 월\nselect distinct \u003cspan class=\"hljs-variable constant_\"\u003eMONTH_ID\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eMonth\u003c/span\u003e_Id_2003  \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e [dbo].[sales_data]  where \u003cspan class=\"hljs-variable constant_\"\u003eYEAR_ID\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e2003\u003c/span\u003e order by \u003cspan class=\"hljs-variable constant_\"\u003eMONTH_ID\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eASC\u003c/span\u003e;\n\nselect \u003cspan class=\"hljs-variable constant_\"\u003eMONTH_ID\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eMonth\u003c/span\u003e_Id_2004 \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e [dbo].[sales_data]  where \u003cspan class=\"hljs-variable constant_\"\u003eYEAR_ID\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e2004\u003c/span\u003e order by \u003cspan class=\"hljs-variable constant_\"\u003eMONTH_ID\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eASC\u003c/span\u003e;\n\nselect distinct \u003cspan class=\"hljs-variable constant_\"\u003eMONTH_ID\u003c/span\u003e  \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eMonth\u003c/span\u003e_Id_2005 \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e [dbo].[sales_data]  where \u003cspan class=\"hljs-variable constant_\"\u003eYEAR_ID\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e2005\u003c/span\u003e order by \u003cspan class=\"hljs-variable constant_\"\u003eMONTH_ID\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eASC\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cimg src=\"/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_2.png\"\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003ch2\u003e2. 분석\u003c/h2\u003e\n\u003cp\u003e2.1 각 제품 라인에서 얼마나 벌고 있나요?\u003c/p\u003e\n\u003cp\u003e클래식 자동차가 가장 많은 구매를 했고, 가장 적은 구매는 기차였습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e--- 제품 라인별로 매출을 그룹화하여 계산해 봅시다\nselect \u003cspan class=\"hljs-variable constant_\"\u003ePRODUCTLINE\u003c/span\u003e, \u003cspan class=\"hljs-title function_\"\u003eSUM\u003c/span\u003e(sales) \u003cspan class=\"hljs-title class_\"\u003eRevenue\u003c/span\u003e \n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e   [dbo].[sales_data]\ngroup by \u003cspan class=\"hljs-variable constant_\"\u003ePRODUCTLINE\u003c/span\u003e\norder by \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e desc\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cimg src=\"/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_3.png\"\u003e\n\u003cp\u003e2.2 매년 매출액은 어떻게 되나요?\u003c/p\u003e\n\u003cp\u003e결과를 통해 2004년이 가장 높은 매출을 기록했으며, 2003년이 이어서 나왔으며, 2005년의 매출액은 가장 낮았다는 것을 알 수 있습니다. 이 차이는 2005년이 단 5개월에 불과하기 때문에 전체 매출량이 2003년과 2004년의 연간 데이터와 비교하여 상대적으로 작기 때문입니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e-- 매년 매출액\nselect \u003cspan class=\"hljs-variable constant_\"\u003eYEAR_ID\u003c/span\u003e, \u003cspan class=\"hljs-title function_\"\u003eSUM\u003c/span\u003e(sales) \u003cspan class=\"hljs-title class_\"\u003eRevenue\u003c/span\u003e \n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e [dbo].[sales_data]\ngroup by \u003cspan class=\"hljs-variable constant_\"\u003eYEAR_ID\u003c/span\u003e\norder by \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e desc \n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_4.png\" alt=\"Customer Segmentation Report\"\u003e\u003c/p\u003e\n\u003cp\u003e2.3. What was the best month for sales in a specific year and how much was earned that month?\u003c/p\u003e\n\u003cp\u003eIn 2003\u003c/p\u003e\n\u003cp\u003eThere were more purchases in November and the next highest sales was October.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e-- \u003cspan class=\"hljs-number\"\u003e2003\u003c/span\u003e년 정보에 대하여\nselect \u003cspan class=\"hljs-variable constant_\"\u003eMONTH_ID\u003c/span\u003e, \u003cspan class=\"hljs-title function_\"\u003esum\u003c/span\u003e(sales) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e 수익, \u003cspan class=\"hljs-title function_\"\u003ecount\u003c/span\u003e(ordernumber) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e 빈도 \n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e [dbo].[sales_data]\nwhere \u003cspan class=\"hljs-variable constant_\"\u003eYEAR_ID\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e2003\u003c/span\u003e\ngroup by \u003cspan class=\"hljs-variable constant_\"\u003eMONTH_ID\u003c/span\u003e\norder by \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e desc\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_5.png\" alt=\"고객 세분화 보고서\"\u003e\u003c/p\u003e\n\u003cp\u003e2004년에도\u003c/p\u003e\n\u003cp\u003e2004년에도 11월에 가장 높은 매출이 있었으며, 다음으로 10월에 높은 매출이 있었습니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e-- \u003cspan class=\"hljs-number\"\u003e2004\u003c/span\u003e 년도를 위한\nselect \u003cspan class=\"hljs-variable constant_\"\u003eMONTH_ID\u003c/span\u003e, \u003cspan class=\"hljs-title function_\"\u003esum\u003c/span\u003e(sales) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eRevenue\u003c/span\u003e, \u003cspan class=\"hljs-title function_\"\u003ecount\u003c/span\u003e(ordernumber) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eFrequency\u003c/span\u003e \n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e [dbo].[sales_data]\nwhere \u003cspan class=\"hljs-variable constant_\"\u003eYEAR_ID\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e2004\u003c/span\u003e\ngroup by \u003cspan class=\"hljs-variable constant_\"\u003eMONTH_ID\u003c/span\u003e\norder by \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e desc\n\u003c/code\u003e\u003c/pre\u003e\n\u003cimg src=\"/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_6.png\"\u003e\n\u003cp\u003e2005년도에\u003c/p\u003e\n\u003cp\u003e2005년에는 최다 구매가 5월에 발생하여 올해의 판매 정점을 나타냈습니다. 세 연도 동안의 처음 다섯 개월 구매를 비교하면, 2005년의 판매량이 비교적 높고, 그 다음이 2004년이며, 가장 낮은 것은 2003년입니다. 이는 회사의 매출이 연도를 통틀어 꾸준히 증가하고 있다는 것을 시사합니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e-- \u003cspan class=\"hljs-number\"\u003e2005\u003c/span\u003e년 기준\nselect \u003cspan class=\"hljs-variable constant_\"\u003eMONTH_ID\u003c/span\u003e, \u003cspan class=\"hljs-title function_\"\u003esum\u003c/span\u003e(sales) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e 매출액, \u003cspan class=\"hljs-title function_\"\u003ecount\u003c/span\u003e(ordernumber) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e 주문빈도\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e [dbo].[sales_data]\nwhere \u003cspan class=\"hljs-variable constant_\"\u003eYEAR_ID\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e2005\u003c/span\u003e\ngroup by \u003cspan class=\"hljs-variable constant_\"\u003eMONTH_ID\u003c/span\u003e\norder by \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e desc\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_7.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003cp\u003e2.4. 회사가 11월에 일반적으로 가장 높은 매출액을 기록하는 제품은 무엇인가요?\u003c/p\u003e\n\u003cp\u003e11월에는 클래식 및 빈티지 자동차의 구매가 두드러지게 증가하여 2003년부터 2004년까지 전반적인 높은 매출에 크게 기여했습니다. 반면에 기차는 동일한 달에 회사의 수익 최소화를 보여주었습니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e-- \u003cspan class=\"hljs-number\"\u003e2003\u003c/span\u003e년 \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e월\nselect \u003cspan class=\"hljs-variable constant_\"\u003eMONTH_ID\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eNovember\u003c/span\u003e_2003, \u003cspan class=\"hljs-variable constant_\"\u003ePRODUCTLINE\u003c/span\u003e, \u003cspan class=\"hljs-title function_\"\u003esum\u003c/span\u003e(sales) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eRevenue\u003c/span\u003e, \u003cspan class=\"hljs-title function_\"\u003ecount\u003c/span\u003e(ordernumber) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eFrequency\u003c/span\u003e \n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e [dbo].[sales_data]\nwhere \u003cspan class=\"hljs-variable constant_\"\u003eYEAR_ID\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e2003\u003c/span\u003e and \u003cspan class=\"hljs-variable constant_\"\u003eMONTH_ID\u003c/span\u003e=\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e\ngroup by \u003cspan class=\"hljs-variable constant_\"\u003eMONTH_ID\u003c/span\u003e, \u003cspan class=\"hljs-variable constant_\"\u003ePRODUCTLINE\u003c/span\u003e\norder by \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e desc\n\n-- \u003cspan class=\"hljs-number\"\u003e2004\u003c/span\u003e년 \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e월\nselect \u003cspan class=\"hljs-variable constant_\"\u003eMONTH_ID\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eNovember\u003c/span\u003e_2004,\u003cspan class=\"hljs-variable constant_\"\u003ePRODUCTLINE\u003c/span\u003e, \u003cspan class=\"hljs-title function_\"\u003esum\u003c/span\u003e(sales) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eRevenue\u003c/span\u003e, \u003cspan class=\"hljs-title function_\"\u003ecount\u003c/span\u003e(ordernumber) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eFrequency\u003c/span\u003e \n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e [dbo].[sales_data]\nwhere \u003cspan class=\"hljs-variable constant_\"\u003eYEAR_ID\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e2004\u003c/span\u003e and \u003cspan class=\"hljs-variable constant_\"\u003eMONTH_ID\u003c/span\u003e=\u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e\ngroup by \u003cspan class=\"hljs-variable constant_\"\u003eMONTH_ID\u003c/span\u003e, \u003cspan class=\"hljs-variable constant_\"\u003ePRODUCTLINE\u003c/span\u003e\norder by \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e desc\n\u003c/code\u003e\u003c/pre\u003e\n\u003cimg src=\"/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_8.png\"\u003e\n\u003ch2\u003e4. 최근성, 주파수 및 금액 (RFM) 보고서\u003c/h2\u003e\n\u003cp\u003e최근성은 마지막 주문 또는 구매 이후 경과한 일 수를 나타내며, Euro Shopping Channel과 La Rochelle Gifts는 데이터에서 가장 최근 구매를 한 날짜에 해당합니다(최대 날짜). 최근성 값이 높을수록 마지막 구매 이후의 기간이 길어집니다. RFM 결과에 따르면 Toys of Finland. Co는 데이터 집합에서 현재 또는 최대 날짜로부터 100일 이상이 지난 마지막 구매를 했습니다.\n또한, 주문 사이의 평균 일 수를 살펴보면 고객들이 얼마나 자주 구매를 하는지에 대한 통찰을 제공합니다. Euro Shopping Channel은 평균 3일 간격으로 가장 꾸준한 고객 중 하나로 나타납니다.\n마찬가지로, 고객 당 금액 값을 검토하면 Euro Shopping Channel이 가장 많이 지출한 것을 확인할 수 있습니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-sql\"\u003e\u003cspan class=\"hljs-comment\"\u003e-- RFM 분석\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eselect\u003c/span\u003e CUSTOMERNAME,\n   \u003cspan class=\"hljs-built_in\"\u003esum\u003c/span\u003e(sales) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e MonetaryValue,\n   \u003cspan class=\"hljs-built_in\"\u003eavg\u003c/span\u003e(sales) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e AvgMonetaryValue,\n   \u003cspan class=\"hljs-built_in\"\u003ecount\u003c/span\u003e(\u003cspan class=\"hljs-operator\"\u003e*\u003c/span\u003e) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e Frequency_of_orders,\n   \u003cspan class=\"hljs-built_in\"\u003ecount\u003c/span\u003e(\u003cspan class=\"hljs-keyword\"\u003edistinct\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003econvert\u003c/span\u003e(\u003cspan class=\"hljs-type\"\u003eDATE\u003c/span\u003e, orderdate)) \u003cspan class=\"hljs-keyword\"\u003eAS\u003c/span\u003e Number_of_unique_order_dates,\n   \u003cspan class=\"hljs-keyword\"\u003econvert\u003c/span\u003e(\u003cspan class=\"hljs-type\"\u003eINT\u003c/span\u003e, round(\u003cspan class=\"hljs-built_in\"\u003ecast\u003c/span\u003e(datediff(dd, \u003cspan class=\"hljs-built_in\"\u003emin\u003c/span\u003e(ORDERDATE), \u003cspan class=\"hljs-built_in\"\u003emax\u003c/span\u003e(ORDERDATE)) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-type\"\u003edecimal\u003c/span\u003e)\u003cspan class=\"hljs-operator\"\u003e/\u003c/span\u003e(\u003cspan class=\"hljs-built_in\"\u003ecount\u003c/span\u003e(\u003cspan class=\"hljs-operator\"\u003e*\u003c/span\u003e)\u003cspan class=\"hljs-number\"\u003e-1\u003c/span\u003e),\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e [Aveg_day_between_orders],\n   datediff(DD,\u003cspan class=\"hljs-built_in\"\u003emax\u003c/span\u003e(orderdate),( \u003cspan class=\"hljs-keyword\"\u003eselect\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003emax\u003c/span\u003e(orderdate) \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e [dbo].[sales_data])) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e recency \n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e [dbo].[sales_data]\n\u003cspan class=\"hljs-keyword\"\u003egroup\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eby\u003c/span\u003e CUSTOMERNAME\n\u003cspan class=\"hljs-keyword\"\u003ehaving\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ecount\u003c/span\u003e(\u003cspan class=\"hljs-operator\"\u003e*\u003c/span\u003e)\u003cspan class=\"hljs-operator\"\u003e\u003e\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eorder\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eby\u003c/span\u003e recency\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_9.png\" alt=\"RFM Analysis\"\u003e\u003c/p\u003e\n\u003ch2\u003e5.0 RFM 보고서 기반의 고객 세분화\u003c/h2\u003e\n\u003cp\u003e제공된 결과는 RFM 기준에 따른 고객 세분화에 대한 통찰을 제공합니다. rfm_recency=1에 속한 고객은 최근 구매 이후 지난 기간이 길어서, 데이터 세트에서 최대 날짜로부터 112일까지 구매를 한 Boards \u0026#x26; Toys Co.와 같이 특징 지어집니다. 반면, rfm_recency=4는 최근 구매를 나타내며, 데이터 세트에서 가장 최근 구매가 14일 전인 Salzburg Collectables과 같은 상황입니다. 이는 rfm_recency=1 또는 2에 속한 고객이 마지막 주문 이후 상당한 시간이 지나자 \"잠재적 이탈 고객\"일 수 있다는 것을 나타냅니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e비슷하게, rfm_monetary에 대해서는 소비가 높은 고객이 rfm_monetary=4로 분류되며, 소비가 적은 고객은 rfm_monetary=1로 분류됩니다. rfm_frequency에 대해, rfm_frequency=4인 고객은 가장 많은 주문을 보유하고 있으며, rfm_frequency=1은 가장 적은 주문을 가진 고객을 나타냅니다.\u003c/p\u003e\n\u003cp\u003e이러한 RFM 카테고리를 분석하여, 최근 구매를 보유한 최고의 고객은(rfm_recency=4), 가장 높은 금액을 지출한 고객(rfm_monetary=4) 및 가장 많은 주문을 가진 고객(rfm_frequency=4)으로 식별할 수 있습니다.\u003c/p\u003e\n\u003cp\u003e---고객을 네 가지 세분류로 분류합니다.\u003c/p\u003e\n\u003cp\u003ewith customer_segment as\n(\nselect\nCUSTOMERNAME,\nsum(sales) as MonetaryValue,\ncount(ordernumber) as Frequency_of_orders,\nmax (orderdate) as last_order_date,\n(select max(orderdate) from [dbo].[sales_data]) as max_order_date,\ndatediff(dd, max(orderdate),(select max(orderdate) from [dbo].[sales_data])) as Recency\nfrom [dbo].[sales_data]\ngroup by CUSTOMERNAME\n)\nselect*,\nNTILE(4) OVER (order by Recency desc) as rfm_recency,\nNTILE(4) OVER (order by Frequency_of_orders) as rfm_frequency,\nNTILE(4) OVER (order by MonetaryValue) as rfm_monetary\nfrom customer_segment\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_10.png\" alt=\"Customer Segmentation Report\"\u003e\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cimg src=\"/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_11.png\"\u003e\n\u003cp\u003e5.1 상기 Segmentation을 기반으로 고객에게 Segment 이름 할당하기.\n고객 Segmentation을 고려할 때, 복합 코드가 444인 고객이 최고의 고객을 대표합니다. 첫 번째 4는 rfm_recency 그룹 4에 속한 고객을 나타내며 최근 구매를 의미합니다. 두 번째 4는 rfm_frequency 그룹 4에 속한 고객을 나타내어 많은 주문을 했음을 의미합니다. 마지막 4는 rfm_monetary 그룹 4에 속한 고객들을 나타내어 더 많은 돈을 소비했다는 것을 의미합니다.\u003c/p\u003e\n\u003cp\u003e반대로, 복합 그룹이 111인 고객들은 오랜 시간 구매를 하지 않은, 주문 수가 적고 지금까지 가장 적은 금액을 소비한 고객들입니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e-- 우리 최고의 고객은 누구인가요?\n\n\u003cspan class=\"hljs-variable constant_\"\u003eDROP\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eTABLE\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eIF\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eEXISTS\u003c/span\u003e #customer_segment; -- 테이블 #rfm 생성\n\u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e customer_segment \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e\n(\n select \n \u003cspan class=\"hljs-variable constant_\"\u003eCUSTOMERNAME\u003c/span\u003e,\n \u003cspan class=\"hljs-title function_\"\u003esum\u003c/span\u003e(sales) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eMonetaryValue\u003c/span\u003e,\n \u003cspan class=\"hljs-title function_\"\u003eavg\u003c/span\u003e(sales) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eAvgMonetaryValue\u003c/span\u003e,\n \u003cspan class=\"hljs-title function_\"\u003eCOUNT\u003c/span\u003e(ordernumber) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eFrequency\u003c/span\u003e,\n \u003cspan class=\"hljs-title function_\"\u003eMAX\u003c/span\u003e(orderdate) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e last_order_date,\n (select \u003cspan class=\"hljs-title function_\"\u003emax\u003c/span\u003e(orderdate) \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e [dbo].[sales_data]) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e max_oder_date,\n \u003cspan class=\"hljs-title function_\"\u003eDATEDIFF\u003c/span\u003e(\u003cspan class=\"hljs-variable constant_\"\u003eDD\u003c/span\u003e, \u003cspan class=\"hljs-title function_\"\u003eMAX\u003c/span\u003e(orderdate),(select \u003cspan class=\"hljs-title function_\"\u003emax\u003c/span\u003e(orderdate) \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e [dbo].[sales_data])) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eRecency\u003c/span\u003e \n \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e [dbo].[sales_data]\n group by \u003cspan class=\"hljs-variable constant_\"\u003eCUSTOMERNAME\u003c/span\u003e \n),\n\nrfm_segmentation \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \n  (\n  select*,\n  \u003cspan class=\"hljs-title function_\"\u003eNTILE\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e) \u003cspan class=\"hljs-variable constant_\"\u003eOVER\u003c/span\u003e (order by \u003cspan class=\"hljs-title class_\"\u003eRecency\u003c/span\u003e desc)\u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e rfm_recency,\n  \u003cspan class=\"hljs-title function_\"\u003eNTILE\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e) \u003cspan class=\"hljs-variable constant_\"\u003eOVER\u003c/span\u003e (order by \u003cspan class=\"hljs-title class_\"\u003eFrequency\u003c/span\u003e) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e rfm_frequency,\n  \u003cspan class=\"hljs-title function_\"\u003eNTILE\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e) \u003cspan class=\"hljs-variable constant_\"\u003eOVER\u003c/span\u003e (order by \u003cspan class=\"hljs-title class_\"\u003eMonetaryValue\u003c/span\u003e) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e rfm_monetary\n   --(\u003cspan class=\"hljs-title function_\"\u003eNTILE\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e) \u003cspan class=\"hljs-variable constant_\"\u003eOVER\u003c/span\u003e (order by \u003cspan class=\"hljs-title class_\"\u003eRecency\u003c/span\u003e)) + (\u003cspan class=\"hljs-title function_\"\u003eNTILE\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e) \u003cspan class=\"hljs-variable constant_\"\u003eOVER\u003c/span\u003e (order by \u003cspan class=\"hljs-title class_\"\u003eFrequency\u003c/span\u003e)) + (\u003cspan class=\"hljs-title function_\"\u003eNTILE\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e) \u003cspan class=\"hljs-variable constant_\"\u003eOVER\u003c/span\u003e (order by \u003cspan class=\"hljs-title class_\"\u003eAvgMonetaryValue\u003c/span\u003e)) \u003cspan class=\"hljs-variable constant_\"\u003eAS\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eCompositeScore\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e customer_segment \n )\n\nselect \n c.*, rfm_recency + rfm_frequency + rfm_monetary \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e rfm_cell,\n \u003cspan class=\"hljs-title function_\"\u003eCAST\u003c/span\u003e(rfm_recency \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e varchar)+ \u003cspan class=\"hljs-title function_\"\u003eCAST\u003c/span\u003e(rfm_frequency \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e varchar)+ \u003cspan class=\"hljs-title function_\"\u003eCAST\u003c/span\u003e(rfm_monetary \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e varchar) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e rfm_cell_string\n\ninto #customer_segment -- 스크립트를 실행하면서 테이블을 생성하는 데 도움이 됩니다. 맨 위에 #rfm 테이블이 이미 생성되었습니다.\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e rfm_segmentation c\n\n\n\nselect \u003cspan class=\"hljs-variable constant_\"\u003eCUSTOMERNAME\u003c/span\u003e, rfm_recency,rfm_frequency, rfm_monetary,rfm_cell_string,\n  \u003cspan class=\"hljs-variable constant_\"\u003eCASE\u003c/span\u003e\n  when rfm_cell_string \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e111\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e112\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e121\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e122\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e211\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e212\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e114\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e141\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e123\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e131\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e132\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e141\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e142\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e221\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e231\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e232\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e242\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e241\u003c/span\u003e) then \u003cspan class=\"hljs-string\"\u003e'잃어버린 나 새로운 고객'\u003c/span\u003e\n  when rfm_cell_string \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e222\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e223\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e233\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e134\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e143\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e133\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e144\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e234\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e232\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e244\u003c/span\u003e) then \u003cspan class=\"hljs-string\"\u003e'사라져가지만 돈을 많이 쓰는 고객'\u003c/span\u003e -- 회사는 그들이 떠나는 것을 방치해서는 안됩니다\n  when rfm_cell_string \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e411\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e412\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e421\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e422\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e342\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e442\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e322\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e332\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e311\u003c/span\u003e) then \u003cspan class=\"hljs-string\"\u003e'정기적이지만 소비가 적은 고객'\u003c/span\u003e\n  when rfm_cell_string \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e424\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e423\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e432\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e324\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e414\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e324\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e331\u003c/span\u003e) then \u003cspan class=\"hljs-string\"\u003e'좋은 고객들'\u003c/span\u003e \n  when rfm_cell_string \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e444\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e443\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e434\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e344\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e333\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e334\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e343\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e433\u003c/span\u003e) then \u003cspan class=\"hljs-string\"\u003e'최고의 고객들'\u003c/span\u003e \n  end rfm_segment\n\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e #customer_segment\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_12.png\" alt=\"RFM Report with Power BI\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_13.png\" alt=\"RFM Report with Power BI\"\u003e\u003c/p\u003e\n\u003ch2\u003e6. Power BI를 사용한 RFM 보고서\u003c/h2\u003e\n\u003cp\u003ePower BI 대시보드를 통해 Euro Shopping Channel이 최고의 성과를 거두었음이 명확히 드러납니다. 해당 채널은 가장 많은 고유 주문을 하여 총 25개를 달성하였고, 또한 최근 구매자 중에서도 속해 있습니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e대시보드에서 주목할 만한 관찰 중 하나는 고객 세그먼트별 매출을 분석할 때 \"우수 고객\"으로 표시된 범주가 의외로 가장 낮은 매출을 보인다는 것입니다. 이는 세분화 규칙을 적용한 후 이 범주에 속하는 고객이 단 하나뿐이기 때문입니다. 따라서 이 한 명의 고객으로부터 발생한 총 매출이 다른 세그먼트에 속한 여러 고객들의 집계 매출보다 낮을 수밖에 없는 것입니다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-19-CustomerSegmentationReportwithSQLandPowerBI_14.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003cp\u003e끝\n프로젝트를 읽어 주셔서 감사합니다.\nLinkedIn: \u003ca href=\"http://www.linkedin.com/in/kofi-duodu-siriboe-a184021b2\" rel=\"nofollow\" target=\"_blank\"\u003ewww.linkedin.com/in/kofi-duodu-siriboe-a184021b2\u003c/a\u003e\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-06-19-CustomerSegmentationReportwithSQLandPowerBI"},"buildId":"QYe6gFAUryFKFgjKBoIfo","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>