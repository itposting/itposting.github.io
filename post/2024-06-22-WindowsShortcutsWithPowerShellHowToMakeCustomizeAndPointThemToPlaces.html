<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>PowerShell을 사용한 Windows 바로가기 만들기, 커스터마이징 및 위치 지정 방법 | itposting</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://itposting.github.io///post/2024-06-22-WindowsShortcutsWithPowerShellHowToMakeCustomizeAndPointThemToPlaces" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="PowerShell을 사용한 Windows 바로가기 만들기, 커스터마이징 및 위치 지정 방법 | itposting" data-gatsby-head="true"/><meta property="og:title" content="PowerShell을 사용한 Windows 바로가기 만들기, 커스터마이징 및 위치 지정 방법 | itposting" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-06-22-WindowsShortcutsWithPowerShellHowToMakeCustomizeAndPointThemToPlaces_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://itposting.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://itposting.github.io///post/2024-06-22-WindowsShortcutsWithPowerShellHowToMakeCustomizeAndPointThemToPlaces" data-gatsby-head="true"/><meta name="twitter:title" content="PowerShell을 사용한 Windows 바로가기 만들기, 커스터마이징 및 위치 지정 방법 | itposting" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-06-22-WindowsShortcutsWithPowerShellHowToMakeCustomizeAndPointThemToPlaces_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | itposting" data-gatsby-head="true"/><meta name="article:published_time" content="2024-06-22 16:35" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-23YXDLKDCL"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-23YXDLKDCL');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b8ef307c9aee1e34.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b8ef307c9aee1e34.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-ac4aa08aae62f90e.js" defer=""></script><script src="/_next/static/chunks/463-0429087d4c0b0335.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-d849684d6d83f07a.js" defer=""></script><script src="/_next/static/QYe6gFAUryFKFgjKBoIfo/_buildManifest.js" defer=""></script><script src="/_next/static/QYe6gFAUryFKFgjKBoIfo/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">IT Posting</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">PowerShell을 사용한 Windows 바로가기 만들기, 커스터마이징 및 위치 지정 방법</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="PowerShell을 사용한 Windows 바로가기 만들기, 커스터마이징 및 위치 지정 방법" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">IT Posting</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Jun 22, 2024</span><span class="posts_reading_time__f7YPP">11<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-06-22-WindowsShortcutsWithPowerShellHowToMakeCustomizeAndPointThemToPlaces&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<p>이제와서 당신이 손에 가장 흔한 작업인 것처럼 확신을 갖고 "응, 30분 만에 끝낼 거야!" 라고 생각할 때 상황이 발생할 것입니다. 그리고 2시간 후에 일부 희미한 문서를 찾아보며, 코드 예제를 보면서 "이게 정말 이런 건가?" 라고 생생히 느낄 수도 있죠.</p>
<p>얼마 전, Windows 11의 제어판 소리 설정의 "녹음" 패널에 데스크톱 바로 가기를 생성하고 배포해야 하는 상황이 발생했습니다. PowerShell에는 바로 가기를 생성하는 "기본" 방법이 없다는 것을 이미 알고 있어서 몇 가지 쉘 방법을 탐색할 예정이었습니다. 그런데 만약에 해당 바로 가기를 제어판 항목의 하위 메뉴로 가리키고 싶거나, 이미 컴퓨터에 존재하지만 동적 라이브러리 안에 저장된 사용자 정의 아이콘을 사용하고 싶다면 어떨까요?</p>
<p>좋아요, 친애하는 독자 여러분, 해결 방법은 있습니다. 때로는 운영 체제의 내부를 살펴 경로를 찾아야 할 때도 있습니다. Windows 바로 가기를 생성하고 사용자 정의하는 방법에 대해 자세히 알아봅시다.</p>
<div class="content-ad"></div>
<h1>단축키, 심볼릭 링크 및 PowerShell</h1>
<p>우선 중요한 것은 PowerShell에 내장된 New-Item cmdlet을 사용하여 심볼릭 링크를 만들 수 있는 방법이 있다는 것입니다.</p>
<pre><code class="hljs language-js"><span class="hljs-title class_">New</span>-<span class="hljs-title class_">Item</span> -<span class="hljs-title class_">ItemType</span> <span class="hljs-title class_">SymbolicLink</span> -<span class="hljs-title class_">Path</span> <span class="hljs-string">"C:\example-link.lnk"</span> -<span class="hljs-title class_">Target</span> <span class="hljs-string">"C:\Users\dbilanoski\Documents\some-text.txt"</span>
</code></pre>
<p>다른 곳에서 이와 같은 단축키를 생성하는 방법을 제안하는 지침을 만날 수 있습니다. 그러나 주의해야 할 점은 이러한 것들이 정확히 동일한 것이 아니라는 것입니다.</p>
<div class="content-ad"></div>
<p>Symbolic links(심볼릭 링크)는 파일 시스템 자체에서 해석된 다른 파일로의 직접적인 링크입니다. 일반 파일과 다르며 크기가 없으며 응용 프로그램이 이를 내재적으로 인식합니다. 사용할 때 실제로 링크된 대상을 직접 사용하는 것처럼 사용됩니다.</p>
<p>한편 바로 가기(Shortcuts)는 Windows 사용자 인터페이스에서 해석된 참조된 객체의 경로를 포함하는 일반 파일입니다. 크기가 있으며 아이콘으로 구성될 수 있으며 사용할 때 이를 읽고 있는 무언가와 대상 경로를 갖고 있어야 합니다(Windows 사용자 인터페이스).</p>
<p>Windows에서 바로 가기가 필요할 때는 바로 가기를 원할 것입니다. 왜냐하면?</p>
<ul>
<li>바로 가기는 참조하는 파일을 추적하여 변경 사항이 발생할 때 업데이트되어 깨질 가능성이 줄어듭니다.</li>
<li>파일과 폴더 외에도 네트워크 위치, 구성 패널, 파일 시스템에 있는 파일 경로로 존재하지 않는 특수 폴더를 엽니다.</li>
<li>특정 폴더의 컨텍스트에서 시작되도록 구성된 바로 가기를 사용할 수 있습니다.</li>
<li>심볼릭 링크를 사용하면 대상 경로에 실행 파일에 대한 명령줄 인수를 포함할 수 없습니다.</li>
<li>아이콘을 심볼릭 링크에 구성할 수 없습니다.</li>
</ul>
<div class="content-ad"></div>
<p>단축키를 친숙하고 편리하게 만드는 이유는 Windows 사용자 인터페이스(셸)에서 처리하기 때문입니다. Windows 사용자 인터페이스는 추가 기능과 편의성을 제공합니다. 그러나 PowerShell에서 이를 만들기 위해서는 셸 메소드에 접근해야 하며, 이로 인해 프로세스가 조금 더 복잡해지게 됩니다.</p>
<h1>서둘러야 할 때를 위해</h1>
<p>PowerShell을 사용하여 단축키를 만들고 고유 아이콘을 사용자 정의하려면 아래의 기본 예시를 참고하세요. 특정 상황에 맞게 경로와 파일 이름을 수정해야 합니다.</p>
<pre><code class="hljs language-js">$ShortcutTarget= <span class="hljs-string">"타겟-경로\타겟-이름"</span>
$ShortcutFile = <span class="hljs-string">"단축키-경로\단축키-이름.lnk"</span>
$WScriptShell = <span class="hljs-title class_">New</span>-<span class="hljs-title class_">Object</span> -<span class="hljs-title class_">ComObject</span> <span class="hljs-title class_">WScript</span>.<span class="hljs-property">Shell</span>
$Shortcut = $WScriptShell.<span class="hljs-title class_">CreateShortcut</span>($ShortcutFile)
$Shortcut.<span class="hljs-property">TargetPath</span> = $ShortcutTarget
$Shortcut.<span class="hljs-property">IconLocation</span> = <span class="hljs-string">"아이콘-경로\아이콘-이름.ico"</span>
$Shortcut.<span class="hljs-title class_">Save</span>()
</code></pre>
<div class="content-ad"></div>
<p>한 줄로 된 스크립트가 필요하시면:</p>
<pre><code class="hljs language-js"># <span class="hljs-title class_">PowerShell</span> 스크립트용
$ws = <span class="hljs-title class_">New</span>-<span class="hljs-title class_">Object</span> -<span class="hljs-title class_">ComObject</span> <span class="hljs-title class_">WScript</span>.<span class="hljs-property">Shell</span>; $s = $ws.<span class="hljs-title class_">CreateShortcut</span>(<span class="hljs-string">'실행할-바로가기-파일-경로\바로가기-파일명.lnk'</span>); $s.<span class="hljs-property">TargetPath</span> = <span class="hljs-string">'대상-파일-경로\대상-파일명'</span>; $s.<span class="hljs-property">IconLocation</span> = <span class="hljs-string">'아이콘-파일-경로\아이콘-파일명.ico'</span>; $s.<span class="hljs-title class_">Save</span>()

# 배치 (<span class="hljs-variable constant_">CMD</span>) 스크립트용
powershell -<span class="hljs-title class_">ExecutionPolicy</span> <span class="hljs-title class_">Bypass</span> -<span class="hljs-title class_">Command</span> <span class="hljs-string">"$ws = New-Object -ComObject WScript.Shell; $s = $ws.CreateShortcut('실행할-바로가기-파일-경로\바로가기-파일명.lnk'); $s.TargetPath = '대상-파일-경로\대상-파일명'; $s.IconLocation = '아이콘-파일-경로\아이콘-파일명.ico'; $s.Save()"</span>
</code></pre>
<h2>구체적인 예시</h2>
<p>서로 다른 바로가기 대상 유형에 대한 적합한 TargetPath 및 필요시 Arguments 구성.</p>
<div class="content-ad"></div>
<pre><code class="hljs language-js"># 파일 지정하기
$Shortcut.<span class="hljs-property">TargetPath</span> = <span class="hljs-string">"C:\Windows\System32\notepad.exe"</span>

# 폴더 지정하기
$Shortcut.<span class="hljs-property">TargetPath</span> = <span class="hljs-string">"C:\Users\Public\Documents"</span>

# 네트워크 공유 지정하기
$Shortcut.<span class="hljs-property">TargetPath</span> = <span class="hljs-string">"C:\Windows\explorer.exe"</span>
$Shortcut.<span class="hljs-property">Arguments</span> = <span class="hljs-string">"\\192.168.10.2\shares"</span>

# 환경 변수를 사용하여 지정하기
$Shortcut.<span class="hljs-property">TargetPath</span> = <span class="hljs-attr">$env</span>:userprofile + <span class="hljs-string">"\Downloads"</span>

# .<span class="hljs-property">cpl</span> 파일을 지정하기
$Shortcut.<span class="hljs-property">TargetPath</span> = <span class="hljs-string">"C:\Windows\System32\mmsys.cpl"</span>

# <span class="hljs-attr">MS</span>:<span class="hljs-variable constant_">SETTINGS</span> <span class="hljs-variable constant_">URI</span> 스킴을 사용하여 지정하기
$Shortcut.<span class="hljs-property">TargetPath</span> = <span class="hljs-string">"ms-settings:installed-apps"</span>

# 이름으로 shell 명령어를 사용하여 지정하기
$Shortcut.<span class="hljs-property">TargetPath</span> = <span class="hljs-string">"C:\Windows\explorer.exe"</span>
$Shortcut.<span class="hljs-property">Arguments</span> = <span class="hljs-string">"shell:NetworkPlacesFolder"</span>

# <span class="hljs-variable constant_">CLSID</span> <span class="hljs-variable constant_">GUID</span>로 shell 명령어를 사용하여 지정하기
$Shortcut.<span class="hljs-property">TargetPath</span> = <span class="hljs-string">"C:\Windows\explorer.exe"</span>
$Shortcut.<span class="hljs-property">Arguments</span> = <span class="hljs-string">"shell:::{BB06C0E4-D293-4f75-8A90-CB05B6477EEE}"</span>

# rundll32를 사용하여 dll 탐색으로 지정하기
$Shortcut.<span class="hljs-property">TargetPath</span> = <span class="hljs-string">"C:\Windows\System32\rundll32.exe"</span>
$Shortcut.<span class="hljs-property">Arguments</span> = <span class="hljs-string">"shell32.dll,Control_RunDLL inetcpl.cpl,,4"</span>
</code></pre>
<h1>세부 정보</h1>
<h2>Powershell로 바로 가기 생성</h2>
<p>PowerShell을 사용하여 바로 가기를 생성하려면, WScript.Shell 클래스의 인스턴스를 포함할 컨테이너로 작동할 COM 객체를 생성해야 합니다. 이는 아마도 초기에 Visual Basic 스크립트를 위해 고안된 꽤 오래된 COM 인터페이스의 일부인 WScript.Shell 클래스의 인스턴스를 담을 객체를 만들 것입니다. 즉, 코드로 바로 가기를 처리하기 위해 필요한 모든 좋은 기능이 구비된 객체를 만들 것입니다. 이는 변수와 속성을 다루는 작업을 포함하므로, 이를 단계적으로 나누어 설명하겠습니다.</p>
<div class="content-ad"></div>
<p>컴퓨터의 각 사용자에 대해 notepad.exe(Windows에서 널리 사용되는 텍스트 편집 도구)에 대한 데스크탑 바로 가기를 만들고자 합니다.</p>
<ol>
<li>먼저 대상 객체와 해당 바로 가기의 경로를 저장할 변수를 만듭니다.</li>
</ol>
<pre><code class="hljs language-js"># 내 바로 가기가 가리키는 위치
$ShortcutTarget = <span class="hljs-string">"C:\Windows\System32\notepad.exe"</span>
# 내 바로 가기가 저장될 곳 및 이름 설정
$ShortcutFile = <span class="hljs-string">"C:\Users\Public\Desktop\notepad.lnk"</span>
</code></pre>
<ol start="2">
<li>New-Object cmdlet을 사용하여 COM 개체로 WScript.Shell 클래스의 인스턴스를 생성합니다.</li>
</ol>
<div class="content-ad"></div>
<pre><code class="hljs language-js">$WScriptShell = <span class="hljs-title class_">New</span>-<span class="hljs-title class_">Object</span> -<span class="hljs-title class_">ComObject</span> <span class="hljs-title class_">WScript</span>.<span class="hljs-property">Shell</span>
</code></pre>
<ol start="3">
<li>WScript.Shell 인스턴스에서 CreateShortcut() 메서드를 사용하여 바로 가기를 만듭니다.</li>
</ol>
<pre><code class="hljs language-js">$shortcut = $WScriptShell.<span class="hljs-title class_">CreateShortcut</span>($ShortcutFile)
</code></pre>
<p>자, 이제 잠시 멈추고 바로 가기 객체의 속성과 메서드를 살펴보면서 우리가 할 수 있는 작업을 살펴보겠습니다.</p>
<div class="content-ad"></div>
<p><img src="/assets/img/2024-06-22-WindowsShortcutsWithPowerShellHowToMakeCustomizeAndPointThemToPlaces_1.png" alt="Shortcut Image"></p>
<p>우리는 단축키를 생성하기 위해 TargetPath 속성에 Notepad.exe를 지정하고 Save() 메서드를 사용해야 합니다.</p>
<p>우리의 단축키에 아이콘을 할당하려면 IconLocation 속성이 관련됩니다. TargetPath에 참조된 실행 파일에 명령줄 인수를 전달하려면 Arguments 속성이 관련됩니다.</p>
<p>WorkingDirectory는 상대 경로 사용시 때로 필요하지만, 단축키를 다룰 때 상대 경로는 피하는 것이 좋습니다.</p>
<div class="content-ad"></div>
<ol start="4">
<li>기본 사항으로 계속해서, 앞서 설정한 변수를 사용하여 Target.Path 속성을 위치와 대상의 이름에 할당하십시오.</li>
</ol>
<pre><code class="hljs language-js">$Shortcut.<span class="hljs-property">TargetPath</span> = $ShortcutTarget
</code></pre>
<ol start="5">
<li>ShortcutFile 변수에 지정된 경로에 바로 가기를 저장하기 위해 Save() 메서드를 호출하여 프로세스를 완료하세요.</li>
</ol>
<pre><code class="hljs language-js">$Shortcut.<span class="hljs-title class_">Save</span>()
</code></pre>
<div class="content-ad"></div>
<p>당신의 바로 가기는 $ShortcutFile 변수에 정의된 위치에 준비될 것입니다.</p>
<h2>장소들을 가리키는 바로 가기</h2>
<p>파워쉘을 사용하여 프로그래밍적으로 바로 가기를 만드는 방법을 알게 되었으니, 파일 이외의 것을 가리킬 때는 어떻게 보이는지 살펴보겠습니다. 불행하게도 항상 명확하지는 않습니다.</p>
<p>한두 개의 속성만 변경할 때는 주석이 있는 코드 블록에서 실제 예제를 사용할 것입니다. — TargetPath와 Arguments가 필요할 때 변경합니다.</p>
<div class="content-ad"></div>
<p>폴더로의 바로 가기</p>
<pre><code class="hljs language-js">$Shortcut.<span class="hljs-property">TargetPath</span> = <span class="hljs-string">"C:\Users\Public\Documents"</span>
</code></pre>
<p>네트워크 공유로의 바로 가기</p>
<p>여기서는 Arguments 속성을 사용하여 TargetPath 속성에서 구성된 explorer.exe로 UNC 형식의 경로를 전달하고 있습니다.</p>
<div class="content-ad"></div>
<p>주로 단축키 생성 프로시저에서 문제를 피하기 위한 것이며, 그렇지 않으면 명령이 실행된 문맥 내에서 경로에 액세스할 수 없는 경우 프로세스가 실패할 수 있습니다.</p>
<pre><code class="hljs language-js">$Shortcut.<span class="hljs-property">TargetPath</span> = <span class="hljs-string">"C:\Windows\explorer.exe"</span>
$Shortcut.<span class="hljs-property">Arguments</span> = <span class="hljs-string">"\\192.168.10.2\shares"</span>
</code></pre>
<p>환경 변수와 함께 사용되는 단축키 대상 경로</p>
<pre><code class="hljs language-js"># 표준 연결 방식인 + 기호를 사용하여
$Shortcut.<span class="hljs-property">TargetPath</span> = <span class="hljs-attr">$env</span>:userprofile + <span class="hljs-string">"\Downloads"</span>

# <span class="hljs-title class_">Join</span>-<span class="hljs-title class_">Path</span> cmdlet을 사용하여
$Shortcut.<span class="hljs-property">TargetPath</span> = <span class="hljs-title class_">Join</span>-<span class="hljs-title class_">Path</span> -<span class="hljs-title class_">Path</span> <span class="hljs-attr">$env</span>:userprofile -<span class="hljs-title class_">ChildPath</span> <span class="hljs-string">"Downloads"</span>
</code></pre>
<div class="content-ad"></div>
<p>컨트롤 패널 파일로의 바로 가기</p>
<p>이 파일들은 C:\Windows\System32 폴더에 있으며, 컨트롤 패널 항목에 접근하기가 편리합니다. 그러나 대부분 다른 방법으로 그 곳에 도달하려고 할 것입니다.</p>
<pre><code class="hljs language-js">$Shortcut.<span class="hljs-property">TargetPath</span> = <span class="hljs-string">"C:\Windows\System32\mmsys.cpl"</span>
</code></pre>
<p>Windows 설정 앱을 통한 패널로의 바로 가기</p>
<div class="content-ad"></div>
<p>Windows 설정 응용 프로그램의 특정 페이지를 지정하는 방법을 제공합니다. ms-settings:<code>페이지 이름</code> 형식을 따라 이동할 수 있습니다.</p>
<pre><code class="hljs language-js">$Shortcut.<span class="hljs-property">TargetPath</span> = <span class="hljs-string">"ms-settings:installed-apps"</span>
</code></pre>
<p>셸 명령을 통한 위치 바로 가기</p>
<p>Windows의 많은 위치는 파일과 유사한 절대 경로 접근이 없어서, 특정 패널이나 폴더에 프로그래밍적으로 어떻게 도달할지가 명확하지 않을 수 있습니다. 이러한 위치를 셸 폴더 또는 가상 폴더라고 하며 알려진 이름을 사용하거나 CLSID 고유 식별자 키 (GUID)를 사용하여 접근할 수 있습니다. CLSID는 레지스트리에서 직접 항목을 열 수 있도록 사용할 수 있는 특별한 키입니다.</p>
<div class="content-ad"></div>
<p>그들에 대해 더 자세히 알고 싶거나 사용 가능한 Windows 11 바로 가기의 완전한 목록을 보고 싶다면, 여기에서 더 깊게 다루었어요.</p>
<pre><code class="hljs language-js"># 이름으로 셸 명령어를 사용하여
$Shortcut.<span class="hljs-property">TargetPath</span> = <span class="hljs-string">"C:\Windows\explorer.exe"</span>
$Shortcut.<span class="hljs-property">Arguments</span> = <span class="hljs-string">"shell:NetworkPlacesFolder"</span>

# <span class="hljs-variable constant_">CLSID</span> <span class="hljs-variable constant_">GUID</span>로 셸 명령어를 사용하여
$Shortcut.<span class="hljs-property">TargetPath</span> = <span class="hljs-string">"C:\Windows\explorer.exe"</span>
$Shortcut.<span class="hljs-property">Arguments</span> = <span class="hljs-string">"shell:::{BB06C0E4-D293-4f75-8A90-CB05B6477EEE}"</span>
</code></pre>
<h2>아이콘으로 바로 가기 맞춤 설정</h2>
<p>만약 당신의 바로 가기가 이미 아이콘이 있는 항목을 가리키고 있다면, 해당 아이콘의 경로는 IconLocation 속성에 저장됩니다.</p>
<div class="content-ad"></div>
<p>PowerShell을 사용하여 단축키에 사용자 정의 아이콘을 할당하려면, 단축키를 만들 때 추가 단계로 IconLocation 속성을 구성하여 기존 아이콘에 도달 가능한 경로를 설정한 후 단축키를 저장하면 됩니다.</p>
<pre><code class="hljs language-js">$Shortcut.<span class="hljs-property">IconLocation</span> = <span class="hljs-string">"\\path-to-your-icon.ico"</span>
</code></pre>
<p>이제 사용자 정의 아이콘으로 구성된 단축키를 가지고 있으므로, 스크립트가 다른 곳에 배포되어야 할 경우 아이콘의 가용성을 확인해야 할 것입니다. 항상 컴퓨터에 이미 있는 요소를 활용하는 것이 좋은 접근 방식일 것입니다.</p>
<p>Windows OS에는 일반 UI 아이콘이 저장되고 사용되는 곳이 있습니다. 일반적으로 이러한 아이콘은 여러 프로그램에서 동시에 공유되는 데이터를 포함하는 동적 링크 라이브러리(DLL)에 패킹되어 있습니다.</p>
<div class="content-ad"></div>
<p>시스템 주변에는 많은 것들이 있지만, OS에서 가장 일반적으로 사용되는 DLL에는 다음과 같은 아이콘이 포함되어 있습니다:</p>
<ul>
<li>C:\Windows\system32\imageres.dll</li>
<li>C:\Windows\system32\shell32.dll</li>
<li>C:\Windows\system32\ddores.dll</li>
</ul>
<p>이러한 아이콘들은 표준 파일이 아니며, 적절한 인덱스 번호를 사용하여 DLL 파일 내에서 참조해야 합니다. 이러한 아이콘들은 쉽게 볼 수 없다는 것이 함정입니다. 따라서 텍스트의 시작 부분에 있는 2시간의 줄서기가 필요합니다.</p>
<p>서드 파티 소프트웨어를 사용하지 않고 시간을 낭비하지 않고 DLL의 중첩된 아이콘 인덱스 번호를 확인하려면, 기존 바로 가기의 "속성" 패널을 사용하여 DLL 파일을 검색하십시오. 그곳에서 원하는 아이콘을 선택하고 변경 내용을 저장한 다음 해당 인덱스 번호를 코드에서 사용할 수 있도록 PowerShell의 WScriptShell의 COM 인스턴스에 바로 가기를 추가하십시오. IconLocation 속성을 검사하여 코드에서 사용할 수 있는 인덱스 번호를 식별할 수 있습니다.</p>
<div class="content-ad"></div>
<p>DLL 아이콘 참조하기</p>
<p>에제로 살펴보겠습니다. 제 노트패드 바로 가기를 특정 라이브러리 중 하나로부터 가져온 독특한 아이콘과 함께 배포하고 싶다고 가정해 보겠습니다. 예를 들어, imageres.dll 라이브러리의 키보드 아이콘을 사용하고 싶다면 어떨까요?</p>
<p>제 데스크탑에 있는 크롬 바로 가기의 현재 IconLocation을 살펴보면 chrome.exe(녹색 선) 패키지 내부의 아이콘(녹색 선)이 사용되고 있으며, 해당 아이콘의 인덱스 번호는 0(분홍색 선)입니다. 이 인덱스는 경로의 일부로 표시되며, 파일 경로와 인덱스 번호는 쉼표로 구분됩니다.</p>
<p><img src="/assets/img/2024-06-22-WindowsShortcutsWithPowerShellHowToMakeCustomizeAndPointThemToPlaces_2.png" alt="이미지"></p>
<div class="content-ad"></div>
<p>또한 chrome.exe 패키지 내부에는 사용할 수 있는 다른 아이콘들이 있다는 것을 알 수 있습니다.</p>
<p>우리는 동일한 Chrome 바로 가기를 사용하여 imageres.dll 라이브러리를 살펴보고 원하는 바로 가기를 선택하고 해당 인덱스 번호를 확인할 수 있습니다.</p>
<ol>
<li>속성 페이지에 액세스하여 "아이콘 변경" 버튼을 클릭하고 "C:\Windows\system32\imageres.dll"로 이동한 후 "Enter"를 눌러 사용 가능한 아이콘을 확인할 수 있습니다.</li>
</ol>
<p>여기에서 사용하고자 하는 키보드 아이콘을 선택했습니다.</p>
<div class="content-ad"></div>
<p>Markdown 형식으로 테이블 태그를 변경해주세요.</p>
<div class="content-ad"></div>
<pre><code class="hljs language-js">$Shortcut.<span class="hljs-property">IconLocation</span> = <span class="hljs-string">"C:\Windows\system32\imageres.dll,173"</span>
</code></pre>
<h2>원라이너</h2>
<p>간단하게 사용하기 위해 이를 한 줄로 표현하려면, "첫 번째 명령; 두 번째 명령; 세 번째 명령"과 같이 세미콜론을 사용하여 명령을 연결할 수 있습니다. 여기서는 경로 변수를 사용하지 않고 직접 속성과 메소드에 넣어줍니다.</p>
<pre><code class="hljs language-js">$ws = <span class="hljs-title class_">New</span>-<span class="hljs-title class_">Object</span> -<span class="hljs-title class_">ComObject</span> <span class="hljs-title class_">WScript</span>.<span class="hljs-property">Shell</span>; $s = $ws.<span class="hljs-title class_">CreateShortcut</span>(<span class="hljs-string">"C:\Users\Public\Desktop\notepad.lnk"</span>); $s.<span class="hljs-property">TargetPath</span> = <span class="hljs-string">"C:\Windows\System32\notepad.exe"</span>; $s.<span class="hljs-property">IconLocation</span> = <span class="hljs-string">"C:\Windows\system32\imageres.dll,173"</span>; $s.<span class="hljs-title class_">Save</span>()
</code></pre>
<div class="content-ad"></div>
<p>cmd를 통해 작업하는 우리에게:</p>
<pre><code class="hljs language-js">powershell -<span class="hljs-title class_">ExecutionPolicy</span> bypass -<span class="hljs-title class_">Command</span> <span class="hljs-string">"$ws = New-Object -ComObject WScript.Shell; $s = $ws.CreateShortcut('C:\Users\Public\Desktop\notepad.lnk'); $s.TargetPath = 'C:\Windows\System32\notepad.exe'; $s.IconLocation = 'C:\Windows\system32\imageres.dll,173'; $s.Save()"</span>
</code></pre>
<h1>결론</h1>
<p>PowerShell을 사용하여 바로 가기를 만드는 것은 COM 객체를 사용하여 WScript.Shell 클래스를 인스턴스화하여 바로 가기 생성 기능에 액세스하는 복잡성을 도입하지만, 프로퍼티 값을 구성하는 루틴 작업으로 단순화됩니다. 배포 전 철저한 테스트, 절대 경로 정확성에 대한 주의 및 아이콘이나 특정 경로와 같은 기존 시스템 요소를 재사용하는 마인드는 중요한 고려 사항입니다.</p>
<div class="content-ad"></div>
<p>당신이 시간을 쏟을 수 있는 곳은 운영 체제의 복잡성에 깊이 파고들어 특정 패널이나 가상 폴더를 대상으로 하는 방법을 알아내는 것입니다. 그러나 대부분의 경우에는 결과적으로 필요한 배포 가능한 한 줄의 코드로 축약될 수 있습니다.</p>
<h1>작성자의 노트</h1>
<p>여기까지 오셨네요! 잘 하셨어요 친구들 — 제가 꽤 괜찮은 작가라서 그런지, 아니면 당신이 훌륭한 독자라서 그런 건지요. 우리는 후자를 택하도록 합시다😅.</p>
<p>나는 기업의 혼돈을 탐내는 경험 많은 IT 서비스 전달 엔지니어 다닐로입니다. 저는 스크립팅, 시스템 관리자 관련 내용, 그리고 다른 곳에서 제대로 문서화되지 않은 주제들에 대해 글을 씁니다. 지식을 공유하고 글쓰기 기술을 향상시키기 위한 목적을 가지고요.</p>
<div class="content-ad"></div>
<p>만졌더니 반복의 경우 피드백을 주세요!</p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"PowerShell을 사용한 Windows 바로가기 만들기, 커스터마이징 및 위치 지정 방법","description":"","date":"2024-06-22 16:35","slug":"2024-06-22-WindowsShortcutsWithPowerShellHowToMakeCustomizeAndPointThemToPlaces","content":"\n\n이제와서 당신이 손에 가장 흔한 작업인 것처럼 확신을 갖고 \"응, 30분 만에 끝낼 거야!\" 라고 생각할 때 상황이 발생할 것입니다. 그리고 2시간 후에 일부 희미한 문서를 찾아보며, 코드 예제를 보면서 \"이게 정말 이런 건가?\" 라고 생생히 느낄 수도 있죠.\n\n얼마 전, Windows 11의 제어판 소리 설정의 \"녹음\" 패널에 데스크톱 바로 가기를 생성하고 배포해야 하는 상황이 발생했습니다. PowerShell에는 바로 가기를 생성하는 \"기본\" 방법이 없다는 것을 이미 알고 있어서 몇 가지 쉘 방법을 탐색할 예정이었습니다. 그런데 만약에 해당 바로 가기를 제어판 항목의 하위 메뉴로 가리키고 싶거나, 이미 컴퓨터에 존재하지만 동적 라이브러리 안에 저장된 사용자 정의 아이콘을 사용하고 싶다면 어떨까요?\n\n좋아요, 친애하는 독자 여러분, 해결 방법은 있습니다. 때로는 운영 체제의 내부를 살펴 경로를 찾아야 할 때도 있습니다. Windows 바로 가기를 생성하고 사용자 정의하는 방법에 대해 자세히 알아봅시다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# 단축키, 심볼릭 링크 및 PowerShell\n\n우선 중요한 것은 PowerShell에 내장된 New-Item cmdlet을 사용하여 심볼릭 링크를 만들 수 있는 방법이 있다는 것입니다.\n\n```js\nNew-Item -ItemType SymbolicLink -Path \"C:\\example-link.lnk\" -Target \"C:\\Users\\dbilanoski\\Documents\\some-text.txt\"\n```\n\n다른 곳에서 이와 같은 단축키를 생성하는 방법을 제안하는 지침을 만날 수 있습니다. 그러나 주의해야 할 점은 이러한 것들이 정확히 동일한 것이 아니라는 것입니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nSymbolic links(심볼릭 링크)는 파일 시스템 자체에서 해석된 다른 파일로의 직접적인 링크입니다. 일반 파일과 다르며 크기가 없으며 응용 프로그램이 이를 내재적으로 인식합니다. 사용할 때 실제로 링크된 대상을 직접 사용하는 것처럼 사용됩니다.\n\n한편 바로 가기(Shortcuts)는 Windows 사용자 인터페이스에서 해석된 참조된 객체의 경로를 포함하는 일반 파일입니다. 크기가 있으며 아이콘으로 구성될 수 있으며 사용할 때 이를 읽고 있는 무언가와 대상 경로를 갖고 있어야 합니다(Windows 사용자 인터페이스).\n\nWindows에서 바로 가기가 필요할 때는 바로 가기를 원할 것입니다. 왜냐하면?\n\n- 바로 가기는 참조하는 파일을 추적하여 변경 사항이 발생할 때 업데이트되어 깨질 가능성이 줄어듭니다.\n- 파일과 폴더 외에도 네트워크 위치, 구성 패널, 파일 시스템에 있는 파일 경로로 존재하지 않는 특수 폴더를 엽니다.\n- 특정 폴더의 컨텍스트에서 시작되도록 구성된 바로 가기를 사용할 수 있습니다.\n- 심볼릭 링크를 사용하면 대상 경로에 실행 파일에 대한 명령줄 인수를 포함할 수 없습니다.\n- 아이콘을 심볼릭 링크에 구성할 수 없습니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n단축키를 친숙하고 편리하게 만드는 이유는 Windows 사용자 인터페이스(셸)에서 처리하기 때문입니다. Windows 사용자 인터페이스는 추가 기능과 편의성을 제공합니다. 그러나 PowerShell에서 이를 만들기 위해서는 셸 메소드에 접근해야 하며, 이로 인해 프로세스가 조금 더 복잡해지게 됩니다.\n\n# 서둘러야 할 때를 위해\n\nPowerShell을 사용하여 단축키를 만들고 고유 아이콘을 사용자 정의하려면 아래의 기본 예시를 참고하세요. 특정 상황에 맞게 경로와 파일 이름을 수정해야 합니다.\n\n```js\n$ShortcutTarget= \"타겟-경로\\타겟-이름\"\n$ShortcutFile = \"단축키-경로\\단축키-이름.lnk\"\n$WScriptShell = New-Object -ComObject WScript.Shell\n$Shortcut = $WScriptShell.CreateShortcut($ShortcutFile)\n$Shortcut.TargetPath = $ShortcutTarget\n$Shortcut.IconLocation = \"아이콘-경로\\아이콘-이름.ico\"\n$Shortcut.Save()\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n한 줄로 된 스크립트가 필요하시면:\n\n```js\n# PowerShell 스크립트용\n$ws = New-Object -ComObject WScript.Shell; $s = $ws.CreateShortcut('실행할-바로가기-파일-경로\\바로가기-파일명.lnk'); $s.TargetPath = '대상-파일-경로\\대상-파일명'; $s.IconLocation = '아이콘-파일-경로\\아이콘-파일명.ico'; $s.Save()\n\n# 배치 (CMD) 스크립트용\npowershell -ExecutionPolicy Bypass -Command \"$ws = New-Object -ComObject WScript.Shell; $s = $ws.CreateShortcut('실행할-바로가기-파일-경로\\바로가기-파일명.lnk'); $s.TargetPath = '대상-파일-경로\\대상-파일명'; $s.IconLocation = '아이콘-파일-경로\\아이콘-파일명.ico'; $s.Save()\"\n```\n\n## 구체적인 예시\n\n서로 다른 바로가기 대상 유형에 대한 적합한 TargetPath 및 필요시 Arguments 구성.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\n# 파일 지정하기\n$Shortcut.TargetPath = \"C:\\Windows\\System32\\notepad.exe\"\n\n# 폴더 지정하기\n$Shortcut.TargetPath = \"C:\\Users\\Public\\Documents\"\n\n# 네트워크 공유 지정하기\n$Shortcut.TargetPath = \"C:\\Windows\\explorer.exe\"\n$Shortcut.Arguments = \"\\\\192.168.10.2\\shares\"\n\n# 환경 변수를 사용하여 지정하기\n$Shortcut.TargetPath = $env:userprofile + \"\\Downloads\"\n\n# .cpl 파일을 지정하기\n$Shortcut.TargetPath = \"C:\\Windows\\System32\\mmsys.cpl\"\n\n# MS:SETTINGS URI 스킴을 사용하여 지정하기\n$Shortcut.TargetPath = \"ms-settings:installed-apps\"\n\n# 이름으로 shell 명령어를 사용하여 지정하기\n$Shortcut.TargetPath = \"C:\\Windows\\explorer.exe\"\n$Shortcut.Arguments = \"shell:NetworkPlacesFolder\"\n\n# CLSID GUID로 shell 명령어를 사용하여 지정하기\n$Shortcut.TargetPath = \"C:\\Windows\\explorer.exe\"\n$Shortcut.Arguments = \"shell:::{BB06C0E4-D293-4f75-8A90-CB05B6477EEE}\"\n\n# rundll32를 사용하여 dll 탐색으로 지정하기\n$Shortcut.TargetPath = \"C:\\Windows\\System32\\rundll32.exe\"\n$Shortcut.Arguments = \"shell32.dll,Control_RunDLL inetcpl.cpl,,4\"\r\n```\n\n# 세부 정보\n\n## Powershell로 바로 가기 생성\n\nPowerShell을 사용하여 바로 가기를 생성하려면, WScript.Shell 클래스의 인스턴스를 포함할 컨테이너로 작동할 COM 객체를 생성해야 합니다. 이는 아마도 초기에 Visual Basic 스크립트를 위해 고안된 꽤 오래된 COM 인터페이스의 일부인 WScript.Shell 클래스의 인스턴스를 담을 객체를 만들 것입니다. 즉, 코드로 바로 가기를 처리하기 위해 필요한 모든 좋은 기능이 구비된 객체를 만들 것입니다. 이는 변수와 속성을 다루는 작업을 포함하므로, 이를 단계적으로 나누어 설명하겠습니다.\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n컴퓨터의 각 사용자에 대해 notepad.exe(Windows에서 널리 사용되는 텍스트 편집 도구)에 대한 데스크탑 바로 가기를 만들고자 합니다.\n\n1. 먼저 대상 객체와 해당 바로 가기의 경로를 저장할 변수를 만듭니다.\n\n```js\n# 내 바로 가기가 가리키는 위치\n$ShortcutTarget = \"C:\\Windows\\System32\\notepad.exe\"\n# 내 바로 가기가 저장될 곳 및 이름 설정\n$ShortcutFile = \"C:\\Users\\Public\\Desktop\\notepad.lnk\"\n```\n\n2. New-Object cmdlet을 사용하여 COM 개체로 WScript.Shell 클래스의 인스턴스를 생성합니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\n```js\n$WScriptShell = New-Object -ComObject WScript.Shell\n```\n\n3. WScript.Shell 인스턴스에서 CreateShortcut() 메서드를 사용하여 바로 가기를 만듭니다.\n\n```js\n$shortcut = $WScriptShell.CreateShortcut($ShortcutFile)\n```\n\n자, 이제 잠시 멈추고 바로 가기 객체의 속성과 메서드를 살펴보면서 우리가 할 수 있는 작업을 살펴보겠습니다.\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n\n![Shortcut Image](/assets/img/2024-06-22-WindowsShortcutsWithPowerShellHowToMakeCustomizeAndPointThemToPlaces_1.png)\n\n우리는 단축키를 생성하기 위해 TargetPath 속성에 Notepad.exe를 지정하고 Save() 메서드를 사용해야 합니다.\n\n우리의 단축키에 아이콘을 할당하려면 IconLocation 속성이 관련됩니다. TargetPath에 참조된 실행 파일에 명령줄 인수를 전달하려면 Arguments 속성이 관련됩니다.\n\nWorkingDirectory는 상대 경로 사용시 때로 필요하지만, 단축키를 다룰 때 상대 경로는 피하는 것이 좋습니다.\n\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n4. 기본 사항으로 계속해서, 앞서 설정한 변수를 사용하여 Target.Path 속성을 위치와 대상의 이름에 할당하십시오.\n\n```js\n$Shortcut.TargetPath = $ShortcutTarget\n```\n\n5. ShortcutFile 변수에 지정된 경로에 바로 가기를 저장하기 위해 Save() 메서드를 호출하여 프로세스를 완료하세요.\n\n```js\n$Shortcut.Save()\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n당신의 바로 가기는 $ShortcutFile 변수에 정의된 위치에 준비될 것입니다.\n\n## 장소들을 가리키는 바로 가기\n\n파워쉘을 사용하여 프로그래밍적으로 바로 가기를 만드는 방법을 알게 되었으니, 파일 이외의 것을 가리킬 때는 어떻게 보이는지 살펴보겠습니다. 불행하게도 항상 명확하지는 않습니다.\n\n한두 개의 속성만 변경할 때는 주석이 있는 코드 블록에서 실제 예제를 사용할 것입니다. — TargetPath와 Arguments가 필요할 때 변경합니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n폴더로의 바로 가기\n\n```js\n$Shortcut.TargetPath = \"C:\\Users\\Public\\Documents\"\n```\n\n네트워크 공유로의 바로 가기\n\n여기서는 Arguments 속성을 사용하여 TargetPath 속성에서 구성된 explorer.exe로 UNC 형식의 경로를 전달하고 있습니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n주로 단축키 생성 프로시저에서 문제를 피하기 위한 것이며, 그렇지 않으면 명령이 실행된 문맥 내에서 경로에 액세스할 수 없는 경우 프로세스가 실패할 수 있습니다.\n\n```js\n$Shortcut.TargetPath = \"C:\\Windows\\explorer.exe\"\n$Shortcut.Arguments = \"\\\\192.168.10.2\\shares\"\n```\n\n환경 변수와 함께 사용되는 단축키 대상 경로\n\n```js\n# 표준 연결 방식인 + 기호를 사용하여\n$Shortcut.TargetPath = $env:userprofile + \"\\Downloads\"\n\n# Join-Path cmdlet을 사용하여\n$Shortcut.TargetPath = Join-Path -Path $env:userprofile -ChildPath \"Downloads\"\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n컨트롤 패널 파일로의 바로 가기\n\n이 파일들은 C:\\Windows\\System32 폴더에 있으며, 컨트롤 패널 항목에 접근하기가 편리합니다. 그러나 대부분 다른 방법으로 그 곳에 도달하려고 할 것입니다.\n\n```js\n$Shortcut.TargetPath = \"C:\\Windows\\System32\\mmsys.cpl\"\n```\n\nWindows 설정 앱을 통한 패널로의 바로 가기\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nWindows 설정 응용 프로그램의 특정 페이지를 지정하는 방법을 제공합니다. ms-settings:`페이지 이름` 형식을 따라 이동할 수 있습니다.\n\n```js\n$Shortcut.TargetPath = \"ms-settings:installed-apps\"\n```\n\n셸 명령을 통한 위치 바로 가기\n\nWindows의 많은 위치는 파일과 유사한 절대 경로 접근이 없어서, 특정 패널이나 폴더에 프로그래밍적으로 어떻게 도달할지가 명확하지 않을 수 있습니다. 이러한 위치를 셸 폴더 또는 가상 폴더라고 하며 알려진 이름을 사용하거나 CLSID 고유 식별자 키 (GUID)를 사용하여 접근할 수 있습니다. CLSID는 레지스트리에서 직접 항목을 열 수 있도록 사용할 수 있는 특별한 키입니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n그들에 대해 더 자세히 알고 싶거나 사용 가능한 Windows 11 바로 가기의 완전한 목록을 보고 싶다면, 여기에서 더 깊게 다루었어요.\n\n```js\n# 이름으로 셸 명령어를 사용하여\n$Shortcut.TargetPath = \"C:\\Windows\\explorer.exe\"\n$Shortcut.Arguments = \"shell:NetworkPlacesFolder\"\n\n# CLSID GUID로 셸 명령어를 사용하여\n$Shortcut.TargetPath = \"C:\\Windows\\explorer.exe\"\n$Shortcut.Arguments = \"shell:::{BB06C0E4-D293-4f75-8A90-CB05B6477EEE}\"\n```\n\n## 아이콘으로 바로 가기 맞춤 설정\n\n만약 당신의 바로 가기가 이미 아이콘이 있는 항목을 가리키고 있다면, 해당 아이콘의 경로는 IconLocation 속성에 저장됩니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nPowerShell을 사용하여 단축키에 사용자 정의 아이콘을 할당하려면, 단축키를 만들 때 추가 단계로 IconLocation 속성을 구성하여 기존 아이콘에 도달 가능한 경로를 설정한 후 단축키를 저장하면 됩니다.\n\n```js\n$Shortcut.IconLocation = \"\\\\path-to-your-icon.ico\"\n```\n\n이제 사용자 정의 아이콘으로 구성된 단축키를 가지고 있으므로, 스크립트가 다른 곳에 배포되어야 할 경우 아이콘의 가용성을 확인해야 할 것입니다. 항상 컴퓨터에 이미 있는 요소를 활용하는 것이 좋은 접근 방식일 것입니다.\n\nWindows OS에는 일반 UI 아이콘이 저장되고 사용되는 곳이 있습니다. 일반적으로 이러한 아이콘은 여러 프로그램에서 동시에 공유되는 데이터를 포함하는 동적 링크 라이브러리(DLL)에 패킹되어 있습니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n시스템 주변에는 많은 것들이 있지만, OS에서 가장 일반적으로 사용되는 DLL에는 다음과 같은 아이콘이 포함되어 있습니다:\n\n- C:\\Windows\\system32\\imageres.dll\n- C:\\Windows\\system32\\shell32.dll\n- C:\\Windows\\system32\\ddores.dll\n\n이러한 아이콘들은 표준 파일이 아니며, 적절한 인덱스 번호를 사용하여 DLL 파일 내에서 참조해야 합니다. 이러한 아이콘들은 쉽게 볼 수 없다는 것이 함정입니다. 따라서 텍스트의 시작 부분에 있는 2시간의 줄서기가 필요합니다.\n\n서드 파티 소프트웨어를 사용하지 않고 시간을 낭비하지 않고 DLL의 중첩된 아이콘 인덱스 번호를 확인하려면, 기존 바로 가기의 \"속성\" 패널을 사용하여 DLL 파일을 검색하십시오. 그곳에서 원하는 아이콘을 선택하고 변경 내용을 저장한 다음 해당 인덱스 번호를 코드에서 사용할 수 있도록 PowerShell의 WScriptShell의 COM 인스턴스에 바로 가기를 추가하십시오. IconLocation 속성을 검사하여 코드에서 사용할 수 있는 인덱스 번호를 식별할 수 있습니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nDLL 아이콘 참조하기\n\n에제로 살펴보겠습니다. 제 노트패드 바로 가기를 특정 라이브러리 중 하나로부터 가져온 독특한 아이콘과 함께 배포하고 싶다고 가정해 보겠습니다. 예를 들어, imageres.dll 라이브러리의 키보드 아이콘을 사용하고 싶다면 어떨까요?\n\n제 데스크탑에 있는 크롬 바로 가기의 현재 IconLocation을 살펴보면 chrome.exe(녹색 선) 패키지 내부의 아이콘(녹색 선)이 사용되고 있으며, 해당 아이콘의 인덱스 번호는 0(분홍색 선)입니다. 이 인덱스는 경로의 일부로 표시되며, 파일 경로와 인덱스 번호는 쉼표로 구분됩니다.\n\n![이미지](/assets/img/2024-06-22-WindowsShortcutsWithPowerShellHowToMakeCustomizeAndPointThemToPlaces_2.png)\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n또한 chrome.exe 패키지 내부에는 사용할 수 있는 다른 아이콘들이 있다는 것을 알 수 있습니다.\n\n우리는 동일한 Chrome 바로 가기를 사용하여 imageres.dll 라이브러리를 살펴보고 원하는 바로 가기를 선택하고 해당 인덱스 번호를 확인할 수 있습니다.\n\n1. 속성 페이지에 액세스하여 \"아이콘 변경\" 버튼을 클릭하고 \"C:\\Windows\\system32\\imageres.dll\"로 이동한 후 \"Enter\"를 눌러 사용 가능한 아이콘을 확인할 수 있습니다.\n\n여기에서 사용하고자 하는 키보드 아이콘을 선택했습니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\nMarkdown 형식으로 테이블 태그를 변경해주세요.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```js\n$Shortcut.IconLocation = \"C:\\Windows\\system32\\imageres.dll,173\"\n```\n\n## 원라이너\n\n간단하게 사용하기 위해 이를 한 줄로 표현하려면, \"첫 번째 명령; 두 번째 명령; 세 번째 명령\"과 같이 세미콜론을 사용하여 명령을 연결할 수 있습니다. 여기서는 경로 변수를 사용하지 않고 직접 속성과 메소드에 넣어줍니다.\n\n```js\n$ws = New-Object -ComObject WScript.Shell; $s = $ws.CreateShortcut(\"C:\\Users\\Public\\Desktop\\notepad.lnk\"); $s.TargetPath = \"C:\\Windows\\System32\\notepad.exe\"; $s.IconLocation = \"C:\\Windows\\system32\\imageres.dll,173\"; $s.Save()\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\ncmd를 통해 작업하는 우리에게:\n\n```js\npowershell -ExecutionPolicy bypass -Command \"$ws = New-Object -ComObject WScript.Shell; $s = $ws.CreateShortcut('C:\\Users\\Public\\Desktop\\notepad.lnk'); $s.TargetPath = 'C:\\Windows\\System32\\notepad.exe'; $s.IconLocation = 'C:\\Windows\\system32\\imageres.dll,173'; $s.Save()\"\n```\n\n# 결론\n\nPowerShell을 사용하여 바로 가기를 만드는 것은 COM 객체를 사용하여 WScript.Shell 클래스를 인스턴스화하여 바로 가기 생성 기능에 액세스하는 복잡성을 도입하지만, 프로퍼티 값을 구성하는 루틴 작업으로 단순화됩니다. 배포 전 철저한 테스트, 절대 경로 정확성에 대한 주의 및 아이콘이나 특정 경로와 같은 기존 시스템 요소를 재사용하는 마인드는 중요한 고려 사항입니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n당신이 시간을 쏟을 수 있는 곳은 운영 체제의 복잡성에 깊이 파고들어 특정 패널이나 가상 폴더를 대상으로 하는 방법을 알아내는 것입니다. 그러나 대부분의 경우에는 결과적으로 필요한 배포 가능한 한 줄의 코드로 축약될 수 있습니다.\n\n# 작성자의 노트\n\n여기까지 오셨네요! 잘 하셨어요 친구들 — 제가 꽤 괜찮은 작가라서 그런지, 아니면 당신이 훌륭한 독자라서 그런 건지요. 우리는 후자를 택하도록 합시다😅.\n\n나는 기업의 혼돈을 탐내는 경험 많은 IT 서비스 전달 엔지니어 다닐로입니다. 저는 스크립팅, 시스템 관리자 관련 내용, 그리고 다른 곳에서 제대로 문서화되지 않은 주제들에 대해 글을 씁니다. 지식을 공유하고 글쓰기 기술을 향상시키기 위한 목적을 가지고요.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n만졌더니 반복의 경우 피드백을 주세요!","ogImage":{"url":"/assets/img/2024-06-22-WindowsShortcutsWithPowerShellHowToMakeCustomizeAndPointThemToPlaces_0.png"},"coverImage":"/assets/img/2024-06-22-WindowsShortcutsWithPowerShellHowToMakeCustomizeAndPointThemToPlaces_0.png","tag":["Tech"],"readingTime":11},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003e이제와서 당신이 손에 가장 흔한 작업인 것처럼 확신을 갖고 \"응, 30분 만에 끝낼 거야!\" 라고 생각할 때 상황이 발생할 것입니다. 그리고 2시간 후에 일부 희미한 문서를 찾아보며, 코드 예제를 보면서 \"이게 정말 이런 건가?\" 라고 생생히 느낄 수도 있죠.\u003c/p\u003e\n\u003cp\u003e얼마 전, Windows 11의 제어판 소리 설정의 \"녹음\" 패널에 데스크톱 바로 가기를 생성하고 배포해야 하는 상황이 발생했습니다. PowerShell에는 바로 가기를 생성하는 \"기본\" 방법이 없다는 것을 이미 알고 있어서 몇 가지 쉘 방법을 탐색할 예정이었습니다. 그런데 만약에 해당 바로 가기를 제어판 항목의 하위 메뉴로 가리키고 싶거나, 이미 컴퓨터에 존재하지만 동적 라이브러리 안에 저장된 사용자 정의 아이콘을 사용하고 싶다면 어떨까요?\u003c/p\u003e\n\u003cp\u003e좋아요, 친애하는 독자 여러분, 해결 방법은 있습니다. 때로는 운영 체제의 내부를 살펴 경로를 찾아야 할 때도 있습니다. Windows 바로 가기를 생성하고 사용자 정의하는 방법에 대해 자세히 알아봅시다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003ch1\u003e단축키, 심볼릭 링크 및 PowerShell\u003c/h1\u003e\n\u003cp\u003e우선 중요한 것은 PowerShell에 내장된 New-Item cmdlet을 사용하여 심볼릭 링크를 만들 수 있는 방법이 있다는 것입니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-title class_\"\u003eNew\u003c/span\u003e-\u003cspan class=\"hljs-title class_\"\u003eItem\u003c/span\u003e -\u003cspan class=\"hljs-title class_\"\u003eItemType\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eSymbolicLink\u003c/span\u003e -\u003cspan class=\"hljs-title class_\"\u003ePath\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"C:\\example-link.lnk\"\u003c/span\u003e -\u003cspan class=\"hljs-title class_\"\u003eTarget\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"C:\\Users\\dbilanoski\\Documents\\some-text.txt\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e다른 곳에서 이와 같은 단축키를 생성하는 방법을 제안하는 지침을 만날 수 있습니다. 그러나 주의해야 할 점은 이러한 것들이 정확히 동일한 것이 아니라는 것입니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003eSymbolic links(심볼릭 링크)는 파일 시스템 자체에서 해석된 다른 파일로의 직접적인 링크입니다. 일반 파일과 다르며 크기가 없으며 응용 프로그램이 이를 내재적으로 인식합니다. 사용할 때 실제로 링크된 대상을 직접 사용하는 것처럼 사용됩니다.\u003c/p\u003e\n\u003cp\u003e한편 바로 가기(Shortcuts)는 Windows 사용자 인터페이스에서 해석된 참조된 객체의 경로를 포함하는 일반 파일입니다. 크기가 있으며 아이콘으로 구성될 수 있으며 사용할 때 이를 읽고 있는 무언가와 대상 경로를 갖고 있어야 합니다(Windows 사용자 인터페이스).\u003c/p\u003e\n\u003cp\u003eWindows에서 바로 가기가 필요할 때는 바로 가기를 원할 것입니다. 왜냐하면?\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e바로 가기는 참조하는 파일을 추적하여 변경 사항이 발생할 때 업데이트되어 깨질 가능성이 줄어듭니다.\u003c/li\u003e\n\u003cli\u003e파일과 폴더 외에도 네트워크 위치, 구성 패널, 파일 시스템에 있는 파일 경로로 존재하지 않는 특수 폴더를 엽니다.\u003c/li\u003e\n\u003cli\u003e특정 폴더의 컨텍스트에서 시작되도록 구성된 바로 가기를 사용할 수 있습니다.\u003c/li\u003e\n\u003cli\u003e심볼릭 링크를 사용하면 대상 경로에 실행 파일에 대한 명령줄 인수를 포함할 수 없습니다.\u003c/li\u003e\n\u003cli\u003e아이콘을 심볼릭 링크에 구성할 수 없습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e단축키를 친숙하고 편리하게 만드는 이유는 Windows 사용자 인터페이스(셸)에서 처리하기 때문입니다. Windows 사용자 인터페이스는 추가 기능과 편의성을 제공합니다. 그러나 PowerShell에서 이를 만들기 위해서는 셸 메소드에 접근해야 하며, 이로 인해 프로세스가 조금 더 복잡해지게 됩니다.\u003c/p\u003e\n\u003ch1\u003e서둘러야 할 때를 위해\u003c/h1\u003e\n\u003cp\u003ePowerShell을 사용하여 단축키를 만들고 고유 아이콘을 사용자 정의하려면 아래의 기본 예시를 참고하세요. 특정 상황에 맞게 경로와 파일 이름을 수정해야 합니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ShortcutTarget= \u003cspan class=\"hljs-string\"\u003e\"타겟-경로\\타겟-이름\"\u003c/span\u003e\n$ShortcutFile = \u003cspan class=\"hljs-string\"\u003e\"단축키-경로\\단축키-이름.lnk\"\u003c/span\u003e\n$WScriptShell = \u003cspan class=\"hljs-title class_\"\u003eNew\u003c/span\u003e-\u003cspan class=\"hljs-title class_\"\u003eObject\u003c/span\u003e -\u003cspan class=\"hljs-title class_\"\u003eComObject\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eWScript\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eShell\u003c/span\u003e\n$Shortcut = $WScriptShell.\u003cspan class=\"hljs-title class_\"\u003eCreateShortcut\u003c/span\u003e($ShortcutFile)\n$Shortcut.\u003cspan class=\"hljs-property\"\u003eTargetPath\u003c/span\u003e = $ShortcutTarget\n$Shortcut.\u003cspan class=\"hljs-property\"\u003eIconLocation\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"아이콘-경로\\아이콘-이름.ico\"\u003c/span\u003e\n$Shortcut.\u003cspan class=\"hljs-title class_\"\u003eSave\u003c/span\u003e()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e한 줄로 된 스크립트가 필요하시면:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# \u003cspan class=\"hljs-title class_\"\u003ePowerShell\u003c/span\u003e 스크립트용\n$ws = \u003cspan class=\"hljs-title class_\"\u003eNew\u003c/span\u003e-\u003cspan class=\"hljs-title class_\"\u003eObject\u003c/span\u003e -\u003cspan class=\"hljs-title class_\"\u003eComObject\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eWScript\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eShell\u003c/span\u003e; $s = $ws.\u003cspan class=\"hljs-title class_\"\u003eCreateShortcut\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'실행할-바로가기-파일-경로\\바로가기-파일명.lnk'\u003c/span\u003e); $s.\u003cspan class=\"hljs-property\"\u003eTargetPath\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e'대상-파일-경로\\대상-파일명'\u003c/span\u003e; $s.\u003cspan class=\"hljs-property\"\u003eIconLocation\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e'아이콘-파일-경로\\아이콘-파일명.ico'\u003c/span\u003e; $s.\u003cspan class=\"hljs-title class_\"\u003eSave\u003c/span\u003e()\n\n# 배치 (\u003cspan class=\"hljs-variable constant_\"\u003eCMD\u003c/span\u003e) 스크립트용\npowershell -\u003cspan class=\"hljs-title class_\"\u003eExecutionPolicy\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eBypass\u003c/span\u003e -\u003cspan class=\"hljs-title class_\"\u003eCommand\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"$ws = New-Object -ComObject WScript.Shell; $s = $ws.CreateShortcut('실행할-바로가기-파일-경로\\바로가기-파일명.lnk'); $s.TargetPath = '대상-파일-경로\\대상-파일명'; $s.IconLocation = '아이콘-파일-경로\\아이콘-파일명.ico'; $s.Save()\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e구체적인 예시\u003c/h2\u003e\n\u003cp\u003e서로 다른 바로가기 대상 유형에 대한 적합한 TargetPath 및 필요시 Arguments 구성.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# 파일 지정하기\n$Shortcut.\u003cspan class=\"hljs-property\"\u003eTargetPath\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"C:\\Windows\\System32\\notepad.exe\"\u003c/span\u003e\n\n# 폴더 지정하기\n$Shortcut.\u003cspan class=\"hljs-property\"\u003eTargetPath\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"C:\\Users\\Public\\Documents\"\u003c/span\u003e\n\n# 네트워크 공유 지정하기\n$Shortcut.\u003cspan class=\"hljs-property\"\u003eTargetPath\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"C:\\Windows\\explorer.exe\"\u003c/span\u003e\n$Shortcut.\u003cspan class=\"hljs-property\"\u003eArguments\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"\\\\192.168.10.2\\shares\"\u003c/span\u003e\n\n# 환경 변수를 사용하여 지정하기\n$Shortcut.\u003cspan class=\"hljs-property\"\u003eTargetPath\u003c/span\u003e = \u003cspan class=\"hljs-attr\"\u003e$env\u003c/span\u003e:userprofile + \u003cspan class=\"hljs-string\"\u003e\"\\Downloads\"\u003c/span\u003e\n\n# .\u003cspan class=\"hljs-property\"\u003ecpl\u003c/span\u003e 파일을 지정하기\n$Shortcut.\u003cspan class=\"hljs-property\"\u003eTargetPath\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"C:\\Windows\\System32\\mmsys.cpl\"\u003c/span\u003e\n\n# \u003cspan class=\"hljs-attr\"\u003eMS\u003c/span\u003e:\u003cspan class=\"hljs-variable constant_\"\u003eSETTINGS\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eURI\u003c/span\u003e 스킴을 사용하여 지정하기\n$Shortcut.\u003cspan class=\"hljs-property\"\u003eTargetPath\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"ms-settings:installed-apps\"\u003c/span\u003e\n\n# 이름으로 shell 명령어를 사용하여 지정하기\n$Shortcut.\u003cspan class=\"hljs-property\"\u003eTargetPath\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"C:\\Windows\\explorer.exe\"\u003c/span\u003e\n$Shortcut.\u003cspan class=\"hljs-property\"\u003eArguments\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"shell:NetworkPlacesFolder\"\u003c/span\u003e\n\n# \u003cspan class=\"hljs-variable constant_\"\u003eCLSID\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eGUID\u003c/span\u003e로 shell 명령어를 사용하여 지정하기\n$Shortcut.\u003cspan class=\"hljs-property\"\u003eTargetPath\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"C:\\Windows\\explorer.exe\"\u003c/span\u003e\n$Shortcut.\u003cspan class=\"hljs-property\"\u003eArguments\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"shell:::{BB06C0E4-D293-4f75-8A90-CB05B6477EEE}\"\u003c/span\u003e\n\n# rundll32를 사용하여 dll 탐색으로 지정하기\n$Shortcut.\u003cspan class=\"hljs-property\"\u003eTargetPath\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"C:\\Windows\\System32\\rundll32.exe\"\u003c/span\u003e\n$Shortcut.\u003cspan class=\"hljs-property\"\u003eArguments\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"shell32.dll,Control_RunDLL inetcpl.cpl,,4\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch1\u003e세부 정보\u003c/h1\u003e\n\u003ch2\u003ePowershell로 바로 가기 생성\u003c/h2\u003e\n\u003cp\u003ePowerShell을 사용하여 바로 가기를 생성하려면, WScript.Shell 클래스의 인스턴스를 포함할 컨테이너로 작동할 COM 객체를 생성해야 합니다. 이는 아마도 초기에 Visual Basic 스크립트를 위해 고안된 꽤 오래된 COM 인터페이스의 일부인 WScript.Shell 클래스의 인스턴스를 담을 객체를 만들 것입니다. 즉, 코드로 바로 가기를 처리하기 위해 필요한 모든 좋은 기능이 구비된 객체를 만들 것입니다. 이는 변수와 속성을 다루는 작업을 포함하므로, 이를 단계적으로 나누어 설명하겠습니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e컴퓨터의 각 사용자에 대해 notepad.exe(Windows에서 널리 사용되는 텍스트 편집 도구)에 대한 데스크탑 바로 가기를 만들고자 합니다.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e먼저 대상 객체와 해당 바로 가기의 경로를 저장할 변수를 만듭니다.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# 내 바로 가기가 가리키는 위치\n$ShortcutTarget = \u003cspan class=\"hljs-string\"\u003e\"C:\\Windows\\System32\\notepad.exe\"\u003c/span\u003e\n# 내 바로 가기가 저장될 곳 및 이름 설정\n$ShortcutFile = \u003cspan class=\"hljs-string\"\u003e\"C:\\Users\\Public\\Desktop\\notepad.lnk\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003eNew-Object cmdlet을 사용하여 COM 개체로 WScript.Shell 클래스의 인스턴스를 생성합니다.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$WScriptShell = \u003cspan class=\"hljs-title class_\"\u003eNew\u003c/span\u003e-\u003cspan class=\"hljs-title class_\"\u003eObject\u003c/span\u003e -\u003cspan class=\"hljs-title class_\"\u003eComObject\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eWScript\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eShell\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"3\"\u003e\n\u003cli\u003eWScript.Shell 인스턴스에서 CreateShortcut() 메서드를 사용하여 바로 가기를 만듭니다.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$shortcut = $WScriptShell.\u003cspan class=\"hljs-title class_\"\u003eCreateShortcut\u003c/span\u003e($ShortcutFile)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e자, 이제 잠시 멈추고 바로 가기 객체의 속성과 메서드를 살펴보면서 우리가 할 수 있는 작업을 살펴보겠습니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-22-WindowsShortcutsWithPowerShellHowToMakeCustomizeAndPointThemToPlaces_1.png\" alt=\"Shortcut Image\"\u003e\u003c/p\u003e\n\u003cp\u003e우리는 단축키를 생성하기 위해 TargetPath 속성에 Notepad.exe를 지정하고 Save() 메서드를 사용해야 합니다.\u003c/p\u003e\n\u003cp\u003e우리의 단축키에 아이콘을 할당하려면 IconLocation 속성이 관련됩니다. TargetPath에 참조된 실행 파일에 명령줄 인수를 전달하려면 Arguments 속성이 관련됩니다.\u003c/p\u003e\n\u003cp\u003eWorkingDirectory는 상대 경로 사용시 때로 필요하지만, 단축키를 다룰 때 상대 경로는 피하는 것이 좋습니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003col start=\"4\"\u003e\n\u003cli\u003e기본 사항으로 계속해서, 앞서 설정한 변수를 사용하여 Target.Path 속성을 위치와 대상의 이름에 할당하십시오.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$Shortcut.\u003cspan class=\"hljs-property\"\u003eTargetPath\u003c/span\u003e = $ShortcutTarget\n\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"5\"\u003e\n\u003cli\u003eShortcutFile 변수에 지정된 경로에 바로 가기를 저장하기 위해 Save() 메서드를 호출하여 프로세스를 완료하세요.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$Shortcut.\u003cspan class=\"hljs-title class_\"\u003eSave\u003c/span\u003e()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e당신의 바로 가기는 $ShortcutFile 변수에 정의된 위치에 준비될 것입니다.\u003c/p\u003e\n\u003ch2\u003e장소들을 가리키는 바로 가기\u003c/h2\u003e\n\u003cp\u003e파워쉘을 사용하여 프로그래밍적으로 바로 가기를 만드는 방법을 알게 되었으니, 파일 이외의 것을 가리킬 때는 어떻게 보이는지 살펴보겠습니다. 불행하게도 항상 명확하지는 않습니다.\u003c/p\u003e\n\u003cp\u003e한두 개의 속성만 변경할 때는 주석이 있는 코드 블록에서 실제 예제를 사용할 것입니다. — TargetPath와 Arguments가 필요할 때 변경합니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e폴더로의 바로 가기\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$Shortcut.\u003cspan class=\"hljs-property\"\u003eTargetPath\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"C:\\Users\\Public\\Documents\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e네트워크 공유로의 바로 가기\u003c/p\u003e\n\u003cp\u003e여기서는 Arguments 속성을 사용하여 TargetPath 속성에서 구성된 explorer.exe로 UNC 형식의 경로를 전달하고 있습니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e주로 단축키 생성 프로시저에서 문제를 피하기 위한 것이며, 그렇지 않으면 명령이 실행된 문맥 내에서 경로에 액세스할 수 없는 경우 프로세스가 실패할 수 있습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$Shortcut.\u003cspan class=\"hljs-property\"\u003eTargetPath\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"C:\\Windows\\explorer.exe\"\u003c/span\u003e\n$Shortcut.\u003cspan class=\"hljs-property\"\u003eArguments\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"\\\\192.168.10.2\\shares\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e환경 변수와 함께 사용되는 단축키 대상 경로\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# 표준 연결 방식인 + 기호를 사용하여\n$Shortcut.\u003cspan class=\"hljs-property\"\u003eTargetPath\u003c/span\u003e = \u003cspan class=\"hljs-attr\"\u003e$env\u003c/span\u003e:userprofile + \u003cspan class=\"hljs-string\"\u003e\"\\Downloads\"\u003c/span\u003e\n\n# \u003cspan class=\"hljs-title class_\"\u003eJoin\u003c/span\u003e-\u003cspan class=\"hljs-title class_\"\u003ePath\u003c/span\u003e cmdlet을 사용하여\n$Shortcut.\u003cspan class=\"hljs-property\"\u003eTargetPath\u003c/span\u003e = \u003cspan class=\"hljs-title class_\"\u003eJoin\u003c/span\u003e-\u003cspan class=\"hljs-title class_\"\u003ePath\u003c/span\u003e -\u003cspan class=\"hljs-title class_\"\u003ePath\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003e$env\u003c/span\u003e:userprofile -\u003cspan class=\"hljs-title class_\"\u003eChildPath\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Downloads\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e컨트롤 패널 파일로의 바로 가기\u003c/p\u003e\n\u003cp\u003e이 파일들은 C:\\Windows\\System32 폴더에 있으며, 컨트롤 패널 항목에 접근하기가 편리합니다. 그러나 대부분 다른 방법으로 그 곳에 도달하려고 할 것입니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$Shortcut.\u003cspan class=\"hljs-property\"\u003eTargetPath\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"C:\\Windows\\System32\\mmsys.cpl\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWindows 설정 앱을 통한 패널로의 바로 가기\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003eWindows 설정 응용 프로그램의 특정 페이지를 지정하는 방법을 제공합니다. ms-settings:\u003ccode\u003e페이지 이름\u003c/code\u003e 형식을 따라 이동할 수 있습니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$Shortcut.\u003cspan class=\"hljs-property\"\u003eTargetPath\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"ms-settings:installed-apps\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e셸 명령을 통한 위치 바로 가기\u003c/p\u003e\n\u003cp\u003eWindows의 많은 위치는 파일과 유사한 절대 경로 접근이 없어서, 특정 패널이나 폴더에 프로그래밍적으로 어떻게 도달할지가 명확하지 않을 수 있습니다. 이러한 위치를 셸 폴더 또는 가상 폴더라고 하며 알려진 이름을 사용하거나 CLSID 고유 식별자 키 (GUID)를 사용하여 접근할 수 있습니다. CLSID는 레지스트리에서 직접 항목을 열 수 있도록 사용할 수 있는 특별한 키입니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e그들에 대해 더 자세히 알고 싶거나 사용 가능한 Windows 11 바로 가기의 완전한 목록을 보고 싶다면, 여기에서 더 깊게 다루었어요.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e# 이름으로 셸 명령어를 사용하여\n$Shortcut.\u003cspan class=\"hljs-property\"\u003eTargetPath\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"C:\\Windows\\explorer.exe\"\u003c/span\u003e\n$Shortcut.\u003cspan class=\"hljs-property\"\u003eArguments\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"shell:NetworkPlacesFolder\"\u003c/span\u003e\n\n# \u003cspan class=\"hljs-variable constant_\"\u003eCLSID\u003c/span\u003e \u003cspan class=\"hljs-variable constant_\"\u003eGUID\u003c/span\u003e로 셸 명령어를 사용하여\n$Shortcut.\u003cspan class=\"hljs-property\"\u003eTargetPath\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"C:\\Windows\\explorer.exe\"\u003c/span\u003e\n$Shortcut.\u003cspan class=\"hljs-property\"\u003eArguments\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"shell:::{BB06C0E4-D293-4f75-8A90-CB05B6477EEE}\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e아이콘으로 바로 가기 맞춤 설정\u003c/h2\u003e\n\u003cp\u003e만약 당신의 바로 가기가 이미 아이콘이 있는 항목을 가리키고 있다면, 해당 아이콘의 경로는 IconLocation 속성에 저장됩니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003ePowerShell을 사용하여 단축키에 사용자 정의 아이콘을 할당하려면, 단축키를 만들 때 추가 단계로 IconLocation 속성을 구성하여 기존 아이콘에 도달 가능한 경로를 설정한 후 단축키를 저장하면 됩니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$Shortcut.\u003cspan class=\"hljs-property\"\u003eIconLocation\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"\\\\path-to-your-icon.ico\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e이제 사용자 정의 아이콘으로 구성된 단축키를 가지고 있으므로, 스크립트가 다른 곳에 배포되어야 할 경우 아이콘의 가용성을 확인해야 할 것입니다. 항상 컴퓨터에 이미 있는 요소를 활용하는 것이 좋은 접근 방식일 것입니다.\u003c/p\u003e\n\u003cp\u003eWindows OS에는 일반 UI 아이콘이 저장되고 사용되는 곳이 있습니다. 일반적으로 이러한 아이콘은 여러 프로그램에서 동시에 공유되는 데이터를 포함하는 동적 링크 라이브러리(DLL)에 패킹되어 있습니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e시스템 주변에는 많은 것들이 있지만, OS에서 가장 일반적으로 사용되는 DLL에는 다음과 같은 아이콘이 포함되어 있습니다:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eC:\\Windows\\system32\\imageres.dll\u003c/li\u003e\n\u003cli\u003eC:\\Windows\\system32\\shell32.dll\u003c/li\u003e\n\u003cli\u003eC:\\Windows\\system32\\ddores.dll\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e이러한 아이콘들은 표준 파일이 아니며, 적절한 인덱스 번호를 사용하여 DLL 파일 내에서 참조해야 합니다. 이러한 아이콘들은 쉽게 볼 수 없다는 것이 함정입니다. 따라서 텍스트의 시작 부분에 있는 2시간의 줄서기가 필요합니다.\u003c/p\u003e\n\u003cp\u003e서드 파티 소프트웨어를 사용하지 않고 시간을 낭비하지 않고 DLL의 중첩된 아이콘 인덱스 번호를 확인하려면, 기존 바로 가기의 \"속성\" 패널을 사용하여 DLL 파일을 검색하십시오. 그곳에서 원하는 아이콘을 선택하고 변경 내용을 저장한 다음 해당 인덱스 번호를 코드에서 사용할 수 있도록 PowerShell의 WScriptShell의 COM 인스턴스에 바로 가기를 추가하십시오. IconLocation 속성을 검사하여 코드에서 사용할 수 있는 인덱스 번호를 식별할 수 있습니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003eDLL 아이콘 참조하기\u003c/p\u003e\n\u003cp\u003e에제로 살펴보겠습니다. 제 노트패드 바로 가기를 특정 라이브러리 중 하나로부터 가져온 독특한 아이콘과 함께 배포하고 싶다고 가정해 보겠습니다. 예를 들어, imageres.dll 라이브러리의 키보드 아이콘을 사용하고 싶다면 어떨까요?\u003c/p\u003e\n\u003cp\u003e제 데스크탑에 있는 크롬 바로 가기의 현재 IconLocation을 살펴보면 chrome.exe(녹색 선) 패키지 내부의 아이콘(녹색 선)이 사용되고 있으며, 해당 아이콘의 인덱스 번호는 0(분홍색 선)입니다. 이 인덱스는 경로의 일부로 표시되며, 파일 경로와 인덱스 번호는 쉼표로 구분됩니다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-22-WindowsShortcutsWithPowerShellHowToMakeCustomizeAndPointThemToPlaces_2.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e또한 chrome.exe 패키지 내부에는 사용할 수 있는 다른 아이콘들이 있다는 것을 알 수 있습니다.\u003c/p\u003e\n\u003cp\u003e우리는 동일한 Chrome 바로 가기를 사용하여 imageres.dll 라이브러리를 살펴보고 원하는 바로 가기를 선택하고 해당 인덱스 번호를 확인할 수 있습니다.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e속성 페이지에 액세스하여 \"아이콘 변경\" 버튼을 클릭하고 \"C:\\Windows\\system32\\imageres.dll\"로 이동한 후 \"Enter\"를 눌러 사용 가능한 아이콘을 확인할 수 있습니다.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e여기에서 사용하고자 하는 키보드 아이콘을 선택했습니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003eMarkdown 형식으로 테이블 태그를 변경해주세요.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$Shortcut.\u003cspan class=\"hljs-property\"\u003eIconLocation\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"C:\\Windows\\system32\\imageres.dll,173\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e원라이너\u003c/h2\u003e\n\u003cp\u003e간단하게 사용하기 위해 이를 한 줄로 표현하려면, \"첫 번째 명령; 두 번째 명령; 세 번째 명령\"과 같이 세미콜론을 사용하여 명령을 연결할 수 있습니다. 여기서는 경로 변수를 사용하지 않고 직접 속성과 메소드에 넣어줍니다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e$ws = \u003cspan class=\"hljs-title class_\"\u003eNew\u003c/span\u003e-\u003cspan class=\"hljs-title class_\"\u003eObject\u003c/span\u003e -\u003cspan class=\"hljs-title class_\"\u003eComObject\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eWScript\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eShell\u003c/span\u003e; $s = $ws.\u003cspan class=\"hljs-title class_\"\u003eCreateShortcut\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"C:\\Users\\Public\\Desktop\\notepad.lnk\"\u003c/span\u003e); $s.\u003cspan class=\"hljs-property\"\u003eTargetPath\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"C:\\Windows\\System32\\notepad.exe\"\u003c/span\u003e; $s.\u003cspan class=\"hljs-property\"\u003eIconLocation\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"C:\\Windows\\system32\\imageres.dll,173\"\u003c/span\u003e; $s.\u003cspan class=\"hljs-title class_\"\u003eSave\u003c/span\u003e()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003ecmd를 통해 작업하는 우리에게:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003epowershell -\u003cspan class=\"hljs-title class_\"\u003eExecutionPolicy\u003c/span\u003e bypass -\u003cspan class=\"hljs-title class_\"\u003eCommand\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"$ws = New-Object -ComObject WScript.Shell; $s = $ws.CreateShortcut('C:\\Users\\Public\\Desktop\\notepad.lnk'); $s.TargetPath = 'C:\\Windows\\System32\\notepad.exe'; $s.IconLocation = 'C:\\Windows\\system32\\imageres.dll,173'; $s.Save()\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch1\u003e결론\u003c/h1\u003e\n\u003cp\u003ePowerShell을 사용하여 바로 가기를 만드는 것은 COM 객체를 사용하여 WScript.Shell 클래스를 인스턴스화하여 바로 가기 생성 기능에 액세스하는 복잡성을 도입하지만, 프로퍼티 값을 구성하는 루틴 작업으로 단순화됩니다. 배포 전 철저한 테스트, 절대 경로 정확성에 대한 주의 및 아이콘이나 특정 경로와 같은 기존 시스템 요소를 재사용하는 마인드는 중요한 고려 사항입니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e당신이 시간을 쏟을 수 있는 곳은 운영 체제의 복잡성에 깊이 파고들어 특정 패널이나 가상 폴더를 대상으로 하는 방법을 알아내는 것입니다. 그러나 대부분의 경우에는 결과적으로 필요한 배포 가능한 한 줄의 코드로 축약될 수 있습니다.\u003c/p\u003e\n\u003ch1\u003e작성자의 노트\u003c/h1\u003e\n\u003cp\u003e여기까지 오셨네요! 잘 하셨어요 친구들 — 제가 꽤 괜찮은 작가라서 그런지, 아니면 당신이 훌륭한 독자라서 그런 건지요. 우리는 후자를 택하도록 합시다😅.\u003c/p\u003e\n\u003cp\u003e나는 기업의 혼돈을 탐내는 경험 많은 IT 서비스 전달 엔지니어 다닐로입니다. 저는 스크립팅, 시스템 관리자 관련 내용, 그리고 다른 곳에서 제대로 문서화되지 않은 주제들에 대해 글을 씁니다. 지식을 공유하고 글쓰기 기술을 향상시키기 위한 목적을 가지고요.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e만졌더니 반복의 경우 피드백을 주세요!\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-06-22-WindowsShortcutsWithPowerShellHowToMakeCustomizeAndPointThemToPlaces"},"buildId":"QYe6gFAUryFKFgjKBoIfo","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>