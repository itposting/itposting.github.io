---
title: "외적, 내적 회전 오른쪽부터 곱하나 왼쪽부터 곱하나요"
description: ""
coverImage: "/assets/img/2024-06-20-ExtrinsicintrinsicrotationDoImultiplyfromrightorleft_0.png"
date: 2024-06-20 18:00
ogImage: 
  url: /assets/img/2024-06-20-ExtrinsicintrinsicrotationDoImultiplyfromrightorleft_0.png
tag: Tech
originalTitle: "Extrinsic , intrinsic rotation: Do I multiply from right or left?"
link: "https://medium.com/@dominicplein/extrinsic-intrinsic-rotation-do-i-multiply-from-right-or-left-357c38c1abfd"
---


## 오일러 각도는 헷갈릴 수 있습니다, 특히 여러 회전을 연쇄적으로 곱셈으로 연결할 때 행렬의 순서가 어떻게 되는지에 대해서요. 이 게시물에서는 외부, 내부 회전 순서의 차이와 오른쪽이나 왼쪽에서 곱셈을 해야 하는지를 어떻게 결정하는지 설명해 드릴게요.

# 회전 행렬 되돌아보기

먼저, 유클리드 공간에서 x-, y-, 또는 z-축 주위의 각도 θ로 점을 회전시키는 데 사용하는 회전 행렬을 간단히 되돌아봅시다. x-축을 중심으로 시각적으로 회전 행렬을 연역해 보겠습니다. 먼저, 아래에 나타난 yz-평면 위에 있는 지점 P를 포함하는 좌표 시스템을 고려해 봅시다.

<div class="content-ad"></div>

이 점의 좌표를 각 φ와 원점으로부터의 길이 r의 관점에서 표현할 수 있습니다. 이제 x-축을 기준으로 각 θ만큼 양의 회전을 적용한 좌표 시스템을 살펴보세요.

![이미지](/assets/img/2024-06-20-ExtrinsicintrinsicrotationDoImultiplyfromrightorleft_1.png)

우리는 새로운 점을 각 φ + θ와 r로 표현할 수 있으며, 삼각함수의 각의 합 공식을 사용하여 최종적으로 다음을 얻을 수 있습니다:

![이미지](/assets/img/2024-06-20-ExtrinsicintrinsicrotationDoImultiplyfromrightorleft_2.png)

<div class="content-ad"></div>

Tada! 저희는 x-축 주위의 회전을 위한 회전 행렬을 유도했어요. 다른 회전 행렬들(횡축 및 z-축에 대한)도 비슷한 방식으로 유도할 수 있어요.

# 외적 및 내적 회전

저희의 회전 행렬 두 개를 곱하면 이 두 회전을 결합한 행렬이 나와요. 발생하는 질문은 두 번째, 세 번째, … 회전이 모두 전역 좌표계(외적)를 참조하는지 다음으로 회전한 좌표계를 참조하는지예요. 명확하게 설명하자면:

- 외적: 모든 회전은 고정된/전역 좌표계 xyz를 참조해요
- 내적: 회전은 마지막으로 회전한 좌표계를 참조해요(첫 번째 회전은 원래/전역 좌표계를 참조해 시작돼요)

<div class="content-ad"></div>

비행기를 예로 들어보겠습니다. 이 비행기는 세 축 중 하나를 기준으로 회전할 수 있습니다. 각도에 그리스 문자 대신에 일반적으로 사용되는 관행은 (항공기 규정 DIN 9300) "yaw", "pitch", "roll" 각도라고 부르는 것입니다.

![이미지](/assets/img/2024-06-20-ExtrinsicintrinsicrotationDoImultiplyfromrightorleft_3.png)

이러한 원소 회전을 연쇄적으로 수행해 봅시다. 먼저, 비행기를 양 방향으로 (오른쪽으로) 90° 회전한 다음, 양 방향으로 (위쪽으로) 45° 기울이고, 마지막으로 양 방향으로 (오른쪽으로) 180° 회전해 봅시다.

![이미지](https://miro.medium.com/v2/resize:fit:1400/1*CBfA04_aHFke0VbY5VQmtw.gif)

<div class="content-ad"></div>

파란색으로 표시된 회전된 프레임입니다. 처음에는 빨간색으로 표시된 전역 좌표 시스템과 정렬되어 있습니다. 90°의 요(Yaw) 이후 회전된 파란색 프레임에 45°의 피치(Pitch)가 적용되며 빨간색 프레임에는 적용되지 않습니다. 따라서 이 회전 순서는 내부적입니다. 종종 원래 z-축을 중심으로, 새로운 y-축, 마지막으로 새로운 x-축 주변으로 회전하므로 z-y’-x’’로 표시됩니다. 우리는 전역 좌표 시스템의 기저를 구성하는 단위 벡터가 모두 세 가지 회전을 적용한 후 어디에 도달하는지 살펴봄으로써 결과적인 회전 행렬을 쉽게 유도할 수 있습니다.

우리는 우리의 비행기에 부착된 몸(비행기)에 연결된 XYZ 좌표계, 또한 바디 프레임이라고도 불리는 XYZ 좌표계로 글로벌/월드 좌표계 xyz를 변환했습니다. 새로운 Y 단위 벡터는 이전 x 단위 벡터의 위치에 놓였으므로 회전 행렬의 열은 (1, 0, 0)로 읽힙니다. X는 이전 y- 및 z-벡터의 배수로 구성됩니다. X가 위쪽을 향하고 있으므로 빨간색 z-축을 음의 방향으로 따라가고 동일한 양만큼 양의 y-방향으로 이동하여 새로운 파란색 X-벡터의 위치에 도착합니다. 45°의 피치로 인한 이 회전의 삼각함수인 사인과 코사인은 √2/2이므로 이 계수는 45° 피치에 대한 것입니다. Z에 대한 마지막 열도 동일하게 추론할 수 있습니다 (해당 부분은 여러분들께 맡깁니다).

단위 벡터의 최종 위치를 살펴보는 대신 회전 행렬을 사용하여 R을 어떻게 계산합니까? 선형 변환(행렬로 표시)을 곱셈을 통해 연결합니다. 행렬 곱셈은 교환법칙이 성립하지 않으므로 원소 회전을 어떤 순서로 곱하는 지에 따라 달라집니다. 회전 행렬을 알기 때문에 직접 시도할 수 있습니다. 위에서 보신 올바른 회전 행렬을 얻으려면 다음과 같은 순서의 피연산자만이 올바른 회전 행렬을 얻게 됩니다.

<div class="content-ad"></div>

![이미지](/assets/img/2024-06-20-ExtrinsicintrinsicrotationDoImultiplyfromrightorleft_5.png)

마침내, 왜 이런 일이 발생하는지에 대한 답변을 드리겠습니다. 그 동안 손으로 곱셈을 계산하여 이 계산이 올바른지 확인할 수 있습니다.

이제 비행기를 이전과 정확히 같은 위치에 놓는 대응하는 외적 회전 순서를 살펴보겠습니다. 그러나, 각 원소 회전 후에 방향을 변경하는 본문(blue) 주변 회전 대신, 이제 언제나 고정된/전역/세계 좌표계(red)에 대해 회전합니다.

![이미지](https://miro.medium.com/v2/resize:fit:1400/1*rs5Q-gfo72NAMlykfcxDWA.gif)

<div class="content-ad"></div>

비행기의 최종 위치는 이전과 정확히 같습니다! 따라서 회전 행렬 R도 동일하게 유지되었다고 추론할 수 있습니다. 그러나 여기에 이르기 위해 우리의 단계 순서가 변경되었습니다: z-y’-x’’ 회전 순서 대신 x-y-z (Roll-Pitch-Yaw) 회전 순서를 사용하여, 우리는 먼저 롤(전역 x 축 주위의 회전), 그다음 피치(전역 y 축 주위의 회전)을 가하고 마지막으로 요(전역 z 축 주위의 회전)을 가했습니다. 언제나 전역 좌표계 xyz를 참조한다는 점을 나타내는 프라임 기호의 부재에 주목하십시오. 이 고정된 프레임에서 생각해보면, 이제 곱셈의 순서는 무엇입니까? 음... 다시 한 번,

![image](/assets/img/2024-06-20-ExtrinsicintrinsicrotationDoImultiplyfromrightorleft_6.png)

세 가지 회전을 모두 결합하는 원하는 회전 행렬을 생성하는 유일한 행렬의 순서입니다. 그렇다면 큰 문제가 무엇입니까? 두 가지 계산 사이의 차이점을 요약할 때 혼란이 발생할 수 있습니다:

- 내적 예시: Yaw-Pitch’-Roll’’ (z-y’-x’’), 즉,
1) 전역 z 축을 중심으로 회전
2) 새로운 y’ 축을 중심으로 회전
3) 새로운 x’’ 축을 중심으로 회전
행렬 곱셈: R = 회전1 ⋅ 회전2 ⋅ 회전3
- 외적 예시: Roll-Pitch-Yaw (x-y-z), 즉,
1) 전역 x 축을 중심으로 회전
2) 전역 y 축을 중심으로 회전
3) 전역 z 축을 중심으로 회전
행렬 곱셈: R = 회전3 ⋅ 회전2 ⋅ 회전1

<div class="content-ad"></div>

우리는 처음의 좌표 시스템 xyz를 새롭게 회전된 시스템 XYZ로 변환하는 단계의 순서와 행렬 곱셈의 인자 순서를 모두 바꿨습니다. 그래서 우리가 동일한 회전 행렬 R을 얻는 이유입니다. 우리는 고정된 기준 프레임 주위로 여러 번 회전하거나 각 회전마다 변하는 프레임에 대해 이야기합니다. 개인적으로 '왼쪽에서 곱하기 또는 오른쪽에서 곱하기' 표현에 대해 의심스러운데, 하지만 당신이 요구한다면, 내재적 회전 순서의 경우에는 왼쪽에서 오른쪽으로 곱하고, 외재적 경우에는 오른쪽에서 왼쪽으로 곱한다고 결론 짓을 수 있을 것입니다.

# 보너스: 왜 인자의 순서가 이렇게 되는 걸까요?

이러한 이중성을 활용하여 동일한 목표에 도달할 수 있다는 것은 상당히 놀라운 일입니다. 지금까지 우리는 계산을 통해 행렬 곱셈을 위한 순서를 동기부여했으며, "다른 방법으로는 작동하지 않기 때문에"입니다. 여기서 다시 한 번 더 자세히 살펴보겠습니다.

외재적 경우는 행렬 곱셈에서 오른쪽에서 왼쪽으로 읽는 “보통” 케이스처럼 보이어야 합니다. 이는 이 회전 행렬로 점을 변환하려고 시도할 때 명확해집니다:

<div class="content-ad"></div>


![](/assets/img/2024-06-20-ExtrinsicintrinsicrotationDoImultiplyfromrightorleft_7.png)

우리는 처음에 Rotation1 행렬을 사용하여 원래의 전역 좌표계를 회전합니다. 그런 다음, Rotation2 행렬을 사용하여 결과 좌표계를 회전하고 마지막으로 세 번째 회전 행렬을 사용합니다. 물론, 행렬 곱셈은 가교적이기 때문에 괄호는 그저 명확하게 문장을 만들기 위함입니다: 점을 변환하려면 오른쪽에서 왼쪽으로 읽고 따라서 먼저 Rotation1을 적용한 다음 Rotation2, 마지막으로 Rotation3을 적용합니다. 이에 대해 불확실함을 느끼신다면, 꼭 3Blue1Brown의 이 비디오를 확인하십시오.

그래서 외적 인 경우 (R=Rotation3⋅Rotation2⋅Rotation1)은 이해하기 쉬워야 합니다. 그렇다면 모두 일어나는 내재적 회전 순서는 어떨까요? 모든 것이 반대로 진행되는 과정입니다: R = Rotation1⋅Rotation2⋅Rotation3. 점을 변환한다면, 먼저 Rotation3을 적용한 다음 Rotation2, 그리고 Rotation1을 적용하여 변환된 점 P'를 얻게 됩니다. 이것은 내재적 회전 순서에 정의된 단계 순서와 모순이 있는 것으로 보입니다. 이 혼동을 해소하기 위해, 우리는 점 P의 좌표를 명시하고 있는 좌표계에 대해 명확히 지정해야 합니다. 다음의 새로운 구문을 도입합니다.

![](/assets/img/2024-06-20-ExtrinsicintrinsicrotationDoImultiplyfromrightorleft_8.png)


<div class="content-ad"></div>

여기서는 원래 좌표계를 기준으로 한 점 P의 좌표를 나타냅니다. 다음 표현은 좌표계 A의 원래 좌표계에 대한 방향을 설명합니다. 다시 말해, 행렬 R은 원래 단위 벡터에 대한 좌표계 A의 해당 단위 벡터의 위치를 나타냅니다. 이를 실제로 확인하기 위해 원점 (1, 0, 0)을 z-축을 기준으로 +45°로 회전해 보겠습니다.

<div class="content-ad"></div>

P₂ 점은 원래 좌표계와 새롭게 회전된 파란색 좌표계 A와 관련하여 두 가지로 나타낼 수 있습니다. 핵심은 A에 따른 P₂가 원래 좌표계에 따른 P₁과 동일한 좌표를 가진다는 점입니다. 따라서 우리가 A에 따른 P₂(1,0,0)에 회전 행렬 R을 적용하면 원래 좌표계에 대한 동일한 점인 (√2/2, √2/2, 0)을 가져옵니다. 이렇게 하면 P₂의 좌표를 A 프레임에서 원래 프레임으로 "변환"합니다. 이 개념은 매우 중요하기 때문에 실제로 보여드리겠습니다.

![image](/assets/img/2024-06-20-ExtrinsicintrinsicrotationDoImultiplyfromrightorleft_11.png)

이것은 우리가 점을 변환할 때 행렬 R의 구축과 실제 적용을 분리해야 하는 이유를 강조합니다.

- 왼쪽 경로 — 행렬 R의 구축: 원래 좌표계를 좌표계 A로 회전합니다. 이렇게 하면 P₁이 P₂로 회전됩니다.
- 오른쪽 경로 — 행렬 R의 적용: 좌표계 A에 따른 점이 주어지면 해당 좌표를 원래 좌표계로 "변환"할 수 있으며, 이는 원래 좌표계를 A로 회전하여 만든 동일한 행렬과 곱셈을 통해 수행합니다. 이것이 내재적 회전 순서에 대한 모든 "역순-역반전-머리가 엉켜버리는-곱셈"이 나오는 곳입니다. 오른쪽 경로는 다음과 같은 공식을 제공합니다. A가 아래첨자로 "소거"되는 것을 볼 수 있습니다.

<div class="content-ad"></div>

<img src="/assets/img/2024-06-20-ExtrinsicintrinsicrotationDoImultiplyfromrightorleft_12.png" />

마지막으로, 모든 것을 함께 살펴봅시다. 새로운 구문을 사용하여 회전 체인을 실제로 보겠습니다. 우리는 z축을 중심으로 45도 회전한 다음 z'축(우연히 z축과 일치하는)을 중심으로 다시 45도 회전합니다.

<img src="/assets/img/2024-06-20-ExtrinsicintrinsicrotationDoImultiplyfromrightorleft_13.png" />

다시 각 회전 행렬의 역할을 설명해 보겠습니다.

<div class="content-ad"></div>


![image](/assets/img/2024-06-20-ExtrinsicintrinsicrotationDoImultiplyfromrightorleft_14.png)

그래서, 이게 우리에게 무엇을 말해주고 있는 걸까요? 다음 연습을 상상해보세요: 원래 좌표계 xyz가 있고 이것을 z축을 중심으로 45도 회전하여 좌표계 A를 얻는다고 합시다. 그런 다음 A를 중심으로(z축을 중심으로) 다시 45도 회전하여 좌표계 B를 얻습니다. 여러분의 역할은 B를 기준으로 한 점이 주어졌을 때, 그 점이 원래 좌표계에 대해 어떤 좌표를 갖는지 찾는 것입니다.

이 문제를 어떻게 해결할까요? 그래프를 보시죠. 우리는 우하단 코너에 B를 기준으로 한 점을 볼 수 있습니다. 그 점을 원래 좌표로 "변환"하는 것은 어떻게 할까요? 간단히 변환되는 과정을 따라가면 됩니다. 먼저, B가 A에 대해 어디에 있는지를 정의하는 회전 행렬과 곱합니다. 이렇게 하면 P₃가 A에 대해 어느 위치에 있는지 알 수 있습니다. 그런 다음, A가 원래 좌표계에 대해 어디에 있는지를 정의하는 회전 행렬과 곱합니다. 이렇게 하면 P₃가 원래 좌표계에 대해 어느 위치에 있는지 알 수 있습니다. 이게 전부입니다.

![image](/assets/img/2024-06-20-ExtrinsicintrinsicrotationDoImultiplyfromrightorleft_15.png)


<div class="content-ad"></div>

이제, 이를 첫 번째 절반에서 한 작업과 비교해 보세요. 이 두 회전을 결합하는 회전 행렬을 어떻게 구성할까요 (내재)? 좌표 시스템이 어디로 이동하는지 따라가면서 시작점은 원래의 좌표 시스템 xyz이고 종착점은 회전된 시스템 XYZ입니다. 그 과정에서 위의 공식에서 볼 수 있는 대로 행렬을 왼쪽에서 오른쪽으로 연결하세요. 이 행렬을 적용할 때 이를 통해 마치 B에서 "얽힌" 후 A로 이동한 다음 원래의 좌표 시스템으로 돌아온 것처럼 됩니다.

외재 경우에는 어떤가요? 행렬 곱셈은 동일하게 유지됩니다. 오른쪽(첫 번째 회전)에서 왼쪽(마지막 회전)으로 읽습니다. 그러나 내재 회전 순서와는 대조적으로 어떤 것을 "얽혀 푸는(unwind)" 것이 필요하지 않습니다. 따라서 첫번째 단계는 원래의 좌표 시스템에서 A로 가는 것이며, 그 다음은 A에서 B로 가는 것입니다. 행렬 곱셈에서, 첫 번째 단계가 가장 오른쪽에 있고, 다음 단계가 왼쪽에 위치합니다. 따라서 여기서는 행렬을 오른쪽에서 왼쪽으로 연결합니다. 이것이 차이점입니다.

![image](/assets/img/2024-06-20-ExtrinsicintrinsicrotationDoImultiplyfromrightorleft_16.png)

# 마무리

<div class="content-ad"></div>

이 포스트에서는 먼저 x축을 중심으로 회전하는 회전 행렬의 유도를 포함한 회전 행렬을 다시 상기했습니다. 그런 다음 비공변 및 내적 회전을 비행기를 통해 비교하고 그들의 이중성을 이해했습니다. 마지막으로, 행렬을 함께 곱할 때 순서가 왜 그렇게 되는지에 대한 질문에 대답하기 위해 더 깊이 들어갔습니다.

이 모든 것 뒤에 있는 수학은 비교적 쉬운 편이지만, 여러분격 및 수식의 개념을 파악하고 다양한 참조 시스템으로 생각하는 것은 다소 어렵습니다. 저는 그래픽을 디자인할 때 아래첨자 및 위첨자로 많은 실수를 저질렀으며 많은 어려움을 겪었습니다. 아마도 모든 실수를 없앴을 것입니다만, 아마도 아니겠죠. 그래서 오류를 발견하신 경우 얼마든지 댓글을 남겨 주시면 기쁘게 수정하겠습니다. 여러분에게 몇 가지 사항을 명확히 하고 선형 대수의 흥미로운 응용에 대한 더 나은 직관을 제공했기를 바랍니다.

YouTube 음악 채널 | 웹사이트 | GitHub