---
title: "차이인차이 101"
description: ""
coverImage: "/assets/img/2024-05-27-Difference-in-Difference101_0.png"
date: 2024-05-27 14:54
ogImage:
  url: /assets/img/2024-05-27-Difference-in-Difference101_0.png
tag: Tech
originalTitle: "Difference-in-Difference 101"
link: "https://medium.com/towards-data-science/difference-in-difference-101-9424cb403f9e"
---

차이인차이(DiD 또는 DD 또는 diff-in-diff)는 무엇인가요? 왜 차이인차이에 관심이 있나요? 오늘은 정책 효과를 연구하는 경제학에서 가장 인기 있는 방법 중 하나에 대한 모든 질문에 답할 거예요.

DiD는 처리 그룹과 대조 그룹 간의 시간에 따른 결과 변화를 비교하여 인과 관계를 추정하는 널리 사용되는 경제학 기법입니다. 처리 그룹과 대조 그룹이 무엇인지에 대한 문제가 있어요. 처리는 정책 또는 변경로 인해 특정 그룹에 영향을 미치는 정책 개입을 말해요. 대조는 개입을 받지 않은 그룹을 말해요. 인과 관계란 원인과 결과의 관계를 의미해요.

우리는 이 방법에 관심을 갖는 이유는 무작위 실험이 불가능한 경우에 정책 변경이나 개입의 효과를 평가하는 데 유용하기 때문이에요. 즉, 때때로 실험은 특정 그룹에 집중되므로 처리를 받은 사람들이 무작위가 아니라는 것을 의미해요. DiD는 무작위화 없이도 개입의 영향을 분리하는 데 도움이 될 거예요.

<div class="content-ad"></div>

이 기사는 개념, 가정, 구현 및 예시 등에 대해 다룰 것입니다.

# DiD란

우리의 연구 질문은: 치료 D가 결과 y에 미치는 영향이 무엇인가요? DiD는 우리에게 치료 그룹이 개입되지 않았다면 치료 그룹에 무슨 일이 일어났을지를 추정할 수 있도록 해줍니다. 이 대역사적 시나리오는 치료의 실제 효과를 이해하는 데 중요합니다. 모든 직업이나 업무는 경제적 성장과 관련하여 세금 인하의 영향을 평가합니다. 또한 공공 정책 분야에서는 새 교통 법규가 사고 발생률에 미치는 영향을 평가합니다. 마케팅에서 DiD는 광고 캠페인이 매출에 미치는 영향을 분석합니다.

![이미지](/assets/img/2024-05-27-Difference-in-Difference101_1.png)

<div class="content-ad"></div>

위 다이어그램을 예로 들어보면 샘플에서 인구 데이터가 있습니다. 여기서는 처리군과 대조군으로 데이터를 나누고 처리군은 개입을 받았습니다. 두 그룹 모두 후기와 전기 변수를 관찰할 수 있습니다.

# DiD 방법

## 간단한 처리/대조 차이 추정기

![DiD 다이어그램](/assets/img/2024-05-27-Difference-in-Difference101_2.png)

<div class="content-ad"></div>

이 방정식은 치료와 대조 그룹 간의 시간 경과에 따른 결과 변화를 비교하여 치료 효과를 계산할 것입니다.

수학을 이해하는 데 도움이 되기 위해 가짜 예제를 만들었습니다.

![다면적 효과](/assets/img/2024-05-27-Difference-in-Difference101_3.png)

위에서 언급한 공식을 사용하면 DiD 계수는 9가 될 것입니다.

<div class="content-ad"></div>

## DiD Estimator: 회귀분석을 사용한 계산

DiD는 처리 효과의 추정을 편향시킬 수 있는 시간 불변 특성을 제어하는 데 도움을 줍니다. 이는 시간이 지남에 따라 일정한 변수(예: 지리적 위치, 성별, 인종, 타고난 능력 등)의 영향을 제거한다는 것을 의미합니다. 그 이유는 이러한 특성이 각 그룹에 대해 전·후 처리 기간 모두 동일하게 영향을 미치기 때문입니다.

기본 DiD 모델의 핵심 방정식은 다음과 같습니다:

![DiD equation](/assets/img/2024-05-27-Difference-in-Difference101_4.png)

<div class="content-ad"></div>

여기서:

- y는 𝑡시간에 그룹 j의 개인 i의 결과 변수입니다.
- 𝐴𝑓𝑡𝑒𝑟은 관측이 사후 처리 기간에 속하는 경우 1과 같은 더미 변수입니다.
- 𝑇𝑟𝑒𝑎𝑡𝑚𝑒𝑛𝑡은 관측이 처리 그룹에 속하는 경우 1과 같은 더미 변수입니다.
- 𝐴𝑓𝑡𝑒𝑟 × 𝑇𝑟𝑒𝑎𝑡𝑚𝑒𝑛𝑡은 상호 작용 항이며, 계수 β는 DiD 추정량을 캡처합니다.

상호 작용 항의 계수는 y에서 DiD 추정량입니다. 회귀 분석은 추가 변수의 표준 오차를 제공하고 제어하는 데 도움이 되기 때문에 연구자들 사이에서 더 인기가 있습니다.

# 평행 추세 가정

<div class="content-ad"></div>

DiD에 대한 주요 가정 중 하나입니다. 이것은 치료가 없을 때 치료 그룹과 대조 그룹 간의 차이가 시간이 지남에 따라 일정하게 유지될 것이라는 생각에 기반을 두고 있습니다. 다시 말해, 치료가 없을 때 β (DiD 추정치)=0입니다.

형식적으로, 이는 다음을 의미합니다:


| Time        | Treatment Group | Control Group  | Difference   |
|-------------|-----------------|----------------|--------------|
| Before      | Y1              | Y0             | Y1 - Y0      |
| After       | Y3              | Y2             | Y3 - Y2      |
| DiD Estimate| (Y1 - Y0) - (Y3 - Y2)                    |


또 다른 관점은 정책 변경이 없었을 때 두 그룹 간의 차이가 정책 변경 없이도 시간이 지남에 따라 동일하게 유지되었을 것이라는 것입니다. 치료 전에 추세가 평행하지 않으면 DiD 추정치가 편향될 수 있습니다.

<div class="content-ad"></div>

## 이 가정을 확인하는 방법

그렇다면 다음 질문은: 어떻게 확인하는 걸까요? 평행 추세 가정의 타당성은 그래픽 분석과 플라시보 테스트를 통해 평가할 수 있습니다.

![그림](/assets/img/2024-05-27-Difference-in-Difference101_6.png)

이 가정은 치료가 적용되지 않은 경우 치료 그룹(주황색 선)과 대조 그룹(파란 점선)이 시간이 지남에 따라 평행한 경로를 따를 것이라는 것입니다. 치료(수직 선)는 치료가 적용되는 지점을 나타내며, 치료 전후에 두 그룹 간의 추세 차이를 비교하여 치료 효과를 추정할 수 있게 합니다.

<div class="content-ad"></div>

## 평행 추세 가정을 위반하는 예시

간단히 말해서, 우리는 치료에서 두 가지를 찾습니다:

- 기울기의 변화

![image](/assets/img/2024-05-27-Difference-in-Difference101_7.png)

<div class="content-ad"></div>


![image](/assets/img/2024-05-27-Difference-in-Difference101_8.png)

위 두 경우 모두 평행한 추세 가정이 만족되지 않습니다. 치료 그룹 결과는 통제 그룹 결과보다 더 빨리 성장하거나(part a) 더 느리게 성장합니다(part b). 이를 수학적으로 표현하면 다음과 같습니다:

DiD = 실제 효과 + 차이 추세 (차이 추세는 0이어야 함)

차이 추세는 양수 (part a) 또는 음수 (part b)일 수 있습니다.


<div class="content-ad"></div>

DiD는 우리가 그것에 대한 차별적인 경향을 가지고 있기 때문에 개입의 영향을 분리할 수 없을 것입니다.

2. 개입 이후의 치료 라인에서의 점프(상승 또는 하락)

![image](/assets/img/2024-05-27-Difference-in-Difference101_9.png)

위의 이미지에서 처리 그룹의 경향이 통제 그룹의 경향과 다르게 변경되어, 개입 없이 일정하게 유지되어야 했던 것과 다릅니다. DiD 연구에서는 점프가 허용되지 않습니다.

<div class="content-ad"></div>

# Placebo Tests

Placebo 테스트는 관측된 치료 효과가 실제로 치료로 인한 것이 아니라 다른 혼재 요소로 인한 것인지 확인하는 데 사용됩니다. 이는 치료 효과가 예상되지 않는 기간이나 그룹에 동일한 분석을 적용하는 것을 포함합니다. 이러한 플레이스보 테스트에서 유의한 효과가 발견되면, 원래 결과가 잘못된 것일 가능성이 있습니다.

예를 들어, 2019년에 고등학교에 알약을 제공하는 개입 연구가 수행되었습니다. 우리는 플레이스보 테스트를 수행할 수 있어서 2017년이라는 가짜 개입 연도를 만들 수 있습니다. 여기서는 정책 변경이 발생하지 않았다는 것을 알고 있습니다. 플레이스보 날짜 (2017년)에 치료 효과 분석을 적용해도 유의미한 변화가 없는 경우, 2019년에 관측된 효과가 (있는 경우) 실제 정책 개입으로 인한 것일 가능성이 높습니다.

# Extensions and Variations of DiD

<div class="content-ad"></div>

- 이벤트 스터디 DiD: 연도별 처리 효과를 추정하여 처리 효과의 타이밍을 평가하고 사전 추세를 확인하는 데 유용합니다. 이 모델은 연도별 처리 효과를 다양하게 설정할 수 있습니다. 우리는 t+1, t+2, ..., t+n 시점에서 효과를 연구할 수 있습니다.
- 합성 대조법(SCM): SCM은 여러 비치료 단위에 가중치를 부여하여 치료 전 특성을 근사하는 합성 대조 그룹을 구성합니다. 이 방법은 단일 처리 단위와 비치료 단위 집단을 비교할 때 특히 유용합니다. 여러 단위의 정보를 결합하여 믿을 수 있는 대조 사실을 제시합니다.

이외에도 많은 방법이 있지만, 여기서는 두 가지만 소개하겠습니다. 나중에 더 자세히 설명하는 글을 쓸 수도 있겠네요.

# 결론

본 글에서는 평균 처리 효과를 추정하는 인기 있는 방법인 Difference-in-Differences (DiD) 추정기법을 분석했습니다. DiD는 처리 및 통제 그룹 간 시간 경과에 따른 변화를 비교함으로써 정책 효과를 연구하는 데 널리 사용됩니다. DiD의 주요 장점은 시간이 지남에 따라 일정하게 유지되는 관측되지 않은 혼입변수를 통제하여 개입의 실제 영향을 분리할 수 있는 능력입니다.

<div class="content-ad"></div>

우리는 평행 추세 가정, 전처리 데이터의 중요성, 그리고 시각적 분석과 장소보 테스트를 사용하여 가정 위반을 확인하는 방법과 같은 주요 개념을 탐구했습니다. 게다가, 이원차 차이-DiD의 확장과 변형인 이벤트 스터디 DiD 및 합성 통제 방법에 대해 이야기했는데, 이는 다양한 시나리오에서 추가 통찰력과 견고성을 제공합니다.

# 참고문헌 및 추가 자료

[1] Wing, C., Simon, K., & Bello-Gomez, R. A. (2018). 차이-DiD 연구 설계: 공공 보건 정책 연구를 위한 모범 사례. 공공 보건 연례 보고서, 39, 453–469.

[2] Callaway, B., & Sant’Anna, P. H. (2021). 다중 시간 기간을 갖는 차이-차이 방법. 계량경제학 잡지, 225(2), 200–230.

<div class="content-ad"></div>

[3] Donald, S. G., & Lang, K. (2007). Inference with difference-in-differences and other panel data. The review of Economics and Statistics, 89(2), 221–233.

## 읽어 주셔서 감사합니다!

읽어 주셔서 감사합니다! 🤗 만약 이 게시물을 즐겼고 더 많은 것을 보고 싶다면 팔로우해주세요. 또한 LinkedIn에서도 팔로우할 수 있습니다. 인과 추론 및 데이터 분석에 관한 블로그를 쓸 계획이며, 항상 단순하게 유지하려고 노력합니다.

소소한 주의: 학습을 위해 쓰기 때문에 최선을 다하겠지만 실수가 발생할 수 있습니다. 오류를 발견하시면 알려주세요. 또한 새로운 주제에 대한 제안을 환영합니다!
