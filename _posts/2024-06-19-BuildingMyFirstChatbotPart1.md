---
title: "나의 첫 번째 챗봇 만들기 - 파트 1"
description: ""
coverImage: "/assets/img/2024-06-19-BuildingMyFirstChatbotPart1_0.png"
date: 2024-06-19 02:05
ogImage: 
  url: /assets/img/2024-06-19-BuildingMyFirstChatbotPart1_0.png
tag: Tech
originalTitle: "Building My First Chatbot — Part 1"
link: "https://medium.com/@aleksmilanov/building-my-first-chatbot-part-1-b27534e98bae"
---


![2024-06-19-BuildingMyFirstChatbotPart1_0.png](/assets/img/2024-06-19-BuildingMyFirstChatbotPart1_0.png)

안녕하세요!

먼저, 제 소개를 좀 해 드릴게요...

전 독립적인 경영 컨설턴트로서, 주요 프로젝트와 프로그램을 감독하는 전문가입니다. 제 전문성은 변화와 전환을 촉진하며, 복잡한 전환을 통해 조직이 전략적 목표를 달성할 수 있도록 도와주는 데에 있습니다.

업무 외적으로는 기술의 내부 작동 방식을 이해하는 데에 열정이 큽니다. 이를 토대로 약 10년 전 소비자 중심의 홈 자동화 솔루션을 실현하기 위한 여정을 시작했습니다. 이 탐구는 많은 길을 걸어가게 했고, 결과적으로 처음 선택한 제품에 만족하지 못했음을 깨달았습니다. 또 다른 소비자 제품/생태계를 시도해볼지 (제거하기가 매우 어려웠던 것으로 입증된) 또는 완전히 오픈소스 솔루션으로 전환할지 선택해야 했습니다.

<div class="content-ad"></div>

요기에는 전문 소프트웨어 개발자가 아니라는 점을 강조하고 싶습니다. 과거에는 VBA를 스스로 가르쳤지만 주 업무는 아니었습니다. 소비자 시스템을 구현한 후에는 화려한 비디오와 마케팅 자료에서 약속된 것을 받기 위해 LUA를 배워야 했으며, 그 과정에서 홈 오토메이션 및 디바이스 통합에 대한 새로운 개념들을 배워야 했는데, 그런 부분들은 처음 스스로 자동화된 집을 구축하겠다는 결심을 한 때 상상하지 못한 일이었습니다.

그럼에도 불구하고, 이 모든 것은 미래에 올 일에 대한 준비를 해준 것은 아니었습니다. 장황한 이야기를 짧게 줄이자면, 오픈 소스 커뮤니티의 몇몇 믿기 힘들 정말 멋진 사람들의 도움과 GPT 이전에 많은 시간을 투자하여 인터넷을 검색하고 기사를 읽고 비디오를 시청하며 끈질긴 노력을 통해 고집이 센 끝에 (적어도 내 마음 속에서) 당시 무서웠고 알 수 없던 오픈 소스 세계에 발을 들이게 되었습니다.

하지만 아주 빨리, 내 마음을 괴롭힌 안정성 및 기능의 빈약함에 대한 두려움은 사라지고, 그때 그때 조금씩 밝고 밝은 세계가 여기 오픈 소스 커뮤니티 안에 있다는 것을 깨닫게 되었습니다!

그 깨달음 이후, 저는 오픈 소스를 기반으로 완전히 자동화된 집을 구축하였고, 지팡이를 휘둘러 가리킬 수 있는 모든 기술, 도구, 제품 등을 활용했지만, 어쨌든 리스트를 만들어보겠습니다. 그런데, 우선, 이 모든 것이 무슨 의미인지 한 번 살펴볼까요?

<div class="content-ad"></div>

한 가정에 300대 이상의 연결된 장치가 있으며 중요한 기능은 다음과 같습니다:

- 자동 조명 (70개 이상 회로)
- 자동 난방 (20개 이상 구역)
- 자동 오디오 (10개 이상 구역)

더 나아가 통합된 장치에는 Sonos, 커튼, 블라인드, 창문, 천창, 경보판, 보안 카메라 등이 포함됩니다.

그리고 소프트웨어 통합에는 Open Weather Map, Pushover, Alexa, Google 캘린더, 사진 및 비디오 프레임을 Samba 파일 서버에, 음성 인식 (STT), 텍스트 음성 변환 (TTS) 등이 포함됩니다.

<div class="content-ad"></div>

매우 많은 종류의 센서가 있습니다: 움직임, 존재, 온도, 조도, 습도 및 공기 품질을 감지하는 센서가 있습니다.

이 모든 것을 실행하고 상호 작용하기 위해 필요한 모든 하드웨어가 있습니다: 유형 1 하이퍼바이저를 사용하여 물리적 및 가상 Debian 서버, 라즈베리 파이, Windows PC, 모바일 폰, 태블릿, WAP, 터치스크린, 스마트 TV, Synology NAS 등이 있습니다.

<img src="/assets/img/2024-06-19-BuildingMyFirstChatbotPart1_1.png" />

마지막으로, 도구 및 소프트웨어로 돌아가기 위해 다음과 같이 요약할 수 있습니다:

<div class="content-ad"></div>

- VueJS (프론트엔드)
- Ionic Vue 및 Android Studio (모바일)
- NuxtJS (프론트엔드)
- Node-Red (백엔드)
- Z-Wave를 통한 nr-zwave-js
- Z-Wave Zniffer (자동화 장치/모듈)
- Zigbee를 통한 zigbee2mqtt (자동화 장치/모듈)
- Mosquitto 서버 (장치 및 다른 프론트엔드에서 백엔드 메시지 전송)
- Debian을 사용하여 주요 허브를 포함한 여러 서버에 대한 운영
- 대시보드/UI에 액세스하는 22인치 터치스크린 패널을 실행하고 스포크 자동화 서버용으로 Raspbian 32비트 및 64비트 사용
- 이벤트용 Influx DB (연도당 약 15 ~ 20 백만 건의 이벤트 기록)
- 대시보드용 Grafana
- Samba 파일 서버 및 HTTP/HTTPS 리디렉션을 위한 Nginx
- SQLite DB 등, ...

시스템은 주로 자체적으로 작동하지만 대시보드에 액세스하거나 다양한 특정 작업용 모바일 앱을 통해 상호 작용할 수 있습니다.

배경 내용을 마치자면, 제가 떠올린 아이디어에 대해 이야기해보겠습니다... 나만의 챗봇을 만들 수 있을까요?

# 나만의 첫 번째 챗봇 만들기
Part 1 — 간단한 챗봇 만들기

<div class="content-ad"></div>

<img src="/assets/img/2024-06-19-BuildingMyFirstChatbotPart1_2.png" />

요즘 우리를 휩쓸고 있는 인공지능에 대한 모든 환호 때문에, 나는 기존의 오픈소스 홈 오토메이션 프로젝트를 확장하여 ChatGPT를 통합하기로 결정했어. 이 여정은 여러 가지 도전과 발견을 거쳐, 최종적으로 가족을 위한 챗봇을 만드는데 영감을 주는데 이르렀어. 기본 아이디어부터 시작해 가족을 위해 흥미로운 사실을 제공하는 대화형 UI를 갖춘 간단한 챗봇을 만들 수 있을까? 

이 시리즈의 포스트에서는 나의 경험을 따라가며, 시간이 지남에 따라 어떻게 기대가 변화되었는지 그리고 그 과정에서 한 흥미로운 발견들을 살펴볼 거야.

# 시작하기

<div class="content-ad"></div>

![2024-06-19-BuildingMyFirstChatbotPart1_3](/assets/img/2024-06-19-BuildingMyFirstChatbotPart1_3.png)

개발 환경은 이미 설정되어 있었습니다. 모든 세부 정보에 대해 자세히 설명하지는 않겠습니다 (이 프로젝트는 어느 정도의 경험이 필요합니다), 기본 사항을 개요할 거에요. 기본 프로그래밍 기술을 사용하여 Node-Red를 사용하고, 주로 JavaScript를 중심으로 한 노하우를 가지고 있으면, 커피를 몇 잔 마신 상태에서 Node-Red 대시보드 노드를 사용하여 자체 챗봇을 설정할 수 있어요.

내 환경은 미니 PC에서 실행되는 Debian을 중심으로 구성되어 있습니다. Node-Red는 백엔드로 설치되어 있고, VueJS를 사용하여 구축된 웹 앱이 있습니다. Node-Red에 대해 들어보지 못했다면 여기서 확인해보세요. 간결한 그래픽 UI를 통해 거의 모든 것에 연결할 수 있는 능력 때문에 권장하는 바입니다. 동시에 매우 강력하고 효율적이며 안정적입니다. VueJS도 마찬가지로 초보자에게는 조금 도전적이지만, 다른 일반적으로 사용되는 프런트 엔드보다 초기에 더 많은 투자를 요구하는 프런트 엔드와는 비교적 쉽게 개발 환경을 설정하고 시작할 수 있습니다. VueJS가 제 모든 요구를 충족했기 때문에 더 이상 찾아보지 않아도 되었어요.

# Open AI API에 연결하기

<div class="content-ad"></div>

<img src="/assets/img/2024-06-19-BuildingMyFirstChatbotPart1_4.png" />

첫 번째 단계는 개발자 계정을 만들고 Open AI에 연결하기 위해 필요한 중요한 API 키와 orgID를 받는 것이었습니다. 이에 대한 자세한 정보는 여기에서 확인할 수 있습니다.

Node-Red를 OpenAI에 직접 연결하는 것이 완전히 가능하지만, 나는 먼저 inductiv의 Node-Red용 OpenAI 노드를 사용하여 시작했습니다. 이 노드는 사용하기 쉽고 프로젝트를 시작하고 확장할 때 필요한 모든 기능을 갖추고 있습니다.

첫 번째 결정은 시작하기에 매우 유연한 방법인 Assistants API를 사용하기로 했습니다. OpenAI 사이트에서 인용한 것처럼 말하면:

<div class="content-ad"></div>

# 데이터 흐름 설계

이제 핵심 파트에 들어가겠습니다. 챗봇을 설정하고 대화를 시작하는 데 따르는 여러 단계가 있습니다:

- 어시스턴트 생성: 이 단계는 특정 설정과 구성으로 새 어시스턴트 인스턴스를 생성하는 것을 포함합니다.
- 어시스턴트 목록: 어시스턴트를 생성한 후에는 새 어시스턴트가 성공적으로 생성되었는지 확인하기 위해 모든 어시스턴트를 나열할 수 있습니다.
- 어시스턴트 검색: 특정 어시스턴트의 세부 정보를 검색하는 것으로, 원하는 구성을 모두 갖추었는지 확인합니다.
- 스레드 생성 및 실행: 어시스턴트가 준비되면 새 대화 스레드를 생성합니다. 또한 이 단계에는 어시스턴트에 첫 번째 메시지를 보내 대화를 시작하는 것도 포함됩니다.
- 실행 목록: 이 단계는 현재 대화 스레드의 상태를 추적하기 위해 모든 활성 또는 이전 대화 실행을 나열하는 것을 포함합니다.
- 메시지 목록: 마지막으로 대화 스레드 내의 메시지를 나열하여 어시스턴트로부터 메시지에 대한 응답을 받습니다.

각 단계는 inductiv의 노드에서 지원되며 각 단계에서 올바른 입력만 제공하면 됩니다. 여기에 입력 및 출력의 수가 많은 만큼 자세히 설명하기는 하지 않겠습니다. 단순히 시작하도록 GitHub에서 inductiv가 제공하는 매우 유용한 기본 흐름이 있다는 점을 언급하겠습니다.
다음에 논의하고 싶은 중요한 시작점은 어시스턴트의 데이터 구조를 정의하는 것입니다.

<div class="content-ad"></div>

# 데이터 모델 및 결정

아래는 제가 마침내 작성한 JSON 템플릿의 샘플입니다. 기본적인 어시스턴트를 작동시키는 것을 넘어 몇 가지 단계를 더 나아갑니다:

```js
{
    "msg.botId": {
        "name": "name",
        "botId": "msg.botId",
        "description": "description",
        "instructions": "instructions",
        "model": "model",
        "temperature": 0.7,
        "created": "created",
        "citation": null,
        "citation_file": null,
        "assistant_id": "assistantId",
        "thread_id": "threadId",
        "message_id": null,
        "status_retry": "",
        "retry_count": 30,
        "messages": [
            {
                "sender": null,
                "content": null
            }
        ],
        "history": [
            {
                "sender": "",
                "content": ""
            }
        ]
    }
}
```

대부분의 키는 자명할 것이며, 일부는 필수이며, 일부는 어시스턴트를 추적하기 위해 제가 만들었습니다. 예를 들어:

<div class="content-ad"></div>

- botId: 앞단에 생성한 고유한 ID로, 봇을 식별하는 데 사용됩니다.
- retry_count: API로부터 응답을 받아올 때 타임아웃되기 전까지의 시간(초)을 저장하는 값입니다.

Node-Red에서 데이터 구조를 설정하면 다음 단계는 테스트를 진행하는 것입니다. 하지만 그 전에 구조의 중요한 부분에 대해 먼저 논의해 보겠습니다:

- model: OpenAI는 사용할 수 있는 모델 세트를 제공합니다. 이번 챗봇의 목적이 모델에 상대적으로 간단한 요청인 일반 지식 사실을 요청하는 것이므로 GPT 3.5 Turbo 모델을 선택했습니다.
- instructions: 이것이 모두 중요한 부분입니다. 가끔 '시스템' 메시지라고도 불리며, 보조 프롬프트로 효과적으로 사용됩니다. 프롬프트 엔지니어링은 별도의 세계이며, 간단한 프롬프트로 시작하였습니다:

```js
var instructions = "어린 아이들이 있는 가족과 대화하는 일반 목적을 갖는 챗봇이에요. 가족에게 흥미로운 이야기를 전하며 시작해 보세요.";
```

<div class="content-ad"></div>

시간을 많이 소비하면서도, 실제로 챗봇의 간단한 성격을 고려할 때 크게 진화시킬 필요가 없어요. 

- 온도: 다른 게시물을 소개할 만한 가치가 있는 온도는, 보기에 따라서는 아주 결정적이고 지루할 수 있는 0부터 실컷 올라가는 11까지, 실제로 2까지입니다. 저는 비교적 균형잡힌 0.7의 온도를 유지하기로 결정했어요. 제 경험상 1.6을 넘어가는 값은 도움이 되지 않는다는 걸 확인했어요. 값이 매우 높게 설정되는 이유는 아직 명확하지 않아요. 테스트 목적을 제외하고는 사용되지 않을 것 같아요.

<div class="content-ad"></div>

# 비즈니스 종착점

API를 통해 요청을 보내고 "1. 어시스턴트 만들기"부터 "6. 메시지 목록"까지의 개념적 흐름을 통해 메시지를 연결했을 때, 의미 있는 응답을 받아 안심했습니다.

물론 여러 번의 시행착오가 있었습니다. 쉽지 않았죠. 많은 난해한 부분과 타임아웃 뒤에, Node-Red의 Context Data Panel에 들어가 봤을 때, Chat GPT 3.5 Turbo에서 화려한 응답을 받았어요:

```js
var content = "안녕하세요! 저는 신사 제너럴 봇-봇, 당신의 신뢰할 수 있는 가족용 챗봇입니다. 
  당신은 가장 큰 눈송이가 1887년 미국 몽태나주 포트 키오에서 떨어져 38센티미터 
  너비와 20센티미터 두께였다는 것을 알고 계셨나요? 눈 내리는 날에 그걸 입으로 받쳐 보는 것을 상상해보세요!";
```

<div class="content-ad"></div>

챗봇의 정의된 데이터 구조를 보면 history라는 객체 배열에 메시지를 저장하고 있음을 알 수 있을 거예요.

OpenAI로부터 응답을 받을 때 messages.sender는 botName을 저장하고, messages.content에 텍스트 응답을 저장하게돼요. 마찬가지로, API를 통해 메시지를 보낼 때 message.sender는 로컬로 저장돼요 (“you”로 UI 표시와 추적을 위해) 그리고 message.content는 이 기본 챗봇에는 간단히 “Tell me something interesting”로 저장돼요.

# 프론트엔드 개발

이제 이것을 실제 사람들이, 어린이 포함, 사용할 수 있는 곳에 노출시키고 싶어요.

<div class="content-ad"></div>

내 프로젝트 중 대다수와 마찬가지로, 이러한 메시지를 표시하기 위한 프론트엔드를 구축하는 것은 친구들과 동료들이 새겨 넣은 여러 가지 아이디어로 이뤄진 나만의 삶을 살게 되었습니다. 결과적으로 나는 "가족 앱"이라고 부르는 것을 만들었어요. 홈 오토메이션 UI에 연결된 단일 웹 페이지로, 몇 가지 구성 요소가 있지만 현재는 GPT 부분에 초점을 맞춘 상태이죠. 상호 작용은 굉장히 간단합니다:

![Family App](/assets/img/2024-06-19-BuildingMyFirstChatbotPart1_5.png)

"다음" 버튼을 클릭하면 새로운 응답을 받을 수 있고, 모두 완료되면 "닫기"를 클릭하여 대화 팝오버 창을 닫을 수 있어요.

스마트 TV에서 실행할 수 있도록 디자인했기 때문에 글꼴 크기가 크고 멀리서도 읽기 쉽고, 나의 TV에서 사용하는 원격 레이저 포인터와 함께 훌륭하게 작동해요.

<div class="content-ad"></div>

이것은 아름다운 시작이었습니다. 이제 TV 원격 제어의 버튼을 클릭하면 하루에 흥미로운 사실을 제공하는 챗봇을 이용할 수 있게 되었습니다. 이것은 저의 아이들과 함께 토론의 주제로 사용하거나, 그들의 삶에 아이디어와 개념을 소개할 수 있게 해주는 초석이 될 수 있습니다. 이렇게 간단한 아이디어임에도 불구하고, 그 당시에는 기분이 좋았습니다.

# Part 1 완료 — 챗봇이 생성됨

![이미지](/assets/img/2024-06-19-BuildingMyFirstChatbotPart1_6.png)

이 여정의 첫 걸음으로, 다른 동작을 얻기 위해 지침과 모델을 수정하는 것은 만족스럽고 놀랍습니다. 많은 시간을 한 가지 메시지를 세밀하게 조정하는 데 소비할 수 있지만, 아마도 이 작업은 미술보다 과학적이라기보다는, 사실 내가 무엇이 근본적인 "규칙"인지 알아가면서 배우는 것 일 수도 있습니다.

<div class="content-ad"></div>

# 모두가 그 값어치가 있었을까요?

그 자체로는 물론 그렇지 않아요. chatgpt.com에 방문하여 최신 4o 모델로 지금 무료로 대화를 시작하는 것이 훨씬 쉽지요. 그러나 이 프로젝트 유형에는 항상 근본적인 걸 쌓고 제 어린이들과의 가족 사용에 대한 통제감을 제공해준 이 첫 단계가 있었죠.

이것은 "저희, 추가로 좀 더 주세요"의 문을 열어주기도 했습니다. "모두를 지배하는 보트 하나"라는 개념과는 전혀 대조되는 상황에서요. 그래서 여정은 계속되고, 보트들아 화려한 보트들, 앞으로 무엇이 기다리고 있을까요?