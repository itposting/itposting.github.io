---
title: "대형 언어 모델 LLMs 이해하기  어떻게 문제를 해결할까"
description: ""
coverImage: "/assets/img/2024-06-22-UnderstandingLargeLanguageModelsLLMsHowDoTheySolveProblems_0.png"
date: 2024-06-22 20:52
ogImage: 
  url: /assets/img/2024-06-22-UnderstandingLargeLanguageModelsLLMsHowDoTheySolveProblems_0.png
tag: Tech
originalTitle: "Understanding Large Language Models (LLMs) — How Do They Solve Problems?"
link: "https://medium.com/@hugmanskj/understanding-large-language-models-llms-how-do-they-solve-problems-3c94720714c5"
---


이 게시물의 한국어 버전을 다음 링크에서 찾을 수 있습니다. 😊

해당 글은 대형 언어 모델에 대한 이해 시리즈(3/4)의 세 번째 글입니다.

요즘에는 대형 언어 모델이 거의 모든 문제를 해결할 수 있다는 것 같아요. 사람들과 대화를 나눌 수도 있고, 질문에 답변하고, 소설을 쓰고, 음악을 작곡하며, 심지어 강의 자료를 디자인할 수도 있어요.

하지만 대형 언어 모델이 이 모든 기능을 어떻게 수행하는 걸까요? 지난 몇 년 동안 어떤 일이 일어나서 가능해졌을까요? 이 글에서는 대형 언어 모델이 일상생활에서 우리가 마주하는 다양한 문제들을 어떻게 해결하는지 살펴보고, 모든 이러한 기능을 통합하는 중요한 모델링 접근 방식을 소개할 거에요. 🚀

<div class="content-ad"></div>

# LLM 이전의 AI 대 LLM 기반 AI

## LLM 이전의 AI

먼저 LLM 이전에 AI가 일반적으로 사용되던 방식을 살펴보겠습니다. 간단한 감성 분석 작업을 예로 들어보겠습니다. 일반적인 과정은 다음과 같을 수 있습니다:

- 감정 유형 정의
- 예를 들어, 긍정적, 부정적, 중립, 혼합된 네 가지 감정 유형이 있다고 가정합시다.
- 충분한 감성 데이터 수집 및 해당 감정 유형에 대한 태깅
- 다양한 출처에서 데이터 수집하고 각 데이터 조각에 대해 감정을 수동으로 태깅합니다.
- NLP 모델 선택 (예: BERT, Electra, RoBERTa 등)
- 수집된 태깅된 데이터를 사용하여 선택한 NLP 모델을 세밀하게 조정합니다.
- 모델에 데이터 입력
- 감정 분석을 위한 데이터를 모델에 입력합니다.
- 출력 벡터 해석
- 모델에 의한 출력 벡터를 해석하여 각 감정 클래스에 대한 확률 값을 계산합니다.
- 이러한 확률 값에 따라 최고값을 가진 감정 클래스를 결정하여 최종 감정 클래스를 결정합니다.
- 최종 서비스 구축
- 세밀하게 조정된 모델을 사용하여 최종 감성 분석 서비스를 구축하고, 웹 서비스 또는 API로 제공할 수 있습니다.

<div class="content-ad"></div>

LLM 이전에 AI를 사용하는 과정은 특정 작업을 수행하기 위해 많은 단계와 많은 수동 작업을 필요로 했습니다. 충분한 훈련 데이터를 수집해야 했고, 모델링 프로세스를 진행해야 했으며, 입력과 출력이 기존 모델의 형식과 일치해야 했습니다. 다시 말해, 데이터 파이프라인은 문제 자체가 아닌 모델의 입출력 형식을 중심으로 구축되어야 했습니다.

이 내용은 다음과 같이 요약할 수 있습니다:

![UnderstandingLargeLanguageModelsLLMsHowDoTheySolveProblems_0](/assets/img/2024-06-22-UnderstandingLargeLanguageModelsLLMsHowDoTheySolveProblems_0.png)

요컨데, 개발자들은 문제와 데이터를 모델의 강점에 맞게 맞춰야 했습니다.

<div class="content-ad"></div>

## LLM 기반 AI

LLM은 문제 해결 과정을 간소화합니다. 특히 GPT와 같은 디코더를 포함한 언어 모델을 사용하면 어떤 "언어" 입력이든 처리하여 "언어" 출력을 생성할 수 있습니다. 이 생성 능력은 모든 문제를 크게 간소화합니다.

생성 언어 모델을 사용하여 감성 분석 문제를 다시 살펴보겠습니다.

- 감성 분석 문제 정의하기.
- 사용자가 텍스트를 입력하면 해당 텍스트의 감성을 분석하고 결과를 출력합니다.
- 사전 훈련된 LLM 모델 선택하기.
- 예를 들어 GPT-3 모델을 선택하십시오.
- 모델에 데이터 입력하기.
- 모델에 텍스트 데이터를 용도에 맞게 입력합니다.
- 예를 들어, 분석 문장이 "This is a movie I want to watch again" 인 경우,
- 프롬프트는 다음과 같을 것입니다:
- 프롬프트: “다음 문장을 다음 네 가지 범주 중 하나로 분류하십시오: 긍정적, 부정적, 중립, 혼합. 문장=This is a movie I want to watch again.
- 모델의 출력 해석하기.
- 모델이 출력한 텍스트를 직접 사용하거나 해석하여 감성을 분류합니다.
- 최종 서비스 구축하기.
- LLM을 사용하여 감성 분석 서비스를 구축하고 웹 서비스나 API로 제공할 수 있습니다.

<div class="content-ad"></div>

위에 표시된 대로, LLM을 사용하면 복잡한 전처리, 모델 선택 또는 세부 조정 과정 없이 감성 분석을 쉽게 수행할 수 있습니다. 모든 과정은 통합 모델에 의해 처리될 수 있어 개발자와 사용자에 대한 부담을 크게 줄일 수 있습니다. 가장 큰 장점은 입력과 출력이 모두 '텍스트'로 통합된다는 점으로, 복잡한 벡터 해석이나 처리가 필요 없다는 점입니다. 이는 다음과 같이 설명할 수 있습니다:

![이미지](/assets/img/2024-06-22-UnderstandingLargeLanguageModelsLLMsHowDoTheySolveProblems_1.png)

# LLM이 문제를 해결하는 방법

이제 LLM, 특히 디코더를 사용하는 생성 모델이 통합적인 관점에서 다양한 문제를 해결하는 방법을 살펴보겠습니다.

<div class="content-ad"></div>

난 생성 모델 LLM이 특정 목표로 훈련되고 예측하는 방식을 알아볼 거야.

## 트랜스포머-디코더 훈련

디코더 전용 언어 모델을 다음과 같이 훈련해:

- 디코더 입력 데이터를 준비해.
- 예시: `s`, A, B, C
- 여기서 `s`는 문장의 시작을 의미해.
- 디코더 출력 데이터를 준비해.
- 예시: A, B, C
- Transformer를 통해 피드포워드 진행해.
- 각 타임스텝에서 예측된 기호가 출력 시점의 기호와 일치하는지 확인해.
- `s`가 있는 타임스텝은 A를 생성해야 해.
- A가 있는 타임스텝은 B를 생성해야 해.
- 각 타임스텝에서 손실을 계산하고 누적해, 이를 기반으로 트랜스포머를 훈련해.

<div class="content-ad"></div>

이 과정은 다음과 같이 시각화될 수 있습니다:

![image](/assets/img/2024-06-22-UnderstandingLargeLanguageModelsLLMsHowDoTheySolveProblems_2.png)

이 교육 과정 중에는 확률 모델링의 네 가지 인스턴스가 발생합니다. 각 타임스텝에서 미래 정보가 보이지 않도록 디코더의 교육 과정 중에 가림 마스크를 적용합니다. 예를 들어:

- P(A | `S`)
- P(B | `S`, A)
- P(C | `S`, A, B)
- P(`/S` | `S`, A, B, C)

<div class="content-ad"></div>

그래서 우리의 "생성 언어 모델"은 궁극적으로 다음 목표를 완성하는 데 최적화되어 있어요.

이를 직관적으로 이해하기 위해, 우리의 사고를 한 단계씩 확장해 봅시다.

## 트랜스포머 디코더로 생성하기

[문장 완성]
저희 언어 모델은 기본적으로 문장을 완성하도록 훈련되어 있어요.

<div class="content-ad"></div>

위의 예시에서 보는 것처럼, Transformer 디코더는 입력 "This is a wonderful" 후에 가장 타당한 단어 "world"을 생성합니다. 그런 다음 "This is a wonderful world" 후에 "isn't"를, 그리고 "This is a wonderful world, isn't" 후에 "it?"을 생성합니다. 기본적으로 문장의 시작이 주어지면 가장 타당한 나머지 부분을 완성합니다.

[문단 완성]
이를 확장할 수 있을까요? 실제로, 우리의 Transformer는 문장과 문단을 구분하지 않습니다; 그저 점점 더 많아지는 토큰을 보는 것뿐입니다.

![](/assets/img/2024-06-22-UnderstandingLargeLanguageModelsLLMsHowDoTheySolveProblems_4.png)

<div class="content-ad"></div>

생성 언어 모델은 문장뿐만 아니라 단락도 완성할 수 있습니다. 초기 내용을 바탕으로 단락의 나머지 부분을 완성합니다.

문장에서 단락으로 확장할 때 모델 구조를 변경했나요? 아니요, 우리는 정확히 같은 모델 구조를 사용했습니다. 입력의 규모만 변경되었습니다. 마찬가지로 입력을 확장하면 다음과 같은 작업을 자연스럽게 수행할 수 있습니다:

- 페이지 완성
- 챕터 완성
- 전체 책 완성

간단히 다양한 정보 규모를 문서로 설명하면, 우리는 LLM을 주어진 문서 조각에 가장 적합한 나머지 조각을 생성하는 엔진으로 정의할 수 있습니다.

<div class="content-ad"></div>

<img src="/assets/img/2024-06-22-UnderstandingLargeLanguageModelsLLMsHowDoTheySolveProblems_5.png" />

위의 그림처럼, 큰 언어 모델(Large Language Models, LLMs)은 주어진 문서 조각 Dₚ를 기반으로 남은 부분 Dₙ을 완성하는 것 이상의 것도 이하의 것도 아닙니다. 음악 작곡, 소설쓰기, 시험 문제 해결 등, 문제 해결의 근본적인 방법은 그냥 빠진 부분을 “가능성 있게” 완성하는 것뿐입니다.

이 과정에는 철학적, 윤리적, 도덕적, 심리적 고려 사항이 내재적으로 내장되어 있지 않습니다. LLMs를 그저 매우 대규모의 “자동 완성 기계”로 생각하는 것이 적절합니다. 이 자동 완성 기계는 방대한 양의 데이터로 훈련되어 가능성 있는 결과를 생성합니다.

## LLMs의 핵심 — 가능성

<div class="content-ad"></div>

LLM들이 Q/A 및 번역과 같은 다양한 응용 프로그램을 처리하기 위해 이 자동완성 기능을 사용하는 방법은 데이터의 힘에 있습니다.

두 가지 응용 프로그램, Q/A 및 번역을 고려해 봅시다.

[Q/A]

질문 Q에 대한 답변 A를 제공하는 것은 Q/A 시스템을 형성합니다. 교육을 위해 우리는 Q/A 쌍을 단일 문서로 생각할 수 있습니다:

<div class="content-ad"></div>

- 문서 D = [Q;A]

LLM(Language Model)이 수십억 개의 이러한 Q/A 문서로 훈련받는다면, 그들은 Q/A 문서를 완성하는 법을 배울 것입니다. Q/A LLM에서 "합리성"은 Q를 따르는 A를 생성하는 것을 의미합니다.

사용자가 질문 Q를 입력할 때:

- LLM(Dₚ=Q) -` Dₙ

<div class="content-ad"></div>

표 태그를 Markdown 형식으로 변경해주세요.

<div class="content-ad"></div>

시스템적으로 보면 다음과 같습니다:

- 문맥 C: “다음 내용을 영어에서 한국어로 번역하세요. 번역할 내용은:”
- 원본 S: “The weather is beautiful today.”
- 번역본 T: “오늘 날씨가 아름답습니다.”

실제로 언어 모델을 훈련하는 과정에서는 다음과 같이 처리됩니다:

- D = [C; S; T]

<div class="content-ad"></div>

수십억 건의 번역 요청 및 결과 문서를 사용하여 훈련된 언어 모델은 자연스럽게 Dₚ = [C; S]를 Dₙ = T와 함께 완성할 수 있는 능력을 개발합니다. 본질적으로 번역기를 생성하는 대신, 우리는 번역 문서의 일부를 가져와 입력하고 자동 완성 기곕이 나머지를 채우도록 허용했습니다.

하지만 사용자에게는 훌륭한 번역이 이루어졌고 실용적으로 사용할 수 있다고 보입니다.

최종적으로 LLM(Large Language Models)이 문제를 해결하는 한 가지 방법은 가장 타당한 방식으로 남은 부분을 완성함으로써입니다. 너무 간단하게 보일 수 있지만, 조금의 상상력을 발휘하면 이 방법이 거의 모든 것을 해결할 수 있다는 것을 알 수 있습니다.

음악 작곡, 소설 쓰기, 영화 제작, 시험 문제 제출 및 해결, 경제 시뮬레이션, 수학 문제 해결, 철학적 논쟁, 인류의 미래 예측 - 우리가 가진 거의 모든 질문은 "가장 타당한" 결과를 제공함으로써 답변될 수 있습니다. 그리고 그 타당한 결과가 바로 LLM, 자동완성 기곕이 제공하는 것입니다.

<div class="content-ad"></div>

# 결론

이 글에서 우리는 대형 언어 모델이 세상의 다양한 문제들을 해결하는 핵심 원리에 대해 탐구했습니다. 간단히 말해, LLM은 자동 완성 기계입니다. 이 엔진은 훈련된 데이터를 기반으로 전체 문서의 전반부가 주어졌을 때, 후반부를 타당하게 완성하는 최적화된 엔진입니다.

이 원리는 간단하지만, LLM은 훈련 중 노출된 데이터의 유형과 구성을 다양화함으로써 새로운 응용 프로그램을 끝없이 만들어낼 수 있는 강력한 도구입니다.

다음 글에서는 이 자동 완성 기계의 "대규모" 측면이 우리에게 미치는 영향에 대해 설명할 것입니다.