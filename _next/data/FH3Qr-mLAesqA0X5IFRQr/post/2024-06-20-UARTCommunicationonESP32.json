{"pageProps":{"post":{"title":"ESP32의 UART 통신","description":"","date":"2024-06-20 16:13","slug":"2024-06-20-UARTCommunicationonESP32","content":"\n\n![UART 통신](/assets/img/2024-06-20-UARTCommunicationonESP32_0.png)\n\nESP32는 Espressif Systems에서 디자인한 인기 있는 보드입니다. 이 보드는 클럭 속도, PWM, I2C, SPI, UART와 같은 훌륭한 기능을 갖춘 일반 개발 보드입니다. 하지만 그 주요 강점은 IoT 기능인 내장 WIFI와 블루투스가 보드에 포함되어 있어 별도의 WIFI 및 블루투스 모듈을 구매할 필요가 없다는 점입니다. ESP32 및 Arduino IDE를 사용한 프로그래밍에 대한 자세한 정보는 여기와 여기의 문서를 참조하십시오.\n\n도구\n\n- 두 개의 ESP32 DEVKIT V1\n- 점퍼 와이어\n- Arduino IDE\n\n<div class=\"content-ad\"></div>\n\nUART\n\nUART은 Universal Asynchronous Receiver Transmitter의 줄임말입니다. 최대 세 개의 연결을 이용한 통신 메커니즘입니다. 이 연결에서 한 모듈의 Rx가 다른 모듈의 Tx에 연결되고 그 반대도 성립되며 두 모듈에 공통적인 그라운드가 제공됩니다. UART는 단방향 통신인 simplex, 양방향 통신이 가능하지만 동시에 통신은 불가능한 half-duplex, 양쪽이 동시에 통신할 수 있는 full duplex와 같이 세 가지 유형의 통신을 지원할 수 있습니다.\n\nESP32의 UART\n\nESP32에는 외부 두 개와 내부 한 개의 UART 채널이 있습니다. UART 핀은 UART0가 Rx 및 TX로 핀 3, 1이며 UART2는 Rx 및 Tx로 핀 16, 17으로 구성됩니다. 한편 UART1은 외부 GPIO가 할당되어 있지 않고 외부 핀을 할당하여 접근할 수 있습니다. 이에 대한 자세한 내용은 나중에 논의될 예정입니다. 저희 프로젝트에서는 두 개의 ESP32 보드를 사용하고 UART 통신을 이용하여 한 보드에서 다른 보드로 데이터를 전송하여, 결과적으로 이벤트를 트리거하도록 할 것입니다. 또한 ESP32 보드의 블루투스 기능을 활용하여, 다른 보드에 블루투스 기능을 제공할 때 ESP32를 HC-05 모듈의 대체품으로 사용할 수 있는지 확인할 것입니다. ESP32의 블루투스 기능을 설정하고 사용하는 방법에 대한 정보는 해당 기사를 참조해 주세요.\n\n<div class=\"content-ad\"></div>\n\n코드 마스터 모듈\n\n마스터 모듈용 아두이노 IDE 코드는 다음과 같습니다.\n\n```js\n#include <BluetoothSerial.h>\n#include <HardwareSerial.h>\nHardwareSerial SerialPort(2);\nBluetoothSerial SerialBT;\nbyte BTd;\n/* SDK에서 Bluetooth 구성이 활성화되어 있는지 확인 */\n#if !defined(CONFIG_BT_ENABLED) || !defined(CONFIG_BLUEDROID_ENABLED)\n#error Bluetooth가 활성화되어 있지 않습니다! `make menuconfig`를 실행하여 활성화하십시오\n#endif\nvoid setup() {\n  Serial.begin(115200);\n  SerialPort.begin(15200,SERIAL_8N1,16,17);\n  SerialBT.begin(\"ESP32\");\n}\nvoid loop() {\n  if(SerialBT.available())\n  {\n    BTd=SerialBT.read();\n    Serial.write(BTd);\n  }\n  if(BTd=='1')\n  {\n    SerialPort.print(1);\n  }\n  if(BTd=='0')\n  {\n    SerialPort.print(0);\n  }\ndelay(100);\n}\n```\n\n줄 별 설명에 대해요\n\n<div class=\"content-ad\"></div>\n\n먼저 시리얼 통신 및 블루투스 연결에 필요한 라이브러리를 포함합니다.\n\n```js\n#include <BluetoothSerial.h>\n#include <HardwareSerial.h>\n```\n\n그 다음에는 사용할 UART 포트를 선택합니다.\n\n```js\nHardwareSerial SerialPort(2);\n```\n\n<div class=\"content-ad\"></div>\n\n그럼 SerialBT 인스턴스를 만들고 Bluetooth 연결 오류 감지 코드를 포함시킵니다.\n\n```js\nBluetoothSerial SerialBT;\nbyte BTd;\n/* Bluetooth 설정이 SDK에서 활성화되어 있는지 확인합니다 */\n#if !defined(CONFIG_BT_ENABLED) || !defined(CONFIG_BLUEDROID_ENABLED)\n#error Bluetooth가 활성화되어 있지 않습니다! `make menuconfig`를 실행하여 활성화하세요\n#endif\n```\n\nvoid setup 블록에서는 시리얼 통신을 초기화하여 보레이트와 핀을 설정하고, Bluetooth 연결을 설정합니다.\n\n```js\nSerial.begin(115200);\nSerialPort.begin(15200, SERIAL_8N1, 16, 17);\nSerialBT.begin(\"ESP32\");\n```\n\n<div class=\"content-ad\"></div>\n\n마침내 루프 블록에서는 Bluetooth 시리얼 포트 데이터 감지 코드를 포함하고, 그 후 Bluetooth 연결을 통해 받은 데이터에 따라 UART로 데이터를 전송하기 위한 조건문을 작성합니다. 시리얼 포트를 통해 데이터를 전송하기 위해 SerialPort.print(data); 함수를 사용합니다.\n\n```js\n  if(SerialBT.available())\n  {\n    BTd=SerialBT.read();\n    Serial.write(BTd);\n  }\n  if(BTd=='1')\n  {\n    SerialPort.print(1);\n  }\n  if(BTd=='0')\n  {\n    SerialPort.print(0);\n  }\n```\n\n코드-슬레이브 모듈\n\n스레이브 ESP32의 코드는 다음과 같습니다.\n\n<div class=\"content-ad\"></div>\n\n```js\r\n#include <HardwareSerial.h>\r\n```\r\n\r\n먼저 라이브러리를 포함합니다.\r\n\r\n그런 다음 사용할 포트를 선택하고 들어오는 데이터를 저장할 문자 변수를 정의합니다.\n\n<div class=\"content-ad\"></div>\n\n```js\nHardwareSerial SerialPort(0); // UART0을 사용합니다\nchar number  = ' ';\n```\n\nvoid setup 블록에서는 UART 통신을 시작하기 위해 보레이트와 포트 핀을 설정합니다.\n\n```js\n  Serial.begin(115200);\n  SerialPort.begin(15200, SERIAL_8N1, 3, 1);\n```\n\nvoid loop 블록에서는 마스터로부터 데이터를 수신하고 시리얼 모니터에 표시합니다. SerialPort.available() 함수를 사용하여 시리얼 포트에서 데이터를 수신할 준비가 되어 있는지 확인한 후, SerialPort.read() 함수를 사용하여 데이터를 char 변수에 저장합니다.\n\n<div class=\"content-ad\"></div>\n\n```js\n if (SerialPort.available())\n {\n    char number = SerialPort.read();\n    Serial.write(number);\n\n }\n```\n\n결과\n\nESP32 모듈에 두 코드를 업로드한 후, 슬레이브 모듈의 시리얼 모니터를 열고 블루투스 통신을 통해 마스터 모듈로 '1' 또는 '0'을 전송합니다. 수신된 데이터는 시리얼 모니터에 표시됩니다. 또한 동일한 표시된 데이터를 사용하여 LED 제어와 같은 조건문을 사용하여 이벤트를 트리거할 수도 있습니다. 블루투스를 통해 수신한 데이터를 직접 전송할 수는 없으므로 조건문을 사용해야 하며 특정 데이터만 전송할 수 있습니다.\n\n참고로, 유료 콘텐츠 작성 및/또는 기사 작성 작업을 위해 ESP32 보드에 대한 무료 안내가 필요할 경우 khantalha7367@gmail.com로 연락하시거나 Fiverr 기가를 방문해주십시오. https://www.fiverr.com/s/rL3mWN, https://www.fiverr.com/s/7rj8Xy\n\n","ogImage":{"url":"/assets/img/2024-06-20-UARTCommunicationonESP32_0.png"},"coverImage":"/assets/img/2024-06-20-UARTCommunicationonESP32_0.png","tag":["Tech"],"readingTime":5},"content":"<!doctype html>\n<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n</head>\n<body>\n<p><img src=\"/assets/img/2024-06-20-UARTCommunicationonESP32_0.png\" alt=\"UART 통신\"></p>\n<p>ESP32는 Espressif Systems에서 디자인한 인기 있는 보드입니다. 이 보드는 클럭 속도, PWM, I2C, SPI, UART와 같은 훌륭한 기능을 갖춘 일반 개발 보드입니다. 하지만 그 주요 강점은 IoT 기능인 내장 WIFI와 블루투스가 보드에 포함되어 있어 별도의 WIFI 및 블루투스 모듈을 구매할 필요가 없다는 점입니다. ESP32 및 Arduino IDE를 사용한 프로그래밍에 대한 자세한 정보는 여기와 여기의 문서를 참조하십시오.</p>\n<p>도구</p>\n<ul>\n<li>두 개의 ESP32 DEVKIT V1</li>\n<li>점퍼 와이어</li>\n<li>Arduino IDE</li>\n</ul>\n<p>UART</p>\n<p>UART은 Universal Asynchronous Receiver Transmitter의 줄임말입니다. 최대 세 개의 연결을 이용한 통신 메커니즘입니다. 이 연결에서 한 모듈의 Rx가 다른 모듈의 Tx에 연결되고 그 반대도 성립되며 두 모듈에 공통적인 그라운드가 제공됩니다. UART는 단방향 통신인 simplex, 양방향 통신이 가능하지만 동시에 통신은 불가능한 half-duplex, 양쪽이 동시에 통신할 수 있는 full duplex와 같이 세 가지 유형의 통신을 지원할 수 있습니다.</p>\n<p>ESP32의 UART</p>\n<p>ESP32에는 외부 두 개와 내부 한 개의 UART 채널이 있습니다. UART 핀은 UART0가 Rx 및 TX로 핀 3, 1이며 UART2는 Rx 및 Tx로 핀 16, 17으로 구성됩니다. 한편 UART1은 외부 GPIO가 할당되어 있지 않고 외부 핀을 할당하여 접근할 수 있습니다. 이에 대한 자세한 내용은 나중에 논의될 예정입니다. 저희 프로젝트에서는 두 개의 ESP32 보드를 사용하고 UART 통신을 이용하여 한 보드에서 다른 보드로 데이터를 전송하여, 결과적으로 이벤트를 트리거하도록 할 것입니다. 또한 ESP32 보드의 블루투스 기능을 활용하여, 다른 보드에 블루투스 기능을 제공할 때 ESP32를 HC-05 모듈의 대체품으로 사용할 수 있는지 확인할 것입니다. ESP32의 블루투스 기능을 설정하고 사용하는 방법에 대한 정보는 해당 기사를 참조해 주세요.</p>\n<p>코드 마스터 모듈</p>\n<p>마스터 모듈용 아두이노 IDE 코드는 다음과 같습니다.</p>\n<pre><code class=\"hljs language-js\">#include &#x3C;<span class=\"hljs-title class_\">BluetoothSerial</span>.<span class=\"hljs-property\">h</span>>\n#include &#x3C;<span class=\"hljs-title class_\">HardwareSerial</span>.<span class=\"hljs-property\">h</span>>\n<span class=\"hljs-title class_\">HardwareSerial</span> <span class=\"hljs-title class_\">SerialPort</span>(<span class=\"hljs-number\">2</span>);\n<span class=\"hljs-title class_\">BluetoothSerial</span> <span class=\"hljs-title class_\">SerialBT</span>;\nbyte <span class=\"hljs-title class_\">BTd</span>;\n<span class=\"hljs-comment\">/* SDK에서 Bluetooth 구성이 활성화되어 있는지 확인 */</span>\n#<span class=\"hljs-keyword\">if</span> !<span class=\"hljs-title function_\">defined</span>(<span class=\"hljs-variable constant_\">CONFIG_BT_ENABLED</span>) || !<span class=\"hljs-title function_\">defined</span>(<span class=\"hljs-variable constant_\">CONFIG_BLUEDROID_ENABLED</span>)\n#error <span class=\"hljs-title class_\">Bluetooth</span>가 활성화되어 있지 않습니다! <span class=\"hljs-string\">`make menuconfig`</span>를 실행하여 활성화하십시오\n#endif\n<span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">setup</span>(<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-title class_\">Serial</span>.<span class=\"hljs-title function_\">begin</span>(<span class=\"hljs-number\">115200</span>);\n  <span class=\"hljs-title class_\">SerialPort</span>.<span class=\"hljs-title function_\">begin</span>(<span class=\"hljs-number\">15200</span>,<span class=\"hljs-variable constant_\">SERIAL_8N1</span>,<span class=\"hljs-number\">16</span>,<span class=\"hljs-number\">17</span>);\n  <span class=\"hljs-title class_\">SerialBT</span>.<span class=\"hljs-title function_\">begin</span>(<span class=\"hljs-string\">\"ESP32\"</span>);\n}\n<span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">loop</span>(<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-title class_\">SerialBT</span>.<span class=\"hljs-title function_\">available</span>())\n  {\n    <span class=\"hljs-title class_\">BTd</span>=<span class=\"hljs-title class_\">SerialBT</span>.<span class=\"hljs-title function_\">read</span>();\n    <span class=\"hljs-title class_\">Serial</span>.<span class=\"hljs-title function_\">write</span>(<span class=\"hljs-title class_\">BTd</span>);\n  }\n  <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-title class_\">BTd</span>==<span class=\"hljs-string\">'1'</span>)\n  {\n    <span class=\"hljs-title class_\">SerialPort</span>.<span class=\"hljs-title function_\">print</span>(<span class=\"hljs-number\">1</span>);\n  }\n  <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-title class_\">BTd</span>==<span class=\"hljs-string\">'0'</span>)\n  {\n    <span class=\"hljs-title class_\">SerialPort</span>.<span class=\"hljs-title function_\">print</span>(<span class=\"hljs-number\">0</span>);\n  }\n<span class=\"hljs-title function_\">delay</span>(<span class=\"hljs-number\">100</span>);\n}\n</code></pre>\n<p>줄 별 설명에 대해요</p>\n<p>먼저 시리얼 통신 및 블루투스 연결에 필요한 라이브러리를 포함합니다.</p>\n<pre><code class=\"hljs language-js\">#include &#x3C;<span class=\"hljs-title class_\">BluetoothSerial</span>.<span class=\"hljs-property\">h</span>>\n#include &#x3C;<span class=\"hljs-title class_\">HardwareSerial</span>.<span class=\"hljs-property\">h</span>>\n</code></pre>\n<p>그 다음에는 사용할 UART 포트를 선택합니다.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-title class_\">HardwareSerial</span> <span class=\"hljs-title class_\">SerialPort</span>(<span class=\"hljs-number\">2</span>);\n</code></pre>\n<p>그럼 SerialBT 인스턴스를 만들고 Bluetooth 연결 오류 감지 코드를 포함시킵니다.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-title class_\">BluetoothSerial</span> <span class=\"hljs-title class_\">SerialBT</span>;\nbyte <span class=\"hljs-title class_\">BTd</span>;\n<span class=\"hljs-comment\">/* Bluetooth 설정이 SDK에서 활성화되어 있는지 확인합니다 */</span>\n#<span class=\"hljs-keyword\">if</span> !<span class=\"hljs-title function_\">defined</span>(<span class=\"hljs-variable constant_\">CONFIG_BT_ENABLED</span>) || !<span class=\"hljs-title function_\">defined</span>(<span class=\"hljs-variable constant_\">CONFIG_BLUEDROID_ENABLED</span>)\n#error <span class=\"hljs-title class_\">Bluetooth</span>가 활성화되어 있지 않습니다! <span class=\"hljs-string\">`make menuconfig`</span>를 실행하여 활성화하세요\n#endif\n</code></pre>\n<p>void setup 블록에서는 시리얼 통신을 초기화하여 보레이트와 핀을 설정하고, Bluetooth 연결을 설정합니다.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-title class_\">Serial</span>.<span class=\"hljs-title function_\">begin</span>(<span class=\"hljs-number\">115200</span>);\n<span class=\"hljs-title class_\">SerialPort</span>.<span class=\"hljs-title function_\">begin</span>(<span class=\"hljs-number\">15200</span>, <span class=\"hljs-variable constant_\">SERIAL_8N1</span>, <span class=\"hljs-number\">16</span>, <span class=\"hljs-number\">17</span>);\n<span class=\"hljs-title class_\">SerialBT</span>.<span class=\"hljs-title function_\">begin</span>(<span class=\"hljs-string\">\"ESP32\"</span>);\n</code></pre>\n<p>마침내 루프 블록에서는 Bluetooth 시리얼 포트 데이터 감지 코드를 포함하고, 그 후 Bluetooth 연결을 통해 받은 데이터에 따라 UART로 데이터를 전송하기 위한 조건문을 작성합니다. 시리얼 포트를 통해 데이터를 전송하기 위해 SerialPort.print(data); 함수를 사용합니다.</p>\n<pre><code class=\"hljs language-js\">  <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-title class_\">SerialBT</span>.<span class=\"hljs-title function_\">available</span>())\n  {\n    <span class=\"hljs-title class_\">BTd</span>=<span class=\"hljs-title class_\">SerialBT</span>.<span class=\"hljs-title function_\">read</span>();\n    <span class=\"hljs-title class_\">Serial</span>.<span class=\"hljs-title function_\">write</span>(<span class=\"hljs-title class_\">BTd</span>);\n  }\n  <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-title class_\">BTd</span>==<span class=\"hljs-string\">'1'</span>)\n  {\n    <span class=\"hljs-title class_\">SerialPort</span>.<span class=\"hljs-title function_\">print</span>(<span class=\"hljs-number\">1</span>);\n  }\n  <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-title class_\">BTd</span>==<span class=\"hljs-string\">'0'</span>)\n  {\n    <span class=\"hljs-title class_\">SerialPort</span>.<span class=\"hljs-title function_\">print</span>(<span class=\"hljs-number\">0</span>);\n  }\n</code></pre>\n<p>코드-슬레이브 모듈</p>\n<p>스레이브 ESP32의 코드는 다음과 같습니다.</p>\n<pre><code class=\"hljs language-js\">#include &#x3C;<span class=\"hljs-title class_\">HardwareSerial</span>.<span class=\"hljs-property\">h</span>>\n</code></pre>\n<p>먼저 라이브러리를 포함합니다.</p>\n<p>그런 다음 사용할 포트를 선택하고 들어오는 데이터를 저장할 문자 변수를 정의합니다.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-title class_\">HardwareSerial</span> <span class=\"hljs-title class_\">SerialPort</span>(<span class=\"hljs-number\">0</span>); <span class=\"hljs-comment\">// UART0을 사용합니다</span>\nchar number  = <span class=\"hljs-string\">' '</span>;\n</code></pre>\n<p>void setup 블록에서는 UART 통신을 시작하기 위해 보레이트와 포트 핀을 설정합니다.</p>\n<pre><code class=\"hljs language-js\">  <span class=\"hljs-title class_\">Serial</span>.<span class=\"hljs-title function_\">begin</span>(<span class=\"hljs-number\">115200</span>);\n  <span class=\"hljs-title class_\">SerialPort</span>.<span class=\"hljs-title function_\">begin</span>(<span class=\"hljs-number\">15200</span>, <span class=\"hljs-variable constant_\">SERIAL_8N1</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">1</span>);\n</code></pre>\n<p>void loop 블록에서는 마스터로부터 데이터를 수신하고 시리얼 모니터에 표시합니다. SerialPort.available() 함수를 사용하여 시리얼 포트에서 데이터를 수신할 준비가 되어 있는지 확인한 후, SerialPort.read() 함수를 사용하여 데이터를 char 변수에 저장합니다.</p>\n<pre><code class=\"hljs language-js\"> <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title class_\">SerialPort</span>.<span class=\"hljs-title function_\">available</span>())\n {\n    char number = <span class=\"hljs-title class_\">SerialPort</span>.<span class=\"hljs-title function_\">read</span>();\n    <span class=\"hljs-title class_\">Serial</span>.<span class=\"hljs-title function_\">write</span>(number);\n\n }\n</code></pre>\n<p>결과</p>\n<p>ESP32 모듈에 두 코드를 업로드한 후, 슬레이브 모듈의 시리얼 모니터를 열고 블루투스 통신을 통해 마스터 모듈로 '1' 또는 '0'을 전송합니다. 수신된 데이터는 시리얼 모니터에 표시됩니다. 또한 동일한 표시된 데이터를 사용하여 LED 제어와 같은 조건문을 사용하여 이벤트를 트리거할 수도 있습니다. 블루투스를 통해 수신한 데이터를 직접 전송할 수는 없으므로 조건문을 사용해야 하며 특정 데이터만 전송할 수 있습니다.</p>\n<p>참고로, 유료 콘텐츠 작성 및/또는 기사 작성 작업을 위해 ESP32 보드에 대한 무료 안내가 필요할 경우 <a href=\"mailto:khantalha7367@gmail.com\">khantalha7367@gmail.com</a>로 연락하시거나 Fiverr 기가를 방문해주십시오. <a href=\"https://www.fiverr.com/s/rL3mWN\" rel=\"nofollow\" target=\"_blank\">https://www.fiverr.com/s/rL3mWN</a>, <a href=\"https://www.fiverr.com/s/7rj8Xy\" rel=\"nofollow\" target=\"_blank\">https://www.fiverr.com/s/7rj8Xy</a></p>\n</body>\n</html>\n"},"__N_SSG":true}