{"pageProps":{"post":{"title":"ì‘ì€ ê¸°ê³„ í•™ìŠµ - í¬ì•„ì†¡ íšŒê·€","description":"","date":"2024-06-20 16:45","slug":"2024-06-20-TinyMLPoissonRegression","content":"\n\nìˆ˜í•™ì  ê¸°ì´ˆë¶€í„° ì—£ì§€ êµ¬í˜„ê¹Œì§€\n\n# ì†Œì…œ ë¯¸ë””ì–´:\n\nğŸ‘¨ğŸ½â€ğŸ’» Github: thommaskevin/TinyML (github.com)\nğŸ‘·ğŸ¾ Linkedin: Thommas Kevin | LinkedIn\nğŸ“½ Youtube: Thommas Kevin â€” YouTube\nğŸ‘¨ğŸ»â€ğŸ« Research group: Conecta.ai (ufrn.br)\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-20-TinyMLPoissonRegression_0.png)\n\n<div class=\"content-ad\"></div>\n\n## ìš”ì•½\n\n# 1 â€” í¬ì•„ì†¡ íšŒê·€ ì´ë¡ \n\ní¬ì•„ì†¡ íšŒê·€ ëª¨í˜•ì€ ê²°ê³¼ê°€ ë°œìƒ íšŸìˆ˜ì¸ ì´ë²¤íŠ¸ë¥¼ ë¬˜ì‚¬í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤: ë¬´ì–‘í•œ ì •ìˆ˜ ê°’ì˜ ì´ì‚° ë°ì´í„°ë¡œ, ì–´ë–¤ ì¼ì´ ì–´ëŠ ê¸°ê°„ ë™ì•ˆ ëª‡ ë²ˆ ë°œìƒí•˜ëŠ”ì§€ë‚˜ ìŠˆí¼ë§ˆì¼“ ëŒ€ê¸° ì¤„ì— ìˆëŠ” ì‚¬ëŒ ìˆ˜ì™€ ê°™ì´ ë¬´ì–‘í•œ ê²ƒì„ ê³„ì‚°í•©ë‹ˆë‹¤.\n\nê³„ìˆ˜ ë°ì´í„°ëŠ” ë¹„ìœ¨ ë°ì´í„°ë¡œë„ í‘œí˜„ë  ìˆ˜ ìˆìœ¼ë©°, ì–´ë–¤ ì¼ì´ íŠ¹ì • ê¸°ê°„ ë‚´ì— ëª‡ ë²ˆ ë°œìƒí•˜ëŠ”ì§€ë¥¼ ìˆœìˆ˜í•œ ê°œìˆ˜ë¡œ í‘œí˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, í•˜ë£¨ì— ì„¸ ë¼ ì‹ì‚¬ë¥¼ í•©ë‹ˆë‹¤.\n\n<div class=\"content-ad\"></div>\n\nPoisson íšŒê·€ëŠ” ì¹´ìš´íŠ¸ ë°ì´í„°ì™€ ë¹„ìœ¨ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ëŠ” ë° ë„ì›€ì´ ë˜ë©°, íŠ¹ì • ì‘ë‹µ ë³€ìˆ˜ Yì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ì„¤ëª… ë³€ìˆ˜ê°€ ë¬´ì—‡ì¸ì§€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ìŠˆí¼ë§ˆì¼“ì€ í¬ì•„ì†¡ íšŒê·€ë¥¼ ì‚¬ìš©í•˜ì—¬ ëŒ€ê¸°ì¤„ì— ìˆëŠ” ì‚¬ëŒ ìˆ˜ë¥¼ ë” ì˜ ì´í•´í•˜ê³  ì˜ˆì¸¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\ní¬ì•„ì†¡ ë¶„í¬ëŠ” íŠ¹ì • ì‹œê°„ ë™ì•ˆ ì´ë²¤íŠ¸ ë˜ëŠ” ì´ë²¤íŠ¸ Yê°€ ë°œìƒí•  í™•ë¥ ì„ ëª¨ë¸ë§í•˜ë©°, ì´ë•Œ ë°œìƒí•˜ëŠ” YëŠ” ì´ì „ Yì˜ ë°œìƒ ì‹œê¸°ì— ì˜í–¥ì„ ë°›ì§€ ì•ŠëŠ”ë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤. ì´ë¥¼ ìˆ˜í•™ì ìœ¼ë¡œ í‘œí˜„í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:\n\n\\[P(Y = y) = \\frac{e^{-\\lambda}\\lambda^y}{y!}\\]\n\nì—¬ê¸°ì„œ y = 0,1,2,â‹¯.\n\n<div class=\"content-ad\"></div>\n\nì—¬ê¸°ì„œ Î¼ëŠ” ë…¸ì¶œ ë‹¨ìœ„ë‹¹ ì´ë²¤íŠ¸ê°€ ë°œìƒí•  í‰ê·  íšŸìˆ˜ì…ë‹ˆë‹¤. Poisson ë¶„í¬ ë§¤ê°œ ë³€ìˆ˜ë¡œë„ ì–¸ê¸‰ë©ë‹ˆë‹¤. ë…¸ì¶œì€ ì‹œê°„, ê³µê°„, ì¸êµ¬ ê·œëª¨, ê±°ë¦¬ ë˜ëŠ” ë©´ì ì´ ë  ìˆ˜ ìˆì§€ë§Œ ì¼ë°˜ì ìœ¼ë¡œ ì‹œê°„ìœ¼ë¡œ ê°€ì •ë˜ë©°, (t)ë¡œ í‘œì‹œë©ë‹ˆë‹¤. ë…¸ì¶œ ê°’ì´ ì œê³µë˜ì§€ ì•Šìœ¼ë©´ 1ë¡œ ê°€ì •ë©ë‹ˆë‹¤.\n\n## 1.1 â€” ê°€ì •\n\nPoisson íšŒê·€ëŠ” í†µê³„ ëª¨ë¸ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ ëª¨ë¸ ì‚¬ìš© ë° ê²°ê³¼ í•´ì„ ì‹œ ê³ ë ¤í•´ì•¼ í•  íŠ¹ì • ê°€ì •ì´ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒì€ Poisson íšŒê·€ì˜ ì£¼ìš” ê°€ì •ì…ë‹ˆë‹¤:\n\nA. ê´€ì¸¡ì¹˜ì˜ ë…ë¦½ì„±: ê´€ì¸¡ì¹˜ëŠ” ì„œë¡œ ë…ë¦½ì ì´ì–´ì•¼ í•©ë‹ˆë‹¤. ì´ê²ƒì€ í•œ ê´€ì¸¡ì¹˜ì—ì„œ ì´ë²¤íŠ¸ì˜ ë°œìƒì´ ë‹¤ë¥¸ ê´€ì¸¡ì¹˜ì—ì„œ ì´ë²¤íŠ¸ì˜ ë°œìƒì— ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šì•„ì•¼ í•¨ì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ê´€ì¸¡ì¹˜ ê°„ì˜ ì˜ì¡´ì„±ì´ ìˆìœ¼ë©´ í¸í–¥ëœ ë§¤ê°œë³€ìˆ˜ ì¶”ì •ì¹˜ì™€ ì˜ëª»ëœ ì¶”ë¡ ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n<div class=\"content-ad\"></div>\n\nB. ë§¤ê°œë³€ìˆ˜ì˜ ì„ í˜•ì„±: ë…ë¦½ ë³€ìˆ˜ì™€ í¬ì•„ì†¡ ë¶„í¬ì˜ ë¡œê·¸ ë³€í™˜ëœ í‰ê·  ê°„ì˜ ê´€ê³„ëŠ” ì„ í˜•ì´ì–´ì•¼ í•©ë‹ˆë‹¤. ì´ ê°€ì •ì€ ê° ë…ë¦½ ë³€ìˆ˜ê°€ ì¢…ì† ë³€ìˆ˜ì— ë¯¸ì¹˜ëŠ” íš¨ê³¼ê°€ ë…ë¦½ ë³€ìˆ˜ì˜ ë‹¤ë¥¸ ê°’ì— ê±¸ì³ ì¼ì •í•¨ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.\n\nC. ì˜¤ë²„ë””ìŠ¤í¼ì „ìŠ¤ì˜ ë¶€ì¬: í¬ì•„ì†¡ íšŒê·€ëŠ” ì¢…ì† ë³€ìˆ˜ì˜ ë¶„ì‚°ì´ í‰ê· ê³¼ ë™ì¼í•˜ë‹¤ëŠ” ê²ƒì„ ê°€ì •í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ í˜„ì‹¤ ì„¸ê³„ì—ì„œëŠ” ë¶„ì‚°ì´ í‰ê· ì„ ì´ˆê³¼í•˜ëŠ” ì˜¤ë²„ë””ìŠ¤í¼ì „ìŠ¤ë¼ê³  ì•Œë ¤ì§„ ìƒí™©ì„ ìì£¼ ë§Œë‚©ë‹ˆë‹¤. ë§Œì•½ ì˜¤ë²„ë””ìŠ¤í¼ì „ìŠ¤ê°€ ì¡´ì¬í•œë‹¤ë©´, ë¹„íš¨ìœ¨ì ì¸ ë§¤ê°œë³€ìˆ˜ ì¶”ì •ê³¼ ê³¼ì†Œí‰ê°€ëœ í‘œì¤€ ì˜¤ì°¨ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nD. ëª¨ë¸ì˜ ì˜¬ë°”ë¥¸ ëª…ì„¸: ëª¨ë¸ì— ëª¨ë“  ê´€ë ¨ ë…ë¦½ ë³€ìˆ˜ë¥¼ í¬í•¨í•˜ê³  ëª¨ë¸ì˜ ê¸°ëŠ¥ì  í˜•íƒœë¥¼ ì˜¬ë°”ë¥´ê²Œ ëª…ì„¸í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ì¤‘ìš”í•œ ë³€ìˆ˜ë¥¼ ë¹ ëœ¨ë¦¬ê±°ë‚˜ ì˜ëª»ëœ ê¸°ëŠ¥ì  í˜•íƒœë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš° í¸í–¥ëœ ë§¤ê°œë³€ìˆ˜ ì¶”ì •ê³¼ ë¶€ì •í™•í•œ ì˜ˆì¸¡ì„ ìœ ë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nE. ê³„ìˆ˜ ë°ì´í„°: í¬ì•„ì†¡ íšŒê·€ëŠ” ë°œìƒ ì´ë²¤íŠ¸ ìˆ˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì¢…ì† ë³€ìˆ˜ê°€ ê³ ì •ëœ ì‹œê°„ ë˜ëŠ” ê³µê°„ ë‹¨ìœ„ ë‚´ì— ë°œìƒí•˜ëŠ” ê²½ìš°ì— ëŒ€í•œ ê³„ìˆ˜ ë°ì´í„°ë¥¼ ëª¨ë¸ë§í•˜ëŠ” ë° ì í•©í•©ë‹ˆë‹¤. ë¹„ê³„ìˆ˜ ë°ì´í„°ì— í¬ì•„ì†¡ íšŒê·€ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ëª¨ë¸ì˜ ê¸°ë³¸ ê°€ì •ì„ ìœ„ë°˜í•˜ê³  ì‹ ë¢°í•  ìˆ˜ ì—†ëŠ” ê²°ê³¼ë¥¼ ì´ˆë˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n<div class=\"content-ad\"></div>\n\nF. ë‹¤ì¤‘ê³µì„ ì„± ì—†ìŒ: ë…ë¦½ ë³€ìˆ˜ë“¤ ê°„ì— ë‹¤ì¤‘ê³µì„ ì„±ì´ ì—†ì–´ì•¼ í•©ë‹ˆë‹¤. ë‹¤ì¤‘ê³µì„ ì„±ì€ ë‘ ê°œ ì´ìƒì˜ ë…ë¦½ ë³€ìˆ˜ê°€ ë†’ì€ ìƒê´€ ê´€ê³„ë¥¼ ê°€ì§ˆ ë•Œ ë°œìƒí•˜ë©°, ì¢…ì† ë³€ìˆ˜ì— ëŒ€í•œ ê°œë³„ì ì¸ ì˜í–¥ì„ ì¶”ì •í•˜ê¸° ì–´ë µê²Œ ë§Œë“­ë‹ˆë‹¤. ë†’ì€ ë‹¤ì¤‘ê³µì„ ì„±ì€ í‘œì¤€ ì˜¤ì°¨ë¥¼ ê³¼ëŒ€í­ìœ¼ë¡œ ì¦í­ì‹œí‚¤ê³  ì¶”ì • ë§¤ê°œë³€ìˆ˜ë¥¼ ë¶ˆì•ˆì •í•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nG. ì´ìƒì¹˜ ì—†ìŒ: ë°ì´í„°ì˜ ì´ìƒì¹˜ëŠ” ë§¤ê°œë³€ìˆ˜ ì¶”ì •ì¹˜ì— ë¶ˆí•„ìš”í•œ ì˜í–¥ì„ ë¯¸ì¹˜ê³  ëª¨í˜•ì˜ ì „ì²´ì ì¸ ì í•©ë„ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. íšŒê·€ ê²°ê³¼ì˜ íƒ€ë‹¹ì„±ì„ ë³´ì¥í•˜ê¸° ìœ„í•´ ì´ìƒì¹˜ë¥¼ ì‹ë³„í•˜ê³  ì ì ˆíˆ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.\n\n## 1.2â€” ëª¨í˜•\n\nGeneralized Linear Models(GLM)ì€ ë°˜ì‘ ë³€ìˆ˜ê°€ ì •ê·œ ë¶„í¬ê°€ ì•„ë‹Œ ë¶„í¬ë¥¼ ë”°ë¥´ëŠ” ëª¨í˜•ì…ë‹ˆë‹¤. ì´ëŠ” ë°˜ì‘ ë³€ìˆ˜ê°€ Yes, Noì™€ ê°™ì´ ë²”ì£¼í˜•ì´ë©° âˆ’âˆë¶€í„° +âˆê¹Œì§€ ë²”ìœ„ê°€ ì•„ë‹Œ ëª¨í˜•ì—ì„œ ì„ í˜• íšŒê·€ ëª¨í˜•ê³¼ ëŒ€ì¡°ì ì…ë‹ˆë‹¤.\n\n<div class=\"content-ad\"></div>\n\në”°ë¼ì„œ, ì‘ë‹µê³¼ ì˜ˆì¸¡ ë³€ìˆ˜ ê°„ì˜ ê´€ê³„ê°€ ì„ í˜•ì¼ í•„ìš”ëŠ” ì—†ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¼ë°˜í™” ì„ í˜• ëª¨í˜•ì—ì„œëŠ”:\n\n![image](/assets/img/2024-06-20-TinyMLPoissonRegression_2.png)\n\nì—¬ê¸°ì„œ g(â‹…)ëŠ” ì„ íƒí•œ ë§í¬ í•¨ìˆ˜ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.\n\ní¬ì•„ì†¡ íšŒê·€ ëª¨í˜•ì€ ì¹´ìš´íŠ¸ ë°ì´í„° ë° ë¶„í• í‘œë¥¼ ëª¨ë¸ë§í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ì¼ë°˜í™” ì„ í˜• ëª¨í˜•ì…ë‹ˆë‹¤. ì¶œë ¥ì¸ Y(ì¹´ìš´íŠ¸)ëŠ” í¬ì•„ì†¡ ë¶„í¬ë¥¼ ë”°ë¥´ëŠ” ê°’ì…ë‹ˆë‹¤. ì´ëŠ” ì˜ˆìƒ ê°’(í‰ê· )ì˜ ë¡œê·¸ë¥¼ ì „ì œë¡œ í•˜ë©°, ì´ë¥¼ ì¼ë¶€ ì•Œë ¤ì§€ì§€ ì•Šì€ ë§¤ê°œë³€ìˆ˜ë¡œ ì„ í˜• í˜•íƒœë¡œ ëª¨ë¸ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n<div class=\"content-ad\"></div>\n\në¹„ì„ í˜• ê´€ê³„ë¥¼ ì„ í˜• í˜•íƒœë¡œ ë³€í™˜í•˜ê¸° ìœ„í•´ ë§í¬ í•¨ìˆ˜ê°€ ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ í•¨ìˆ˜ëŠ” í¬ì•„ì†¡ íšŒê·€ì˜ ë¡œê·¸ì…ë‹ˆë‹¤. ì´ë¡œ ì¸í•´ í¬ì•„ì†¡ íšŒê·€ ëª¨ë¸ì€ ì¢…ì¢… ë¡œê·¸-ì„ í˜• ëª¨ë¸ì´ë¼ê³ ë„ ë¶ˆë¦½ë‹ˆë‹¤. í¬ì•„ì†¡ íšŒê·€ ëª¨ë¸ì˜ ì¼ë°˜ì ì¸ ìˆ˜í•™ì  í˜•íƒœëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:\n\n\n<img src=\"/assets/img/2024-06-20-TinyMLPoissonRegression_3.png\" />\n\n\nì—¬ê¸°ì„œ Î¼iëŠ” ë°˜ì‘ ë³€ìˆ˜ Yiì˜ ê¸°ëŒ€ê°’ì…ë‹ˆë‹¤.\n\nê³„ìˆ˜ Î±ì™€ Î²ëŠ” ìˆ˜ì¹˜ì´ë©°, ì—¬ê¸°ì„œ Î±ëŠ” ì ˆí¸ì„ ë‚˜íƒ€ë‚´ë©° ë•Œë¡œëŠ” Î±ëŠ” Î²0ìœ¼ë¡œë„ í‘œì‹œë©ë‹ˆë‹¤. xëŠ” ì˜ˆì¸¡ ë³€ìˆ˜ ë˜ëŠ” ì„¤ëª… ë³€ìˆ˜ì…ë‹ˆë‹¤.\n\n<div class=\"content-ad\"></div>\n\ní•œ ê°œì˜ ì˜ˆì¸¡ ë³€ìˆ˜(predictor variable)ì™€ í•œ ê°œì˜ ì‘ë‹µ ë³€ìˆ˜(response variable)ë¥¼ ê°–ëŠ” ë°©ì •ì‹ì„ ê³ ë ¤í•´ ë´…ì‹œë‹¤:\n\n![equation1](/assets/img/2024-06-20-TinyMLPoissonRegression_4.png)\n\nì´ëŠ” ë‹¤ìŒê³¼ ë™ì¼í•©ë‹ˆë‹¤:\n\n![equation2](/assets/img/2024-06-20-TinyMLPoissonRegression_5.png)\n\n<div class=\"content-ad\"></div>\n\ní¬ì•„ì†¡ íšŒê·€ ëª¨í˜•ì—ì„œ ì„¤ëª…ë³€ìˆ˜ëŠ” ìˆ˜ì¹˜ê°’ ë˜ëŠ” ë²”ì£¼ê°’ì˜ ì¡°í•©ì„ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\ní¬ì•„ì†¡ ë¶„í¬ì™€ í¬ì•„ì†¡ íšŒê·€ì˜ ê°€ì¥ ì¤‘ìš”í•œ íŠ¹ì§• ì¤‘ í•˜ë‚˜ëŠ” ë“±ë¶„ì‚°ì„±ì…ë‹ˆë‹¤. ì´ëŠ” ë¶„í¬ì˜ í‰ê· ê³¼ ë¶„ì‚°ì´ ê°™ìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.\n\ní‰ê· ì„ Î¼ë¼ê³  ê°€ì •í•´ë³´ê² ìŠµë‹ˆë‹¤. í¬ì•„ì†¡ íšŒê·€ì—ì„œëŠ” í‰ê· ê³¼ ë¶„ì‚°ì´ ë‹¤ìŒê³¼ ê°™ì´ ê´€ë ¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤:\n\n![equation](/assets/img/2024-06-20-TinyMLPoissonRegression_6.png)\n\n<div class=\"content-ad\"></div>\n\nì—¬ê¸°ì„œ ÏƒÂ²ì€ ë¶„ì‚° íŒŒë¼ë¯¸í„°ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. í¬ì•„ì†¡ ëª¨ë¸ì´ ì™„ì „íˆ ì í•©ë˜ë ¤ë©´ ë¶„ì‚°ì´ í‰ê· ê³¼ ë™ì¼í•´ì•¼ í•©ë‹ˆë‹¤(var(Y) = E(Y)) ì¦‰, ÏƒÂ² ê°’ì€ 1ì´ ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.\n\në¶„ì‚°ì´ í‰ê· ë³´ë‹¤ í´ ë•Œì—ëŠ” ì´ë¥¼ ì´ˆê³¼ë¶„ì‚°(overdispersion)ì´ë¼ê³  í•˜ë©°, ÏƒÂ² ê°’ì´ 1ë³´ë‹¤ í½ë‹ˆë‹¤. ë°˜ë©´ ÏƒÂ² ê°’ì´ 1ë³´ë‹¤ ì‘ì„ ë•Œì—ëŠ” ì´ë¥¼ ë¯¸ë‹¬ë¶„ì‚°(underdispersion)ì´ë¼ê³  í•©ë‹ˆë‹¤.\n\n## 1.3 â€” ê³„ìˆ˜ ì¶”ì •\n\ní¬ì•„ì†¡ íšŒê·€ì—ì„œëŠ” ëª¨ë¸ íŒŒë¼ë¯¸í„°ë¥¼ ì¶”ì •í•˜ì—¬ ë…ë¦½ ë³€ìˆ˜ì™€ ì¢…ì† ê³„ìˆ˜ ë³€ìˆ˜ ê°„ì˜ ìµœì  ê´€ê³„ë¥¼ ì°¾ìŠµë‹ˆë‹¤. ì´ ì¶”ì •ì€ ì£¼ë¡œ ìµœëŒ€ ìš°ë„ë²•ì„ ì‚¬ìš©í•˜ì—¬ ìˆ˜í–‰ë©ë‹ˆë‹¤.\n\n<div class=\"content-ad\"></div>\n\n## 1.3.1 â€” ìµœëŒ€ ìš°ë„ ë°©ë²• (Maximum Likelihood Method, MLM)\n\nìµœëŒ€ ìš°ë„ ë°©ë²•ì€ í†µê³„ ëª¨ë¸ì˜ ë§¤ê°œ ë³€ìˆ˜ë¥¼ ì¶”ì •í•˜ê¸° ìœ„í•œ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” í†µê³„ ê¸°ë²•ì…ë‹ˆë‹¤. ì´ ë°©ë²•ì€ ê´€ì¸¡ëœ ë°ì´í„°ì˜ ìš°ë„ë¥¼ ê·¹ëŒ€í™”í•˜ëŠ” ë§¤ê°œ ë³€ìˆ˜ ê°’ì„ ì°¾ìŠµë‹ˆë‹¤. ì¦‰, ìš°ë¦¬ëŠ” ì œì•ˆëœ ëª¨ë¸ì— ì˜í•´ ìƒì„±ë˜ì—ˆì„ ê°€ëŠ¥ì„±ì´ ê°€ì¥ ë†’ì€ ê´€ì¸¡ëœ ë°ì´í„°ë¥¼ ë§Œë“œëŠ” ë§¤ê°œ ë³€ìˆ˜ë¥¼ ì°¾ìŠµë‹ˆë‹¤.\n\ní¬ì•„ì†¡ íšŒê·€ ë¶„ì„ì—ì„œ ìš°ë„ í•¨ìˆ˜ëŠ” ê° ê°œë³„ ê´€ì¸¡ì„ ìœ„í•œ ê´€ì¸¡ëœ íšŸìˆ˜ë¥¼ ê´€ì¸¡ í™•ë¥ ì˜ ê³±ìœ¼ë¡œ ì •ì˜ë©ë‹ˆë‹¤. í˜•ì‹ì ìœ¼ë¡œ, ìš°ë„ í•¨ìˆ˜ L(Î²0, Î²1,â€¦, Î²p)ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì£¼ì–´ì§‘ë‹ˆë‹¤:\n\n<div class=\"content-ad\"></div>\n\nì—¬ê¸°ì— ìˆìŠµë‹ˆë‹¤:\n\n- nì€ ì´ ê´€ì¸¡ê°’ì˜ ìˆ˜ì…ë‹ˆë‹¤.\n- yiëŠ” ië²ˆì§¸ ê´€ì¸¡ê°’ì˜ ê´€ì¸¡ëœ ìˆ˜ì…ë‹ˆë‹¤.\n- Î¼iëŠ” ië²ˆì§¸ ê´€ì¸¡ê°’ì— í•´ë‹¹í•˜ëŠ” ì´ë¡ ì  í‰ê· ìœ¼ë¡œ, ë¡œê·¸ ë§í¬ í•¨ìˆ˜ì— ì˜í•´ ì£¼ì–´ì§‘ë‹ˆë‹¤.\n\níŒŒë¼ë¯¸í„° ì¶”ì •ì˜ ëª©í‘œëŠ” ìš°ë„ í•¨ìˆ˜ë¥¼ ìµœëŒ€í™”í•˜ëŠ” ê³„ìˆ˜ Î²0, Î²1,..., Î²pì˜ ê°’ì„ ì°¾ëŠ” ê²ƒì…ë‹ˆë‹¤. ë‹¤ì‹œ ë§í•´, ìš°ë¦¬ëŠ” ê´€ì¸¡ëœ ë°ì´í„°ê°€ í¬ì•„ì†¡ íšŒê·€ ëª¨ë¸ì— ì˜í•´ ìƒì„±ë˜ì—ˆì„ ê°€ëŠ¥ì„±ì´ ê°€ì¥ ë†’ì€ ë§¤ê°œë³€ìˆ˜ë¥¼ ì°¾ìŠµë‹ˆë‹¤.\n\n# 2 â€” TinyML êµ¬í˜„\n\n<div class=\"content-ad\"></div>\n\nìœ„ì˜ ì˜ˆì‹œë¥¼ í†µí•´ ESP32, Arduino, Arduino Portenta H7 with Vision Shield, Raspberry ë° ë‹¤ë¥¸ ë‹¤ì–‘í•œ ë§ˆì´í¬ë¡œì»¨íŠ¸ë¡¤ëŸ¬ ë˜ëŠ” IoT ê¸°ê¸°ì—ì„œ ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n2.0 â€” requirements.txt íŒŒì¼ì— ë‚˜ì—´ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•˜ì„¸ìš”\n\n```js\n!pip install -r requirements.txt\n```\n\n2.1 â€” ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°€ì ¸ì˜¤ê¸°\n\n<div class=\"content-ad\"></div>\n\n```python\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import PoissonRegressor\nfrom sklearn.metrics import (\n    mean_absolute_error,\n    mean_poisson_deviance,\n    mean_squared_error,\n)\n\nimport m2cgen as m2c\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\n\nfrom matplotlib import pyplot as plt\n\nimport warnings\nwarnings.filterwarnings('ignore')\n```\n\n2.2 â€” ë°ì´í„°ì…‹ ë¡œë“œ\n\nâ€œì°¨ëŸ‰ ì†ì„± ë° ë°°ì¶œ ë°ì´í„°ì…‹â€ì€ 2000ë…„ì— ì œì¡°ëœ ë‹¤ì–‘í•œ ì°¨ëŸ‰ì— ëŒ€í•œ í¬ê´„ì ì¸ ì •ë³´ë¥¼ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ ë°ì´í„°ì…‹ì—ëŠ” ì œì¡°ì‚¬, ëª¨ë¸, ì°¨ëŸ‰ í´ë˜ìŠ¤, ì—”ì§„ í¬ê¸°, ì‹¤ë¦°ë” ìˆ˜, ë³€ì†ê¸° ìœ í˜• ë° ì—°ë£Œ ìœ í˜•ê³¼ ê°™ì€ ì„¸ë¶€ ì •ë³´ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë˜í•œ ì—°ë£Œ ì†Œë¹„ ë° ì´ì‚°í™”íƒ„ì†Œ ë°°ì¶œì— ëŒ€í•œ ë²”ìœ„ë¥¼ ì œê³µí•˜ì—¬ ê° ì°¨ëŸ‰ì˜ í™˜ê²½ ì˜í–¥ì— ëŒ€í•œ í†µì°°ì„ ì œê³µí•©ë‹ˆë‹¤. ì´ ë°ì´í„°ì…‹ì€ ì†Œí˜•ë¶€í„° ì¤‘í˜•ê¹Œì§€ ë‹¤ì–‘í•œ ì°¨ì¢…ì„ í¬í•¨í•˜ë©°, ì „í†µì ì¸ ëª¨ë¸ë¶€í„° ê³ ì„±ëŠ¥ ëª¨ë¸ê¹Œì§€ ëª¨ë‘ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ ì •ë³´ë¥¼ í†µí•´ ë¶„ì„ê°€ì™€ ì—°êµ¬ìëŠ” ì°¨ëŸ‰ íŠ¹ì„±, ì—°ë£Œ íš¨ìœ¨ì„± ë° ë°°ì¶œ ì¶”ì„¸ë¥¼ ì—°êµ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë°ì´í„°ì…‹ì€ ìë™ì°¨ ì‚°ì—… í™˜ê²½ì„ ì´í•´í•˜ê³  í™˜ê²½ ì§€ì† ê°€ëŠ¥ì„± ë° êµí†µ ì •ì±…ì— ëŒ€í•œ ë…¼ì˜ì— ì •ë³´ë¥¼ ì œê³µí•˜ëŠ” ì†Œì¤‘í•œ ìë£Œì›ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.\n\në§í¬: https://www.kaggle.com/datasets/krupadharamshi/fuelconsumption/data\n\n\n<div class=\"content-ad\"></div>\n\n```python\ndf = pd.read_csv('./data/FuelConsumption.csv')\ndf.head()\n```\n\n<img src=\"/assets/img/2024-06-20-TinyMLPoissonRegression_8.png\" />\n\n```python\ndf.info()\n```\n\n<img src=\"/assets/img/2024-06-20-TinyMLPoissonRegression_9.png\" />\n\n\n<div class=\"content-ad\"></div>\n\n```js\ndf.describe()\n```\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-20-TinyMLPoissonRegression_10.png)\n\n2.3 â€” ë°ì´í„° ì •ë¦¬\n\n```js\n# 1. ê²°ì¸¡ê°’ì´ ìˆëŠ” í–‰ ì œê±°\ndf.dropna(inplace=True)\n# 2. ì¤‘ë³µê°’ ì œê±°\ndf.drop_duplicates(inplace=True)\n```\n\n<div class=\"content-ad\"></div>\n\n\n# ë°ì´í„° í”„ë ˆì„ ì •ë¦¬ í›„ì— ê²°ê³¼ í‘œì‹œ\ndf.describe()\n\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-20-TinyMLPoissonRegression_11.png)\n\n2.4 â€” íƒìƒ‰ì  ë°ì´í„° ë¶„ì„\n\n```python\nsns.pairplot(df[['ENGINE SIZE','CYLINDERS','FUEL CONSUMPTION','COEMISSIONS ']])\nplt.savefig('.\\\\figures\\\\pairplot.png', dpi=300, bbox_inches='tight')\n```\n\n<div class=\"content-ad\"></div>\n\n\n<img src=\"/assets/img/2024-06-20-TinyMLPoissonRegression_12.png\" />\n\n```js\ncorr = df[['ENGINE SIZE','CYLINDERS','FUEL CONSUMPTION','COEMISSIONS ']].corr('spearman')\n```\n\n```js\n# ê·¸ë¦¼ í¬ê¸° ì¡°ì ˆ\nplt.figure(figsize=(18,10))\n# íˆíŠ¸ë§µ ìƒì„±ì„ ìœ„í•œ ê¸°ì¡´ ì½”ë“œ\nheatmap = sns.heatmap(corr, xticklabels=corr.columns, yticklabels=corr.columns, cmap='coolwarm')\n# íˆíŠ¸ë§µì— ê°’ ì¶”ê°€\nfor i in range(len(corr.columns)):\n    for j in range(len(corr.columns)):\n        plt.text(j + 0.5, i + 0.5, f\"{corr.iloc[i, j]:.2f}\", ha='center', va='center', color='black', fontsize=18)\n\nplt.xticks(fontsize=20, rotation=45)\nplt.yticks(fontsize=20, rotation=0)\ncbar = heatmap.collections[0].colorbar\ncbar.ax.tick_params(labelsize=20)\n\nplt.savefig('.\\\\figures\\\\heatmap.png', dpi=300, bbox_inches='tight')\n\n# íˆíŠ¸ë§µ í‘œì‹œ\nplt.show()\n```\n\n<img src=\"/assets/img/2024-06-20-TinyMLPoissonRegression_13.png\" />\n\n\n<div class=\"content-ad\"></div>\n\n2.5â€” í›ˆë ¨ ë° í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ ë¶„í• í•˜ê¸°\n\n```js\nX=df[['ì—”ì§„ í¬ê¸°','ì‹¤ë¦°ë”', 'CO2 ë°°ì¶œëŸ‰']]\ny=df[['ì—°ë£Œ ì†Œë¹„']]\n```\n\n```js\n# ë°ì´í„°ë¥¼ í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¡œ ë¶„í• í•˜ê¸°\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)\n```\n\n2.6 â€” íšŒê·€ ëª¨ë¸ ìƒì„±í•˜ê¸°\n\n<div class=\"content-ad\"></div>\n\n```js\ndef score_estimator(y_pred , y_true):\n\n    print(\n        \"MSE: %.3f\"\n        % mean_squared_error(\n            y_true, y_pred\n        )\n    )\n    print(\n        \"MAE: %.3f\"\n        % mean_absolute_error(\n            y_true, y_pred, \n        )\n    )\n\n    # í‘¸ì•„ì†¡ ì†ì‹¤ì„ ê³„ì‚°í•  ë•Œ, ìœ íš¨í•˜ì§€ ì•Šì€ ë¹„ ì–‘ìˆ˜ ì˜ˆì¸¡ì„ ë¬´ì‹œí•©ë‹ˆë‹¤.\n    mask = y_pred > 0\n    if (~mask).any():\n        n_masked, n_samples = (~mask).sum(), mask.shape[0]\n        print(\n            \"ê²½ê³ : ì¶”ì •ìê°€ í‘¸ì•„ì†¡ ì†ì‹¤ì„ ê³„ì‚°í•  ë•Œ, %sê°œì˜ ìƒ˜í”Œ ì¤‘ %sê°œì˜ ë¹„ ìœ íš¨í•œ, ë¹„ ì–‘ìˆ˜ ì˜ˆì¸¡ ê°’ì´ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ì˜ˆì¸¡ ê°’ì€ í‘¸ì•„ì†¡ ì†ì‹¤ì„ ê³„ì‚°í•  ë•Œ ë¬´ì‹œë©ë‹ˆë‹¤.\"\n            % (n_samples, n_masked)\n        )\n\n    print(\n        \"í‰ê·  í‘¸ì•„ì†¡ ì†ì‹¤: %.3f\"\n        % mean_poisson_deviance(\n            y_true ,\n            y_pred  \n        )\n    )\n```\n\n```js\nmodel = PoissonRegressor(alpha=1e-12)\n```\n\n2.7 â€” ëª¨ë¸ í•™ìŠµ\n\n```js\nmodel.fit(X_train, y_train)\n```\n\n<div class=\"content-ad\"></div>\n\n2.8 â€” ëª¨ë¸ í‰ê°€\n\n```js\ny_train_pred = model.predict(X_train)\ny_test_pred = model.predict(X_test)\n```\n\n```js\n# ì”ì°¨ ê³„ì‚°\ntrain_residuals = y_train.values.reshape(1,-1).tolist()[0] - y_train_pred\n# ì”ì°¨ì˜ í‰ê· ê³¼ í‘œì¤€ í¸ì°¨ ê³„ì‚°\ntrain_residuals_mean = np.mean(train_residuals)\ntrain_residuals_std = np.std(train_residuals)\n# ì”ì°¨ ê³„ì‚°\ntest_residuals = y_test.values.reshape(1,-1).tolist()[0] - y_test_pred\n# ì”ì°¨ì˜ í‰ê· ê³¼ í‘œì¤€ í¸ì°¨ ê³„ì‚°\ntest_residuals_mean = np.mean(test_residuals)\ntest_residuals_std = np.std(test_residuals)\n\n\n# ì”ì°¨ ì‹œê°í™”\nplt.figure(figsize=(10, 5))\n\nplt.subplot(1, 2, 1)\nplt.scatter(y_train_pred, train_residuals, c='blue', marker='o', label=f'í•™ìŠµ ë°ì´í„°')\nplt.axhline(y=0, color='r', linestyle='-')\nplt.axhline(y=train_residuals_mean, color='k', linestyle='--', label=f'í‰ê· : {train_residuals_mean:.3f}')\nplt.axhline(y=train_residuals_mean + 2 * train_residuals_std, color='g', linestyle='--', label=f'+2 í‘œì¤€ í¸ì°¨: {2*train_residuals_std:.2f}')\nplt.axhline(y=train_residuals_mean - 2 * train_residuals_std, color='g', linestyle='--', label=f'-2 í‘œì¤€ í¸ì°¨: {-2*train_residuals_std:.2f}')  \nplt.xlabel('ì˜ˆì¸¡ ê°’')\nplt.ylabel('ì”ì°¨')\nplt.title('ì”ì°¨ ëŒ€ ì˜ˆì¸¡ ê°’ (í•™ìŠµ ë°ì´í„°)')\nplt.legend(loc='upper left')\nplt.grid(True)\n\nplt.subplot(1, 2, 2)\nplt.scatter(y_test_pred, test_residuals, c='green', marker='s', label=f'í…ŒìŠ¤íŠ¸ ë°ì´í„°')\nplt.axhline(y=0, color='r', linestyle='-')\nplt.axhline(y=test_residuals_mean, color='k', linestyle='--', label=f'í‰ê· : {test_residuals_mean:.3f}')\nplt.axhline(y=test_residuals_mean + 2 * test_residuals_std, color='g', linestyle='--', label=f'+2 í‘œì¤€ í¸ì°¨: {2*test_residuals_std:.2f}')\nplt.axhline(y=test_residuals_mean - 2 * test_residuals_std, color='g', linestyle='--', label=f'-2 í‘œì¤€ í¸ì°¨: {-2*test_residuals_std:.2f}')  \nplt.xlabel('ì˜ˆì¸¡ ê°’')\nplt.ylabel('ì”ì°¨')\nplt.title('ì”ì°¨ ëŒ€ ì˜ˆì¸¡ ê°’ (í…ŒìŠ¤íŠ¸ ë°ì´í„°)')\nplt.legend(loc='upper left')\nplt.grid(True)\n\nplt.tight_layout()\nplt.show()\n\n\n\n# ì •ê·œì„± í™•ì¸\nplt.figure(figsize=(10, 5))\n\nplt.subplot(1, 2, 1)\nplt.hist(train_residuals, bins=20, color='blue', alpha=0.6)\nplt.title('ì”ì°¨ íˆìŠ¤í† ê·¸ë¨ (í•™ìŠµ ë°ì´í„°)')\nplt.xlabel('ì”ì°¨')\nplt.ylabel('ë¹ˆë„')\nplt.axvline(x=train_residuals_mean, color='k', linestyle='--', label=f'í‰ê· : {train_residuals_mean:.3f}')\nplt.axvline(x=train_residuals_mean + 2 * train_residuals_std, color='g', linestyle='--', label=f'+2 í‘œì¤€ í¸ì°¨: {2*train_residuals_std:.3f}')\nplt.axvline(x=train_residuals_mean - 2 * train_residuals_std, color='g', linestyle='--', label=f'-2 í‘œì¤€ í¸ì°¨: {-2*train_residuals_std:.3f}')  \nplt.legend(loc='upper right')\nplt.grid(True)\n\nplt.subplot(1, 2, 2)\nplt.hist(test_residuals, bins=20, color='green', alpha=0.6)\nplt.title('ì”ì°¨ íˆìŠ¤í† ê·¸ë¨ (í…ŒìŠ¤íŠ¸ ë°ì´í„°)')\nplt.xlabel('ì”ì°¨')\nplt.ylabel('ë¹ˆë„')\nplt.axvline(x=test_residuals_mean, color='k', linestyle='--', label=f'í‰ê· : {test_residuals_mean:.3f}')\nplt.axvline(x=test_residuals_mean + 2 * test_residuals_std, color='g', linestyle='--', label=f'+2 í‘œì¤€ í¸ì°¨: {2*test_residuals_std:.3f}')\nplt.axvline(x=test_residuals_mean - 2 * test_residuals_std, color='g', linestyle='--', label=f'-2 í‘œì¤€ í¸ì°¨: {-2*test_residuals_std:.3f}')  \nplt.legend(loc='upper right')\nplt.grid(True)\n\nplt.tight_layout()\nplt.show()\n```\n\n<div class=\"content-ad\"></div>\n\nì•ˆë…•í•˜ì„¸ìš”! ìš”ì²­í•˜ì‹  ë‚´ìš©ì„ í•œêµ­ì–´ë¡œ ë²ˆì—­í•´ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-20-TinyMLPoissonRegression_15.png)\n\n2.8.1 â€” í›ˆë ¨ ë°ì´í„°ë¡œ ëª¨ë¸ í‰ê°€í•˜ê¸°\n\n```js\nprint(\"PoissonRegressor í‰ê°€:\")\nscore_estimator(y_train_pred, y_train)\n```\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-20-TinyMLPoissonRegression_16.png)\n\n<div class=\"content-ad\"></div>\n\n```js\nplt.plot(y_train.values, label=\"ì›ë³¸\")\nplt.plot(y_train_pred, label=\"ì˜ˆì¸¡\")\nplt.legend(loc='best', fancybox=True, shadow=True)\nplt.grid()\n```\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-20-TinyMLPoissonRegression_17.png)\n\n2.8.2 â€” í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ ëª¨ë¸ í‰ê°€\n\n```js\nprint(\"PoissonRegressor í‰ê°€:\")\nscore_estimator(y_test_pred, y_test)\n```\n\n<div class=\"content-ad\"></div>\n\n![2024-06-20-TinyMLPoissonRegression_18.png](/assets/img/2024-06-20-TinyMLPoissonRegression_18.png)\n\n```js\nplt.plot(y_test.values, label=\"original\")\nplt.plot(y_test_pred, label=\"predicted\")\nplt.legend(loc='best', fancybox=True, shadow=True)\nplt.grid()\n```\n\n![2024-06-20-TinyMLPoissonRegression_19.png](/assets/img/2024-06-20-TinyMLPoissonRegression_19.png)\n\n2.9 â€” Microcontrollerì— êµ¬í˜„ë  ëª¨ë¸ ì–»ê¸°\n\n<div class=\"content-ad\"></div>\n\n```js\ncode = m2c.export_to_c(model)\nprint(code)\n```\n\n```js\n#include <math.h>\ndouble score(double *input)\n{\n    return exp(1.7347124654302846 + input[0] * 0.011406244946132144 + input[1] * 0.01010646886054758 + input[2] * 0.0028201461971878914);\n}\n```\n\n2.10â€” .h íŒŒì¼ì— í…œí”Œë¦¿ ì €ì¥\n\n```js\nwith open('./PoissonRegressor.h', 'w') as file:\n    file.write(code)\n```\n\n<div class=\"content-ad\"></div>\n\n## 2.11 â€” ëª¨ë¸ ë°°í¬\n\n2.11.1 â€” ì•„ë‘ì´ë…¸ ìŠ¤ì¼€ì¹˜ ì™„ì„±\n\n```js\n#include \"PoissonRegressor.h\"\n\nEloquent::ML::Port::PoissonRegressor PoissonRegressor;\n\nvoid setup()\n{\n  Serial.begin(115200);\n}\n\nvoid loop()\n{\n  float X_1[] = {6., 2.7, 5.1, 1.6};\n  int result_1 = PoissonRegressor.predict(X_1);\n  Serial.print(\"X1ì„ ì…ë ¥ìœ¼ë¡œ í•œ ì˜ˆì¸¡ ê²°ê³¼(ì‹¤ì œ ê°’ = 1):\");\n  Serial.println(result_1);\n  delay(2000);\n\n  float X_2[] = {4.8, 3.1, 1.6, 0.2};\n  int result_2 = PoissonRegressor.predict(X_2);\n  Serial.print(\"X2ì„ ì…ë ¥ìœ¼ë¡œ í•œ ì˜ˆì¸¡ ê²°ê³¼(ì‹¤ì œ ê°’ = 0):\");\n  Serial.println(result_2);\n  delay(2000);\n}\n```\n\n2.12 â€” ê²°ê³¼\n\n<div class=\"content-ad\"></div>\n\n![ì´ë¯¸ì§€](/assets/img/2024-06-20-TinyMLPoissonRegression_20.png)\n\nì „ì²´ í”„ë¡œì íŠ¸: TinyML/15_Poisson_Regressor at main Â· thommaskevin/TinyML (github.com)\n\n## ë§Œì•½ ë§ˆìŒì— ë“œì‹ ë‹¤ë©´ ì œê²Œ ì»¤í”¼ í•œ ì” ì‚¬ì£¼ì„¸ìš” â˜•ï¸ğŸ’° (Bitcoin)\n\nì½”ë“œ: bc1qzydjy4m9yhmjjrkgtrzhsgmkq79qenvcvc7qzn\n\n<div class=\"content-ad\"></div>\n\n\n![image](/assets/img/2024-06-20-TinyMLPoissonRegression_21.png)\n","ogImage":{"url":"/assets/img/2024-06-20-TinyMLPoissonRegression_0.png"},"coverImage":"/assets/img/2024-06-20-TinyMLPoissonRegression_0.png","tag":["Tech"],"readingTime":15},"content":"<!doctype html>\n<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n</head>\n<body>\n<p>ìˆ˜í•™ì  ê¸°ì´ˆë¶€í„° ì—£ì§€ êµ¬í˜„ê¹Œì§€</p>\n<h1>ì†Œì…œ ë¯¸ë””ì–´:</h1>\n<p>ğŸ‘¨ğŸ½â€ğŸ’» Github: thommaskevin/TinyML (github.com)\nğŸ‘·ğŸ¾ Linkedin: Thommas Kevin | LinkedIn\nğŸ“½ Youtube: Thommas Kevin â€” YouTube\nğŸ‘¨ğŸ»â€ğŸ« Research group: Conecta.ai (ufrn.br)</p>\n<p><img src=\"/assets/img/2024-06-20-TinyMLPoissonRegression_0.png\" alt=\"ì´ë¯¸ì§€\"></p>\n<div class=\"content-ad\"></div>\n<h2>ìš”ì•½</h2>\n<h1>1 â€” í¬ì•„ì†¡ íšŒê·€ ì´ë¡ </h1>\n<p>í¬ì•„ì†¡ íšŒê·€ ëª¨í˜•ì€ ê²°ê³¼ê°€ ë°œìƒ íšŸìˆ˜ì¸ ì´ë²¤íŠ¸ë¥¼ ë¬˜ì‚¬í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤: ë¬´ì–‘í•œ ì •ìˆ˜ ê°’ì˜ ì´ì‚° ë°ì´í„°ë¡œ, ì–´ë–¤ ì¼ì´ ì–´ëŠ ê¸°ê°„ ë™ì•ˆ ëª‡ ë²ˆ ë°œìƒí•˜ëŠ”ì§€ë‚˜ ìŠˆí¼ë§ˆì¼“ ëŒ€ê¸° ì¤„ì— ìˆëŠ” ì‚¬ëŒ ìˆ˜ì™€ ê°™ì´ ë¬´ì–‘í•œ ê²ƒì„ ê³„ì‚°í•©ë‹ˆë‹¤.</p>\n<p>ê³„ìˆ˜ ë°ì´í„°ëŠ” ë¹„ìœ¨ ë°ì´í„°ë¡œë„ í‘œí˜„ë  ìˆ˜ ìˆìœ¼ë©°, ì–´ë–¤ ì¼ì´ íŠ¹ì • ê¸°ê°„ ë‚´ì— ëª‡ ë²ˆ ë°œìƒí•˜ëŠ”ì§€ë¥¼ ìˆœìˆ˜í•œ ê°œìˆ˜ë¡œ í‘œí˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, í•˜ë£¨ì— ì„¸ ë¼ ì‹ì‚¬ë¥¼ í•©ë‹ˆë‹¤.</p>\n<div class=\"content-ad\"></div>\n<p>Poisson íšŒê·€ëŠ” ì¹´ìš´íŠ¸ ë°ì´í„°ì™€ ë¹„ìœ¨ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ëŠ” ë° ë„ì›€ì´ ë˜ë©°, íŠ¹ì • ì‘ë‹µ ë³€ìˆ˜ Yì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ì„¤ëª… ë³€ìˆ˜ê°€ ë¬´ì—‡ì¸ì§€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ìŠˆí¼ë§ˆì¼“ì€ í¬ì•„ì†¡ íšŒê·€ë¥¼ ì‚¬ìš©í•˜ì—¬ ëŒ€ê¸°ì¤„ì— ìˆëŠ” ì‚¬ëŒ ìˆ˜ë¥¼ ë” ì˜ ì´í•´í•˜ê³  ì˜ˆì¸¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>í¬ì•„ì†¡ ë¶„í¬ëŠ” íŠ¹ì • ì‹œê°„ ë™ì•ˆ ì´ë²¤íŠ¸ ë˜ëŠ” ì´ë²¤íŠ¸ Yê°€ ë°œìƒí•  í™•ë¥ ì„ ëª¨ë¸ë§í•˜ë©°, ì´ë•Œ ë°œìƒí•˜ëŠ” YëŠ” ì´ì „ Yì˜ ë°œìƒ ì‹œê¸°ì— ì˜í–¥ì„ ë°›ì§€ ì•ŠëŠ”ë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤. ì´ë¥¼ ìˆ˜í•™ì ìœ¼ë¡œ í‘œí˜„í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p>\n<p>[P(Y = y) = \\frac{e^{-\\lambda}\\lambda^y}{y!}]</p>\n<p>ì—¬ê¸°ì„œ y = 0,1,2,â‹¯.</p>\n<div class=\"content-ad\"></div>\n<p>ì—¬ê¸°ì„œ Î¼ëŠ” ë…¸ì¶œ ë‹¨ìœ„ë‹¹ ì´ë²¤íŠ¸ê°€ ë°œìƒí•  í‰ê·  íšŸìˆ˜ì…ë‹ˆë‹¤. Poisson ë¶„í¬ ë§¤ê°œ ë³€ìˆ˜ë¡œë„ ì–¸ê¸‰ë©ë‹ˆë‹¤. ë…¸ì¶œì€ ì‹œê°„, ê³µê°„, ì¸êµ¬ ê·œëª¨, ê±°ë¦¬ ë˜ëŠ” ë©´ì ì´ ë  ìˆ˜ ìˆì§€ë§Œ ì¼ë°˜ì ìœ¼ë¡œ ì‹œê°„ìœ¼ë¡œ ê°€ì •ë˜ë©°, (t)ë¡œ í‘œì‹œë©ë‹ˆë‹¤. ë…¸ì¶œ ê°’ì´ ì œê³µë˜ì§€ ì•Šìœ¼ë©´ 1ë¡œ ê°€ì •ë©ë‹ˆë‹¤.</p>\n<h2>1.1 â€” ê°€ì •</h2>\n<p>Poisson íšŒê·€ëŠ” í†µê³„ ëª¨ë¸ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ ëª¨ë¸ ì‚¬ìš© ë° ê²°ê³¼ í•´ì„ ì‹œ ê³ ë ¤í•´ì•¼ í•  íŠ¹ì • ê°€ì •ì´ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒì€ Poisson íšŒê·€ì˜ ì£¼ìš” ê°€ì •ì…ë‹ˆë‹¤:</p>\n<p>A. ê´€ì¸¡ì¹˜ì˜ ë…ë¦½ì„±: ê´€ì¸¡ì¹˜ëŠ” ì„œë¡œ ë…ë¦½ì ì´ì–´ì•¼ í•©ë‹ˆë‹¤. ì´ê²ƒì€ í•œ ê´€ì¸¡ì¹˜ì—ì„œ ì´ë²¤íŠ¸ì˜ ë°œìƒì´ ë‹¤ë¥¸ ê´€ì¸¡ì¹˜ì—ì„œ ì´ë²¤íŠ¸ì˜ ë°œìƒì— ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šì•„ì•¼ í•¨ì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ê´€ì¸¡ì¹˜ ê°„ì˜ ì˜ì¡´ì„±ì´ ìˆìœ¼ë©´ í¸í–¥ëœ ë§¤ê°œë³€ìˆ˜ ì¶”ì •ì¹˜ì™€ ì˜ëª»ëœ ì¶”ë¡ ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"content-ad\"></div>\n<p>B. ë§¤ê°œë³€ìˆ˜ì˜ ì„ í˜•ì„±: ë…ë¦½ ë³€ìˆ˜ì™€ í¬ì•„ì†¡ ë¶„í¬ì˜ ë¡œê·¸ ë³€í™˜ëœ í‰ê·  ê°„ì˜ ê´€ê³„ëŠ” ì„ í˜•ì´ì–´ì•¼ í•©ë‹ˆë‹¤. ì´ ê°€ì •ì€ ê° ë…ë¦½ ë³€ìˆ˜ê°€ ì¢…ì† ë³€ìˆ˜ì— ë¯¸ì¹˜ëŠ” íš¨ê³¼ê°€ ë…ë¦½ ë³€ìˆ˜ì˜ ë‹¤ë¥¸ ê°’ì— ê±¸ì³ ì¼ì •í•¨ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</p>\n<p>C. ì˜¤ë²„ë””ìŠ¤í¼ì „ìŠ¤ì˜ ë¶€ì¬: í¬ì•„ì†¡ íšŒê·€ëŠ” ì¢…ì† ë³€ìˆ˜ì˜ ë¶„ì‚°ì´ í‰ê· ê³¼ ë™ì¼í•˜ë‹¤ëŠ” ê²ƒì„ ê°€ì •í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ í˜„ì‹¤ ì„¸ê³„ì—ì„œëŠ” ë¶„ì‚°ì´ í‰ê· ì„ ì´ˆê³¼í•˜ëŠ” ì˜¤ë²„ë””ìŠ¤í¼ì „ìŠ¤ë¼ê³  ì•Œë ¤ì§„ ìƒí™©ì„ ìì£¼ ë§Œë‚©ë‹ˆë‹¤. ë§Œì•½ ì˜¤ë²„ë””ìŠ¤í¼ì „ìŠ¤ê°€ ì¡´ì¬í•œë‹¤ë©´, ë¹„íš¨ìœ¨ì ì¸ ë§¤ê°œë³€ìˆ˜ ì¶”ì •ê³¼ ê³¼ì†Œí‰ê°€ëœ í‘œì¤€ ì˜¤ì°¨ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>D. ëª¨ë¸ì˜ ì˜¬ë°”ë¥¸ ëª…ì„¸: ëª¨ë¸ì— ëª¨ë“  ê´€ë ¨ ë…ë¦½ ë³€ìˆ˜ë¥¼ í¬í•¨í•˜ê³  ëª¨ë¸ì˜ ê¸°ëŠ¥ì  í˜•íƒœë¥¼ ì˜¬ë°”ë¥´ê²Œ ëª…ì„¸í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ì¤‘ìš”í•œ ë³€ìˆ˜ë¥¼ ë¹ ëœ¨ë¦¬ê±°ë‚˜ ì˜ëª»ëœ ê¸°ëŠ¥ì  í˜•íƒœë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš° í¸í–¥ëœ ë§¤ê°œë³€ìˆ˜ ì¶”ì •ê³¼ ë¶€ì •í™•í•œ ì˜ˆì¸¡ì„ ìœ ë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>E. ê³„ìˆ˜ ë°ì´í„°: í¬ì•„ì†¡ íšŒê·€ëŠ” ë°œìƒ ì´ë²¤íŠ¸ ìˆ˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì¢…ì† ë³€ìˆ˜ê°€ ê³ ì •ëœ ì‹œê°„ ë˜ëŠ” ê³µê°„ ë‹¨ìœ„ ë‚´ì— ë°œìƒí•˜ëŠ” ê²½ìš°ì— ëŒ€í•œ ê³„ìˆ˜ ë°ì´í„°ë¥¼ ëª¨ë¸ë§í•˜ëŠ” ë° ì í•©í•©ë‹ˆë‹¤. ë¹„ê³„ìˆ˜ ë°ì´í„°ì— í¬ì•„ì†¡ íšŒê·€ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ëª¨ë¸ì˜ ê¸°ë³¸ ê°€ì •ì„ ìœ„ë°˜í•˜ê³  ì‹ ë¢°í•  ìˆ˜ ì—†ëŠ” ê²°ê³¼ë¥¼ ì´ˆë˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"content-ad\"></div>\n<p>F. ë‹¤ì¤‘ê³µì„ ì„± ì—†ìŒ: ë…ë¦½ ë³€ìˆ˜ë“¤ ê°„ì— ë‹¤ì¤‘ê³µì„ ì„±ì´ ì—†ì–´ì•¼ í•©ë‹ˆë‹¤. ë‹¤ì¤‘ê³µì„ ì„±ì€ ë‘ ê°œ ì´ìƒì˜ ë…ë¦½ ë³€ìˆ˜ê°€ ë†’ì€ ìƒê´€ ê´€ê³„ë¥¼ ê°€ì§ˆ ë•Œ ë°œìƒí•˜ë©°, ì¢…ì† ë³€ìˆ˜ì— ëŒ€í•œ ê°œë³„ì ì¸ ì˜í–¥ì„ ì¶”ì •í•˜ê¸° ì–´ë µê²Œ ë§Œë“­ë‹ˆë‹¤. ë†’ì€ ë‹¤ì¤‘ê³µì„ ì„±ì€ í‘œì¤€ ì˜¤ì°¨ë¥¼ ê³¼ëŒ€í­ìœ¼ë¡œ ì¦í­ì‹œí‚¤ê³  ì¶”ì • ë§¤ê°œë³€ìˆ˜ë¥¼ ë¶ˆì•ˆì •í•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>G. ì´ìƒì¹˜ ì—†ìŒ: ë°ì´í„°ì˜ ì´ìƒì¹˜ëŠ” ë§¤ê°œë³€ìˆ˜ ì¶”ì •ì¹˜ì— ë¶ˆí•„ìš”í•œ ì˜í–¥ì„ ë¯¸ì¹˜ê³  ëª¨í˜•ì˜ ì „ì²´ì ì¸ ì í•©ë„ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. íšŒê·€ ê²°ê³¼ì˜ íƒ€ë‹¹ì„±ì„ ë³´ì¥í•˜ê¸° ìœ„í•´ ì´ìƒì¹˜ë¥¼ ì‹ë³„í•˜ê³  ì ì ˆíˆ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.</p>\n<h2>1.2â€” ëª¨í˜•</h2>\n<p>Generalized Linear Models(GLM)ì€ ë°˜ì‘ ë³€ìˆ˜ê°€ ì •ê·œ ë¶„í¬ê°€ ì•„ë‹Œ ë¶„í¬ë¥¼ ë”°ë¥´ëŠ” ëª¨í˜•ì…ë‹ˆë‹¤. ì´ëŠ” ë°˜ì‘ ë³€ìˆ˜ê°€ Yes, Noì™€ ê°™ì´ ë²”ì£¼í˜•ì´ë©° âˆ’âˆë¶€í„° +âˆê¹Œì§€ ë²”ìœ„ê°€ ì•„ë‹Œ ëª¨í˜•ì—ì„œ ì„ í˜• íšŒê·€ ëª¨í˜•ê³¼ ëŒ€ì¡°ì ì…ë‹ˆë‹¤.</p>\n<div class=\"content-ad\"></div>\n<p>ë”°ë¼ì„œ, ì‘ë‹µê³¼ ì˜ˆì¸¡ ë³€ìˆ˜ ê°„ì˜ ê´€ê³„ê°€ ì„ í˜•ì¼ í•„ìš”ëŠ” ì—†ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¼ë°˜í™” ì„ í˜• ëª¨í˜•ì—ì„œëŠ”:</p>\n<p><img src=\"/assets/img/2024-06-20-TinyMLPoissonRegression_2.png\" alt=\"image\"></p>\n<p>ì—¬ê¸°ì„œ g(â‹…)ëŠ” ì„ íƒí•œ ë§í¬ í•¨ìˆ˜ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</p>\n<p>í¬ì•„ì†¡ íšŒê·€ ëª¨í˜•ì€ ì¹´ìš´íŠ¸ ë°ì´í„° ë° ë¶„í• í‘œë¥¼ ëª¨ë¸ë§í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ì¼ë°˜í™” ì„ í˜• ëª¨í˜•ì…ë‹ˆë‹¤. ì¶œë ¥ì¸ Y(ì¹´ìš´íŠ¸)ëŠ” í¬ì•„ì†¡ ë¶„í¬ë¥¼ ë”°ë¥´ëŠ” ê°’ì…ë‹ˆë‹¤. ì´ëŠ” ì˜ˆìƒ ê°’(í‰ê· )ì˜ ë¡œê·¸ë¥¼ ì „ì œë¡œ í•˜ë©°, ì´ë¥¼ ì¼ë¶€ ì•Œë ¤ì§€ì§€ ì•Šì€ ë§¤ê°œë³€ìˆ˜ë¡œ ì„ í˜• í˜•íƒœë¡œ ëª¨ë¸ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"content-ad\"></div>\n<p>ë¹„ì„ í˜• ê´€ê³„ë¥¼ ì„ í˜• í˜•íƒœë¡œ ë³€í™˜í•˜ê¸° ìœ„í•´ ë§í¬ í•¨ìˆ˜ê°€ ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ í•¨ìˆ˜ëŠ” í¬ì•„ì†¡ íšŒê·€ì˜ ë¡œê·¸ì…ë‹ˆë‹¤. ì´ë¡œ ì¸í•´ í¬ì•„ì†¡ íšŒê·€ ëª¨ë¸ì€ ì¢…ì¢… ë¡œê·¸-ì„ í˜• ëª¨ë¸ì´ë¼ê³ ë„ ë¶ˆë¦½ë‹ˆë‹¤. í¬ì•„ì†¡ íšŒê·€ ëª¨ë¸ì˜ ì¼ë°˜ì ì¸ ìˆ˜í•™ì  í˜•íƒœëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p>\n<img src=\"/assets/img/2024-06-20-TinyMLPoissonRegression_3.png\">\n<p>ì—¬ê¸°ì„œ Î¼iëŠ” ë°˜ì‘ ë³€ìˆ˜ Yiì˜ ê¸°ëŒ€ê°’ì…ë‹ˆë‹¤.</p>\n<p>ê³„ìˆ˜ Î±ì™€ Î²ëŠ” ìˆ˜ì¹˜ì´ë©°, ì—¬ê¸°ì„œ Î±ëŠ” ì ˆí¸ì„ ë‚˜íƒ€ë‚´ë©° ë•Œë¡œëŠ” Î±ëŠ” Î²0ìœ¼ë¡œë„ í‘œì‹œë©ë‹ˆë‹¤. xëŠ” ì˜ˆì¸¡ ë³€ìˆ˜ ë˜ëŠ” ì„¤ëª… ë³€ìˆ˜ì…ë‹ˆë‹¤.</p>\n<div class=\"content-ad\"></div>\n<p>í•œ ê°œì˜ ì˜ˆì¸¡ ë³€ìˆ˜(predictor variable)ì™€ í•œ ê°œì˜ ì‘ë‹µ ë³€ìˆ˜(response variable)ë¥¼ ê°–ëŠ” ë°©ì •ì‹ì„ ê³ ë ¤í•´ ë´…ì‹œë‹¤:</p>\n<p><img src=\"/assets/img/2024-06-20-TinyMLPoissonRegression_4.png\" alt=\"equation1\"></p>\n<p>ì´ëŠ” ë‹¤ìŒê³¼ ë™ì¼í•©ë‹ˆë‹¤:</p>\n<p><img src=\"/assets/img/2024-06-20-TinyMLPoissonRegression_5.png\" alt=\"equation2\"></p>\n<div class=\"content-ad\"></div>\n<p>í¬ì•„ì†¡ íšŒê·€ ëª¨í˜•ì—ì„œ ì„¤ëª…ë³€ìˆ˜ëŠ” ìˆ˜ì¹˜ê°’ ë˜ëŠ” ë²”ì£¼ê°’ì˜ ì¡°í•©ì„ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>í¬ì•„ì†¡ ë¶„í¬ì™€ í¬ì•„ì†¡ íšŒê·€ì˜ ê°€ì¥ ì¤‘ìš”í•œ íŠ¹ì§• ì¤‘ í•˜ë‚˜ëŠ” ë“±ë¶„ì‚°ì„±ì…ë‹ˆë‹¤. ì´ëŠ” ë¶„í¬ì˜ í‰ê· ê³¼ ë¶„ì‚°ì´ ê°™ìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</p>\n<p>í‰ê· ì„ Î¼ë¼ê³  ê°€ì •í•´ë³´ê² ìŠµë‹ˆë‹¤. í¬ì•„ì†¡ íšŒê·€ì—ì„œëŠ” í‰ê· ê³¼ ë¶„ì‚°ì´ ë‹¤ìŒê³¼ ê°™ì´ ê´€ë ¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤:</p>\n<p><img src=\"/assets/img/2024-06-20-TinyMLPoissonRegression_6.png\" alt=\"equation\"></p>\n<div class=\"content-ad\"></div>\n<p>ì—¬ê¸°ì„œ ÏƒÂ²ì€ ë¶„ì‚° íŒŒë¼ë¯¸í„°ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. í¬ì•„ì†¡ ëª¨ë¸ì´ ì™„ì „íˆ ì í•©ë˜ë ¤ë©´ ë¶„ì‚°ì´ í‰ê· ê³¼ ë™ì¼í•´ì•¼ í•©ë‹ˆë‹¤(var(Y) = E(Y)) ì¦‰, ÏƒÂ² ê°’ì€ 1ì´ ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.</p>\n<p>ë¶„ì‚°ì´ í‰ê· ë³´ë‹¤ í´ ë•Œì—ëŠ” ì´ë¥¼ ì´ˆê³¼ë¶„ì‚°(overdispersion)ì´ë¼ê³  í•˜ë©°, ÏƒÂ² ê°’ì´ 1ë³´ë‹¤ í½ë‹ˆë‹¤. ë°˜ë©´ ÏƒÂ² ê°’ì´ 1ë³´ë‹¤ ì‘ì„ ë•Œì—ëŠ” ì´ë¥¼ ë¯¸ë‹¬ë¶„ì‚°(underdispersion)ì´ë¼ê³  í•©ë‹ˆë‹¤.</p>\n<h2>1.3 â€” ê³„ìˆ˜ ì¶”ì •</h2>\n<p>í¬ì•„ì†¡ íšŒê·€ì—ì„œëŠ” ëª¨ë¸ íŒŒë¼ë¯¸í„°ë¥¼ ì¶”ì •í•˜ì—¬ ë…ë¦½ ë³€ìˆ˜ì™€ ì¢…ì† ê³„ìˆ˜ ë³€ìˆ˜ ê°„ì˜ ìµœì  ê´€ê³„ë¥¼ ì°¾ìŠµë‹ˆë‹¤. ì´ ì¶”ì •ì€ ì£¼ë¡œ ìµœëŒ€ ìš°ë„ë²•ì„ ì‚¬ìš©í•˜ì—¬ ìˆ˜í–‰ë©ë‹ˆë‹¤.</p>\n<div class=\"content-ad\"></div>\n<h2>1.3.1 â€” ìµœëŒ€ ìš°ë„ ë°©ë²• (Maximum Likelihood Method, MLM)</h2>\n<p>ìµœëŒ€ ìš°ë„ ë°©ë²•ì€ í†µê³„ ëª¨ë¸ì˜ ë§¤ê°œ ë³€ìˆ˜ë¥¼ ì¶”ì •í•˜ê¸° ìœ„í•œ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” í†µê³„ ê¸°ë²•ì…ë‹ˆë‹¤. ì´ ë°©ë²•ì€ ê´€ì¸¡ëœ ë°ì´í„°ì˜ ìš°ë„ë¥¼ ê·¹ëŒ€í™”í•˜ëŠ” ë§¤ê°œ ë³€ìˆ˜ ê°’ì„ ì°¾ìŠµë‹ˆë‹¤. ì¦‰, ìš°ë¦¬ëŠ” ì œì•ˆëœ ëª¨ë¸ì— ì˜í•´ ìƒì„±ë˜ì—ˆì„ ê°€ëŠ¥ì„±ì´ ê°€ì¥ ë†’ì€ ê´€ì¸¡ëœ ë°ì´í„°ë¥¼ ë§Œë“œëŠ” ë§¤ê°œ ë³€ìˆ˜ë¥¼ ì°¾ìŠµë‹ˆë‹¤.</p>\n<p>í¬ì•„ì†¡ íšŒê·€ ë¶„ì„ì—ì„œ ìš°ë„ í•¨ìˆ˜ëŠ” ê° ê°œë³„ ê´€ì¸¡ì„ ìœ„í•œ ê´€ì¸¡ëœ íšŸìˆ˜ë¥¼ ê´€ì¸¡ í™•ë¥ ì˜ ê³±ìœ¼ë¡œ ì •ì˜ë©ë‹ˆë‹¤. í˜•ì‹ì ìœ¼ë¡œ, ìš°ë„ í•¨ìˆ˜ L(Î²0, Î²1,â€¦, Î²p)ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì£¼ì–´ì§‘ë‹ˆë‹¤:</p>\n<div class=\"content-ad\"></div>\n<p>ì—¬ê¸°ì— ìˆìŠµë‹ˆë‹¤:</p>\n<ul>\n<li>nì€ ì´ ê´€ì¸¡ê°’ì˜ ìˆ˜ì…ë‹ˆë‹¤.</li>\n<li>yiëŠ” ië²ˆì§¸ ê´€ì¸¡ê°’ì˜ ê´€ì¸¡ëœ ìˆ˜ì…ë‹ˆë‹¤.</li>\n<li>Î¼iëŠ” ië²ˆì§¸ ê´€ì¸¡ê°’ì— í•´ë‹¹í•˜ëŠ” ì´ë¡ ì  í‰ê· ìœ¼ë¡œ, ë¡œê·¸ ë§í¬ í•¨ìˆ˜ì— ì˜í•´ ì£¼ì–´ì§‘ë‹ˆë‹¤.</li>\n</ul>\n<p>íŒŒë¼ë¯¸í„° ì¶”ì •ì˜ ëª©í‘œëŠ” ìš°ë„ í•¨ìˆ˜ë¥¼ ìµœëŒ€í™”í•˜ëŠ” ê³„ìˆ˜ Î²0, Î²1,..., Î²pì˜ ê°’ì„ ì°¾ëŠ” ê²ƒì…ë‹ˆë‹¤. ë‹¤ì‹œ ë§í•´, ìš°ë¦¬ëŠ” ê´€ì¸¡ëœ ë°ì´í„°ê°€ í¬ì•„ì†¡ íšŒê·€ ëª¨ë¸ì— ì˜í•´ ìƒì„±ë˜ì—ˆì„ ê°€ëŠ¥ì„±ì´ ê°€ì¥ ë†’ì€ ë§¤ê°œë³€ìˆ˜ë¥¼ ì°¾ìŠµë‹ˆë‹¤.</p>\n<h1>2 â€” TinyML êµ¬í˜„</h1>\n<div class=\"content-ad\"></div>\n<p>ìœ„ì˜ ì˜ˆì‹œë¥¼ í†µí•´ ESP32, Arduino, Arduino Portenta H7 with Vision Shield, Raspberry ë° ë‹¤ë¥¸ ë‹¤ì–‘í•œ ë§ˆì´í¬ë¡œì»¨íŠ¸ë¡¤ëŸ¬ ë˜ëŠ” IoT ê¸°ê¸°ì—ì„œ ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>2.0 â€” requirements.txt íŒŒì¼ì— ë‚˜ì—´ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•˜ì„¸ìš”</p>\n<pre><code class=\"hljs language-js\">!pip install -r requirements.<span class=\"hljs-property\">txt</span>\n</code></pre>\n<p>2.1 â€” ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°€ì ¸ì˜¤ê¸°</p>\n<div class=\"content-ad\"></div>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-keyword\">from</span> sklearn.model_selection <span class=\"hljs-keyword\">import</span> train_test_split\n<span class=\"hljs-keyword\">from</span> sklearn.linear_model <span class=\"hljs-keyword\">import</span> PoissonRegressor\n<span class=\"hljs-keyword\">from</span> sklearn.metrics <span class=\"hljs-keyword\">import</span> (\n    mean_absolute_error,\n    mean_poisson_deviance,\n    mean_squared_error,\n)\n\n<span class=\"hljs-keyword\">import</span> m2cgen <span class=\"hljs-keyword\">as</span> m2c\n<span class=\"hljs-keyword\">import</span> numpy <span class=\"hljs-keyword\">as</span> np\n<span class=\"hljs-keyword\">import</span> pandas <span class=\"hljs-keyword\">as</span> pd\n<span class=\"hljs-keyword\">import</span> seaborn <span class=\"hljs-keyword\">as</span> sns\n\n<span class=\"hljs-keyword\">from</span> matplotlib <span class=\"hljs-keyword\">import</span> pyplot <span class=\"hljs-keyword\">as</span> plt\n\n<span class=\"hljs-keyword\">import</span> warnings\nwarnings.filterwarnings(<span class=\"hljs-string\">'ignore'</span>)\n</code></pre>\n<p>2.2 â€” ë°ì´í„°ì…‹ ë¡œë“œ</p>\n<p>â€œì°¨ëŸ‰ ì†ì„± ë° ë°°ì¶œ ë°ì´í„°ì…‹â€ì€ 2000ë…„ì— ì œì¡°ëœ ë‹¤ì–‘í•œ ì°¨ëŸ‰ì— ëŒ€í•œ í¬ê´„ì ì¸ ì •ë³´ë¥¼ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ ë°ì´í„°ì…‹ì—ëŠ” ì œì¡°ì‚¬, ëª¨ë¸, ì°¨ëŸ‰ í´ë˜ìŠ¤, ì—”ì§„ í¬ê¸°, ì‹¤ë¦°ë” ìˆ˜, ë³€ì†ê¸° ìœ í˜• ë° ì—°ë£Œ ìœ í˜•ê³¼ ê°™ì€ ì„¸ë¶€ ì •ë³´ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë˜í•œ ì—°ë£Œ ì†Œë¹„ ë° ì´ì‚°í™”íƒ„ì†Œ ë°°ì¶œì— ëŒ€í•œ ë²”ìœ„ë¥¼ ì œê³µí•˜ì—¬ ê° ì°¨ëŸ‰ì˜ í™˜ê²½ ì˜í–¥ì— ëŒ€í•œ í†µì°°ì„ ì œê³µí•©ë‹ˆë‹¤. ì´ ë°ì´í„°ì…‹ì€ ì†Œí˜•ë¶€í„° ì¤‘í˜•ê¹Œì§€ ë‹¤ì–‘í•œ ì°¨ì¢…ì„ í¬í•¨í•˜ë©°, ì „í†µì ì¸ ëª¨ë¸ë¶€í„° ê³ ì„±ëŠ¥ ëª¨ë¸ê¹Œì§€ ëª¨ë‘ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ ì •ë³´ë¥¼ í†µí•´ ë¶„ì„ê°€ì™€ ì—°êµ¬ìëŠ” ì°¨ëŸ‰ íŠ¹ì„±, ì—°ë£Œ íš¨ìœ¨ì„± ë° ë°°ì¶œ ì¶”ì„¸ë¥¼ ì—°êµ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë°ì´í„°ì…‹ì€ ìë™ì°¨ ì‚°ì—… í™˜ê²½ì„ ì´í•´í•˜ê³  í™˜ê²½ ì§€ì† ê°€ëŠ¥ì„± ë° êµí†µ ì •ì±…ì— ëŒ€í•œ ë…¼ì˜ì— ì •ë³´ë¥¼ ì œê³µí•˜ëŠ” ì†Œì¤‘í•œ ìë£Œì›ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.</p>\n<p>ë§í¬: <a href=\"https://www.kaggle.com/datasets/krupadharamshi/fuelconsumption/data\" rel=\"nofollow\" target=\"_blank\">https://www.kaggle.com/datasets/krupadharamshi/fuelconsumption/data</a></p>\n<div class=\"content-ad\"></div>\n<pre><code class=\"hljs language-python\">df = pd.read_csv(<span class=\"hljs-string\">'./data/FuelConsumption.csv'</span>)\ndf.head()\n</code></pre>\n<img src=\"/assets/img/2024-06-20-TinyMLPoissonRegression_8.png\">\n<pre><code class=\"hljs language-python\">df.info()\n</code></pre>\n<img src=\"/assets/img/2024-06-20-TinyMLPoissonRegression_9.png\">\n<div class=\"content-ad\"></div>\n<pre><code class=\"hljs language-js\">df.<span class=\"hljs-title function_\">describe</span>()\n</code></pre>\n<p><img src=\"/assets/img/2024-06-20-TinyMLPoissonRegression_10.png\" alt=\"ì´ë¯¸ì§€\"></p>\n<p>2.3 â€” ë°ì´í„° ì •ë¦¬</p>\n<pre><code class=\"hljs language-js\"># <span class=\"hljs-number\">1.</span> ê²°ì¸¡ê°’ì´ ìˆëŠ” í–‰ ì œê±°\ndf.<span class=\"hljs-title function_\">dropna</span>(inplace=<span class=\"hljs-title class_\">True</span>)\n# <span class=\"hljs-number\">2.</span> ì¤‘ë³µê°’ ì œê±°\ndf.<span class=\"hljs-title function_\">drop_duplicates</span>(inplace=<span class=\"hljs-title class_\">True</span>)\n</code></pre>\n<div class=\"content-ad\"></div>\n<h1>ë°ì´í„° í”„ë ˆì„ ì •ë¦¬ í›„ì— ê²°ê³¼ í‘œì‹œ</h1>\n<p>df.describe()</p>\n<p><img src=\"/assets/img/2024-06-20-TinyMLPoissonRegression_11.png\" alt=\"ì´ë¯¸ì§€\"></p>\n<p>2.4 â€” íƒìƒ‰ì  ë°ì´í„° ë¶„ì„</p>\n<pre><code class=\"hljs language-python\">sns.pairplot(df[[<span class=\"hljs-string\">'ENGINE SIZE'</span>,<span class=\"hljs-string\">'CYLINDERS'</span>,<span class=\"hljs-string\">'FUEL CONSUMPTION'</span>,<span class=\"hljs-string\">'COEMISSIONS '</span>]])\nplt.savefig(<span class=\"hljs-string\">'.\\\\figures\\\\pairplot.png'</span>, dpi=<span class=\"hljs-number\">300</span>, bbox_inches=<span class=\"hljs-string\">'tight'</span>)\n</code></pre>\n<div class=\"content-ad\"></div>\n<img src=\"/assets/img/2024-06-20-TinyMLPoissonRegression_12.png\">\n<pre><code class=\"hljs language-js\">corr = df[[<span class=\"hljs-string\">'ENGINE SIZE'</span>,<span class=\"hljs-string\">'CYLINDERS'</span>,<span class=\"hljs-string\">'FUEL CONSUMPTION'</span>,<span class=\"hljs-string\">'COEMISSIONS '</span>]].<span class=\"hljs-title function_\">corr</span>(<span class=\"hljs-string\">'spearman'</span>)\n</code></pre>\n<pre><code class=\"hljs language-js\"># ê·¸ë¦¼ í¬ê¸° ì¡°ì ˆ\nplt.<span class=\"hljs-title function_\">figure</span>(figsize=(<span class=\"hljs-number\">18</span>,<span class=\"hljs-number\">10</span>))\n# íˆíŠ¸ë§µ ìƒì„±ì„ ìœ„í•œ ê¸°ì¡´ ì½”ë“œ\nheatmap = sns.<span class=\"hljs-title function_\">heatmap</span>(corr, xticklabels=corr.<span class=\"hljs-property\">columns</span>, yticklabels=corr.<span class=\"hljs-property\">columns</span>, cmap=<span class=\"hljs-string\">'coolwarm'</span>)\n# íˆíŠ¸ë§µì— ê°’ ì¶”ê°€\n<span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-title function_\">range</span>(<span class=\"hljs-title function_\">len</span>(corr.<span class=\"hljs-property\">columns</span>)):\n    <span class=\"hljs-keyword\">for</span> j <span class=\"hljs-keyword\">in</span> <span class=\"hljs-title function_\">range</span>(<span class=\"hljs-title function_\">len</span>(corr.<span class=\"hljs-property\">columns</span>)):\n        plt.<span class=\"hljs-title function_\">text</span>(j + <span class=\"hljs-number\">0.5</span>, i + <span class=\"hljs-number\">0.5</span>, f<span class=\"hljs-string\">\"{corr.iloc[i, j]:.2f}\"</span>, ha=<span class=\"hljs-string\">'center'</span>, va=<span class=\"hljs-string\">'center'</span>, color=<span class=\"hljs-string\">'black'</span>, fontsize=<span class=\"hljs-number\">18</span>)\n\nplt.<span class=\"hljs-title function_\">xticks</span>(fontsize=<span class=\"hljs-number\">20</span>, rotation=<span class=\"hljs-number\">45</span>)\nplt.<span class=\"hljs-title function_\">yticks</span>(fontsize=<span class=\"hljs-number\">20</span>, rotation=<span class=\"hljs-number\">0</span>)\ncbar = heatmap.<span class=\"hljs-property\">collections</span>[<span class=\"hljs-number\">0</span>].<span class=\"hljs-property\">colorbar</span>\ncbar.<span class=\"hljs-property\">ax</span>.<span class=\"hljs-title function_\">tick_params</span>(labelsize=<span class=\"hljs-number\">20</span>)\n\nplt.<span class=\"hljs-title function_\">savefig</span>(<span class=\"hljs-string\">'.\\\\figures\\\\heatmap.png'</span>, dpi=<span class=\"hljs-number\">300</span>, bbox_inches=<span class=\"hljs-string\">'tight'</span>)\n\n# íˆíŠ¸ë§µ í‘œì‹œ\nplt.<span class=\"hljs-title function_\">show</span>()\n</code></pre>\n<img src=\"/assets/img/2024-06-20-TinyMLPoissonRegression_13.png\">\n<div class=\"content-ad\"></div>\n<p>2.5â€” í›ˆë ¨ ë° í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ ë¶„í• í•˜ê¸°</p>\n<pre><code class=\"hljs language-js\">X=df[[<span class=\"hljs-string\">'ì—”ì§„ í¬ê¸°'</span>,<span class=\"hljs-string\">'ì‹¤ë¦°ë”'</span>, <span class=\"hljs-string\">'CO2 ë°°ì¶œëŸ‰'</span>]]\ny=df[[<span class=\"hljs-string\">'ì—°ë£Œ ì†Œë¹„'</span>]]\n</code></pre>\n<pre><code class=\"hljs language-js\"># ë°ì´í„°ë¥¼ í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¡œ ë¶„í• í•˜ê¸°\nX_train, X_test, y_train, y_test = <span class=\"hljs-title function_\">train_test_split</span>(X, y, test_size=<span class=\"hljs-number\">0.3</span>, random_state=<span class=\"hljs-number\">42</span>)\n</code></pre>\n<p>2.6 â€” íšŒê·€ ëª¨ë¸ ìƒì„±í•˜ê¸°</p>\n<div class=\"content-ad\"></div>\n<pre><code class=\"hljs language-js\">def <span class=\"hljs-title function_\">score_estimator</span>(y_pred , y_true):\n\n    <span class=\"hljs-title function_\">print</span>(\n        <span class=\"hljs-string\">\"MSE: %.3f\"</span>\n        % <span class=\"hljs-title function_\">mean_squared_error</span>(\n            y_true, y_pred\n        )\n    )\n    <span class=\"hljs-title function_\">print</span>(\n        <span class=\"hljs-string\">\"MAE: %.3f\"</span>\n        % <span class=\"hljs-title function_\">mean_absolute_error</span>(\n            y_true, y_pred, \n        )\n    )\n\n    # í‘¸ì•„ì†¡ ì†ì‹¤ì„ ê³„ì‚°í•  ë•Œ, ìœ íš¨í•˜ì§€ ì•Šì€ ë¹„ ì–‘ìˆ˜ ì˜ˆì¸¡ì„ ë¬´ì‹œí•©ë‹ˆë‹¤.\n    mask = y_pred > <span class=\"hljs-number\">0</span>\n    <span class=\"hljs-keyword\">if</span> (~mask).<span class=\"hljs-title function_\">any</span>():\n        n_masked, n_samples = (~mask).<span class=\"hljs-title function_\">sum</span>(), mask.<span class=\"hljs-property\">shape</span>[<span class=\"hljs-number\">0</span>]\n        <span class=\"hljs-title function_\">print</span>(\n            <span class=\"hljs-string\">\"ê²½ê³ : ì¶”ì •ìê°€ í‘¸ì•„ì†¡ ì†ì‹¤ì„ ê³„ì‚°í•  ë•Œ, %sê°œì˜ ìƒ˜í”Œ ì¤‘ %sê°œì˜ ë¹„ ìœ íš¨í•œ, ë¹„ ì–‘ìˆ˜ ì˜ˆì¸¡ ê°’ì´ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ì˜ˆì¸¡ ê°’ì€ í‘¸ì•„ì†¡ ì†ì‹¤ì„ ê³„ì‚°í•  ë•Œ ë¬´ì‹œë©ë‹ˆë‹¤.\"</span>\n            % (n_samples, n_masked)\n        )\n\n    <span class=\"hljs-title function_\">print</span>(\n        <span class=\"hljs-string\">\"í‰ê·  í‘¸ì•„ì†¡ ì†ì‹¤: %.3f\"</span>\n        % <span class=\"hljs-title function_\">mean_poisson_deviance</span>(\n            y_true ,\n            y_pred  \n        )\n    )\n</code></pre>\n<pre><code class=\"hljs language-js\">model = <span class=\"hljs-title class_\">PoissonRegressor</span>(alpha=<span class=\"hljs-number\">1e-12</span>)\n</code></pre>\n<p>2.7 â€” ëª¨ë¸ í•™ìŠµ</p>\n<pre><code class=\"hljs language-js\">model.<span class=\"hljs-title function_\">fit</span>(X_train, y_train)\n</code></pre>\n<div class=\"content-ad\"></div>\n<p>2.8 â€” ëª¨ë¸ í‰ê°€</p>\n<pre><code class=\"hljs language-js\">y_train_pred = model.<span class=\"hljs-title function_\">predict</span>(X_train)\ny_test_pred = model.<span class=\"hljs-title function_\">predict</span>(X_test)\n</code></pre>\n<pre><code class=\"hljs language-js\"># ì”ì°¨ ê³„ì‚°\ntrain_residuals = y_train.<span class=\"hljs-property\">values</span>.<span class=\"hljs-title function_\">reshape</span>(<span class=\"hljs-number\">1</span>,-<span class=\"hljs-number\">1</span>).<span class=\"hljs-title function_\">tolist</span>()[<span class=\"hljs-number\">0</span>] - y_train_pred\n# ì”ì°¨ì˜ í‰ê· ê³¼ í‘œì¤€ í¸ì°¨ ê³„ì‚°\ntrain_residuals_mean = np.<span class=\"hljs-title function_\">mean</span>(train_residuals)\ntrain_residuals_std = np.<span class=\"hljs-title function_\">std</span>(train_residuals)\n# ì”ì°¨ ê³„ì‚°\ntest_residuals = y_test.<span class=\"hljs-property\">values</span>.<span class=\"hljs-title function_\">reshape</span>(<span class=\"hljs-number\">1</span>,-<span class=\"hljs-number\">1</span>).<span class=\"hljs-title function_\">tolist</span>()[<span class=\"hljs-number\">0</span>] - y_test_pred\n# ì”ì°¨ì˜ í‰ê· ê³¼ í‘œì¤€ í¸ì°¨ ê³„ì‚°\ntest_residuals_mean = np.<span class=\"hljs-title function_\">mean</span>(test_residuals)\ntest_residuals_std = np.<span class=\"hljs-title function_\">std</span>(test_residuals)\n\n\n# ì”ì°¨ ì‹œê°í™”\nplt.<span class=\"hljs-title function_\">figure</span>(figsize=(<span class=\"hljs-number\">10</span>, <span class=\"hljs-number\">5</span>))\n\nplt.<span class=\"hljs-title function_\">subplot</span>(<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">1</span>)\nplt.<span class=\"hljs-title function_\">scatter</span>(y_train_pred, train_residuals, c=<span class=\"hljs-string\">'blue'</span>, marker=<span class=\"hljs-string\">'o'</span>, label=f<span class=\"hljs-string\">'í•™ìŠµ ë°ì´í„°'</span>)\nplt.<span class=\"hljs-title function_\">axhline</span>(y=<span class=\"hljs-number\">0</span>, color=<span class=\"hljs-string\">'r'</span>, linestyle=<span class=\"hljs-string\">'-'</span>)\nplt.<span class=\"hljs-title function_\">axhline</span>(y=train_residuals_mean, color=<span class=\"hljs-string\">'k'</span>, linestyle=<span class=\"hljs-string\">'--'</span>, label=f<span class=\"hljs-string\">'í‰ê· : {train_residuals_mean:.3f}'</span>)\nplt.<span class=\"hljs-title function_\">axhline</span>(y=train_residuals_mean + <span class=\"hljs-number\">2</span> * train_residuals_std, color=<span class=\"hljs-string\">'g'</span>, linestyle=<span class=\"hljs-string\">'--'</span>, label=f<span class=\"hljs-string\">'+2 í‘œì¤€ í¸ì°¨: {2*train_residuals_std:.2f}'</span>)\nplt.<span class=\"hljs-title function_\">axhline</span>(y=train_residuals_mean - <span class=\"hljs-number\">2</span> * train_residuals_std, color=<span class=\"hljs-string\">'g'</span>, linestyle=<span class=\"hljs-string\">'--'</span>, label=f<span class=\"hljs-string\">'-2 í‘œì¤€ í¸ì°¨: {-2*train_residuals_std:.2f}'</span>)  \nplt.<span class=\"hljs-title function_\">xlabel</span>(<span class=\"hljs-string\">'ì˜ˆì¸¡ ê°’'</span>)\nplt.<span class=\"hljs-title function_\">ylabel</span>(<span class=\"hljs-string\">'ì”ì°¨'</span>)\nplt.<span class=\"hljs-title function_\">title</span>(<span class=\"hljs-string\">'ì”ì°¨ ëŒ€ ì˜ˆì¸¡ ê°’ (í•™ìŠµ ë°ì´í„°)'</span>)\nplt.<span class=\"hljs-title function_\">legend</span>(loc=<span class=\"hljs-string\">'upper left'</span>)\nplt.<span class=\"hljs-title function_\">grid</span>(<span class=\"hljs-title class_\">True</span>)\n\nplt.<span class=\"hljs-title function_\">subplot</span>(<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">2</span>)\nplt.<span class=\"hljs-title function_\">scatter</span>(y_test_pred, test_residuals, c=<span class=\"hljs-string\">'green'</span>, marker=<span class=\"hljs-string\">'s'</span>, label=f<span class=\"hljs-string\">'í…ŒìŠ¤íŠ¸ ë°ì´í„°'</span>)\nplt.<span class=\"hljs-title function_\">axhline</span>(y=<span class=\"hljs-number\">0</span>, color=<span class=\"hljs-string\">'r'</span>, linestyle=<span class=\"hljs-string\">'-'</span>)\nplt.<span class=\"hljs-title function_\">axhline</span>(y=test_residuals_mean, color=<span class=\"hljs-string\">'k'</span>, linestyle=<span class=\"hljs-string\">'--'</span>, label=f<span class=\"hljs-string\">'í‰ê· : {test_residuals_mean:.3f}'</span>)\nplt.<span class=\"hljs-title function_\">axhline</span>(y=test_residuals_mean + <span class=\"hljs-number\">2</span> * test_residuals_std, color=<span class=\"hljs-string\">'g'</span>, linestyle=<span class=\"hljs-string\">'--'</span>, label=f<span class=\"hljs-string\">'+2 í‘œì¤€ í¸ì°¨: {2*test_residuals_std:.2f}'</span>)\nplt.<span class=\"hljs-title function_\">axhline</span>(y=test_residuals_mean - <span class=\"hljs-number\">2</span> * test_residuals_std, color=<span class=\"hljs-string\">'g'</span>, linestyle=<span class=\"hljs-string\">'--'</span>, label=f<span class=\"hljs-string\">'-2 í‘œì¤€ í¸ì°¨: {-2*test_residuals_std:.2f}'</span>)  \nplt.<span class=\"hljs-title function_\">xlabel</span>(<span class=\"hljs-string\">'ì˜ˆì¸¡ ê°’'</span>)\nplt.<span class=\"hljs-title function_\">ylabel</span>(<span class=\"hljs-string\">'ì”ì°¨'</span>)\nplt.<span class=\"hljs-title function_\">title</span>(<span class=\"hljs-string\">'ì”ì°¨ ëŒ€ ì˜ˆì¸¡ ê°’ (í…ŒìŠ¤íŠ¸ ë°ì´í„°)'</span>)\nplt.<span class=\"hljs-title function_\">legend</span>(loc=<span class=\"hljs-string\">'upper left'</span>)\nplt.<span class=\"hljs-title function_\">grid</span>(<span class=\"hljs-title class_\">True</span>)\n\nplt.<span class=\"hljs-title function_\">tight_layout</span>()\nplt.<span class=\"hljs-title function_\">show</span>()\n\n\n\n# ì •ê·œì„± í™•ì¸\nplt.<span class=\"hljs-title function_\">figure</span>(figsize=(<span class=\"hljs-number\">10</span>, <span class=\"hljs-number\">5</span>))\n\nplt.<span class=\"hljs-title function_\">subplot</span>(<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">1</span>)\nplt.<span class=\"hljs-title function_\">hist</span>(train_residuals, bins=<span class=\"hljs-number\">20</span>, color=<span class=\"hljs-string\">'blue'</span>, alpha=<span class=\"hljs-number\">0.6</span>)\nplt.<span class=\"hljs-title function_\">title</span>(<span class=\"hljs-string\">'ì”ì°¨ íˆìŠ¤í† ê·¸ë¨ (í•™ìŠµ ë°ì´í„°)'</span>)\nplt.<span class=\"hljs-title function_\">xlabel</span>(<span class=\"hljs-string\">'ì”ì°¨'</span>)\nplt.<span class=\"hljs-title function_\">ylabel</span>(<span class=\"hljs-string\">'ë¹ˆë„'</span>)\nplt.<span class=\"hljs-title function_\">axvline</span>(x=train_residuals_mean, color=<span class=\"hljs-string\">'k'</span>, linestyle=<span class=\"hljs-string\">'--'</span>, label=f<span class=\"hljs-string\">'í‰ê· : {train_residuals_mean:.3f}'</span>)\nplt.<span class=\"hljs-title function_\">axvline</span>(x=train_residuals_mean + <span class=\"hljs-number\">2</span> * train_residuals_std, color=<span class=\"hljs-string\">'g'</span>, linestyle=<span class=\"hljs-string\">'--'</span>, label=f<span class=\"hljs-string\">'+2 í‘œì¤€ í¸ì°¨: {2*train_residuals_std:.3f}'</span>)\nplt.<span class=\"hljs-title function_\">axvline</span>(x=train_residuals_mean - <span class=\"hljs-number\">2</span> * train_residuals_std, color=<span class=\"hljs-string\">'g'</span>, linestyle=<span class=\"hljs-string\">'--'</span>, label=f<span class=\"hljs-string\">'-2 í‘œì¤€ í¸ì°¨: {-2*train_residuals_std:.3f}'</span>)  \nplt.<span class=\"hljs-title function_\">legend</span>(loc=<span class=\"hljs-string\">'upper right'</span>)\nplt.<span class=\"hljs-title function_\">grid</span>(<span class=\"hljs-title class_\">True</span>)\n\nplt.<span class=\"hljs-title function_\">subplot</span>(<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">2</span>)\nplt.<span class=\"hljs-title function_\">hist</span>(test_residuals, bins=<span class=\"hljs-number\">20</span>, color=<span class=\"hljs-string\">'green'</span>, alpha=<span class=\"hljs-number\">0.6</span>)\nplt.<span class=\"hljs-title function_\">title</span>(<span class=\"hljs-string\">'ì”ì°¨ íˆìŠ¤í† ê·¸ë¨ (í…ŒìŠ¤íŠ¸ ë°ì´í„°)'</span>)\nplt.<span class=\"hljs-title function_\">xlabel</span>(<span class=\"hljs-string\">'ì”ì°¨'</span>)\nplt.<span class=\"hljs-title function_\">ylabel</span>(<span class=\"hljs-string\">'ë¹ˆë„'</span>)\nplt.<span class=\"hljs-title function_\">axvline</span>(x=test_residuals_mean, color=<span class=\"hljs-string\">'k'</span>, linestyle=<span class=\"hljs-string\">'--'</span>, label=f<span class=\"hljs-string\">'í‰ê· : {test_residuals_mean:.3f}'</span>)\nplt.<span class=\"hljs-title function_\">axvline</span>(x=test_residuals_mean + <span class=\"hljs-number\">2</span> * test_residuals_std, color=<span class=\"hljs-string\">'g'</span>, linestyle=<span class=\"hljs-string\">'--'</span>, label=f<span class=\"hljs-string\">'+2 í‘œì¤€ í¸ì°¨: {2*test_residuals_std:.3f}'</span>)\nplt.<span class=\"hljs-title function_\">axvline</span>(x=test_residuals_mean - <span class=\"hljs-number\">2</span> * test_residuals_std, color=<span class=\"hljs-string\">'g'</span>, linestyle=<span class=\"hljs-string\">'--'</span>, label=f<span class=\"hljs-string\">'-2 í‘œì¤€ í¸ì°¨: {-2*test_residuals_std:.3f}'</span>)  \nplt.<span class=\"hljs-title function_\">legend</span>(loc=<span class=\"hljs-string\">'upper right'</span>)\nplt.<span class=\"hljs-title function_\">grid</span>(<span class=\"hljs-title class_\">True</span>)\n\nplt.<span class=\"hljs-title function_\">tight_layout</span>()\nplt.<span class=\"hljs-title function_\">show</span>()\n</code></pre>\n<div class=\"content-ad\"></div>\n<p>ì•ˆë…•í•˜ì„¸ìš”! ìš”ì²­í•˜ì‹  ë‚´ìš©ì„ í•œêµ­ì–´ë¡œ ë²ˆì—­í•´ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>\n<p><img src=\"/assets/img/2024-06-20-TinyMLPoissonRegression_15.png\" alt=\"ì´ë¯¸ì§€\"></p>\n<p>2.8.1 â€” í›ˆë ¨ ë°ì´í„°ë¡œ ëª¨ë¸ í‰ê°€í•˜ê¸°</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-title function_\">print</span>(<span class=\"hljs-string\">\"PoissonRegressor í‰ê°€:\"</span>)\n<span class=\"hljs-title function_\">score_estimator</span>(y_train_pred, y_train)\n</code></pre>\n<p><img src=\"/assets/img/2024-06-20-TinyMLPoissonRegression_16.png\" alt=\"ì´ë¯¸ì§€\"></p>\n<div class=\"content-ad\"></div>\n<pre><code class=\"hljs language-js\">plt.<span class=\"hljs-title function_\">plot</span>(y_train.<span class=\"hljs-property\">values</span>, label=<span class=\"hljs-string\">\"ì›ë³¸\"</span>)\nplt.<span class=\"hljs-title function_\">plot</span>(y_train_pred, label=<span class=\"hljs-string\">\"ì˜ˆì¸¡\"</span>)\nplt.<span class=\"hljs-title function_\">legend</span>(loc=<span class=\"hljs-string\">'best'</span>, fancybox=<span class=\"hljs-title class_\">True</span>, shadow=<span class=\"hljs-title class_\">True</span>)\nplt.<span class=\"hljs-title function_\">grid</span>()\n</code></pre>\n<p><img src=\"/assets/img/2024-06-20-TinyMLPoissonRegression_17.png\" alt=\"ì´ë¯¸ì§€\"></p>\n<p>2.8.2 â€” í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ ëª¨ë¸ í‰ê°€</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-title function_\">print</span>(<span class=\"hljs-string\">\"PoissonRegressor í‰ê°€:\"</span>)\n<span class=\"hljs-title function_\">score_estimator</span>(y_test_pred, y_test)\n</code></pre>\n<div class=\"content-ad\"></div>\n<p><img src=\"/assets/img/2024-06-20-TinyMLPoissonRegression_18.png\" alt=\"2024-06-20-TinyMLPoissonRegression_18.png\"></p>\n<pre><code class=\"hljs language-js\">plt.<span class=\"hljs-title function_\">plot</span>(y_test.<span class=\"hljs-property\">values</span>, label=<span class=\"hljs-string\">\"original\"</span>)\nplt.<span class=\"hljs-title function_\">plot</span>(y_test_pred, label=<span class=\"hljs-string\">\"predicted\"</span>)\nplt.<span class=\"hljs-title function_\">legend</span>(loc=<span class=\"hljs-string\">'best'</span>, fancybox=<span class=\"hljs-title class_\">True</span>, shadow=<span class=\"hljs-title class_\">True</span>)\nplt.<span class=\"hljs-title function_\">grid</span>()\n</code></pre>\n<p><img src=\"/assets/img/2024-06-20-TinyMLPoissonRegression_19.png\" alt=\"2024-06-20-TinyMLPoissonRegression_19.png\"></p>\n<p>2.9 â€” Microcontrollerì— êµ¬í˜„ë  ëª¨ë¸ ì–»ê¸°</p>\n<div class=\"content-ad\"></div>\n<pre><code class=\"hljs language-js\">code = m2c.<span class=\"hljs-title function_\">export_to_c</span>(model)\n<span class=\"hljs-title function_\">print</span>(code)\n</code></pre>\n<pre><code class=\"hljs language-js\">#include &#x3C;math.<span class=\"hljs-property\">h</span>>\ndouble <span class=\"hljs-title function_\">score</span>(<span class=\"hljs-params\">double *input</span>)\n{\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_\">exp</span>(<span class=\"hljs-number\">1.7347124654302846</span> + input[<span class=\"hljs-number\">0</span>] * <span class=\"hljs-number\">0.011406244946132144</span> + input[<span class=\"hljs-number\">1</span>] * <span class=\"hljs-number\">0.01010646886054758</span> + input[<span class=\"hljs-number\">2</span>] * <span class=\"hljs-number\">0.0028201461971878914</span>);\n}\n</code></pre>\n<p>2.10â€” .h íŒŒì¼ì— í…œí”Œë¦¿ ì €ì¥</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">with</span> <span class=\"hljs-title function_\">open</span>(<span class=\"hljs-string\">'./PoissonRegressor.h'</span>, <span class=\"hljs-string\">'w'</span>) <span class=\"hljs-keyword\">as</span> <span class=\"hljs-attr\">file</span>:\n    file.<span class=\"hljs-title function_\">write</span>(code)\n</code></pre>\n<div class=\"content-ad\"></div>\n<h2>2.11 â€” ëª¨ë¸ ë°°í¬</h2>\n<p>2.11.1 â€” ì•„ë‘ì´ë…¸ ìŠ¤ì¼€ì¹˜ ì™„ì„±</p>\n<pre><code class=\"hljs language-js\">#include <span class=\"hljs-string\">\"PoissonRegressor.h\"</span>\n\n<span class=\"hljs-title class_\">Eloquent</span>::<span class=\"hljs-attr\">ML</span>::<span class=\"hljs-title class_\">Port</span>::<span class=\"hljs-title class_\">PoissonRegressor</span> <span class=\"hljs-title class_\">PoissonRegressor</span>;\n\n<span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">setup</span>(<span class=\"hljs-params\"></span>)\n{\n  <span class=\"hljs-title class_\">Serial</span>.<span class=\"hljs-title function_\">begin</span>(<span class=\"hljs-number\">115200</span>);\n}\n\n<span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">loop</span>(<span class=\"hljs-params\"></span>)\n{\n  float <span class=\"hljs-variable constant_\">X_1</span>[] = {<span class=\"hljs-number\">6.</span>, <span class=\"hljs-number\">2.7</span>, <span class=\"hljs-number\">5.1</span>, <span class=\"hljs-number\">1.6</span>};\n  int result_1 = <span class=\"hljs-title class_\">PoissonRegressor</span>.<span class=\"hljs-title function_\">predict</span>(<span class=\"hljs-variable constant_\">X_1</span>);\n  <span class=\"hljs-title class_\">Serial</span>.<span class=\"hljs-title function_\">print</span>(<span class=\"hljs-string\">\"X1ì„ ì…ë ¥ìœ¼ë¡œ í•œ ì˜ˆì¸¡ ê²°ê³¼(ì‹¤ì œ ê°’ = 1):\"</span>);\n  <span class=\"hljs-title class_\">Serial</span>.<span class=\"hljs-title function_\">println</span>(result_1);\n  <span class=\"hljs-title function_\">delay</span>(<span class=\"hljs-number\">2000</span>);\n\n  float <span class=\"hljs-variable constant_\">X_2</span>[] = {<span class=\"hljs-number\">4.8</span>, <span class=\"hljs-number\">3.1</span>, <span class=\"hljs-number\">1.6</span>, <span class=\"hljs-number\">0.2</span>};\n  int result_2 = <span class=\"hljs-title class_\">PoissonRegressor</span>.<span class=\"hljs-title function_\">predict</span>(<span class=\"hljs-variable constant_\">X_2</span>);\n  <span class=\"hljs-title class_\">Serial</span>.<span class=\"hljs-title function_\">print</span>(<span class=\"hljs-string\">\"X2ì„ ì…ë ¥ìœ¼ë¡œ í•œ ì˜ˆì¸¡ ê²°ê³¼(ì‹¤ì œ ê°’ = 0):\"</span>);\n  <span class=\"hljs-title class_\">Serial</span>.<span class=\"hljs-title function_\">println</span>(result_2);\n  <span class=\"hljs-title function_\">delay</span>(<span class=\"hljs-number\">2000</span>);\n}\n</code></pre>\n<p>2.12 â€” ê²°ê³¼</p>\n<div class=\"content-ad\"></div>\n<p><img src=\"/assets/img/2024-06-20-TinyMLPoissonRegression_20.png\" alt=\"ì´ë¯¸ì§€\"></p>\n<p>ì „ì²´ í”„ë¡œì íŠ¸: TinyML/15_Poisson_Regressor at main Â· thommaskevin/TinyML (github.com)</p>\n<h2>ë§Œì•½ ë§ˆìŒì— ë“œì‹ ë‹¤ë©´ ì œê²Œ ì»¤í”¼ í•œ ì” ì‚¬ì£¼ì„¸ìš” â˜•ï¸ğŸ’° (Bitcoin)</h2>\n<p>ì½”ë“œ: bc1qzydjy4m9yhmjjrkgtrzhsgmkq79qenvcvc7qzn</p>\n<div class=\"content-ad\"></div>\n<p><img src=\"/assets/img/2024-06-20-TinyMLPoissonRegression_21.png\" alt=\"image\"></p>\n</body>\n</html>\n"},"__N_SSG":true}