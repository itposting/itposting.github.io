{"pageProps":{"post":{"title":"PowerShell을 사용해 SMTP로 메일 보내는 방법","description":"","date":"2024-06-22 16:32","slug":"2024-06-22-HowtosendmailSMTPwithPowerShell","content":"\n\n파워셸로 이메일을 SMTP로 보내는 방법은 어떻게 해야 하나요? 오랜 시간 리눅스 사용자인 저에게 윈도우로 돌아오는 것은 새로운 경험이죠.\n\n작업 중에 애플리케이션이 이메일을 보내지 못하는 이유를 알 수 없어 곤란할 때가 종종 있죠. 컴퓨터에서 메일 연결을 테스트하여 제대로 작동하는지 확인하고 싶을 것입니다.\n\n자, 이제 PowerShell을 사용하여 인증된 SMTP로 메일을 보내는 테스트를 해볼 거에요.\n\n\n# 먼저 SMTP 정보를 가져오세요\n\n\n<div class=\"content-ad\"></div>\n\n우선, 이메일 SMTP를 테스트하여 메일 서버를 인증하는 계정으로 전송할 것입니다. 따라서 아래와 같은 정보를 얻어야 합니다:\n\n- 사용자 이름: 메일 서버에 로그인하는 데 사용되는 사용자 이름.\n- 암호: 메일 서버에 로그인하는 데 사용되는 암호.\n- SMTP 서버: 메일 서버의 주소.\n- SMTP 포트: 이메일을 전송하는 데 사용할 포트.\n\n예를 들어, 다음과 같이 얻었습니다:\n\n- 사용자 이름: usertest\n- 암호: Passtest123\n- SMTP 서버: retail.smtp.com (smtp.com을 사용)\n- SMTP 포트: 25\n\n<div class=\"content-ad\"></div>\n\n# PowerShell을 사용하여 이메일 SMTP 전송하기\n\n![이미지](/assets/img/2024-06-22-HowtosendmailSMTPwithPowerShell_0.png)\n\n이제 아래 명령어를 실행하기 전에 값을 본인에 맞게 변경해 주세요:\n\n```javascript\n$username = 'usertest'\n$password = 'Passtest123'\n$secpasswd = ConvertTo-SecureString $password -AsPlainText -Force\n$mycreds = New-Object System.Management.Automation.PSCredential ($username, $secpasswd)\nSend-MailMessage -Credential $mycreds -SmtpServer retail.smtp.com -Port 25 -From usertest@devopslite.com -To ghost@gmail.com -Subject test -Body test\n```\n\n<div class=\"content-ad\"></div>\n\n- $username: 이 줄은 사용자 이름을 정의합니다.\n- $password: 이 줄은 암호를 정의합니다.\n- $secpasswd: 일반 텍스트 암호를 비밀 문자열로 변환하는 함수를 호출합니다.\n- $mycreds: 사용자 이름과 비밀 암호로 새 객체를 만들어, Send-MailMessage 명령어에 전달됩니다.\n- Send-MailMessage: 이 명령은 주소 usertest@devopslite.com에서 ghost@gmail.com으로 이메일을 보내는 데 사용됩니다. -Subject 및 -Body 옵션을 따라 내용을 변경할 수도 있습니다.\n\n만약 smtp 포트 25를 사용하지 않는다면, 위 명령을 TLS 연결을 사용하는 포트 587을 사용하도록 변경할 수 있습니다.\n\n```js\n$username = 'usertest'\n$password = 'Passtest123'\n$secpasswd = ConvertTo-SecureString $password -AsPlainText -Force\n$mycreds = New-Object System.Management.Automation.PSCredential ($username, $secpasswd)\nSend-MailMessage -Credential $mycreds -SmtpServer retail.smtp.com -Port 587 -UseSsl -From usertest@devopslite.com -To ghost@gmail.com -Subject test -Body test\n```\n\n# 결론\n\n<div class=\"content-ad\"></div>\n\n간단한 명령어 몇 개만 사용하면 Windows에서 PowerShell을 사용하여 SMTP로 이메일을 보낼 수 있어요. 제 데모에서는 Windows 11 OS를 사용하고 있어서 다른 OS에서도 잘 동작할 거예요.\n\n원본 게시물: https://devopslite.com/how-to-send-mail-smtp-with-powershell/","ogImage":{"url":"/assets/img/2024-06-22-HowtosendmailSMTPwithPowerShell_0.png"},"coverImage":"/assets/img/2024-06-22-HowtosendmailSMTPwithPowerShell_0.png","tag":["Tech"],"readingTime":3},"content":"<!doctype html>\n<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n</head>\n<body>\n<p>파워셸로 이메일을 SMTP로 보내는 방법은 어떻게 해야 하나요? 오랜 시간 리눅스 사용자인 저에게 윈도우로 돌아오는 것은 새로운 경험이죠.</p>\n<p>작업 중에 애플리케이션이 이메일을 보내지 못하는 이유를 알 수 없어 곤란할 때가 종종 있죠. 컴퓨터에서 메일 연결을 테스트하여 제대로 작동하는지 확인하고 싶을 것입니다.</p>\n<p>자, 이제 PowerShell을 사용하여 인증된 SMTP로 메일을 보내는 테스트를 해볼 거에요.</p>\n<h1>먼저 SMTP 정보를 가져오세요</h1>\n<div class=\"content-ad\"></div>\n<p>우선, 이메일 SMTP를 테스트하여 메일 서버를 인증하는 계정으로 전송할 것입니다. 따라서 아래와 같은 정보를 얻어야 합니다:</p>\n<ul>\n<li>사용자 이름: 메일 서버에 로그인하는 데 사용되는 사용자 이름.</li>\n<li>암호: 메일 서버에 로그인하는 데 사용되는 암호.</li>\n<li>SMTP 서버: 메일 서버의 주소.</li>\n<li>SMTP 포트: 이메일을 전송하는 데 사용할 포트.</li>\n</ul>\n<p>예를 들어, 다음과 같이 얻었습니다:</p>\n<ul>\n<li>사용자 이름: usertest</li>\n<li>암호: Passtest123</li>\n<li>SMTP 서버: retail.smtp.com (smtp.com을 사용)</li>\n<li>SMTP 포트: 25</li>\n</ul>\n<div class=\"content-ad\"></div>\n<h1>PowerShell을 사용하여 이메일 SMTP 전송하기</h1>\n<p><img src=\"/assets/img/2024-06-22-HowtosendmailSMTPwithPowerShell_0.png\" alt=\"이미지\"></p>\n<p>이제 아래 명령어를 실행하기 전에 값을 본인에 맞게 변경해 주세요:</p>\n<pre><code class=\"hljs language-javascript\">$username = <span class=\"hljs-string\">'usertest'</span>\n$password = <span class=\"hljs-string\">'Passtest123'</span>\n$secpasswd = <span class=\"hljs-title class_\">ConvertTo</span>-<span class=\"hljs-title class_\">SecureString</span> $password -<span class=\"hljs-title class_\">AsPlainText</span> -<span class=\"hljs-title class_\">Force</span>\n$mycreds = <span class=\"hljs-title class_\">New</span>-<span class=\"hljs-title class_\">Object</span> <span class=\"hljs-title class_\">System</span>.<span class=\"hljs-property\">Management</span>.<span class=\"hljs-property\">Automation</span>.<span class=\"hljs-property\">PSCredential</span> ($username, $secpasswd)\n<span class=\"hljs-title class_\">Send</span>-<span class=\"hljs-title class_\">MailMessage</span> -<span class=\"hljs-title class_\">Credential</span> $mycreds -<span class=\"hljs-title class_\">SmtpServer</span> retail.<span class=\"hljs-property\">smtp</span>.<span class=\"hljs-property\">com</span> -<span class=\"hljs-title class_\">Port</span> <span class=\"hljs-number\">25</span> -<span class=\"hljs-title class_\">From</span> usertest@devopslite.<span class=\"hljs-property\">com</span> -<span class=\"hljs-title class_\">To</span> ghost@gmail.<span class=\"hljs-property\">com</span> -<span class=\"hljs-title class_\">Subject</span> test -<span class=\"hljs-title class_\">Body</span> test\n</code></pre>\n<div class=\"content-ad\"></div>\n<ul>\n<li>$username: 이 줄은 사용자 이름을 정의합니다.</li>\n<li>$password: 이 줄은 암호를 정의합니다.</li>\n<li>$secpasswd: 일반 텍스트 암호를 비밀 문자열로 변환하는 함수를 호출합니다.</li>\n<li>$mycreds: 사용자 이름과 비밀 암호로 새 객체를 만들어, Send-MailMessage 명령어에 전달됩니다.</li>\n<li>Send-MailMessage: 이 명령은 주소 <a href=\"mailto:usertest@devopslite.com\">usertest@devopslite.com</a>에서 <a href=\"mailto:ghost@gmail.com\">ghost@gmail.com</a>으로 이메일을 보내는 데 사용됩니다. -Subject 및 -Body 옵션을 따라 내용을 변경할 수도 있습니다.</li>\n</ul>\n<p>만약 smtp 포트 25를 사용하지 않는다면, 위 명령을 TLS 연결을 사용하는 포트 587을 사용하도록 변경할 수 있습니다.</p>\n<pre><code class=\"hljs language-js\">$username = <span class=\"hljs-string\">'usertest'</span>\n$password = <span class=\"hljs-string\">'Passtest123'</span>\n$secpasswd = <span class=\"hljs-title class_\">ConvertTo</span>-<span class=\"hljs-title class_\">SecureString</span> $password -<span class=\"hljs-title class_\">AsPlainText</span> -<span class=\"hljs-title class_\">Force</span>\n$mycreds = <span class=\"hljs-title class_\">New</span>-<span class=\"hljs-title class_\">Object</span> <span class=\"hljs-title class_\">System</span>.<span class=\"hljs-property\">Management</span>.<span class=\"hljs-property\">Automation</span>.<span class=\"hljs-property\">PSCredential</span> ($username, $secpasswd)\n<span class=\"hljs-title class_\">Send</span>-<span class=\"hljs-title class_\">MailMessage</span> -<span class=\"hljs-title class_\">Credential</span> $mycreds -<span class=\"hljs-title class_\">SmtpServer</span> retail.<span class=\"hljs-property\">smtp</span>.<span class=\"hljs-property\">com</span> -<span class=\"hljs-title class_\">Port</span> <span class=\"hljs-number\">587</span> -<span class=\"hljs-title class_\">UseSsl</span> -<span class=\"hljs-title class_\">From</span> usertest@devopslite.<span class=\"hljs-property\">com</span> -<span class=\"hljs-title class_\">To</span> ghost@gmail.<span class=\"hljs-property\">com</span> -<span class=\"hljs-title class_\">Subject</span> test -<span class=\"hljs-title class_\">Body</span> test\n</code></pre>\n<h1>결론</h1>\n<div class=\"content-ad\"></div>\n<p>간단한 명령어 몇 개만 사용하면 Windows에서 PowerShell을 사용하여 SMTP로 이메일을 보낼 수 있어요. 제 데모에서는 Windows 11 OS를 사용하고 있어서 다른 OS에서도 잘 동작할 거예요.</p>\n<p>원본 게시물: <a href=\"https://devopslite.com/how-to-send-mail-smtp-with-powershell/\" rel=\"nofollow\" target=\"_blank\">https://devopslite.com/how-to-send-mail-smtp-with-powershell/</a></p>\n</body>\n</html>\n"},"__N_SSG":true}