{"pageProps":{"post":{"title":"블루투스를 사용하여 헤드리스 라즈베리 파이에 연결하는 방법","description":"","date":"2024-06-23 18:13","slug":"2024-06-23-ConnecttoaheadlessRaspberryPiusingBluetooth","content":"\n\n<img src=\"/assets/img/2024-06-23-ConnecttoaheadlessRaspberryPiusingBluetooth_0.png\" />\n\n헤드리스 Raspberry Pi 기반 솔루션을 배포하는 데 있어서의 한 가지 어려움은 고객 네트워크에 라우터 액세스 없이 장치를 구성하는 것입니다. 종종 기계의 무선 설정을 변경해야 하지만 클라이언트 환경에서 설정을 변경할 수 있는 방법이 없습니다. 한 가지 솔루션은 장치에 Bluetooth 시리얼 포트를 구성하여 PC에서 실행 중인 Putty SSH 세션과 통신을 허용하는 것입니다. 연결이 설정되면 Bluetooth 검색을 끄어 다른 사람이 심지어 인식하지 못하도록 할 수 있습니다. 기계에서 액세스 포인트를 여는 것보다 안전하며 훨씬 간단합니다. 사실, 이 솔루션을 사용하려면 설치할 새 소프트웨어가 필요하지 않습니다. 대부분의 Bluetooth 기능을 포함하는 빌드와 함께 제공되는 소프트웨어의 구성만 필요합니다. 이를 Raspberry Pi 3+ 및 OrangePi Zero 3에서 시험했습니다. 한 가지 주의할 점은, 이 솔루션은 미래 릴리스에서 폐기될 예정이라는 RFCOMM 소프트웨어에 기반을 두고 있습니다. 다른 패키지를 사용한 (간단한) 대체 방법을 찾지 못했고, 제 개인적인 구성 도구에서만 사용하고 있기 때문에 미래의 구식화 위험을 감수할 의향이 있습니다. 웹에서 솔루션을 연구하는 동안 해결책에 대한 기술적인 기사를 많이 찾았지만 단계별 가이드는 찾지 못했습니다. 그래서 여기에 있습니다...\n\n- 개발이나 구성을 위해 일반적으로 수행하는 것처럼 Windows PC의 PuTTY를 사용하여 알려진 네트워크의 헤드리스 장치에 연결합니다.\n- RFCOMM 서비스를 위한 서비스 시작 파일을 추가합니다. 이는 /etc/systemd/system 디렉토리에 있어야하며 파일 이름은 rfcomm.service 여야합니다.\n\n```js\nsudo nano /etc/systemd/system/rfcomm.service\n```\n\n<div class=\"content-ad\"></div>\n\n아래 내용을 입력해주세요:\n\n\n[Unit]\nDescription=RFCOMM 서비스\nAfter=bluetooth.service\nRequires=bluetooth.service\n[Service]\nExecStart=/usr/bin/rfcomm watch hci0 1 getty rfcomm0 115200 xterm -a <로그인이름>\n[Install]\nWantedBy=multi-user.target\n\n\n`<로그인이름>` 자리에 기기에 로그인하려는 사용자 이름을 입력해주세요. 만약 자동 로그인을 원치 않는다면, `ExecStart` 줄의 `xterm` 이후에 있는 모든 내용을 제거해주세요.\n\n3. 다음 명령어를 사용하여 재부팅 시 실행되도록 이 서비스를 설치해주세요:\n\n<div class=\"content-ad\"></div>\n\n```js\nsudo systemctl enable rfcomm\n```\n\n4. 다음과 같이 맨 위에 \"DisbablePlugins = pnat\" 문을 추가하여 파일 /etc/bluetooth/main.conf를 수정하십시오:\n\n```js\n[General]\nDisablePlugins = pnat\n```\n\n5. 사용하고 싶은 Bluetooth 이름을 가진 파일 /etc/machine-info를 추가하거나 수정하십시오.\n\n<div class=\"content-ad\"></div>\n\n```js\nPRETTY_HOSTNAME=<블루투스이름>\n```\n\n원하는 장치 이름으로 표시하고 싶다면 `블루투스이름`을 대체하세요.\n\n6. 블루투스 서비스 파일을 수정하세요.\n\n```js\nsudo nano /etc/systemd/system/bluetooth.target.wants/bluetooth.service\n```\n\n<div class=\"content-ad\"></div>\n\n다음 두 줄로 대체해주세요:\n\n```js\nExecStart=/usr/libexec/bluetooth/bluetoothd -C\nExecStartPost=/usr/bin/sdptool add SP\n```\n\n<div class=\"content-ad\"></div>\n\n7. 이제 구성이 완료되어 장치를 다시 부팅하여 서비스를 다시 시작하세요.\n\n8. 이제 PC와 Bluetooth 연결을 수동으로 설정할 수 있습니다. 이 작업은 한 번만 수행하면 됩니다. 기기가 근접할 때마다 연결이 다시 설정됩니다. 라즈베리 파이 장치에서 다음 명령을 입력하세요:\n\n```js\nsudo bluetoothctl\ndiscoverable on\nagent on\npairable on\nscan on\n```\n\n이제 아래와 같이 Bluetooth 장치 ID가 표시됩니다. 통신하는 기기의 16진수 값을 찾아 작동 중인지 확인하세요.\n\n<div class=\"content-ad\"></div>\n\n<img src=\"/assets/img/2024-06-23-ConnecttoaheadlessRaspberryPiusingBluetooth_1.png\" />\n\n9. 이제 Windows PC로 이동하여 \"Bluetooth 및 기타 장치 설정\"을 열어주세요. 그런 다음 \"Bluetooth 또는 기타 장치 추가\"를 선택한 후 \"Bluetooth\"를 선택합니다. 그러면 장치 목록이 표시됩니다. 해당 장치를 선택하면 페어링 키가 표시되고 확인 메시지가 나타납니다. PC에서 확인한 후 라즈베리 파이에서 두 가지 메시지에 \"예\"로 답하세요. 이 시점에서 두 장치가 페어링되었으며 이제 라즈베리 파이 창으로 돌아가서 다음과 같이 입력해주세요:\n\n```js\nDiscoverable off\nexit\n```\n\n10. 올바른 연결을 확인하려면 PC로 돌아가주세요. \"Bluetooth 및 기타 장치\" 창에서 아래로 스크롤하여 \"장치 및 프린터\"를 찾아 선택해주세요. 여기에 따라 \"Unspecified\" 항목 하위에 장치 목록이 표시됩니다.\n\n<div class=\"content-ad\"></div>\n\n\n<img src=\"/assets/img/2024-06-23-ConnecttoaheadlessRaspberryPiusingBluetooth_2.png\" />\n\n이제 디바이스에 마우스 오른쪽 버튼을 클릭한 다음 \"속성\"을 선택하세요. 그런 다음 \"서비스\" 탭을 선택하세요. 다음과 같은 화면이 나타날 것입니다:\n\n<img src=\"/assets/img/2024-06-23-ConnecttoaheadlessRaspberryPiusingBluetooth_3.png\" />\n\n시리얼 포트 항목이 여러분의 디바이스에 연결해야 하는 포트입니다. 다음 단계에서 사용할 COM 포트 번호를 기록해주세요.\n\n\n<div class=\"content-ad\"></div>\n\n11. 이제 PC에서 새 PuTTY 창을 열고 표시된대로 연결 매개변수를 입력하세요. \"Serial\" 연결 유형을 선택하고 COM 포트 및 속도 값을 입력하세요.\n\n![이미지](/assets/img/2024-06-23-ConnecttoaheadlessRaspberryPiusingBluetooth_4.png)\n\n이제 \"열기\"를 선택하고 잠시 후에...\n\n![이미지](/assets/img/2024-06-23-ConnecttoaheadlessRaspberryPiusingBluetooth_5.png)\n\n<div class=\"content-ad\"></div>\n\n당신이 있네요!\n\n이제 raspi-config를 사용하여 다른 네트워크를 설정하거나 필요한 다른 구성 변경을 할 수 있습니다.\n\n여기까지 왔으니, 두 장치를 모두 전원을 끄고 다시 키고, 다시 구성하지 않고도 연결할 수 있는 능력을 테스트해보는 것이 좋습니다. 두 기기가 재부팅된 후 PC에서 \"Bluetooth 및 기타 장치\"로 이동하여 장치가 식별되고 시리얼 포트 서비스가 실행 중인지 확인하세요. 그렇다면 준비된 것입니다. 이제 두 장치를 Wifi 접속이 없는 위치로 옮기고 여전히 PuTTY와 Bluetooth를 통해 무선 장치와 통신할 수 있습니다.\n\n그게 다에요! 마지막으로 한 가지 덧붙이자면, 몇 년간 Medium에서 독자로 활동해 왔지만, 이번이 처음으로 글을 게시하는 시도입니다. 건성적인 피드백을 환영할게요.","ogImage":{"url":"/assets/img/2024-06-23-ConnecttoaheadlessRaspberryPiusingBluetooth_0.png"},"coverImage":"/assets/img/2024-06-23-ConnecttoaheadlessRaspberryPiusingBluetooth_0.png","tag":["Tech"],"readingTime":5},"content":"<!doctype html>\n<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n</head>\n<body>\n<img src=\"/assets/img/2024-06-23-ConnecttoaheadlessRaspberryPiusingBluetooth_0.png\">\n<p>헤드리스 Raspberry Pi 기반 솔루션을 배포하는 데 있어서의 한 가지 어려움은 고객 네트워크에 라우터 액세스 없이 장치를 구성하는 것입니다. 종종 기계의 무선 설정을 변경해야 하지만 클라이언트 환경에서 설정을 변경할 수 있는 방법이 없습니다. 한 가지 솔루션은 장치에 Bluetooth 시리얼 포트를 구성하여 PC에서 실행 중인 Putty SSH 세션과 통신을 허용하는 것입니다. 연결이 설정되면 Bluetooth 검색을 끄어 다른 사람이 심지어 인식하지 못하도록 할 수 있습니다. 기계에서 액세스 포인트를 여는 것보다 안전하며 훨씬 간단합니다. 사실, 이 솔루션을 사용하려면 설치할 새 소프트웨어가 필요하지 않습니다. 대부분의 Bluetooth 기능을 포함하는 빌드와 함께 제공되는 소프트웨어의 구성만 필요합니다. 이를 Raspberry Pi 3+ 및 OrangePi Zero 3에서 시험했습니다. 한 가지 주의할 점은, 이 솔루션은 미래 릴리스에서 폐기될 예정이라는 RFCOMM 소프트웨어에 기반을 두고 있습니다. 다른 패키지를 사용한 (간단한) 대체 방법을 찾지 못했고, 제 개인적인 구성 도구에서만 사용하고 있기 때문에 미래의 구식화 위험을 감수할 의향이 있습니다. 웹에서 솔루션을 연구하는 동안 해결책에 대한 기술적인 기사를 많이 찾았지만 단계별 가이드는 찾지 못했습니다. 그래서 여기에 있습니다...</p>\n<ul>\n<li>개발이나 구성을 위해 일반적으로 수행하는 것처럼 Windows PC의 PuTTY를 사용하여 알려진 네트워크의 헤드리스 장치에 연결합니다.</li>\n<li>RFCOMM 서비스를 위한 서비스 시작 파일을 추가합니다. 이는 /etc/systemd/system 디렉토리에 있어야하며 파일 이름은 rfcomm.service 여야합니다.</li>\n</ul>\n<pre><code class=\"hljs language-js\">sudo nano /etc/systemd/system/rfcomm.<span class=\"hljs-property\">service</span>\n</code></pre>\n<div class=\"content-ad\"></div>\n<p>아래 내용을 입력해주세요:</p>\n<p>[Unit]\nDescription=RFCOMM 서비스\nAfter=bluetooth.service\nRequires=bluetooth.service\n[Service]\nExecStart=/usr/bin/rfcomm watch hci0 1 getty rfcomm0 115200 xterm -a &#x3C;로그인이름>\n[Install]\nWantedBy=multi-user.target</p>\n<p><code>&#x3C;로그인이름></code> 자리에 기기에 로그인하려는 사용자 이름을 입력해주세요. 만약 자동 로그인을 원치 않는다면, <code>ExecStart</code> 줄의 <code>xterm</code> 이후에 있는 모든 내용을 제거해주세요.</p>\n<ol start=\"3\">\n<li>다음 명령어를 사용하여 재부팅 시 실행되도록 이 서비스를 설치해주세요:</li>\n</ol>\n<div class=\"content-ad\"></div>\n<pre><code class=\"hljs language-js\">sudo systemctl enable rfcomm\n</code></pre>\n<ol start=\"4\">\n<li>다음과 같이 맨 위에 \"DisbablePlugins = pnat\" 문을 추가하여 파일 /etc/bluetooth/main.conf를 수정하십시오:</li>\n</ol>\n<pre><code class=\"hljs language-js\">[<span class=\"hljs-title class_\">General</span>]\n<span class=\"hljs-title class_\">DisablePlugins</span> = pnat\n</code></pre>\n<ol start=\"5\">\n<li>사용하고 싶은 Bluetooth 이름을 가진 파일 /etc/machine-info를 추가하거나 수정하십시오.</li>\n</ol>\n<div class=\"content-ad\"></div>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-variable constant_\">PRETTY_HOSTNAME</span>=&#x3C;블루투스이름>\n</code></pre>\n<p>원하는 장치 이름으로 표시하고 싶다면 <code>블루투스이름</code>을 대체하세요.</p>\n<ol start=\"6\">\n<li>블루투스 서비스 파일을 수정하세요.</li>\n</ol>\n<pre><code class=\"hljs language-js\">sudo nano /etc/systemd/system/bluetooth.<span class=\"hljs-property\">target</span>.<span class=\"hljs-property\">wants</span>/bluetooth.<span class=\"hljs-property\">service</span>\n</code></pre>\n<div class=\"content-ad\"></div>\n<p>다음 두 줄로 대체해주세요:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-title class_\">ExecStart</span>=<span class=\"hljs-regexp\">/usr/</span>libexec/bluetooth/bluetoothd -C\n<span class=\"hljs-title class_\">ExecStartPost</span>=<span class=\"hljs-regexp\">/usr/</span>bin/sdptool add <span class=\"hljs-variable constant_\">SP</span>\n</code></pre>\n<div class=\"content-ad\"></div>\n<ol start=\"7\">\n<li>\n<p>이제 구성이 완료되어 장치를 다시 부팅하여 서비스를 다시 시작하세요.</p>\n</li>\n<li>\n<p>이제 PC와 Bluetooth 연결을 수동으로 설정할 수 있습니다. 이 작업은 한 번만 수행하면 됩니다. 기기가 근접할 때마다 연결이 다시 설정됩니다. 라즈베리 파이 장치에서 다음 명령을 입력하세요:</p>\n</li>\n</ol>\n<pre><code class=\"hljs language-js\">sudo bluetoothctl\ndiscoverable on\nagent on\npairable on\nscan on\n</code></pre>\n<p>이제 아래와 같이 Bluetooth 장치 ID가 표시됩니다. 통신하는 기기의 16진수 값을 찾아 작동 중인지 확인하세요.</p>\n<div class=\"content-ad\"></div>\n<img src=\"/assets/img/2024-06-23-ConnecttoaheadlessRaspberryPiusingBluetooth_1.png\">\n<ol start=\"9\">\n<li>이제 Windows PC로 이동하여 \"Bluetooth 및 기타 장치 설정\"을 열어주세요. 그런 다음 \"Bluetooth 또는 기타 장치 추가\"를 선택한 후 \"Bluetooth\"를 선택합니다. 그러면 장치 목록이 표시됩니다. 해당 장치를 선택하면 페어링 키가 표시되고 확인 메시지가 나타납니다. PC에서 확인한 후 라즈베리 파이에서 두 가지 메시지에 \"예\"로 답하세요. 이 시점에서 두 장치가 페어링되었으며 이제 라즈베리 파이 창으로 돌아가서 다음과 같이 입력해주세요:</li>\n</ol>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-title class_\">Discoverable</span> off\nexit\n</code></pre>\n<ol start=\"10\">\n<li>올바른 연결을 확인하려면 PC로 돌아가주세요. \"Bluetooth 및 기타 장치\" 창에서 아래로 스크롤하여 \"장치 및 프린터\"를 찾아 선택해주세요. 여기에 따라 \"Unspecified\" 항목 하위에 장치 목록이 표시됩니다.</li>\n</ol>\n<div class=\"content-ad\"></div>\n<img src=\"/assets/img/2024-06-23-ConnecttoaheadlessRaspberryPiusingBluetooth_2.png\">\n<p>이제 디바이스에 마우스 오른쪽 버튼을 클릭한 다음 \"속성\"을 선택하세요. 그런 다음 \"서비스\" 탭을 선택하세요. 다음과 같은 화면이 나타날 것입니다:</p>\n<img src=\"/assets/img/2024-06-23-ConnecttoaheadlessRaspberryPiusingBluetooth_3.png\">\n<p>시리얼 포트 항목이 여러분의 디바이스에 연결해야 하는 포트입니다. 다음 단계에서 사용할 COM 포트 번호를 기록해주세요.</p>\n<div class=\"content-ad\"></div>\n<ol start=\"11\">\n<li>이제 PC에서 새 PuTTY 창을 열고 표시된대로 연결 매개변수를 입력하세요. \"Serial\" 연결 유형을 선택하고 COM 포트 및 속도 값을 입력하세요.</li>\n</ol>\n<p><img src=\"/assets/img/2024-06-23-ConnecttoaheadlessRaspberryPiusingBluetooth_4.png\" alt=\"이미지\"></p>\n<p>이제 \"열기\"를 선택하고 잠시 후에...</p>\n<p><img src=\"/assets/img/2024-06-23-ConnecttoaheadlessRaspberryPiusingBluetooth_5.png\" alt=\"이미지\"></p>\n<div class=\"content-ad\"></div>\n<p>당신이 있네요!</p>\n<p>이제 raspi-config를 사용하여 다른 네트워크를 설정하거나 필요한 다른 구성 변경을 할 수 있습니다.</p>\n<p>여기까지 왔으니, 두 장치를 모두 전원을 끄고 다시 키고, 다시 구성하지 않고도 연결할 수 있는 능력을 테스트해보는 것이 좋습니다. 두 기기가 재부팅된 후 PC에서 \"Bluetooth 및 기타 장치\"로 이동하여 장치가 식별되고 시리얼 포트 서비스가 실행 중인지 확인하세요. 그렇다면 준비된 것입니다. 이제 두 장치를 Wifi 접속이 없는 위치로 옮기고 여전히 PuTTY와 Bluetooth를 통해 무선 장치와 통신할 수 있습니다.</p>\n<p>그게 다에요! 마지막으로 한 가지 덧붙이자면, 몇 년간 Medium에서 독자로 활동해 왔지만, 이번이 처음으로 글을 게시하는 시도입니다. 건성적인 피드백을 환영할게요.</p>\n</body>\n</html>\n"},"__N_SSG":true}